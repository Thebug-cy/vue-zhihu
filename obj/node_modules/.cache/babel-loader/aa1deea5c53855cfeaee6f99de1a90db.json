{"remainingRequest":"/Users/w/Documents/三阶段/2020-9-16/node_modules/babel-loader/lib/index.js!/Users/w/Documents/三阶段/2020-9-16/src/components/my-banner/js/jquery-1.7.2.js","dependencies":[{"path":"/Users/w/Documents/三阶段/2020-9-16/src/components/my-banner/js/jquery-1.7.2.js","mtime":1600351385249},{"path":"/Users/w/Documents/三阶段/2020-9-16/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/w/Documents/三阶段/2020-9-16/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdWIiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLnRvLWpzb24iKTsKCnZhciBfdHlwZW9mID0gcmVxdWlyZSgiL1VzZXJzL3cvRG9jdW1lbnRzL1x1NEUwOVx1OTYzNlx1NkJCNS8yMDIwLTktMTYvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIik7CgovKiEKICogalF1ZXJ5IEphdmFTY3JpcHQgTGlicmFyeSB2MS43LjIKICogaHR0cDovL2pxdWVyeS5jb20vCiAqCiAqIENvcHlyaWdodCAyMDExLCBKb2huIFJlc2lnCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLgogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCiAqCiAqIEluY2x1ZGVzIFNpenpsZS5qcwogKiBodHRwOi8vc2l6emxlanMuY29tLwogKiBDb3B5cmlnaHQgMjAxMSwgVGhlIERvam8gRm91bmRhdGlvbgogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlULCBCU0QsIGFuZCBHUEwgTGljZW5zZXMuCiAqCiAqIERhdGU6IFdlZCBNYXIgMjEgMTI6NDY6MzQgMjAxMiAtMDcwMAogKi8KKGZ1bmN0aW9uICh3aW5kb3csIHVuZGVmaW5lZCkgewogIC8vIFVzZSB0aGUgY29ycmVjdCBkb2N1bWVudCBhY2NvcmRpbmdseSB3aXRoIHdpbmRvdyBhcmd1bWVudCAoc2FuZGJveCkKICB2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQsCiAgICAgIG5hdmlnYXRvciA9IHdpbmRvdy5uYXZpZ2F0b3IsCiAgICAgIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uOwoKICB2YXIgalF1ZXJ5ID0gZnVuY3Rpb24gKCkgewogICAgLy8gRGVmaW5lIGEgbG9jYWwgY29weSBvZiBqUXVlcnkKICAgIHZhciBqUXVlcnkgPSBmdW5jdGlvbiBqUXVlcnkoc2VsZWN0b3IsIGNvbnRleHQpIHsKICAgICAgLy8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnCiAgICAgIHJldHVybiBuZXcgalF1ZXJ5LmZuLmluaXQoc2VsZWN0b3IsIGNvbnRleHQsIHJvb3RqUXVlcnkpOwogICAgfSwKICAgICAgICAvLyBNYXAgb3ZlciBqUXVlcnkgaW4gY2FzZSBvZiBvdmVyd3JpdGUKICAgIF9qUXVlcnkgPSB3aW5kb3cualF1ZXJ5LAogICAgICAgIC8vIE1hcCBvdmVyIHRoZSAkIGluIGNhc2Ugb2Ygb3ZlcndyaXRlCiAgICBfJCA9IHdpbmRvdy4kLAogICAgICAgIC8vIEEgY2VudHJhbCByZWZlcmVuY2UgdG8gdGhlIHJvb3QgalF1ZXJ5KGRvY3VtZW50KQogICAgcm9vdGpRdWVyeSwKICAgICAgICAvLyBBIHNpbXBsZSB3YXkgdG8gY2hlY2sgZm9yIEhUTUwgc3RyaW5ncyBvciBJRCBzdHJpbmdzCiAgICAvLyBQcmlvcml0aXplICNpZCBvdmVyIDx0YWc+IHRvIGF2b2lkIFhTUyB2aWEgbG9jYXRpb24uaGFzaCAoIzk1MjEpCiAgICBxdWlja0V4cHIgPSAvXig/OlteIzxdKig8W1x3XFddKz4pW14+XSokfCMoW1x3XC1dKikkKS8sCiAgICAgICAgLy8gQ2hlY2sgaWYgYSBzdHJpbmcgaGFzIGEgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVyIGluIGl0CiAgICBybm90d2hpdGUgPSAvXFMvLAogICAgICAgIC8vIFVzZWQgZm9yIHRyaW1taW5nIHdoaXRlc3BhY2UKICAgIHRyaW1MZWZ0ID0gL15ccysvLAogICAgICAgIHRyaW1SaWdodCA9IC9ccyskLywKICAgICAgICAvLyBNYXRjaCBhIHN0YW5kYWxvbmUgdGFnCiAgICByc2luZ2xlVGFnID0gL148KFx3KylccypcLz8+KD86PFwvXDE+KT8kLywKICAgICAgICAvLyBKU09OIFJlZ0V4cAogICAgcnZhbGlkY2hhcnMgPSAvXltcXSw6e31cc10qJC8sCiAgICAgICAgcnZhbGlkZXNjYXBlID0gL1xcKD86WyJcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZywKICAgICAgICBydmFsaWR0b2tlbnMgPSAvIlteIlxcXG5ccl0qInx0cnVlfGZhbHNlfG51bGx8LT9cZCsoPzpcLlxkKik/KD86W2VFXVsrXC1dP1xkKyk/L2csCiAgICAgICAgcnZhbGlkYnJhY2VzID0gLyg/Ol58OnwsKSg/OlxzKlxbKSsvZywKICAgICAgICAvLyBVc2VyYWdlbnQgUmVnRXhwCiAgICByd2Via2l0ID0gLyh3ZWJraXQpWyBcL10oW1x3Ll0rKS8sCiAgICAgICAgcm9wZXJhID0gLyhvcGVyYSkoPzouKnZlcnNpb24pP1sgXC9dKFtcdy5dKykvLAogICAgICAgIHJtc2llID0gLyhtc2llKSAoW1x3Ll0rKS8sCiAgICAgICAgcm1vemlsbGEgPSAvKG1vemlsbGEpKD86Lio/IHJ2OihbXHcuXSspKT8vLAogICAgICAgIC8vIE1hdGNoZXMgZGFzaGVkIHN0cmluZyBmb3IgY2FtZWxpemluZwogICAgcmRhc2hBbHBoYSA9IC8tKFthLXpdfFswLTldKS9pZywKICAgICAgICBybXNQcmVmaXggPSAvXi1tcy0vLAogICAgICAgIC8vIFVzZWQgYnkgalF1ZXJ5LmNhbWVsQ2FzZSBhcyBjYWxsYmFjayB0byByZXBsYWNlKCkKICAgIGZjYW1lbENhc2UgPSBmdW5jdGlvbiBmY2FtZWxDYXNlKGFsbCwgbGV0dGVyKSB7CiAgICAgIHJldHVybiAobGV0dGVyICsgIiIpLnRvVXBwZXJDYXNlKCk7CiAgICB9LAogICAgICAgIC8vIEtlZXAgYSBVc2VyQWdlbnQgc3RyaW5nIGZvciB1c2Ugd2l0aCBqUXVlcnkuYnJvd3NlcgogICAgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAvLyBGb3IgbWF0Y2hpbmcgdGhlIGVuZ2luZSBhbmQgdmVyc2lvbiBvZiB0aGUgYnJvd3NlcgogICAgYnJvd3Nlck1hdGNoLAogICAgICAgIC8vIFRoZSBkZWZlcnJlZCB1c2VkIG9uIERPTSByZWFkeQogICAgcmVhZHlMaXN0LAogICAgICAgIC8vIFRoZSByZWFkeSBldmVudCBoYW5kbGVyCiAgICBfRE9NQ29udGVudExvYWRlZDIsCiAgICAgICAgLy8gU2F2ZSBhIHJlZmVyZW5jZSB0byBzb21lIGNvcmUgbWV0aG9kcwogICAgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLAogICAgICAgIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksCiAgICAgICAgcHVzaCA9IEFycmF5LnByb3RvdHlwZS5wdXNoLAogICAgICAgIF9zbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZSwKICAgICAgICB0cmltID0gU3RyaW5nLnByb3RvdHlwZS50cmltLAogICAgICAgIGluZGV4T2YgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiwKICAgICAgICAvLyBbW0NsYXNzXV0gLT4gdHlwZSBwYWlycwogICAgY2xhc3MydHlwZSA9IHt9OwoKICAgIGpRdWVyeS5mbiA9IGpRdWVyeS5wcm90b3R5cGUgPSB7CiAgICAgIGNvbnN0cnVjdG9yOiBqUXVlcnksCiAgICAgIGluaXQ6IGZ1bmN0aW9uIGluaXQoc2VsZWN0b3IsIGNvbnRleHQsIHJvb3RqUXVlcnkpIHsKICAgICAgICB2YXIgbWF0Y2gsIGVsZW0sIHJldCwgZG9jOyAvLyBIYW5kbGUgJCgiIiksICQobnVsbCksIG9yICQodW5kZWZpbmVkKQoKICAgICAgICBpZiAoIXNlbGVjdG9yKSB7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9IC8vIEhhbmRsZSAkKERPTUVsZW1lbnQpCgoKICAgICAgICBpZiAoc2VsZWN0b3Iubm9kZVR5cGUpIHsKICAgICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXNbMF0gPSBzZWxlY3RvcjsKICAgICAgICAgIHRoaXMubGVuZ3RoID0gMTsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0gLy8gVGhlIGJvZHkgZWxlbWVudCBvbmx5IGV4aXN0cyBvbmNlLCBvcHRpbWl6ZSBmaW5kaW5nIGl0CgoKICAgICAgICBpZiAoc2VsZWN0b3IgPT09ICJib2R5IiAmJiAhY29udGV4dCAmJiBkb2N1bWVudC5ib2R5KSB7CiAgICAgICAgICB0aGlzLmNvbnRleHQgPSBkb2N1bWVudDsKICAgICAgICAgIHRoaXNbMF0gPSBkb2N1bWVudC5ib2R5OwogICAgICAgICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yOwogICAgICAgICAgdGhpcy5sZW5ndGggPSAxOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSAvLyBIYW5kbGUgSFRNTCBzdHJpbmdzCgoKICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIikgewogICAgICAgICAgLy8gQXJlIHdlIGRlYWxpbmcgd2l0aCBIVE1MIHN0cmluZyBvciBhbiBJRD8KICAgICAgICAgIGlmIChzZWxlY3Rvci5jaGFyQXQoMCkgPT09ICI8IiAmJiBzZWxlY3Rvci5jaGFyQXQoc2VsZWN0b3IubGVuZ3RoIC0gMSkgPT09ICI+IiAmJiBzZWxlY3Rvci5sZW5ndGggPj0gMykgewogICAgICAgICAgICAvLyBBc3N1bWUgdGhhdCBzdHJpbmdzIHRoYXQgc3RhcnQgYW5kIGVuZCB3aXRoIDw+IGFyZSBIVE1MIGFuZCBza2lwIHRoZSByZWdleCBjaGVjawogICAgICAgICAgICBtYXRjaCA9IFtudWxsLCBzZWxlY3RvciwgbnVsbF07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtYXRjaCA9IHF1aWNrRXhwci5leGVjKHNlbGVjdG9yKTsKICAgICAgICAgIH0gLy8gVmVyaWZ5IGEgbWF0Y2gsIGFuZCB0aGF0IG5vIGNvbnRleHQgd2FzIHNwZWNpZmllZCBmb3IgI2lkCgoKICAgICAgICAgIGlmIChtYXRjaCAmJiAobWF0Y2hbMV0gfHwgIWNvbnRleHQpKSB7CiAgICAgICAgICAgIC8vIEhBTkRMRTogJChodG1sKSAtPiAkKGFycmF5KQogICAgICAgICAgICBpZiAobWF0Y2hbMV0pIHsKICAgICAgICAgICAgICBjb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRleHRbMF0gOiBjb250ZXh0OwogICAgICAgICAgICAgIGRvYyA9IGNvbnRleHQgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IGRvY3VtZW50OyAvLyBJZiBhIHNpbmdsZSBzdHJpbmcgaXMgcGFzc2VkIGluIGFuZCBpdCdzIGEgc2luZ2xlIHRhZwogICAgICAgICAgICAgIC8vIGp1c3QgZG8gYSBjcmVhdGVFbGVtZW50IGFuZCBza2lwIHRoZSByZXN0CgogICAgICAgICAgICAgIHJldCA9IHJzaW5nbGVUYWcuZXhlYyhzZWxlY3Rvcik7CgogICAgICAgICAgICAgIGlmIChyZXQpIHsKICAgICAgICAgICAgICAgIGlmIChqUXVlcnkuaXNQbGFpbk9iamVjdChjb250ZXh0KSkgewogICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IFtkb2N1bWVudC5jcmVhdGVFbGVtZW50KHJldFsxXSldOwogICAgICAgICAgICAgICAgICBqUXVlcnkuZm4uYXR0ci5jYWxsKHNlbGVjdG9yLCBjb250ZXh0LCB0cnVlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yID0gW2RvYy5jcmVhdGVFbGVtZW50KHJldFsxXSldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudChbbWF0Y2hbMV1dLCBbZG9jXSk7CiAgICAgICAgICAgICAgICBzZWxlY3RvciA9IChyZXQuY2FjaGVhYmxlID8galF1ZXJ5LmNsb25lKHJldC5mcmFnbWVudCkgOiByZXQuZnJhZ21lbnQpLmNoaWxkTm9kZXM7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4galF1ZXJ5Lm1lcmdlKHRoaXMsIHNlbGVjdG9yKTsgLy8gSEFORExFOiAkKCIjaWQiKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtYXRjaFsyXSk7IC8vIENoZWNrIHBhcmVudE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zCiAgICAgICAgICAgICAgLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2MwoKICAgICAgICAgICAgICBpZiAoZWxlbSAmJiBlbGVtLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgICAgIC8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBJRSBhbmQgT3BlcmEgcmV0dXJuIGl0ZW1zCiAgICAgICAgICAgICAgICAvLyBieSBuYW1lIGluc3RlYWQgb2YgSUQKICAgICAgICAgICAgICAgIGlmIChlbGVtLmlkICE9PSBtYXRjaFsyXSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gcm9vdGpRdWVyeS5maW5kKHNlbGVjdG9yKTsKICAgICAgICAgICAgICAgIH0gLy8gT3RoZXJ3aXNlLCB3ZSBpbmplY3QgdGhlIGVsZW1lbnQgZGlyZWN0bHkgaW50byB0aGUgalF1ZXJ5IG9iamVjdAoKCiAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICB0aGlzWzBdID0gZWxlbTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGRvY3VtZW50OwogICAgICAgICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSAvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKQoKICAgICAgICAgIH0gZWxzZSBpZiAoIWNvbnRleHQgfHwgY29udGV4dC5qcXVlcnkpIHsKICAgICAgICAgICAgcmV0dXJuIChjb250ZXh0IHx8IHJvb3RqUXVlcnkpLmZpbmQoc2VsZWN0b3IpOyAvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dCkKICAgICAgICAgICAgLy8gKHdoaWNoIGlzIGp1c3QgZXF1aXZhbGVudCB0bzogJChjb250ZXh0KS5maW5kKGV4cHIpCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvcihjb250ZXh0KS5maW5kKHNlbGVjdG9yKTsKICAgICAgICAgIH0gLy8gSEFORExFOiAkKGZ1bmN0aW9uKQogICAgICAgICAgLy8gU2hvcnRjdXQgZm9yIGRvY3VtZW50IHJlYWR5CgogICAgICAgIH0gZWxzZSBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7CiAgICAgICAgICByZXR1cm4gcm9vdGpRdWVyeS5yZWFkeShzZWxlY3Rvcik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2VsZWN0b3Iuc2VsZWN0b3IgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yLnNlbGVjdG9yOwogICAgICAgICAgdGhpcy5jb250ZXh0ID0gc2VsZWN0b3IuY29udGV4dDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBqUXVlcnkubWFrZUFycmF5KHNlbGVjdG9yLCB0aGlzKTsKICAgICAgfSwKICAgICAgLy8gU3RhcnQgd2l0aCBhbiBlbXB0eSBzZWxlY3RvcgogICAgICBzZWxlY3RvcjogIiIsCiAgICAgIC8vIFRoZSBjdXJyZW50IHZlcnNpb24gb2YgalF1ZXJ5IGJlaW5nIHVzZWQKICAgICAganF1ZXJ5OiAiMS43LjIiLAogICAgICAvLyBUaGUgZGVmYXVsdCBsZW5ndGggb2YgYSBqUXVlcnkgb2JqZWN0IGlzIDAKICAgICAgbGVuZ3RoOiAwLAogICAgICAvLyBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIGNvbnRhaW5lZCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldAogICAgICBzaXplOiBmdW5jdGlvbiBzaXplKCkgewogICAgICAgIHJldHVybiB0aGlzLmxlbmd0aDsKICAgICAgfSwKICAgICAgdG9BcnJheTogZnVuY3Rpb24gdG9BcnJheSgpIHsKICAgICAgICByZXR1cm4gX3NsaWNlLmNhbGwodGhpcywgMCk7CiAgICAgIH0sCiAgICAgIC8vIEdldCB0aGUgTnRoIGVsZW1lbnQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBzZXQgT1IKICAgICAgLy8gR2V0IHRoZSB3aG9sZSBtYXRjaGVkIGVsZW1lbnQgc2V0IGFzIGEgY2xlYW4gYXJyYXkKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQobnVtKSB7CiAgICAgICAgcmV0dXJuIG51bSA9PSBudWxsID8gLy8gUmV0dXJuIGEgJ2NsZWFuJyBhcnJheQogICAgICAgIHRoaXMudG9BcnJheSgpIDogLy8gUmV0dXJuIGp1c3QgdGhlIG9iamVjdAogICAgICAgIG51bSA8IDAgPyB0aGlzW3RoaXMubGVuZ3RoICsgbnVtXSA6IHRoaXNbbnVtXTsKICAgICAgfSwKICAgICAgLy8gVGFrZSBhbiBhcnJheSBvZiBlbGVtZW50cyBhbmQgcHVzaCBpdCBvbnRvIHRoZSBzdGFjawogICAgICAvLyAocmV0dXJuaW5nIHRoZSBuZXcgbWF0Y2hlZCBlbGVtZW50IHNldCkKICAgICAgcHVzaFN0YWNrOiBmdW5jdGlvbiBwdXNoU3RhY2soZWxlbXMsIG5hbWUsIHNlbGVjdG9yKSB7CiAgICAgICAgLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKICAgICAgICB2YXIgcmV0ID0gdGhpcy5jb25zdHJ1Y3RvcigpOwoKICAgICAgICBpZiAoalF1ZXJ5LmlzQXJyYXkoZWxlbXMpKSB7CiAgICAgICAgICBwdXNoLmFwcGx5KHJldCwgZWxlbXMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBqUXVlcnkubWVyZ2UocmV0LCBlbGVtcyk7CiAgICAgICAgfSAvLyBBZGQgdGhlIG9sZCBvYmplY3Qgb250byB0aGUgc3RhY2sgKGFzIGEgcmVmZXJlbmNlKQoKCiAgICAgICAgcmV0LnByZXZPYmplY3QgPSB0aGlzOwogICAgICAgIHJldC5jb250ZXh0ID0gdGhpcy5jb250ZXh0OwoKICAgICAgICBpZiAobmFtZSA9PT0gImZpbmQiKSB7CiAgICAgICAgICByZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yICsgKHRoaXMuc2VsZWN0b3IgPyAiICIgOiAiIikgKyBzZWxlY3RvcjsKICAgICAgICB9IGVsc2UgaWYgKG5hbWUpIHsKICAgICAgICAgIHJldC5zZWxlY3RvciA9IHRoaXMuc2VsZWN0b3IgKyAiLiIgKyBuYW1lICsgIigiICsgc2VsZWN0b3IgKyAiKSI7CiAgICAgICAgfSAvLyBSZXR1cm4gdGhlIG5ld2x5LWZvcm1lZCBlbGVtZW50IHNldAoKCiAgICAgICAgcmV0dXJuIHJldDsKICAgICAgfSwKICAgICAgLy8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC4KICAgICAgLy8gKFlvdSBjYW4gc2VlZCB0aGUgYXJndW1lbnRzIHdpdGggYW4gYXJyYXkgb2YgYXJncywgYnV0IHRoaXMgaXMKICAgICAgLy8gb25seSB1c2VkIGludGVybmFsbHkuKQogICAgICBlYWNoOiBmdW5jdGlvbiBlYWNoKGNhbGxiYWNrLCBhcmdzKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeS5lYWNoKHRoaXMsIGNhbGxiYWNrLCBhcmdzKTsKICAgICAgfSwKICAgICAgcmVhZHk6IGZ1bmN0aW9uIHJlYWR5KGZuKSB7CiAgICAgICAgLy8gQXR0YWNoIHRoZSBsaXN0ZW5lcnMKICAgICAgICBqUXVlcnkuYmluZFJlYWR5KCk7IC8vIEFkZCB0aGUgY2FsbGJhY2sKCiAgICAgICAgcmVhZHlMaXN0LmFkZChmbik7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCiAgICAgIGVxOiBmdW5jdGlvbiBlcShpKSB7CiAgICAgICAgaSA9ICtpOwogICAgICAgIHJldHVybiBpID09PSAtMSA/IHRoaXMuc2xpY2UoaSkgOiB0aGlzLnNsaWNlKGksIGkgKyAxKTsKICAgICAgfSwKICAgICAgZmlyc3Q6IGZ1bmN0aW9uIGZpcnN0KCkgewogICAgICAgIHJldHVybiB0aGlzLmVxKDApOwogICAgICB9LAogICAgICBsYXN0OiBmdW5jdGlvbiBsYXN0KCkgewogICAgICAgIHJldHVybiB0aGlzLmVxKC0xKTsKICAgICAgfSwKICAgICAgc2xpY2U6IGZ1bmN0aW9uIHNsaWNlKCkgewogICAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhfc2xpY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgInNsaWNlIiwgX3NsaWNlLmNhbGwoYXJndW1lbnRzKS5qb2luKCIsIikpOwogICAgICB9LAogICAgICBtYXA6IGZ1bmN0aW9uIG1hcChjYWxsYmFjaykgewogICAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhqUXVlcnkubWFwKHRoaXMsIGZ1bmN0aW9uIChlbGVtLCBpKSB7CiAgICAgICAgICByZXR1cm4gY2FsbGJhY2suY2FsbChlbGVtLCBpLCBlbGVtKTsKICAgICAgICB9KSk7CiAgICAgIH0sCiAgICAgIGVuZDogZnVuY3Rpb24gZW5kKCkgewogICAgICAgIHJldHVybiB0aGlzLnByZXZPYmplY3QgfHwgdGhpcy5jb25zdHJ1Y3RvcihudWxsKTsKICAgICAgfSwKICAgICAgLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgogICAgICAvLyBCZWhhdmVzIGxpa2UgYW4gQXJyYXkncyBtZXRob2QsIG5vdCBsaWtlIGEgalF1ZXJ5IG1ldGhvZC4KICAgICAgcHVzaDogcHVzaCwKICAgICAgc29ydDogW10uc29ydCwKICAgICAgc3BsaWNlOiBbXS5zcGxpY2UKICAgIH07IC8vIEdpdmUgdGhlIGluaXQgZnVuY3Rpb24gdGhlIGpRdWVyeSBwcm90b3R5cGUgZm9yIGxhdGVyIGluc3RhbnRpYXRpb24KCiAgICBqUXVlcnkuZm4uaW5pdC5wcm90b3R5cGUgPSBqUXVlcnkuZm47CgogICAgalF1ZXJ5LmV4dGVuZCA9IGpRdWVyeS5mbi5leHRlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBvcHRpb25zLAogICAgICAgICAgbmFtZSwKICAgICAgICAgIHNyYywKICAgICAgICAgIGNvcHksCiAgICAgICAgICBjb3B5SXNBcnJheSwKICAgICAgICAgIGNsb25lLAogICAgICAgICAgdGFyZ2V0ID0gYXJndW1lbnRzWzBdIHx8IHt9LAogICAgICAgICAgaSA9IDEsCiAgICAgICAgICBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLAogICAgICAgICAgZGVlcCA9IGZhbHNlOyAvLyBIYW5kbGUgYSBkZWVwIGNvcHkgc2l0dWF0aW9uCgogICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4iKSB7CiAgICAgICAgZGVlcCA9IHRhcmdldDsKICAgICAgICB0YXJnZXQgPSBhcmd1bWVudHNbMV0gfHwge307IC8vIHNraXAgdGhlIGJvb2xlYW4gYW5kIHRoZSB0YXJnZXQKCiAgICAgICAgaSA9IDI7CiAgICAgIH0gLy8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpCgoKICAgICAgaWYgKF90eXBlb2YodGFyZ2V0KSAhPT0gIm9iamVjdCIgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKHRhcmdldCkpIHsKICAgICAgICB0YXJnZXQgPSB7fTsKICAgICAgfSAvLyBleHRlbmQgalF1ZXJ5IGl0c2VsZiBpZiBvbmx5IG9uZSBhcmd1bWVudCBpcyBwYXNzZWQKCgogICAgICBpZiAobGVuZ3RoID09PSBpKSB7CiAgICAgICAgdGFyZ2V0ID0gdGhpczsKICAgICAgICAtLWk7CiAgICAgIH0KCiAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBPbmx5IGRlYWwgd2l0aCBub24tbnVsbC91bmRlZmluZWQgdmFsdWVzCiAgICAgICAgaWYgKChvcHRpb25zID0gYXJndW1lbnRzW2ldKSAhPSBudWxsKSB7CiAgICAgICAgICAvLyBFeHRlbmQgdGhlIGJhc2Ugb2JqZWN0CiAgICAgICAgICBmb3IgKG5hbWUgaW4gb3B0aW9ucykgewogICAgICAgICAgICBzcmMgPSB0YXJnZXRbbmFtZV07CiAgICAgICAgICAgIGNvcHkgPSBvcHRpb25zW25hbWVdOyAvLyBQcmV2ZW50IG5ldmVyLWVuZGluZyBsb29wCgogICAgICAgICAgICBpZiAodGFyZ2V0ID09PSBjb3B5KSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0gLy8gUmVjdXJzZSBpZiB3ZSdyZSBtZXJnaW5nIHBsYWluIG9iamVjdHMgb3IgYXJyYXlzCgoKICAgICAgICAgICAgaWYgKGRlZXAgJiYgY29weSAmJiAoalF1ZXJ5LmlzUGxhaW5PYmplY3QoY29weSkgfHwgKGNvcHlJc0FycmF5ID0galF1ZXJ5LmlzQXJyYXkoY29weSkpKSkgewogICAgICAgICAgICAgIGlmIChjb3B5SXNBcnJheSkgewogICAgICAgICAgICAgICAgY29weUlzQXJyYXkgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGNsb25lID0gc3JjICYmIGpRdWVyeS5pc0FycmF5KHNyYykgPyBzcmMgOiBbXTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2xvbmUgPSBzcmMgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3Qoc3JjKSA/IHNyYyA6IHt9OwogICAgICAgICAgICAgIH0gLy8gTmV2ZXIgbW92ZSBvcmlnaW5hbCBvYmplY3RzLCBjbG9uZSB0aGVtCgoKICAgICAgICAgICAgICB0YXJnZXRbbmFtZV0gPSBqUXVlcnkuZXh0ZW5kKGRlZXAsIGNsb25lLCBjb3B5KTsgLy8gRG9uJ3QgYnJpbmcgaW4gdW5kZWZpbmVkIHZhbHVlcwogICAgICAgICAgICB9IGVsc2UgaWYgKGNvcHkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIHRhcmdldFtuYW1lXSA9IGNvcHk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8gUmV0dXJuIHRoZSBtb2RpZmllZCBvYmplY3QKCgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfTsKCiAgICBqUXVlcnkuZXh0ZW5kKHsKICAgICAgbm9Db25mbGljdDogZnVuY3Rpb24gbm9Db25mbGljdChkZWVwKSB7CiAgICAgICAgaWYgKHdpbmRvdy4kID09PSBqUXVlcnkpIHsKICAgICAgICAgIHdpbmRvdy4kID0gXyQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoZGVlcCAmJiB3aW5kb3cualF1ZXJ5ID09PSBqUXVlcnkpIHsKICAgICAgICAgIHdpbmRvdy5qUXVlcnkgPSBfalF1ZXJ5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGpRdWVyeTsKICAgICAgfSwKICAgICAgLy8gSXMgdGhlIERPTSByZWFkeSB0byBiZSB1c2VkPyBTZXQgdG8gdHJ1ZSBvbmNlIGl0IG9jY3Vycy4KICAgICAgaXNSZWFkeTogZmFsc2UsCiAgICAgIC8vIEEgY291bnRlciB0byB0cmFjayBob3cgbWFueSBpdGVtcyB0byB3YWl0IGZvciBiZWZvcmUKICAgICAgLy8gdGhlIHJlYWR5IGV2ZW50IGZpcmVzLiBTZWUgIzY3ODEKICAgICAgcmVhZHlXYWl0OiAxLAogICAgICAvLyBIb2xkIChvciByZWxlYXNlKSB0aGUgcmVhZHkgZXZlbnQKICAgICAgaG9sZFJlYWR5OiBmdW5jdGlvbiBob2xkUmVhZHkoaG9sZCkgewogICAgICAgIGlmIChob2xkKSB7CiAgICAgICAgICBqUXVlcnkucmVhZHlXYWl0Kys7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGpRdWVyeS5yZWFkeSh0cnVlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIEhhbmRsZSB3aGVuIHRoZSBET00gaXMgcmVhZHkKICAgICAgcmVhZHk6IGZ1bmN0aW9uIHJlYWR5KHdhaXQpIHsKICAgICAgICAvLyBFaXRoZXIgYSByZWxlYXNlZCBob2xkIG9yIGFuIERPTXJlYWR5L2xvYWQgZXZlbnQgYW5kIG5vdCB5ZXQgcmVhZHkKICAgICAgICBpZiAod2FpdCA9PT0gdHJ1ZSAmJiAhIC0talF1ZXJ5LnJlYWR5V2FpdCB8fCB3YWl0ICE9PSB0cnVlICYmICFqUXVlcnkuaXNSZWFkeSkgewogICAgICAgICAgLy8gTWFrZSBzdXJlIGJvZHkgZXhpc3RzLCBhdCBsZWFzdCwgaW4gY2FzZSBJRSBnZXRzIGEgbGl0dGxlIG92ZXJ6ZWFsb3VzICh0aWNrZXQgIzU0NDMpLgogICAgICAgICAgaWYgKCFkb2N1bWVudC5ib2R5KSB7CiAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGpRdWVyeS5yZWFkeSwgMSk7CiAgICAgICAgICB9IC8vIFJlbWVtYmVyIHRoYXQgdGhlIERPTSBpcyByZWFkeQoKCiAgICAgICAgICBqUXVlcnkuaXNSZWFkeSA9IHRydWU7IC8vIElmIGEgbm9ybWFsIERPTSBSZWFkeSBldmVudCBmaXJlZCwgZGVjcmVtZW50LCBhbmQgd2FpdCBpZiBuZWVkIGJlCgogICAgICAgICAgaWYgKHdhaXQgIT09IHRydWUgJiYgLS1qUXVlcnkucmVhZHlXYWl0ID4gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IC8vIElmIHRoZXJlIGFyZSBmdW5jdGlvbnMgYm91bmQsIHRvIGV4ZWN1dGUKCgogICAgICAgICAgcmVhZHlMaXN0LmZpcmVXaXRoKGRvY3VtZW50LCBbalF1ZXJ5XSk7IC8vIFRyaWdnZXIgYW55IGJvdW5kIHJlYWR5IGV2ZW50cwoKICAgICAgICAgIGlmIChqUXVlcnkuZm4udHJpZ2dlcikgewogICAgICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLnRyaWdnZXIoInJlYWR5Iikub2ZmKCJyZWFkeSIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgYmluZFJlYWR5OiBmdW5jdGlvbiBiaW5kUmVhZHkoKSB7CiAgICAgICAgaWYgKHJlYWR5TGlzdCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVhZHlMaXN0ID0galF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKTsgLy8gQ2F0Y2ggY2FzZXMgd2hlcmUgJChkb2N1bWVudCkucmVhZHkoKSBpcyBjYWxsZWQgYWZ0ZXIgdGhlCiAgICAgICAgLy8gYnJvd3NlciBldmVudCBoYXMgYWxyZWFkeSBvY2N1cnJlZC4KCiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICJjb21wbGV0ZSIpIHsKICAgICAgICAgIC8vIEhhbmRsZSBpdCBhc3luY2hyb25vdXNseSB0byBhbGxvdyBzY3JpcHRzIHRoZSBvcHBvcnR1bml0eSB0byBkZWxheSByZWFkeQogICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoalF1ZXJ5LnJlYWR5LCAxKTsKICAgICAgICB9IC8vIE1vemlsbGEsIE9wZXJhIGFuZCB3ZWJraXQgbmlnaHRsaWVzIGN1cnJlbnRseSBzdXBwb3J0IHRoaXMgZXZlbnQKCgogICAgICAgIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgICAgICAvLyBVc2UgdGhlIGhhbmR5IGV2ZW50IGNhbGxiYWNrCiAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgX0RPTUNvbnRlbnRMb2FkZWQyLCBmYWxzZSk7IC8vIEEgZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrCgogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBqUXVlcnkucmVhZHksIGZhbHNlKTsgLy8gSWYgSUUgZXZlbnQgbW9kZWwgaXMgdXNlZAogICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgICAgICAgIC8vIGVuc3VyZSBmaXJpbmcgYmVmb3JlIG9ubG9hZCwKICAgICAgICAgIC8vIG1heWJlIGxhdGUgYnV0IHNhZmUgYWxzbyBmb3IgaWZyYW1lcwogICAgICAgICAgZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsIF9ET01Db250ZW50TG9hZGVkMik7IC8vIEEgZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrCgogICAgICAgICAgd2luZG93LmF0dGFjaEV2ZW50KCJvbmxvYWQiLCBqUXVlcnkucmVhZHkpOyAvLyBJZiBJRSBhbmQgbm90IGEgZnJhbWUKICAgICAgICAgIC8vIGNvbnRpbnVhbGx5IGNoZWNrIHRvIHNlZSBpZiB0aGUgZG9jdW1lbnQgaXMgcmVhZHkKCiAgICAgICAgICB2YXIgdG9wbGV2ZWwgPSBmYWxzZTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICB0b3BsZXZlbCA9IHdpbmRvdy5mcmFtZUVsZW1lbnQgPT0gbnVsbDsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9CgogICAgICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCAmJiB0b3BsZXZlbCkgewogICAgICAgICAgICBkb1Njcm9sbENoZWNrKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBTZWUgdGVzdC91bml0L2NvcmUuanMgZm9yIGRldGFpbHMgY29uY2VybmluZyBpc0Z1bmN0aW9uLgogICAgICAvLyBTaW5jZSB2ZXJzaW9uIDEuMywgRE9NIG1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBsaWtlIGFsZXJ0CiAgICAgIC8vIGFyZW4ndCBzdXBwb3J0ZWQuIFRoZXkgcmV0dXJuIGZhbHNlIG9uIElFICgjMjk2OCkuCiAgICAgIGlzRnVuY3Rpb246IGZ1bmN0aW9uIGlzRnVuY3Rpb24ob2JqKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeS50eXBlKG9iaikgPT09ICJmdW5jdGlvbiI7CiAgICAgIH0sCiAgICAgIGlzQXJyYXk6IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKG9iaikgewogICAgICAgIHJldHVybiBqUXVlcnkudHlwZShvYmopID09PSAiYXJyYXkiOwogICAgICB9LAogICAgICBpc1dpbmRvdzogZnVuY3Rpb24gaXNXaW5kb3cob2JqKSB7CiAgICAgICAgcmV0dXJuIG9iaiAhPSBudWxsICYmIG9iaiA9PSBvYmoud2luZG93OwogICAgICB9LAogICAgICBpc051bWVyaWM6IGZ1bmN0aW9uIGlzTnVtZXJpYyhvYmopIHsKICAgICAgICByZXR1cm4gIWlzTmFOKHBhcnNlRmxvYXQob2JqKSkgJiYgaXNGaW5pdGUob2JqKTsKICAgICAgfSwKICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHsKICAgICAgICByZXR1cm4gb2JqID09IG51bGwgPyBTdHJpbmcob2JqKSA6IGNsYXNzMnR5cGVbdG9TdHJpbmcuY2FsbChvYmopXSB8fCAib2JqZWN0IjsKICAgICAgfSwKICAgICAgaXNQbGFpbk9iamVjdDogZnVuY3Rpb24gaXNQbGFpbk9iamVjdChvYmopIHsKICAgICAgICAvLyBNdXN0IGJlIGFuIE9iamVjdC4KICAgICAgICAvLyBCZWNhdXNlIG9mIElFLCB3ZSBhbHNvIGhhdmUgdG8gY2hlY2sgdGhlIHByZXNlbmNlIG9mIHRoZSBjb25zdHJ1Y3RvciBwcm9wZXJ0eS4KICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCBET00gbm9kZXMgYW5kIHdpbmRvdyBvYmplY3RzIGRvbid0IHBhc3MgdGhyb3VnaCwgYXMgd2VsbAogICAgICAgIGlmICghb2JqIHx8IGpRdWVyeS50eXBlKG9iaikgIT09ICJvYmplY3QiIHx8IG9iai5ub2RlVHlwZSB8fCBqUXVlcnkuaXNXaW5kb3cob2JqKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIE5vdCBvd24gY29uc3RydWN0b3IgcHJvcGVydHkgbXVzdCBiZSBPYmplY3QKICAgICAgICAgIGlmIChvYmouY29uc3RydWN0b3IgJiYgIWhhc093bi5jYWxsKG9iaiwgImNvbnN0cnVjdG9yIikgJiYgIWhhc093bi5jYWxsKG9iai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsICJpc1Byb3RvdHlwZU9mIikpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIC8vIElFOCw5IFdpbGwgdGhyb3cgZXhjZXB0aW9ucyBvbiBjZXJ0YWluIGhvc3Qgb2JqZWN0cyAjOTg5NwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gLy8gT3duIHByb3BlcnRpZXMgYXJlIGVudW1lcmF0ZWQgZmlyc3RseSwgc28gdG8gc3BlZWQgdXAsCiAgICAgICAgLy8gaWYgbGFzdCBvbmUgaXMgb3duLCB0aGVuIGFsbCBwcm9wZXJ0aWVzIGFyZSBvd24uCgoKICAgICAgICB2YXIga2V5OwoKICAgICAgICBmb3IgKGtleSBpbiBvYmopIHt9CgogICAgICAgIHJldHVybiBrZXkgPT09IHVuZGVmaW5lZCB8fCBoYXNPd24uY2FsbChvYmosIGtleSk7CiAgICAgIH0sCiAgICAgIGlzRW1wdHlPYmplY3Q6IGZ1bmN0aW9uIGlzRW1wdHlPYmplY3Qob2JqKSB7CiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBvYmopIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICBlcnJvcjogZnVuY3Rpb24gZXJyb3IobXNnKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7CiAgICAgIH0sCiAgICAgIHBhcnNlSlNPTjogZnVuY3Rpb24gcGFyc2VKU09OKGRhdGEpIHsKICAgICAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJzdHJpbmciIHx8ICFkYXRhKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9IC8vIE1ha2Ugc3VyZSBsZWFkaW5nL3RyYWlsaW5nIHdoaXRlc3BhY2UgaXMgcmVtb3ZlZCAoSUUgY2FuJ3QgaGFuZGxlIGl0KQoKCiAgICAgICAgZGF0YSA9IGpRdWVyeS50cmltKGRhdGEpOyAvLyBBdHRlbXB0IHRvIHBhcnNlIHVzaW5nIHRoZSBuYXRpdmUgSlNPTiBwYXJzZXIgZmlyc3QKCiAgICAgICAgaWYgKHdpbmRvdy5KU09OICYmIHdpbmRvdy5KU09OLnBhcnNlKSB7CiAgICAgICAgICByZXR1cm4gd2luZG93LkpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgfSAvLyBNYWtlIHN1cmUgdGhlIGluY29taW5nIGRhdGEgaXMgYWN0dWFsIEpTT04KICAgICAgICAvLyBMb2dpYyBib3Jyb3dlZCBmcm9tIGh0dHA6Ly9qc29uLm9yZy9qc29uMi5qcwoKCiAgICAgICAgaWYgKHJ2YWxpZGNoYXJzLnRlc3QoZGF0YS5yZXBsYWNlKHJ2YWxpZGVzY2FwZSwgIkAiKS5yZXBsYWNlKHJ2YWxpZHRva2VucywgIl0iKS5yZXBsYWNlKHJ2YWxpZGJyYWNlcywgIiIpKSkgewogICAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigicmV0dXJuICIgKyBkYXRhKSgpOwogICAgICAgIH0KCiAgICAgICAgalF1ZXJ5LmVycm9yKCJJbnZhbGlkIEpTT046ICIgKyBkYXRhKTsKICAgICAgfSwKICAgICAgLy8gQ3Jvc3MtYnJvd3NlciB4bWwgcGFyc2luZwogICAgICBwYXJzZVhNTDogZnVuY3Rpb24gcGFyc2VYTUwoZGF0YSkgewogICAgICAgIGlmICh0eXBlb2YgZGF0YSAhPT0gInN0cmluZyIgfHwgIWRhdGEpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgdmFyIHhtbCwgdG1wOwoKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKHdpbmRvdy5ET01QYXJzZXIpIHsKICAgICAgICAgICAgLy8gU3RhbmRhcmQKICAgICAgICAgICAgdG1wID0gbmV3IERPTVBhcnNlcigpOwogICAgICAgICAgICB4bWwgPSB0bXAucGFyc2VGcm9tU3RyaW5nKGRhdGEsICJ0ZXh0L3htbCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gSUUKICAgICAgICAgICAgeG1sID0gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKTsKICAgICAgICAgICAgeG1sLmFzeW5jID0gImZhbHNlIjsKICAgICAgICAgICAgeG1sLmxvYWRYTUwoZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgeG1sID0gdW5kZWZpbmVkOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF4bWwgfHwgIXhtbC5kb2N1bWVudEVsZW1lbnQgfHwgeG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aCkgewogICAgICAgICAgalF1ZXJ5LmVycm9yKCJJbnZhbGlkIFhNTDogIiArIGRhdGEpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHhtbDsKICAgICAgfSwKICAgICAgbm9vcDogZnVuY3Rpb24gbm9vcCgpIHt9LAogICAgICAvLyBFdmFsdWF0ZXMgYSBzY3JpcHQgaW4gYSBnbG9iYWwgY29udGV4dAogICAgICAvLyBXb3JrYXJvdW5kcyBiYXNlZCBvbiBmaW5kaW5ncyBieSBKaW0gRHJpc2NvbGwKICAgICAgLy8gaHR0cDovL3dlYmxvZ3MuamF2YS5uZXQvYmxvZy9kcmlzY29sbC9hcmNoaXZlLzIwMDkvMDkvMDgvZXZhbC1qYXZhc2NyaXB0LWdsb2JhbC1jb250ZXh0CiAgICAgIGdsb2JhbEV2YWw6IGZ1bmN0aW9uIGdsb2JhbEV2YWwoZGF0YSkgewogICAgICAgIGlmIChkYXRhICYmIHJub3R3aGl0ZS50ZXN0KGRhdGEpKSB7CiAgICAgICAgICAvLyBXZSB1c2UgZXhlY1NjcmlwdCBvbiBJbnRlcm5ldCBFeHBsb3JlcgogICAgICAgICAgLy8gV2UgdXNlIGFuIGFub255bW91cyBmdW5jdGlvbiBzbyB0aGF0IGNvbnRleHQgaXMgd2luZG93CiAgICAgICAgICAvLyByYXRoZXIgdGhhbiBqUXVlcnkgaW4gRmlyZWZveAogICAgICAgICAgKHdpbmRvdy5leGVjU2NyaXB0IHx8IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIHdpbmRvd1siZXZhbCJdLmNhbGwod2luZG93LCBkYXRhKTsKICAgICAgICAgIH0pKGRhdGEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gQ29udmVydCBkYXNoZWQgdG8gY2FtZWxDYXNlOyB1c2VkIGJ5IHRoZSBjc3MgYW5kIGRhdGEgbW9kdWxlcwogICAgICAvLyBNaWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1NzIpCiAgICAgIGNhbWVsQ2FzZTogZnVuY3Rpb24gY2FtZWxDYXNlKHN0cmluZykgewogICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZShybXNQcmVmaXgsICJtcy0iKS5yZXBsYWNlKHJkYXNoQWxwaGEsIGZjYW1lbENhc2UpOwogICAgICB9LAogICAgICBub2RlTmFtZTogZnVuY3Rpb24gbm9kZU5hbWUoZWxlbSwgbmFtZSkgewogICAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PT0gbmFtZS50b1VwcGVyQ2FzZSgpOwogICAgICB9LAogICAgICAvLyBhcmdzIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CiAgICAgIGVhY2g6IGZ1bmN0aW9uIGVhY2gob2JqZWN0LCBjYWxsYmFjaywgYXJncykgewogICAgICAgIHZhciBuYW1lLAogICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgbGVuZ3RoID0gb2JqZWN0Lmxlbmd0aCwKICAgICAgICAgICAgaXNPYmogPSBsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBqUXVlcnkuaXNGdW5jdGlvbihvYmplY3QpOwoKICAgICAgICBpZiAoYXJncykgewogICAgICAgICAgaWYgKGlzT2JqKSB7CiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmplY3QpIHsKICAgICAgICAgICAgICBpZiAoY2FsbGJhY2suYXBwbHkob2JqZWN0W25hbWVdLCBhcmdzKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yICg7IGkgPCBsZW5ndGg7KSB7CiAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrLmFwcGx5KG9iamVjdFtpKytdLCBhcmdzKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBBIHNwZWNpYWwsIGZhc3QsIGNhc2UgZm9yIHRoZSBtb3N0IGNvbW1vbiB1c2Ugb2YgZWFjaAoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGlzT2JqKSB7CiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvYmplY3QpIHsKICAgICAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChvYmplY3RbbmFtZV0sIG5hbWUsIG9iamVjdFtuYW1lXSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOykgewogICAgICAgICAgICAgIGlmIChjYWxsYmFjay5jYWxsKG9iamVjdFtpXSwgaSwgb2JqZWN0W2krK10pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gb2JqZWN0OwogICAgICB9LAogICAgICAvLyBVc2UgbmF0aXZlIFN0cmluZy50cmltIGZ1bmN0aW9uIHdoZXJldmVyIHBvc3NpYmxlCiAgICAgIHRyaW06IHRyaW0gPyBmdW5jdGlvbiAodGV4dCkgewogICAgICAgIHJldHVybiB0ZXh0ID09IG51bGwgPyAiIiA6IHRyaW0uY2FsbCh0ZXh0KTsKICAgICAgfSA6IC8vIE90aGVyd2lzZSB1c2Ugb3VyIG93biB0cmltbWluZyBmdW5jdGlvbmFsaXR5CiAgICAgIGZ1bmN0aW9uICh0ZXh0KSB7CiAgICAgICAgcmV0dXJuIHRleHQgPT0gbnVsbCA/ICIiIDogdGV4dC50b1N0cmluZygpLnJlcGxhY2UodHJpbUxlZnQsICIiKS5yZXBsYWNlKHRyaW1SaWdodCwgIiIpOwogICAgICB9LAogICAgICAvLyByZXN1bHRzIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CiAgICAgIG1ha2VBcnJheTogZnVuY3Rpb24gbWFrZUFycmF5KGFycmF5LCByZXN1bHRzKSB7CiAgICAgICAgdmFyIHJldCA9IHJlc3VsdHMgfHwgW107CgogICAgICAgIGlmIChhcnJheSAhPSBudWxsKSB7CiAgICAgICAgICAvLyBUaGUgd2luZG93LCBzdHJpbmdzIChhbmQgZnVuY3Rpb25zKSBhbHNvIGhhdmUgJ2xlbmd0aCcKICAgICAgICAgIC8vIFR3ZWFrZWQgbG9naWMgc2xpZ2h0bHkgdG8gaGFuZGxlIEJsYWNrYmVycnkgNC43IFJlZ0V4cCBpc3N1ZXMgIzY5MzAKICAgICAgICAgIHZhciB0eXBlID0galF1ZXJ5LnR5cGUoYXJyYXkpOwoKICAgICAgICAgIGlmIChhcnJheS5sZW5ndGggPT0gbnVsbCB8fCB0eXBlID09PSAic3RyaW5nIiB8fCB0eXBlID09PSAiZnVuY3Rpb24iIHx8IHR5cGUgPT09ICJyZWdleHAiIHx8IGpRdWVyeS5pc1dpbmRvdyhhcnJheSkpIHsKICAgICAgICAgICAgcHVzaC5jYWxsKHJldCwgYXJyYXkpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgalF1ZXJ5Lm1lcmdlKHJldCwgYXJyYXkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJldDsKICAgICAgfSwKICAgICAgaW5BcnJheTogZnVuY3Rpb24gaW5BcnJheShlbGVtLCBhcnJheSwgaSkgewogICAgICAgIHZhciBsZW47CgogICAgICAgIGlmIChhcnJheSkgewogICAgICAgICAgaWYgKGluZGV4T2YpIHsKICAgICAgICAgICAgcmV0dXJuIGluZGV4T2YuY2FsbChhcnJheSwgZWxlbSwgaSk7CiAgICAgICAgICB9CgogICAgICAgICAgbGVuID0gYXJyYXkubGVuZ3RoOwogICAgICAgICAgaSA9IGkgPyBpIDwgMCA/IE1hdGgubWF4KDAsIGxlbiArIGkpIDogaSA6IDA7CgogICAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAvLyBTa2lwIGFjY2Vzc2luZyBpbiBzcGFyc2UgYXJyYXlzCiAgICAgICAgICAgIGlmIChpIGluIGFycmF5ICYmIGFycmF5W2ldID09PSBlbGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiAtMTsKICAgICAgfSwKICAgICAgbWVyZ2U6IGZ1bmN0aW9uIG1lcmdlKGZpcnN0LCBzZWNvbmQpIHsKICAgICAgICB2YXIgaSA9IGZpcnN0Lmxlbmd0aCwKICAgICAgICAgICAgaiA9IDA7CgogICAgICAgIGlmICh0eXBlb2Ygc2Vjb25kLmxlbmd0aCA9PT0gIm51bWJlciIpIHsKICAgICAgICAgIGZvciAodmFyIGwgPSBzZWNvbmQubGVuZ3RoOyBqIDwgbDsgaisrKSB7CiAgICAgICAgICAgIGZpcnN0W2krK10gPSBzZWNvbmRbal07CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdoaWxlIChzZWNvbmRbal0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBmaXJzdFtpKytdID0gc2Vjb25kW2orK107CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmaXJzdC5sZW5ndGggPSBpOwogICAgICAgIHJldHVybiBmaXJzdDsKICAgICAgfSwKICAgICAgZ3JlcDogZnVuY3Rpb24gZ3JlcChlbGVtcywgY2FsbGJhY2ssIGludikgewogICAgICAgIHZhciByZXQgPSBbXSwKICAgICAgICAgICAgcmV0VmFsOwogICAgICAgIGludiA9ICEhaW52OyAvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgb25seSBzYXZpbmcgdGhlIGl0ZW1zCiAgICAgICAgLy8gdGhhdCBwYXNzIHRoZSB2YWxpZGF0b3IgZnVuY3Rpb24KCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGVsZW1zLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICByZXRWYWwgPSAhIWNhbGxiYWNrKGVsZW1zW2ldLCBpKTsKCiAgICAgICAgICBpZiAoaW52ICE9PSByZXRWYWwpIHsKICAgICAgICAgICAgcmV0LnB1c2goZWxlbXNbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJldDsKICAgICAgfSwKICAgICAgLy8gYXJnIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CiAgICAgIG1hcDogZnVuY3Rpb24gbWFwKGVsZW1zLCBjYWxsYmFjaywgYXJnKSB7CiAgICAgICAgdmFyIHZhbHVlLAogICAgICAgICAgICBrZXksCiAgICAgICAgICAgIHJldCA9IFtdLAogICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgbGVuZ3RoID0gZWxlbXMubGVuZ3RoLAogICAgICAgICAgICAvLyBqcXVlcnkgb2JqZWN0cyBhcmUgdHJlYXRlZCBhcyBhcnJheXMKICAgICAgICBpc0FycmF5ID0gZWxlbXMgaW5zdGFuY2VvZiBqUXVlcnkgfHwgbGVuZ3RoICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGxlbmd0aCA9PT0gIm51bWJlciIgJiYgKGxlbmd0aCA+IDAgJiYgZWxlbXNbMF0gJiYgZWxlbXNbbGVuZ3RoIC0gMV0gfHwgbGVuZ3RoID09PSAwIHx8IGpRdWVyeS5pc0FycmF5KGVsZW1zKSk7IC8vIEdvIHRocm91Z2ggdGhlIGFycmF5LCB0cmFuc2xhdGluZyBlYWNoIG9mIHRoZSBpdGVtcyB0byB0aGVpcgoKICAgICAgICBpZiAoaXNBcnJheSkgewogICAgICAgICAgZm9yICg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YWx1ZSA9IGNhbGxiYWNrKGVsZW1zW2ldLCBpLCBhcmcpOwoKICAgICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICAgICAgICByZXRbcmV0Lmxlbmd0aF0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBHbyB0aHJvdWdoIGV2ZXJ5IGtleSBvbiB0aGUgb2JqZWN0LAoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yIChrZXkgaW4gZWxlbXMpIHsKICAgICAgICAgICAgdmFsdWUgPSBjYWxsYmFjayhlbGVtc1trZXldLCBrZXksIGFyZyk7CgogICAgICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgICAgICAgIHJldFtyZXQubGVuZ3RoXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCgoKICAgICAgICByZXR1cm4gcmV0LmNvbmNhdC5hcHBseShbXSwgcmV0KTsKICAgICAgfSwKICAgICAgLy8gQSBnbG9iYWwgR1VJRCBjb3VudGVyIGZvciBvYmplY3RzCiAgICAgIGd1aWQ6IDEsCiAgICAgIC8vIEJpbmQgYSBmdW5jdGlvbiB0byBhIGNvbnRleHQsIG9wdGlvbmFsbHkgcGFydGlhbGx5IGFwcGx5aW5nIGFueQogICAgICAvLyBhcmd1bWVudHMuCiAgICAgIHByb3h5OiBmdW5jdGlvbiBwcm94eShmbiwgY29udGV4dCkgewogICAgICAgIGlmICh0eXBlb2YgY29udGV4dCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIHZhciB0bXAgPSBmbltjb250ZXh0XTsKICAgICAgICAgIGNvbnRleHQgPSBmbjsKICAgICAgICAgIGZuID0gdG1wOwogICAgICAgIH0gLy8gUXVpY2sgY2hlY2sgdG8gZGV0ZXJtaW5lIGlmIHRhcmdldCBpcyBjYWxsYWJsZSwgaW4gdGhlIHNwZWMKICAgICAgICAvLyB0aGlzIHRocm93cyBhIFR5cGVFcnJvciwgYnV0IHdlIHdpbGwganVzdCByZXR1cm4gdW5kZWZpbmVkLgoKCiAgICAgICAgaWYgKCFqUXVlcnkuaXNGdW5jdGlvbihmbikpIHsKICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgfSAvLyBTaW11bGF0ZWQgYmluZAoKCiAgICAgICAgdmFyIGFyZ3MgPSBfc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpLAogICAgICAgICAgICBwcm94eSA9IGZ1bmN0aW9uIHByb3h5KCkgewogICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KGNvbnRleHQsIGFyZ3MuY29uY2F0KF9zbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgICAgICB9OyAvLyBTZXQgdGhlIGd1aWQgb2YgdW5pcXVlIGhhbmRsZXIgdG8gdGhlIHNhbWUgb2Ygb3JpZ2luYWwgaGFuZGxlciwgc28gaXQgY2FuIGJlIHJlbW92ZWQKCgogICAgICAgIHByb3h5Lmd1aWQgPSBmbi5ndWlkID0gZm4uZ3VpZCB8fCBwcm94eS5ndWlkIHx8IGpRdWVyeS5ndWlkKys7CiAgICAgICAgcmV0dXJuIHByb3h5OwogICAgICB9LAogICAgICAvLyBNdXRpZnVuY3Rpb25hbCBtZXRob2QgdG8gZ2V0IGFuZCBzZXQgdmFsdWVzIHRvIGEgY29sbGVjdGlvbgogICAgICAvLyBUaGUgdmFsdWUvcyBjYW4gb3B0aW9uYWxseSBiZSBleGVjdXRlZCBpZiBpdCdzIGEgZnVuY3Rpb24KICAgICAgYWNjZXNzOiBmdW5jdGlvbiBhY2Nlc3MoZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCBwYXNzKSB7CiAgICAgICAgdmFyIGV4ZWMsCiAgICAgICAgICAgIGJ1bGsgPSBrZXkgPT0gbnVsbCwKICAgICAgICAgICAgaSA9IDAsCiAgICAgICAgICAgIGxlbmd0aCA9IGVsZW1zLmxlbmd0aDsgLy8gU2V0cyBtYW55IHZhbHVlcwoKICAgICAgICBpZiAoa2V5ICYmIF90eXBlb2Yoa2V5KSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIGZvciAoaSBpbiBrZXkpIHsKICAgICAgICAgICAgalF1ZXJ5LmFjY2VzcyhlbGVtcywgZm4sIGksIGtleVtpXSwgMSwgZW1wdHlHZXQsIHZhbHVlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjaGFpbmFibGUgPSAxOyAvLyBTZXRzIG9uZSB2YWx1ZQogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gT3B0aW9uYWxseSwgZnVuY3Rpb24gdmFsdWVzIGdldCBleGVjdXRlZCBpZiBleGVjIGlzIHRydWUKICAgICAgICAgIGV4ZWMgPSBwYXNzID09PSB1bmRlZmluZWQgJiYgalF1ZXJ5LmlzRnVuY3Rpb24odmFsdWUpOwoKICAgICAgICAgIGlmIChidWxrKSB7CiAgICAgICAgICAgIC8vIEJ1bGsgb3BlcmF0aW9ucyBvbmx5IGl0ZXJhdGUgd2hlbiBleGVjdXRpbmcgZnVuY3Rpb24gdmFsdWVzCiAgICAgICAgICAgIGlmIChleGVjKSB7CiAgICAgICAgICAgICAgZXhlYyA9IGZuOwoKICAgICAgICAgICAgICBmbiA9IGZ1bmN0aW9uIGZuKGVsZW0sIGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBleGVjLmNhbGwoalF1ZXJ5KGVsZW0pLCB2YWx1ZSk7CiAgICAgICAgICAgICAgfTsgLy8gT3RoZXJ3aXNlIHRoZXkgcnVuIGFnYWluc3QgdGhlIGVudGlyZSBzZXQKCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZm4uY2FsbChlbGVtcywgdmFsdWUpOwogICAgICAgICAgICAgIGZuID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChmbikgewogICAgICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgZm4oZWxlbXNbaV0sIGtleSwgZXhlYyA/IHZhbHVlLmNhbGwoZWxlbXNbaV0sIGksIGZuKGVsZW1zW2ldLCBrZXkpKSA6IHZhbHVlLCBwYXNzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGNoYWluYWJsZSA9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2hhaW5hYmxlID8gZWxlbXMgOiAvLyBHZXRzCiAgICAgICAgYnVsayA/IGZuLmNhbGwoZWxlbXMpIDogbGVuZ3RoID8gZm4oZWxlbXNbMF0sIGtleSkgOiBlbXB0eUdldDsKICAgICAgfSwKICAgICAgbm93OiBmdW5jdGlvbiBub3coKSB7CiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICB9LAogICAgICAvLyBVc2Ugb2YgalF1ZXJ5LmJyb3dzZXIgaXMgZnJvd25lZCB1cG9uLgogICAgICAvLyBNb3JlIGRldGFpbHM6IGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVXRpbGl0aWVzL2pRdWVyeS5icm93c2VyCiAgICAgIHVhTWF0Y2g6IGZ1bmN0aW9uIHVhTWF0Y2godWEpIHsKICAgICAgICB1YSA9IHVhLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgdmFyIG1hdGNoID0gcndlYmtpdC5leGVjKHVhKSB8fCByb3BlcmEuZXhlYyh1YSkgfHwgcm1zaWUuZXhlYyh1YSkgfHwgdWEuaW5kZXhPZigiY29tcGF0aWJsZSIpIDwgMCAmJiBybW96aWxsYS5leGVjKHVhKSB8fCBbXTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgYnJvd3NlcjogbWF0Y2hbMV0gfHwgIiIsCiAgICAgICAgICB2ZXJzaW9uOiBtYXRjaFsyXSB8fCAiMCIKICAgICAgICB9OwogICAgICB9LAogICAgICBzdWI6IGZ1bmN0aW9uIHN1YigpIHsKICAgICAgICBmdW5jdGlvbiBqUXVlcnlTdWIoc2VsZWN0b3IsIGNvbnRleHQpIHsKICAgICAgICAgIHJldHVybiBuZXcgalF1ZXJ5U3ViLmZuLmluaXQoc2VsZWN0b3IsIGNvbnRleHQpOwogICAgICAgIH0KCiAgICAgICAgalF1ZXJ5LmV4dGVuZCh0cnVlLCBqUXVlcnlTdWIsIHRoaXMpOwogICAgICAgIGpRdWVyeVN1Yi5zdXBlcmNsYXNzID0gdGhpczsKICAgICAgICBqUXVlcnlTdWIuZm4gPSBqUXVlcnlTdWIucHJvdG90eXBlID0gdGhpcygpOwogICAgICAgIGpRdWVyeVN1Yi5mbi5jb25zdHJ1Y3RvciA9IGpRdWVyeVN1YjsKICAgICAgICBqUXVlcnlTdWIuc3ViID0gdGhpcy5zdWI7CgogICAgICAgIGpRdWVyeVN1Yi5mbi5pbml0ID0gZnVuY3Rpb24gaW5pdChzZWxlY3RvciwgY29udGV4dCkgewogICAgICAgICAgaWYgKGNvbnRleHQgJiYgY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSAmJiAhKGNvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnlTdWIpKSB7CiAgICAgICAgICAgIGNvbnRleHQgPSBqUXVlcnlTdWIoY29udGV4dCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGpRdWVyeS5mbi5pbml0LmNhbGwodGhpcywgc2VsZWN0b3IsIGNvbnRleHQsIHJvb3RqUXVlcnlTdWIpOwogICAgICAgIH07CgogICAgICAgIGpRdWVyeVN1Yi5mbi5pbml0LnByb3RvdHlwZSA9IGpRdWVyeVN1Yi5mbjsKICAgICAgICB2YXIgcm9vdGpRdWVyeVN1YiA9IGpRdWVyeVN1Yihkb2N1bWVudCk7CiAgICAgICAgcmV0dXJuIGpRdWVyeVN1YjsKICAgICAgfSwKICAgICAgYnJvd3Nlcjoge30KICAgIH0pOyAvLyBQb3B1bGF0ZSB0aGUgY2xhc3MydHlwZSBtYXAKCiAgICBqUXVlcnkuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCIuc3BsaXQoIiAiKSwgZnVuY3Rpb24gKGksIG5hbWUpIHsKICAgICAgY2xhc3MydHlwZVsiW29iamVjdCAiICsgbmFtZSArICJdIl0gPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICB9KTsKICAgIGJyb3dzZXJNYXRjaCA9IGpRdWVyeS51YU1hdGNoKHVzZXJBZ2VudCk7CgogICAgaWYgKGJyb3dzZXJNYXRjaC5icm93c2VyKSB7CiAgICAgIGpRdWVyeS5icm93c2VyW2Jyb3dzZXJNYXRjaC5icm93c2VyXSA9IHRydWU7CiAgICAgIGpRdWVyeS5icm93c2VyLnZlcnNpb24gPSBicm93c2VyTWF0Y2gudmVyc2lvbjsKICAgIH0gLy8gRGVwcmVjYXRlZCwgdXNlIGpRdWVyeS5icm93c2VyLndlYmtpdCBpbnN0ZWFkCgoKICAgIGlmIChqUXVlcnkuYnJvd3Nlci53ZWJraXQpIHsKICAgICAgalF1ZXJ5LmJyb3dzZXIuc2FmYXJpID0gdHJ1ZTsKICAgIH0gLy8gSUUgZG9lc24ndCBtYXRjaCBub24tYnJlYWtpbmcgc3BhY2VzIHdpdGggXHMKCgogICAgaWYgKHJub3R3aGl0ZS50ZXN0KCJceEEwIikpIHsKICAgICAgdHJpbUxlZnQgPSAvXltcc1x4QTBdKy87CiAgICAgIHRyaW1SaWdodCA9IC9bXHNceEEwXSskLzsKICAgIH0gLy8gQWxsIGpRdWVyeSBvYmplY3RzIHNob3VsZCBwb2ludCBiYWNrIHRvIHRoZXNlCgoKICAgIHJvb3RqUXVlcnkgPSBqUXVlcnkoZG9jdW1lbnQpOyAvLyBDbGVhbnVwIGZ1bmN0aW9ucyBmb3IgdGhlIGRvY3VtZW50IHJlYWR5IG1ldGhvZAoKICAgIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgIF9ET01Db250ZW50TG9hZGVkMiA9IGZ1bmN0aW9uIERPTUNvbnRlbnRMb2FkZWQoKSB7CiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIF9ET01Db250ZW50TG9hZGVkMiwgZmFsc2UpOwogICAgICAgIGpRdWVyeS5yZWFkeSgpOwogICAgICB9OwogICAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hFdmVudCkgewogICAgICBfRE9NQ29udGVudExvYWRlZDIgPSBmdW5jdGlvbiBfRE9NQ29udGVudExvYWRlZCgpIHsKICAgICAgICAvLyBNYWtlIHN1cmUgYm9keSBleGlzdHMsIGF0IGxlYXN0LCBpbiBjYXNlIElFIGdldHMgYSBsaXR0bGUgb3ZlcnplYWxvdXMgKHRpY2tldCAjNTQ0MykuCiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICJjb21wbGV0ZSIpIHsKICAgICAgICAgIGRvY3VtZW50LmRldGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBfRE9NQ29udGVudExvYWRlZDIpOwogICAgICAgICAgalF1ZXJ5LnJlYWR5KCk7CiAgICAgICAgfQogICAgICB9OwogICAgfSAvLyBUaGUgRE9NIHJlYWR5IGNoZWNrIGZvciBJbnRlcm5ldCBFeHBsb3JlcgoKCiAgICBmdW5jdGlvbiBkb1Njcm9sbENoZWNrKCkgewogICAgICBpZiAoalF1ZXJ5LmlzUmVhZHkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgLy8gSWYgSUUgaXMgdXNlZCwgdXNlIHRoZSB0cmljayBieSBEaWVnbyBQZXJpbmkKICAgICAgICAvLyBodHRwOi8vamF2YXNjcmlwdC5ud2JveC5jb20vSUVDb250ZW50TG9hZGVkLwogICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCgibGVmdCIpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgc2V0VGltZW91dChkb1Njcm9sbENoZWNrLCAxKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gYW5kIGV4ZWN1dGUgYW55IHdhaXRpbmcgZnVuY3Rpb25zCgoKICAgICAgalF1ZXJ5LnJlYWR5KCk7CiAgICB9CgogICAgcmV0dXJuIGpRdWVyeTsKICB9KCk7IC8vIFN0cmluZyB0byBPYmplY3QgZmxhZ3MgZm9ybWF0IGNhY2hlCgoKICB2YXIgZmxhZ3NDYWNoZSA9IHt9OyAvLyBDb252ZXJ0IFN0cmluZy1mb3JtYXR0ZWQgZmxhZ3MgaW50byBPYmplY3QtZm9ybWF0dGVkIG9uZXMgYW5kIHN0b3JlIGluIGNhY2hlCgogIGZ1bmN0aW9uIGNyZWF0ZUZsYWdzKGZsYWdzKSB7CiAgICB2YXIgb2JqZWN0ID0gZmxhZ3NDYWNoZVtmbGFnc10gPSB7fSwKICAgICAgICBpLAogICAgICAgIGxlbmd0aDsKICAgIGZsYWdzID0gZmxhZ3Muc3BsaXQoL1xzKy8pOwoKICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGZsYWdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIG9iamVjdFtmbGFnc1tpXV0gPSB0cnVlOwogICAgfQoKICAgIHJldHVybiBvYmplY3Q7CiAgfQogIC8qCiAgICogQ3JlYXRlIGEgY2FsbGJhY2sgbGlzdCB1c2luZyB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnM6CiAgICoKICAgKglmbGFnczoJYW4gb3B0aW9uYWwgbGlzdCBvZiBzcGFjZS1zZXBhcmF0ZWQgZmxhZ3MgdGhhdCB3aWxsIGNoYW5nZSBob3cKICAgKgkJCXRoZSBjYWxsYmFjayBsaXN0IGJlaGF2ZXMKICAgKgogICAqIEJ5IGRlZmF1bHQgYSBjYWxsYmFjayBsaXN0IHdpbGwgYWN0IGxpa2UgYW4gZXZlbnQgY2FsbGJhY2sgbGlzdCBhbmQgY2FuIGJlCiAgICogImZpcmVkIiBtdWx0aXBsZSB0aW1lcy4KICAgKgogICAqIFBvc3NpYmxlIGZsYWdzOgogICAqCiAgICoJb25jZToJCQl3aWxsIGVuc3VyZSB0aGUgY2FsbGJhY2sgbGlzdCBjYW4gb25seSBiZSBmaXJlZCBvbmNlIChsaWtlIGEgRGVmZXJyZWQpCiAgICoKICAgKgltZW1vcnk6CQkJd2lsbCBrZWVwIHRyYWNrIG9mIHByZXZpb3VzIHZhbHVlcyBhbmQgd2lsbCBjYWxsIGFueSBjYWxsYmFjayBhZGRlZAogICAqCQkJCQlhZnRlciB0aGUgbGlzdCBoYXMgYmVlbiBmaXJlZCByaWdodCBhd2F5IHdpdGggdGhlIGxhdGVzdCAibWVtb3JpemVkIgogICAqCQkJCQl2YWx1ZXMgKGxpa2UgYSBEZWZlcnJlZCkKICAgKgogICAqCXVuaXF1ZToJCQl3aWxsIGVuc3VyZSBhIGNhbGxiYWNrIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UgKG5vIGR1cGxpY2F0ZSBpbiB0aGUgbGlzdCkKICAgKgogICAqCXN0b3BPbkZhbHNlOglpbnRlcnJ1cHQgY2FsbGluZ3Mgd2hlbiBhIGNhbGxiYWNrIHJldHVybnMgZmFsc2UKICAgKgogICAqLwoKCiAgalF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uIChmbGFncykgewogICAgLy8gQ29udmVydCBmbGFncyBmcm9tIFN0cmluZy1mb3JtYXR0ZWQgdG8gT2JqZWN0LWZvcm1hdHRlZAogICAgLy8gKHdlIGNoZWNrIGluIGNhY2hlIGZpcnN0KQogICAgZmxhZ3MgPSBmbGFncyA/IGZsYWdzQ2FjaGVbZmxhZ3NdIHx8IGNyZWF0ZUZsYWdzKGZsYWdzKSA6IHt9OwoKICAgIHZhciAvLyBBY3R1YWwgY2FsbGJhY2sgbGlzdAogICAgbGlzdCA9IFtdLAogICAgICAgIC8vIFN0YWNrIG9mIGZpcmUgY2FsbHMgZm9yIHJlcGVhdGFibGUgbGlzdHMKICAgIHN0YWNrID0gW10sCiAgICAgICAgLy8gTGFzdCBmaXJlIHZhbHVlIChmb3Igbm9uLWZvcmdldHRhYmxlIGxpc3RzKQogICAgbWVtb3J5LAogICAgICAgIC8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IHdhcyBhbHJlYWR5IGZpcmVkCiAgICBfZmlyZWQsCiAgICAgICAgLy8gRmxhZyB0byBrbm93IGlmIGxpc3QgaXMgY3VycmVudGx5IGZpcmluZwogICAgZmlyaW5nLAogICAgICAgIC8vIEZpcnN0IGNhbGxiYWNrIHRvIGZpcmUgKHVzZWQgaW50ZXJuYWxseSBieSBhZGQgYW5kIGZpcmVXaXRoKQogICAgZmlyaW5nU3RhcnQsCiAgICAgICAgLy8gRW5kIG9mIHRoZSBsb29wIHdoZW4gZmlyaW5nCiAgICBmaXJpbmdMZW5ndGgsCiAgICAgICAgLy8gSW5kZXggb2YgY3VycmVudGx5IGZpcmluZyBjYWxsYmFjayAobW9kaWZpZWQgYnkgcmVtb3ZlIGlmIG5lZWRlZCkKICAgIGZpcmluZ0luZGV4LAogICAgICAgIC8vIEFkZCBvbmUgb3Igc2V2ZXJhbCBjYWxsYmFja3MgdG8gdGhlIGxpc3QKICAgIF9hZGQgPSBmdW5jdGlvbiBhZGQoYXJncykgewogICAgICB2YXIgaSwgbGVuZ3RoLCBlbGVtLCB0eXBlLCBhY3R1YWw7CgogICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgZWxlbSA9IGFyZ3NbaV07CiAgICAgICAgdHlwZSA9IGpRdWVyeS50eXBlKGVsZW0pOwoKICAgICAgICBpZiAodHlwZSA9PT0gImFycmF5IikgewogICAgICAgICAgLy8gSW5zcGVjdCByZWN1cnNpdmVseQogICAgICAgICAgX2FkZChlbGVtKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgIC8vIEFkZCBpZiBub3QgaW4gdW5pcXVlIG1vZGUgYW5kIGNhbGxiYWNrIGlzIG5vdCBpbgogICAgICAgICAgaWYgKCFmbGFncy51bmlxdWUgfHwgIXNlbGYuaGFzKGVsZW0pKSB7CiAgICAgICAgICAgIGxpc3QucHVzaChlbGVtKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAgICAgLy8gRmlyZSBjYWxsYmFja3MKICAgIGZpcmUgPSBmdW5jdGlvbiBmaXJlKGNvbnRleHQsIGFyZ3MpIHsKICAgICAgYXJncyA9IGFyZ3MgfHwgW107CiAgICAgIG1lbW9yeSA9ICFmbGFncy5tZW1vcnkgfHwgW2NvbnRleHQsIGFyZ3NdOwogICAgICBfZmlyZWQgPSB0cnVlOwogICAgICBmaXJpbmcgPSB0cnVlOwogICAgICBmaXJpbmdJbmRleCA9IGZpcmluZ1N0YXJ0IHx8IDA7CiAgICAgIGZpcmluZ1N0YXJ0ID0gMDsKICAgICAgZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7CgogICAgICBmb3IgKDsgbGlzdCAmJiBmaXJpbmdJbmRleCA8IGZpcmluZ0xlbmd0aDsgZmlyaW5nSW5kZXgrKykgewogICAgICAgIGlmIChsaXN0W2ZpcmluZ0luZGV4XS5hcHBseShjb250ZXh0LCBhcmdzKSA9PT0gZmFsc2UgJiYgZmxhZ3Muc3RvcE9uRmFsc2UpIHsKICAgICAgICAgIG1lbW9yeSA9IHRydWU7IC8vIE1hcmsgYXMgaGFsdGVkCgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBmaXJpbmcgPSBmYWxzZTsKCiAgICAgIGlmIChsaXN0KSB7CiAgICAgICAgaWYgKCFmbGFncy5vbmNlKSB7CiAgICAgICAgICBpZiAoc3RhY2sgJiYgc3RhY2subGVuZ3RoKSB7CiAgICAgICAgICAgIG1lbW9yeSA9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHNlbGYuZmlyZVdpdGgobWVtb3J5WzBdLCBtZW1vcnlbMV0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAobWVtb3J5ID09PSB0cnVlKSB7CiAgICAgICAgICBzZWxmLmRpc2FibGUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGlzdCA9IFtdOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICAgICAvLyBBY3R1YWwgQ2FsbGJhY2tzIG9iamVjdAogICAgc2VsZiA9IHsKICAgICAgLy8gQWRkIGEgY2FsbGJhY2sgb3IgYSBjb2xsZWN0aW9uIG9mIGNhbGxiYWNrcyB0byB0aGUgbGlzdAogICAgICBhZGQ6IGZ1bmN0aW9uIGFkZCgpIHsKICAgICAgICBpZiAobGlzdCkgewogICAgICAgICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoOwoKICAgICAgICAgIF9hZGQoYXJndW1lbnRzKTsgLy8gRG8gd2UgbmVlZCB0byBhZGQgdGhlIGNhbGxiYWNrcyB0byB0aGUKICAgICAgICAgIC8vIGN1cnJlbnQgZmlyaW5nIGJhdGNoPwoKCiAgICAgICAgICBpZiAoZmlyaW5nKSB7CiAgICAgICAgICAgIGZpcmluZ0xlbmd0aCA9IGxpc3QubGVuZ3RoOyAvLyBXaXRoIG1lbW9yeSwgaWYgd2UncmUgbm90IGZpcmluZyB0aGVuCiAgICAgICAgICAgIC8vIHdlIHNob3VsZCBjYWxsIHJpZ2h0IGF3YXksIHVubGVzcyBwcmV2aW91cwogICAgICAgICAgICAvLyBmaXJpbmcgd2FzIGhhbHRlZCAoc3RvcE9uRmFsc2UpCiAgICAgICAgICB9IGVsc2UgaWYgKG1lbW9yeSAmJiBtZW1vcnkgIT09IHRydWUpIHsKICAgICAgICAgICAgZmlyaW5nU3RhcnQgPSBsZW5ndGg7CiAgICAgICAgICAgIGZpcmUobWVtb3J5WzBdLCBtZW1vcnlbMV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCiAgICAgIC8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3QKICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7CiAgICAgICAgaWYgKGxpc3QpIHsKICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLAogICAgICAgICAgICAgIGFyZ0luZGV4ID0gMCwKICAgICAgICAgICAgICBhcmdMZW5ndGggPSBhcmdzLmxlbmd0aDsKCiAgICAgICAgICBmb3IgKDsgYXJnSW5kZXggPCBhcmdMZW5ndGg7IGFyZ0luZGV4KyspIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgaWYgKGFyZ3NbYXJnSW5kZXhdID09PSBsaXN0W2ldKSB7CiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgZmlyaW5nSW5kZXggYW5kIGZpcmluZ0xlbmd0aAogICAgICAgICAgICAgICAgaWYgKGZpcmluZykgewogICAgICAgICAgICAgICAgICBpZiAoaSA8PSBmaXJpbmdMZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBmaXJpbmdMZW5ndGgtLTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPD0gZmlyaW5nSW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICAgIGZpcmluZ0luZGV4LS07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IC8vIFJlbW92ZSB0aGUgZWxlbWVudAoKCiAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpLS0sIDEpOyAvLyBJZiB3ZSBoYXZlIHNvbWUgdW5pY2l0eSBwcm9wZXJ0eSB0aGVuCiAgICAgICAgICAgICAgICAvLyB3ZSBvbmx5IG5lZWQgdG8gZG8gdGhpcyBvbmNlCgogICAgICAgICAgICAgICAgaWYgKGZsYWdzLnVuaXF1ZSkgewogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9LAogICAgICAvLyBDb250cm9sIGlmIGEgZ2l2ZW4gY2FsbGJhY2sgaXMgaW4gdGhlIGxpc3QKICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoZm4pIHsKICAgICAgICBpZiAobGlzdCkgewogICAgICAgICAgdmFyIGkgPSAwLAogICAgICAgICAgICAgIGxlbmd0aCA9IGxpc3QubGVuZ3RoOwoKICAgICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGZuID09PSBsaXN0W2ldKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSwKICAgICAgLy8gUmVtb3ZlIGFsbCBjYWxsYmFja3MgZnJvbSB0aGUgbGlzdAogICAgICBlbXB0eTogZnVuY3Rpb24gZW1wdHkoKSB7CiAgICAgICAgbGlzdCA9IFtdOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9LAogICAgICAvLyBIYXZlIHRoZSBsaXN0IGRvIG5vdGhpbmcgYW55bW9yZQogICAgICBkaXNhYmxlOiBmdW5jdGlvbiBkaXNhYmxlKCkgewogICAgICAgIGxpc3QgPSBzdGFjayA9IG1lbW9yeSA9IHVuZGVmaW5lZDsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSwKICAgICAgLy8gSXMgaXQgZGlzYWJsZWQ/CiAgICAgIGRpc2FibGVkOiBmdW5jdGlvbiBkaXNhYmxlZCgpIHsKICAgICAgICByZXR1cm4gIWxpc3Q7CiAgICAgIH0sCiAgICAgIC8vIExvY2sgdGhlIGxpc3QgaW4gaXRzIGN1cnJlbnQgc3RhdGUKICAgICAgbG9jazogZnVuY3Rpb24gbG9jaygpIHsKICAgICAgICBzdGFjayA9IHVuZGVmaW5lZDsKCiAgICAgICAgaWYgKCFtZW1vcnkgfHwgbWVtb3J5ID09PSB0cnVlKSB7CiAgICAgICAgICBzZWxmLmRpc2FibGUoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9LAogICAgICAvLyBJcyBpdCBsb2NrZWQ/CiAgICAgIGxvY2tlZDogZnVuY3Rpb24gbG9ja2VkKCkgewogICAgICAgIHJldHVybiAhc3RhY2s7CiAgICAgIH0sCiAgICAgIC8vIENhbGwgYWxsIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBjb250ZXh0IGFuZCBhcmd1bWVudHMKICAgICAgZmlyZVdpdGg6IGZ1bmN0aW9uIGZpcmVXaXRoKGNvbnRleHQsIGFyZ3MpIHsKICAgICAgICBpZiAoc3RhY2spIHsKICAgICAgICAgIGlmIChmaXJpbmcpIHsKICAgICAgICAgICAgaWYgKCFmbGFncy5vbmNlKSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChbY29udGV4dCwgYXJnc10pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKCEoZmxhZ3Mub25jZSAmJiBtZW1vcnkpKSB7CiAgICAgICAgICAgIGZpcmUoY29udGV4dCwgYXJncyk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfSwKICAgICAgLy8gQ2FsbCBhbGwgdGhlIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBhcmd1bWVudHMKICAgICAgZmlyZTogZnVuY3Rpb24gZmlyZSgpIHsKICAgICAgICBzZWxmLmZpcmVXaXRoKHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCiAgICAgIC8vIFRvIGtub3cgaWYgdGhlIGNhbGxiYWNrcyBoYXZlIGFscmVhZHkgYmVlbiBjYWxsZWQgYXQgbGVhc3Qgb25jZQogICAgICBmaXJlZDogZnVuY3Rpb24gZmlyZWQoKSB7CiAgICAgICAgcmV0dXJuICEhX2ZpcmVkOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBzZWxmOwogIH07CgogIHZhciAvLyBTdGF0aWMgcmVmZXJlbmNlIHRvIHNsaWNlCiAgc2xpY2VEZWZlcnJlZCA9IFtdLnNsaWNlOwogIGpRdWVyeS5leHRlbmQoewogICAgRGVmZXJyZWQ6IGZ1bmN0aW9uIERlZmVycmVkKGZ1bmMpIHsKICAgICAgdmFyIGRvbmVMaXN0ID0galF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwKICAgICAgICAgIGZhaWxMaXN0ID0galF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwKICAgICAgICAgIHByb2dyZXNzTGlzdCA9IGpRdWVyeS5DYWxsYmFja3MoIm1lbW9yeSIpLAogICAgICAgICAgX3N0YXRlID0gInBlbmRpbmciLAogICAgICAgICAgbGlzdHMgPSB7CiAgICAgICAgcmVzb2x2ZTogZG9uZUxpc3QsCiAgICAgICAgcmVqZWN0OiBmYWlsTGlzdCwKICAgICAgICBub3RpZnk6IHByb2dyZXNzTGlzdAogICAgICB9LAogICAgICAgICAgX3Byb21pc2UgPSB7CiAgICAgICAgZG9uZTogZG9uZUxpc3QuYWRkLAogICAgICAgIGZhaWw6IGZhaWxMaXN0LmFkZCwKICAgICAgICBwcm9ncmVzczogcHJvZ3Jlc3NMaXN0LmFkZCwKICAgICAgICBzdGF0ZTogZnVuY3Rpb24gc3RhdGUoKSB7CiAgICAgICAgICByZXR1cm4gX3N0YXRlOwogICAgICAgIH0sCiAgICAgICAgLy8gRGVwcmVjYXRlZAogICAgICAgIGlzUmVzb2x2ZWQ6IGRvbmVMaXN0LmZpcmVkLAogICAgICAgIGlzUmVqZWN0ZWQ6IGZhaWxMaXN0LmZpcmVkLAogICAgICAgIHRoZW46IGZ1bmN0aW9uIHRoZW4oZG9uZUNhbGxiYWNrcywgZmFpbENhbGxiYWNrcywgcHJvZ3Jlc3NDYWxsYmFja3MpIHsKICAgICAgICAgIGRlZmVycmVkLmRvbmUoZG9uZUNhbGxiYWNrcykuZmFpbChmYWlsQ2FsbGJhY2tzKS5wcm9ncmVzcyhwcm9ncmVzc0NhbGxiYWNrcyk7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIGFsd2F5czogZnVuY3Rpb24gYWx3YXlzKCkgewogICAgICAgICAgZGVmZXJyZWQuZG9uZS5hcHBseShkZWZlcnJlZCwgYXJndW1lbnRzKS5mYWlsLmFwcGx5KGRlZmVycmVkLCBhcmd1bWVudHMpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSwKICAgICAgICBwaXBlOiBmdW5jdGlvbiBwaXBlKGZuRG9uZSwgZm5GYWlsLCBmblByb2dyZXNzKSB7CiAgICAgICAgICByZXR1cm4galF1ZXJ5LkRlZmVycmVkKGZ1bmN0aW9uIChuZXdEZWZlcikgewogICAgICAgICAgICBqUXVlcnkuZWFjaCh7CiAgICAgICAgICAgICAgZG9uZTogW2ZuRG9uZSwgInJlc29sdmUiXSwKICAgICAgICAgICAgICBmYWlsOiBbZm5GYWlsLCAicmVqZWN0Il0sCiAgICAgICAgICAgICAgcHJvZ3Jlc3M6IFtmblByb2dyZXNzLCAibm90aWZ5Il0KICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGhhbmRsZXIsIGRhdGEpIHsKICAgICAgICAgICAgICB2YXIgZm4gPSBkYXRhWzBdLAogICAgICAgICAgICAgICAgICBhY3Rpb24gPSBkYXRhWzFdLAogICAgICAgICAgICAgICAgICByZXR1cm5lZDsKCiAgICAgICAgICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKGZuKSkgewogICAgICAgICAgICAgICAgZGVmZXJyZWRbaGFuZGxlcl0oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICByZXR1cm5lZCA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAgICAgICAgICAgICBpZiAocmV0dXJuZWQgJiYgalF1ZXJ5LmlzRnVuY3Rpb24ocmV0dXJuZWQucHJvbWlzZSkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm5lZC5wcm9taXNlKCkudGhlbihuZXdEZWZlci5yZXNvbHZlLCBuZXdEZWZlci5yZWplY3QsIG5ld0RlZmVyLm5vdGlmeSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbmV3RGVmZXJbYWN0aW9uICsgIldpdGgiXSh0aGlzID09PSBkZWZlcnJlZCA/IG5ld0RlZmVyIDogdGhpcywgW3JldHVybmVkXSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkZWZlcnJlZFtoYW5kbGVyXShuZXdEZWZlclthY3Rpb25dKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkucHJvbWlzZSgpOwogICAgICAgIH0sCiAgICAgICAgLy8gR2V0IGEgcHJvbWlzZSBmb3IgdGhpcyBkZWZlcnJlZAogICAgICAgIC8vIElmIG9iaiBpcyBwcm92aWRlZCwgdGhlIHByb21pc2UgYXNwZWN0IGlzIGFkZGVkIHRvIHRoZSBvYmplY3QKICAgICAgICBwcm9taXNlOiBmdW5jdGlvbiBwcm9taXNlKG9iaikgewogICAgICAgICAgaWYgKG9iaiA9PSBudWxsKSB7CiAgICAgICAgICAgIG9iaiA9IF9wcm9taXNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIF9wcm9taXNlKSB7CiAgICAgICAgICAgICAgb2JqW2tleV0gPSBfcHJvbWlzZVtrZXldOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG9iajsKICAgICAgICB9CiAgICAgIH0sCiAgICAgICAgICBkZWZlcnJlZCA9IF9wcm9taXNlLnByb21pc2Uoe30pLAogICAgICAgICAga2V5OwoKICAgICAgZm9yIChrZXkgaW4gbGlzdHMpIHsKICAgICAgICBkZWZlcnJlZFtrZXldID0gbGlzdHNba2V5XS5maXJlOwogICAgICAgIGRlZmVycmVkW2tleSArICJXaXRoIl0gPSBsaXN0c1trZXldLmZpcmVXaXRoOwogICAgICB9IC8vIEhhbmRsZSBzdGF0ZQoKCiAgICAgIGRlZmVycmVkLmRvbmUoZnVuY3Rpb24gKCkgewogICAgICAgIF9zdGF0ZSA9ICJyZXNvbHZlZCI7CiAgICAgIH0sIGZhaWxMaXN0LmRpc2FibGUsIHByb2dyZXNzTGlzdC5sb2NrKS5mYWlsKGZ1bmN0aW9uICgpIHsKICAgICAgICBfc3RhdGUgPSAicmVqZWN0ZWQiOwogICAgICB9LCBkb25lTGlzdC5kaXNhYmxlLCBwcm9ncmVzc0xpc3QubG9jayk7IC8vIENhbGwgZ2l2ZW4gZnVuYyBpZiBhbnkKCiAgICAgIGlmIChmdW5jKSB7CiAgICAgICAgZnVuYy5jYWxsKGRlZmVycmVkLCBkZWZlcnJlZCk7CiAgICAgIH0gLy8gQWxsIGRvbmUhCgoKICAgICAgcmV0dXJuIGRlZmVycmVkOwogICAgfSwKICAgIC8vIERlZmVycmVkIGhlbHBlcgogICAgd2hlbjogZnVuY3Rpb24gd2hlbihmaXJzdFBhcmFtKSB7CiAgICAgIHZhciBhcmdzID0gc2xpY2VEZWZlcnJlZC5jYWxsKGFyZ3VtZW50cywgMCksCiAgICAgICAgICBpID0gMCwKICAgICAgICAgIGxlbmd0aCA9IGFyZ3MubGVuZ3RoLAogICAgICAgICAgcFZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpLAogICAgICAgICAgY291bnQgPSBsZW5ndGgsCiAgICAgICAgICBwQ291bnQgPSBsZW5ndGgsCiAgICAgICAgICBkZWZlcnJlZCA9IGxlbmd0aCA8PSAxICYmIGZpcnN0UGFyYW0gJiYgalF1ZXJ5LmlzRnVuY3Rpb24oZmlyc3RQYXJhbS5wcm9taXNlKSA/IGZpcnN0UGFyYW0gOiBqUXVlcnkuRGVmZXJyZWQoKSwKICAgICAgICAgIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlKCk7CgogICAgICBmdW5jdGlvbiByZXNvbHZlRnVuYyhpKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gc2xpY2VEZWZlcnJlZC5jYWxsKGFyZ3VtZW50cywgMCkgOiB2YWx1ZTsKCiAgICAgICAgICBpZiAoISAtLWNvdW50KSB7CiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmVXaXRoKGRlZmVycmVkLCBhcmdzKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgICBmdW5jdGlvbiBwcm9ncmVzc0Z1bmMoaSkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIHBWYWx1ZXNbaV0gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IHNsaWNlRGVmZXJyZWQuY2FsbChhcmd1bWVudHMsIDApIDogdmFsdWU7CiAgICAgICAgICBkZWZlcnJlZC5ub3RpZnlXaXRoKHByb21pc2UsIHBWYWx1ZXMpOwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGlmIChsZW5ndGggPiAxKSB7CiAgICAgICAgZm9yICg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKGFyZ3NbaV0gJiYgYXJnc1tpXS5wcm9taXNlICYmIGpRdWVyeS5pc0Z1bmN0aW9uKGFyZ3NbaV0ucHJvbWlzZSkpIHsKICAgICAgICAgICAgYXJnc1tpXS5wcm9taXNlKCkudGhlbihyZXNvbHZlRnVuYyhpKSwgZGVmZXJyZWQucmVqZWN0LCBwcm9ncmVzc0Z1bmMoaSkpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLS1jb3VudDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghY291bnQpIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmVXaXRoKGRlZmVycmVkLCBhcmdzKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGVmZXJyZWQgIT09IGZpcnN0UGFyYW0pIHsKICAgICAgICBkZWZlcnJlZC5yZXNvbHZlV2l0aChkZWZlcnJlZCwgbGVuZ3RoID8gW2ZpcnN0UGFyYW1dIDogW10pOwogICAgICB9CgogICAgICByZXR1cm4gcHJvbWlzZTsKICAgIH0KICB9KTsKCiAgalF1ZXJ5LnN1cHBvcnQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc3VwcG9ydCwKICAgICAgICBhbGwsCiAgICAgICAgYSwKICAgICAgICBzZWxlY3QsCiAgICAgICAgb3B0LAogICAgICAgIGlucHV0LAogICAgICAgIGZyYWdtZW50LAogICAgICAgIHRkcywKICAgICAgICBldmVudHMsCiAgICAgICAgZXZlbnROYW1lLAogICAgICAgIGksCiAgICAgICAgaXNTdXBwb3J0ZWQsCiAgICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksCiAgICAgICAgZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OyAvLyBQcmVsaW1pbmFyeSB0ZXN0cwoKICAgIGRpdi5zZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIsICJ0Iik7CiAgICBkaXYuaW5uZXJIVE1MID0gIiAgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYScgc3R5bGU9J3RvcDoxcHg7ZmxvYXQ6bGVmdDtvcGFjaXR5Oi41NTsnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjsKICAgIGFsbCA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpOwogICAgYSA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWzBdOyAvLyBDYW4ndCBnZXQgYmFzaWMgdGVzdCBzdXBwb3J0CgogICAgaWYgKCFhbGwgfHwgIWFsbC5sZW5ndGggfHwgIWEpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfSAvLyBGaXJzdCBiYXRjaCBvZiBzdXBwb3J0cyB0ZXN0cwoKCiAgICBzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKTsKICAgIG9wdCA9IHNlbGVjdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7CiAgICBpbnB1dCA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKVswXTsKICAgIHN1cHBvcnQgPSB7CiAgICAgIC8vIElFIHN0cmlwcyBsZWFkaW5nIHdoaXRlc3BhY2Ugd2hlbiAuaW5uZXJIVE1MIGlzIHVzZWQKICAgICAgbGVhZGluZ1doaXRlc3BhY2U6IGRpdi5maXJzdENoaWxkLm5vZGVUeXBlID09PSAzLAogICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0Ym9keSBlbGVtZW50cyBhcmVuJ3QgYXV0b21hdGljYWxseSBpbnNlcnRlZAogICAgICAvLyBJRSB3aWxsIGluc2VydCB0aGVtIGludG8gZW1wdHkgdGFibGVzCiAgICAgIHRib2R5OiAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpLmxlbmd0aCwKICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgbGluayBlbGVtZW50cyBnZXQgc2VyaWFsaXplZCBjb3JyZWN0bHkgYnkgaW5uZXJIVE1MCiAgICAgIC8vIFRoaXMgcmVxdWlyZXMgYSB3cmFwcGVyIGVsZW1lbnQgaW4gSUUKICAgICAgaHRtbFNlcmlhbGl6ZTogISFkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImxpbmsiKS5sZW5ndGgsCiAgICAgIC8vIEdldCB0aGUgc3R5bGUgaW5mb3JtYXRpb24gZnJvbSBnZXRBdHRyaWJ1dGUKICAgICAgLy8gKElFIHVzZXMgLmNzc1RleHQgaW5zdGVhZCkKICAgICAgc3R5bGU6IC90b3AvLnRlc3QoYS5nZXRBdHRyaWJ1dGUoInN0eWxlIikpLAogICAgICAvLyBNYWtlIHN1cmUgdGhhdCBVUkxzIGFyZW4ndCBtYW5pcHVsYXRlZAogICAgICAvLyAoSUUgbm9ybWFsaXplcyBpdCBieSBkZWZhdWx0KQogICAgICBocmVmTm9ybWFsaXplZDogYS5nZXRBdHRyaWJ1dGUoImhyZWYiKSA9PT0gIi9hIiwKICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgZWxlbWVudCBvcGFjaXR5IGV4aXN0cwogICAgICAvLyAoSUUgdXNlcyBmaWx0ZXIgaW5zdGVhZCkKICAgICAgLy8gVXNlIGEgcmVnZXggdG8gd29yayBhcm91bmQgYSBXZWJLaXQgaXNzdWUuIFNlZSAjNTE0NQogICAgICBvcGFjaXR5OiAvXjAuNTUvLnRlc3QoYS5zdHlsZS5vcGFjaXR5KSwKICAgICAgLy8gVmVyaWZ5IHN0eWxlIGZsb2F0IGV4aXN0ZW5jZQogICAgICAvLyAoSUUgdXNlcyBzdHlsZUZsb2F0IGluc3RlYWQgb2YgY3NzRmxvYXQpCiAgICAgIGNzc0Zsb2F0OiAhIWEuc3R5bGUuY3NzRmxvYXQsCiAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IGlmIG5vIHZhbHVlIGlzIHNwZWNpZmllZCBmb3IgYSBjaGVja2JveAogICAgICAvLyB0aGF0IGl0IGRlZmF1bHRzIHRvICJvbiIuCiAgICAgIC8vIChXZWJLaXQgZGVmYXVsdHMgdG8gIiIgaW5zdGVhZCkKICAgICAgY2hlY2tPbjogaW5wdXQudmFsdWUgPT09ICJvbiIsCiAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IGEgc2VsZWN0ZWQtYnktZGVmYXVsdCBvcHRpb24gaGFzIGEgd29ya2luZyBzZWxlY3RlZCBwcm9wZXJ0eS4KICAgICAgLy8gKFdlYktpdCBkZWZhdWx0cyB0byBmYWxzZSBpbnN0ZWFkIG9mIHRydWUsIElFIHRvbywgaWYgaXQncyBpbiBhbiBvcHRncm91cCkKICAgICAgb3B0U2VsZWN0ZWQ6IG9wdC5zZWxlY3RlZCwKICAgICAgLy8gVGVzdCBzZXRBdHRyaWJ1dGUgb24gY2FtZWxDYXNlIGNsYXNzLiBJZiBpdCB3b3Jrcywgd2UgbmVlZCBhdHRyRml4ZXMgd2hlbiBkb2luZyBnZXQvc2V0QXR0cmlidXRlIChpZTYvNykKICAgICAgZ2V0U2V0QXR0cmlidXRlOiBkaXYuY2xhc3NOYW1lICE9PSAidCIsCiAgICAgIC8vIFRlc3RzIGZvciBlbmN0eXBlIHN1cHBvcnQgb24gYSBmb3JtKCM2NzQzKQogICAgICBlbmN0eXBlOiAhIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImZvcm0iKS5lbmN0eXBlLAogICAgICAvLyBNYWtlcyBzdXJlIGNsb25pbmcgYW4gaHRtbDUgZWxlbWVudCBkb2VzIG5vdCBjYXVzZSBwcm9ibGVtcwogICAgICAvLyBXaGVyZSBvdXRlckhUTUwgaXMgdW5kZWZpbmVkLCB0aGlzIHN0aWxsIHdvcmtzCiAgICAgIGh0bWw1Q2xvbmU6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm5hdiIpLmNsb25lTm9kZSh0cnVlKS5vdXRlckhUTUwgIT09ICI8Om5hdj48LzpuYXY+IiwKICAgICAgLy8gV2lsbCBiZSBkZWZpbmVkIGxhdGVyCiAgICAgIHN1Ym1pdEJ1YmJsZXM6IHRydWUsCiAgICAgIGNoYW5nZUJ1YmJsZXM6IHRydWUsCiAgICAgIGZvY3VzaW5CdWJibGVzOiBmYWxzZSwKICAgICAgZGVsZXRlRXhwYW5kbzogdHJ1ZSwKICAgICAgbm9DbG9uZUV2ZW50OiB0cnVlLAogICAgICBpbmxpbmVCbG9ja05lZWRzTGF5b3V0OiBmYWxzZSwKICAgICAgc2hyaW5rV3JhcEJsb2NrczogZmFsc2UsCiAgICAgIHJlbGlhYmxlTWFyZ2luUmlnaHQ6IHRydWUsCiAgICAgIHBpeGVsTWFyZ2luOiB0cnVlCiAgICB9OyAvLyBqUXVlcnkuYm94TW9kZWwgREVQUkVDQVRFRCBpbiAxLjMsIHVzZSBqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbCBpbnN0ZWFkCgogICAgalF1ZXJ5LmJveE1vZGVsID0gc3VwcG9ydC5ib3hNb2RlbCA9IGRvY3VtZW50LmNvbXBhdE1vZGUgPT09ICJDU1MxQ29tcGF0IjsgLy8gTWFrZSBzdXJlIGNoZWNrZWQgc3RhdHVzIGlzIHByb3Blcmx5IGNsb25lZAoKICAgIGlucHV0LmNoZWNrZWQgPSB0cnVlOwogICAgc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCA9IGlucHV0LmNsb25lTm9kZSh0cnVlKS5jaGVja2VkOyAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgb3B0aW9ucyBpbnNpZGUgZGlzYWJsZWQgc2VsZWN0cyBhcmVuJ3QgbWFya2VkIGFzIGRpc2FibGVkCiAgICAvLyAoV2ViS2l0IG1hcmtzIHRoZW0gYXMgZGlzYWJsZWQpCgogICAgc2VsZWN0LmRpc2FibGVkID0gdHJ1ZTsKICAgIHN1cHBvcnQub3B0RGlzYWJsZWQgPSAhb3B0LmRpc2FibGVkOyAvLyBUZXN0IHRvIHNlZSBpZiBpdCdzIHBvc3NpYmxlIHRvIGRlbGV0ZSBhbiBleHBhbmRvIGZyb20gYW4gZWxlbWVudAogICAgLy8gRmFpbHMgaW4gSW50ZXJuZXQgRXhwbG9yZXIKCiAgICB0cnkgewogICAgICBkZWxldGUgZGl2LnRlc3Q7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9IGZhbHNlOwogICAgfQoKICAgIGlmICghZGl2LmFkZEV2ZW50TGlzdGVuZXIgJiYgZGl2LmF0dGFjaEV2ZW50ICYmIGRpdi5maXJlRXZlbnQpIHsKICAgICAgZGl2LmF0dGFjaEV2ZW50KCJvbmNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICAgIC8vIENsb25pbmcgYSBub2RlIHNob3VsZG4ndCBjb3B5IG92ZXIgYW55CiAgICAgICAgLy8gYm91bmQgZXZlbnQgaGFuZGxlcnMgKElFIGRvZXMgdGhpcykKICAgICAgICBzdXBwb3J0Lm5vQ2xvbmVFdmVudCA9IGZhbHNlOwogICAgICB9KTsKICAgICAgZGl2LmNsb25lTm9kZSh0cnVlKS5maXJlRXZlbnQoIm9uY2xpY2siKTsKICAgIH0gLy8gQ2hlY2sgaWYgYSByYWRpbyBtYWludGFpbnMgaXRzIHZhbHVlCiAgICAvLyBhZnRlciBiZWluZyBhcHBlbmRlZCB0byB0aGUgRE9NCgoKICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgIGlucHV0LnZhbHVlID0gInQiOwogICAgaW5wdXQuc2V0QXR0cmlidXRlKCJ0eXBlIiwgInJhZGlvIik7CiAgICBzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gInQiOwogICAgaW5wdXQuc2V0QXR0cmlidXRlKCJjaGVja2VkIiwgImNoZWNrZWQiKTsgLy8gIzExMjE3IC0gV2ViS2l0IGxvc2VzIGNoZWNrIHdoZW4gdGhlIG5hbWUgaXMgYWZ0ZXIgdGhlIGNoZWNrZWQgYXR0cmlidXRlCgogICAgaW5wdXQuc2V0QXR0cmlidXRlKCJuYW1lIiwgInQiKTsKICAgIGRpdi5hcHBlbmRDaGlsZChpbnB1dCk7CiAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGRpdi5sYXN0Q2hpbGQpOyAvLyBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHMKCiAgICBzdXBwb3J0LmNoZWNrQ2xvbmUgPSBmcmFnbWVudC5jbG9uZU5vZGUodHJ1ZSkuY2xvbmVOb2RlKHRydWUpLmxhc3RDaGlsZC5jaGVja2VkOyAvLyBDaGVjayBpZiBhIGRpc2Nvbm5lY3RlZCBjaGVja2JveCB3aWxsIHJldGFpbiBpdHMgY2hlY2tlZAogICAgLy8gdmFsdWUgb2YgdHJ1ZSBhZnRlciBhcHBlbmRlZCB0byB0aGUgRE9NIChJRTYvNykKCiAgICBzdXBwb3J0LmFwcGVuZENoZWNrZWQgPSBpbnB1dC5jaGVja2VkOwogICAgZnJhZ21lbnQucmVtb3ZlQ2hpbGQoaW5wdXQpOwogICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZGl2KTsgLy8gVGVjaG5pcXVlIGZyb20gSnVyaXkgWmF5dHNldgogICAgLy8gaHR0cDovL3BlcmZlY3Rpb25raWxscy5jb20vZGV0ZWN0aW5nLWV2ZW50LXN1cHBvcnQtd2l0aG91dC1icm93c2VyLXNuaWZmaW5nLwogICAgLy8gV2Ugb25seSBjYXJlIGFib3V0IHRoZSBjYXNlIHdoZXJlIG5vbi1zdGFuZGFyZCBldmVudCBzeXN0ZW1zCiAgICAvLyBhcmUgdXNlZCwgbmFtZWx5IGluIElFLiBTaG9ydC1jaXJjdWl0aW5nIGhlcmUgaGVscHMgdXMgdG8KICAgIC8vIGF2b2lkIGFuIGV2YWwgY2FsbCAoaW4gc2V0QXR0cmlidXRlKSB3aGljaCBjYW4gY2F1c2UgQ1NQCiAgICAvLyB0byBnbyBoYXl3aXJlLiBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL1NlY3VyaXR5L0NTUAoKICAgIGlmIChkaXYuYXR0YWNoRXZlbnQpIHsKICAgICAgZm9yIChpIGluIHsKICAgICAgICBzdWJtaXQ6IDEsCiAgICAgICAgY2hhbmdlOiAxLAogICAgICAgIGZvY3VzaW46IDEKICAgICAgfSkgewogICAgICAgIGV2ZW50TmFtZSA9ICJvbiIgKyBpOwogICAgICAgIGlzU3VwcG9ydGVkID0gZXZlbnROYW1lIGluIGRpdjsKCiAgICAgICAgaWYgKCFpc1N1cHBvcnRlZCkgewogICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZShldmVudE5hbWUsICJyZXR1cm47Iik7CiAgICAgICAgICBpc1N1cHBvcnRlZCA9IHR5cGVvZiBkaXZbZXZlbnROYW1lXSA9PT0gImZ1bmN0aW9uIjsKICAgICAgICB9CgogICAgICAgIHN1cHBvcnRbaSArICJCdWJibGVzIl0gPSBpc1N1cHBvcnRlZDsKICAgICAgfQogICAgfQoKICAgIGZyYWdtZW50LnJlbW92ZUNoaWxkKGRpdik7IC8vIE51bGwgZWxlbWVudHMgdG8gYXZvaWQgbGVha3MgaW4gSUUKCiAgICBmcmFnbWVudCA9IHNlbGVjdCA9IG9wdCA9IGRpdiA9IGlucHV0ID0gbnVsbDsgLy8gUnVuIHRlc3RzIHRoYXQgbmVlZCBhIGJvZHkgYXQgZG9jIHJlYWR5CgogICAgalF1ZXJ5KGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGNvbnRhaW5lciwKICAgICAgICAgIG91dGVyLAogICAgICAgICAgaW5uZXIsCiAgICAgICAgICB0YWJsZSwKICAgICAgICAgIHRkLAogICAgICAgICAgb2Zmc2V0U3VwcG9ydCwKICAgICAgICAgIG1hcmdpbkRpdiwKICAgICAgICAgIGNvbk1hcmdpblRvcCwKICAgICAgICAgIHN0eWxlLAogICAgICAgICAgaHRtbCwKICAgICAgICAgIHBvc2l0aW9uVG9wTGVmdFdpZHRoSGVpZ2h0LAogICAgICAgICAgcGFkZGluZ01hcmdpbkJvcmRlclZpc2liaWxpdHksCiAgICAgICAgICBwYWRkaW5nTWFyZ2luQm9yZGVyLAogICAgICAgICAgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07CgogICAgICBpZiAoIWJvZHkpIHsKICAgICAgICAvLyBSZXR1cm4gZm9yIGZyYW1lc2V0IGRvY3MgdGhhdCBkb24ndCBoYXZlIGEgYm9keQogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uTWFyZ2luVG9wID0gMTsKICAgICAgcGFkZGluZ01hcmdpbkJvcmRlciA9ICJwYWRkaW5nOjA7bWFyZ2luOjA7Ym9yZGVyOiI7CiAgICAgIHBvc2l0aW9uVG9wTGVmdFdpZHRoSGVpZ2h0ID0gInBvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDoxcHg7aGVpZ2h0OjFweDsiOwogICAgICBwYWRkaW5nTWFyZ2luQm9yZGVyVmlzaWJpbGl0eSA9IHBhZGRpbmdNYXJnaW5Cb3JkZXIgKyAiMDt2aXNpYmlsaXR5OmhpZGRlbjsiOwogICAgICBzdHlsZSA9ICJzdHlsZT0nIiArIHBvc2l0aW9uVG9wTGVmdFdpZHRoSGVpZ2h0ICsgcGFkZGluZ01hcmdpbkJvcmRlciArICI1cHggc29saWQgIzAwMDsiOwogICAgICBodG1sID0gIjxkaXYgIiArIHN0eWxlICsgImRpc3BsYXk6YmxvY2s7Jz48ZGl2IHN0eWxlPSciICsgcGFkZGluZ01hcmdpbkJvcmRlciArICIwO2Rpc3BsYXk6YmxvY2s7b3ZlcmZsb3c6aGlkZGVuOyc+PC9kaXY+PC9kaXY+IiArICI8dGFibGUgIiArIHN0eWxlICsgIicgY2VsbHBhZGRpbmc9JzAnIGNlbGxzcGFjaW5nPScwJz4iICsgIjx0cj48dGQ+PC90ZD48L3RyPjwvdGFibGU+IjsKICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gcGFkZGluZ01hcmdpbkJvcmRlclZpc2liaWxpdHkgKyAid2lkdGg6MDtoZWlnaHQ6MDtwb3NpdGlvbjpzdGF0aWM7dG9wOjA7bWFyZ2luLXRvcDoiICsgY29uTWFyZ2luVG9wICsgInB4IjsKICAgICAgYm9keS5pbnNlcnRCZWZvcmUoY29udGFpbmVyLCBib2R5LmZpcnN0Q2hpbGQpOyAvLyBDb25zdHJ1Y3QgdGhlIHRlc3QgZWxlbWVudAoKICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXYpOyAvLyBDaGVjayBpZiB0YWJsZSBjZWxscyBzdGlsbCBoYXZlIG9mZnNldFdpZHRoL0hlaWdodCB3aGVuIHRoZXkgYXJlIHNldAogICAgICAvLyB0byBkaXNwbGF5Om5vbmUgYW5kIHRoZXJlIGFyZSBzdGlsbCBvdGhlciB2aXNpYmxlIHRhYmxlIGNlbGxzIGluIGEKICAgICAgLy8gdGFibGUgcm93OyBpZiBzbywgb2Zmc2V0V2lkdGgvSGVpZ2h0IGFyZSBub3QgcmVsaWFibGUgZm9yIHVzZSB3aGVuCiAgICAgIC8vIGRldGVybWluaW5nIGlmIGFuIGVsZW1lbnQgaGFzIGJlZW4gaGlkZGVuIGRpcmVjdGx5IHVzaW5nCiAgICAgIC8vIGRpc3BsYXk6bm9uZSAoaXQgaXMgc3RpbGwgc2FmZSB0byB1c2Ugb2Zmc2V0cyBpZiBhIHBhcmVudCBlbGVtZW50IGlzCiAgICAgIC8vIGhpZGRlbjsgZG9uIHNhZmV0eSBnb2dnbGVzIGFuZCBzZWUgYnVnICM0NTEyIGZvciBtb3JlIGluZm9ybWF0aW9uKS4KICAgICAgLy8gKG9ubHkgSUUgOCBmYWlscyB0aGlzIHRlc3QpCgogICAgICBkaXYuaW5uZXJIVE1MID0gIjx0YWJsZT48dHI+PHRkIHN0eWxlPSciICsgcGFkZGluZ01hcmdpbkJvcmRlciArICIwO2Rpc3BsYXk6bm9uZSc+PC90ZD48dGQ+dDwvdGQ+PC90cj48L3RhYmxlPiI7CiAgICAgIHRkcyA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGQiKTsKICAgICAgaXNTdXBwb3J0ZWQgPSB0ZHNbMF0ub2Zmc2V0SGVpZ2h0ID09PSAwOwogICAgICB0ZHNbMF0uc3R5bGUuZGlzcGxheSA9ICIiOwogICAgICB0ZHNbMV0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsgLy8gQ2hlY2sgaWYgZW1wdHkgdGFibGUgY2VsbHMgc3RpbGwgaGF2ZSBvZmZzZXRXaWR0aC9IZWlnaHQKICAgICAgLy8gKElFIDw9IDggZmFpbCB0aGlzIHRlc3QpCgogICAgICBzdXBwb3J0LnJlbGlhYmxlSGlkZGVuT2Zmc2V0cyA9IGlzU3VwcG9ydGVkICYmIHRkc1swXS5vZmZzZXRIZWlnaHQgPT09IDA7IC8vIENoZWNrIGlmIGRpdiB3aXRoIGV4cGxpY2l0IHdpZHRoIGFuZCBubyBtYXJnaW4tcmlnaHQgaW5jb3JyZWN0bHkKICAgICAgLy8gZ2V0cyBjb21wdXRlZCBtYXJnaW4tcmlnaHQgYmFzZWQgb24gd2lkdGggb2YgY29udGFpbmVyLiBGb3IgbW9yZQogICAgICAvLyBpbmZvIHNlZSBidWcgIzMzMzMKICAgICAgLy8gRmFpbHMgaW4gV2ViS2l0IGJlZm9yZSBGZWIgMjAxMSBuaWdodGxpZXMKICAgICAgLy8gV2ViS2l0IEJ1ZyAxMzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3IgbWFyZ2luLXJpZ2h0CgogICAgICBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHsKICAgICAgICBkaXYuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgbWFyZ2luRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgbWFyZ2luRGl2LnN0eWxlLndpZHRoID0gIjAiOwogICAgICAgIG1hcmdpbkRpdi5zdHlsZS5tYXJnaW5SaWdodCA9ICIwIjsKICAgICAgICBkaXYuc3R5bGUud2lkdGggPSAiMnB4IjsKICAgICAgICBkaXYuYXBwZW5kQ2hpbGQobWFyZ2luRGl2KTsKICAgICAgICBzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQgPSAocGFyc2VJbnQoKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG1hcmdpbkRpdiwgbnVsbCkgfHwgewogICAgICAgICAgbWFyZ2luUmlnaHQ6IDAKICAgICAgICB9KS5tYXJnaW5SaWdodCwgMTApIHx8IDApID09PSAwOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGRpdi5zdHlsZS56b29tICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIC8vIENoZWNrIGlmIG5hdGl2ZWx5IGJsb2NrLWxldmVsIGVsZW1lbnRzIGFjdCBsaWtlIGlubGluZS1ibG9jawogICAgICAgIC8vIGVsZW1lbnRzIHdoZW4gc2V0dGluZyB0aGVpciBkaXNwbGF5IHRvICdpbmxpbmUnIGFuZCBnaXZpbmcKICAgICAgICAvLyB0aGVtIGxheW91dAogICAgICAgIC8vIChJRSA8IDggZG9lcyB0aGlzKQogICAgICAgIGRpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICBkaXYuc3R5bGUud2lkdGggPSBkaXYuc3R5bGUucGFkZGluZyA9ICIxcHgiOwogICAgICAgIGRpdi5zdHlsZS5ib3JkZXIgPSAwOwogICAgICAgIGRpdi5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CiAgICAgICAgZGl2LnN0eWxlLnpvb20gPSAxOwogICAgICAgIHN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dCA9IGRpdi5vZmZzZXRXaWR0aCA9PT0gMzsgLy8gQ2hlY2sgaWYgZWxlbWVudHMgd2l0aCBsYXlvdXQgc2hyaW5rLXdyYXAgdGhlaXIgY2hpbGRyZW4KICAgICAgICAvLyAoSUUgNiBkb2VzIHRoaXMpCgogICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBkaXYuc3R5bGUub3ZlcmZsb3cgPSAidmlzaWJsZSI7CiAgICAgICAgZGl2LmlubmVySFRNTCA9ICI8ZGl2IHN0eWxlPSd3aWR0aDo1cHg7Jz48L2Rpdj4iOwogICAgICAgIHN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcyA9IGRpdi5vZmZzZXRXaWR0aCAhPT0gMzsKICAgICAgfQoKICAgICAgZGl2LnN0eWxlLmNzc1RleHQgPSBwb3NpdGlvblRvcExlZnRXaWR0aEhlaWdodCArIHBhZGRpbmdNYXJnaW5Cb3JkZXJWaXNpYmlsaXR5OwogICAgICBkaXYuaW5uZXJIVE1MID0gaHRtbDsKICAgICAgb3V0ZXIgPSBkaXYuZmlyc3RDaGlsZDsKICAgICAgaW5uZXIgPSBvdXRlci5maXJzdENoaWxkOwogICAgICB0ZCA9IG91dGVyLm5leHRTaWJsaW5nLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZDsKICAgICAgb2Zmc2V0U3VwcG9ydCA9IHsKICAgICAgICBkb2VzTm90QWRkQm9yZGVyOiBpbm5lci5vZmZzZXRUb3AgIT09IDUsCiAgICAgICAgZG9lc0FkZEJvcmRlckZvclRhYmxlQW5kQ2VsbHM6IHRkLm9mZnNldFRvcCA9PT0gNQogICAgICB9OwogICAgICBpbm5lci5zdHlsZS5wb3NpdGlvbiA9ICJmaXhlZCI7CiAgICAgIGlubmVyLnN0eWxlLnRvcCA9ICIyMHB4IjsgLy8gc2FmYXJpIHN1YnRyYWN0cyBwYXJlbnQgYm9yZGVyIHdpZHRoIGhlcmUgd2hpY2ggaXMgNXB4CgogICAgICBvZmZzZXRTdXBwb3J0LmZpeGVkUG9zaXRpb24gPSBpbm5lci5vZmZzZXRUb3AgPT09IDIwIHx8IGlubmVyLm9mZnNldFRvcCA9PT0gMTU7CiAgICAgIGlubmVyLnN0eWxlLnBvc2l0aW9uID0gaW5uZXIuc3R5bGUudG9wID0gIiI7CiAgICAgIG91dGVyLnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgIG91dGVyLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKICAgICAgb2Zmc2V0U3VwcG9ydC5zdWJ0cmFjdHNCb3JkZXJGb3JPdmVyZmxvd05vdFZpc2libGUgPSBpbm5lci5vZmZzZXRUb3AgPT09IC01OwogICAgICBvZmZzZXRTdXBwb3J0LmRvZXNOb3RJbmNsdWRlTWFyZ2luSW5Cb2R5T2Zmc2V0ID0gYm9keS5vZmZzZXRUb3AgIT09IGNvbk1hcmdpblRvcDsKCiAgICAgIGlmICh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSkgewogICAgICAgIGRpdi5zdHlsZS5tYXJnaW5Ub3AgPSAiMSUiOwogICAgICAgIHN1cHBvcnQucGl4ZWxNYXJnaW4gPSAod2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LCBudWxsKSB8fCB7CiAgICAgICAgICBtYXJnaW5Ub3A6IDAKICAgICAgICB9KS5tYXJnaW5Ub3AgIT09ICIxJSI7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgY29udGFpbmVyLnN0eWxlLnpvb20gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgY29udGFpbmVyLnN0eWxlLnpvb20gPSAxOwogICAgICB9CgogICAgICBib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7CiAgICAgIG1hcmdpbkRpdiA9IGRpdiA9IGNvbnRhaW5lciA9IG51bGw7CiAgICAgIGpRdWVyeS5leHRlbmQoc3VwcG9ydCwgb2Zmc2V0U3VwcG9ydCk7CiAgICB9KTsKICAgIHJldHVybiBzdXBwb3J0OwogIH0oKTsKCiAgdmFyIHJicmFjZSA9IC9eKD86XHsuKlx9fFxbLipcXSkkLywKICAgICAgcm11bHRpRGFzaCA9IC8oW0EtWl0pL2c7CiAgalF1ZXJ5LmV4dGVuZCh7CiAgICBjYWNoZToge30sCiAgICAvLyBQbGVhc2UgdXNlIHdpdGggY2F1dGlvbgogICAgdXVpZDogMCwKICAgIC8vIFVuaXF1ZSBmb3IgZWFjaCBjb3B5IG9mIGpRdWVyeSBvbiB0aGUgcGFnZQogICAgLy8gTm9uLWRpZ2l0cyByZW1vdmVkIHRvIG1hdGNoIHJpbmxpbmVqUXVlcnkKICAgIGV4cGFuZG86ICJqUXVlcnkiICsgKGpRdWVyeS5mbi5qcXVlcnkgKyBNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cRC9nLCAiIiksCiAgICAvLyBUaGUgZm9sbG93aW5nIGVsZW1lbnRzIHRocm93IHVuY2F0Y2hhYmxlIGV4Y2VwdGlvbnMgaWYgeW91CiAgICAvLyBhdHRlbXB0IHRvIGFkZCBleHBhbmRvIHByb3BlcnRpZXMgdG8gdGhlbS4KICAgIG5vRGF0YTogewogICAgICAiZW1iZWQiOiB0cnVlLAogICAgICAvLyBCYW4gYWxsIG9iamVjdHMgZXhjZXB0IGZvciBGbGFzaCAod2hpY2ggaGFuZGxlIGV4cGFuZG9zKQogICAgICAib2JqZWN0IjogImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMCIsCiAgICAgICJhcHBsZXQiOiB0cnVlCiAgICB9LAogICAgaGFzRGF0YTogZnVuY3Rpb24gaGFzRGF0YShlbGVtKSB7CiAgICAgIGVsZW0gPSBlbGVtLm5vZGVUeXBlID8galF1ZXJ5LmNhY2hlW2VsZW1balF1ZXJ5LmV4cGFuZG9dXSA6IGVsZW1balF1ZXJ5LmV4cGFuZG9dOwogICAgICByZXR1cm4gISFlbGVtICYmICFpc0VtcHR5RGF0YU9iamVjdChlbGVtKTsKICAgIH0sCiAgICBkYXRhOiBmdW5jdGlvbiBkYXRhKGVsZW0sIG5hbWUsIF9kYXRhLCBwdnQKICAgIC8qIEludGVybmFsIFVzZSBPbmx5ICovCiAgICApIHsKICAgICAgaWYgKCFqUXVlcnkuYWNjZXB0RGF0YShlbGVtKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHByaXZhdGVDYWNoZSwKICAgICAgICAgIHRoaXNDYWNoZSwKICAgICAgICAgIHJldCwKICAgICAgICAgIGludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCiAgICAgICAgICBnZXRCeU5hbWUgPSB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIsCiAgICAgICAgICAvLyBXZSBoYXZlIHRvIGhhbmRsZSBET00gbm9kZXMgYW5kIEpTIG9iamVjdHMgZGlmZmVyZW50bHkgYmVjYXVzZSBJRTYtNwogICAgICAvLyBjYW4ndCBHQyBvYmplY3QgcmVmZXJlbmNlcyBwcm9wZXJseSBhY3Jvc3MgdGhlIERPTS1KUyBib3VuZGFyeQogICAgICBpc05vZGUgPSBlbGVtLm5vZGVUeXBlLAogICAgICAgICAgLy8gT25seSBET00gbm9kZXMgbmVlZCB0aGUgZ2xvYmFsIGpRdWVyeSBjYWNoZTsgSlMgb2JqZWN0IGRhdGEgaXMKICAgICAgLy8gYXR0YWNoZWQgZGlyZWN0bHkgdG8gdGhlIG9iamVjdCBzbyBHQyBjYW4gb2NjdXIgYXV0b21hdGljYWxseQogICAgICBjYWNoZSA9IGlzTm9kZSA/IGpRdWVyeS5jYWNoZSA6IGVsZW0sCiAgICAgICAgICAvLyBPbmx5IGRlZmluaW5nIGFuIElEIGZvciBKUyBvYmplY3RzIGlmIGl0cyBjYWNoZSBhbHJlYWR5IGV4aXN0cyBhbGxvd3MKICAgICAgLy8gdGhlIGNvZGUgdG8gc2hvcnRjdXQgb24gdGhlIHNhbWUgcGF0aCBhcyBhIERPTSBub2RlIHdpdGggbm8gY2FjaGUKICAgICAgaWQgPSBpc05vZGUgPyBlbGVtW2ludGVybmFsS2V5XSA6IGVsZW1baW50ZXJuYWxLZXldICYmIGludGVybmFsS2V5LAogICAgICAgICAgaXNFdmVudHMgPSBuYW1lID09PSAiZXZlbnRzIjsgLy8gQXZvaWQgZG9pbmcgYW55IG1vcmUgd29yayB0aGFuIHdlIG5lZWQgdG8gd2hlbiB0cnlpbmcgdG8gZ2V0IGRhdGEgb24gYW4KICAgICAgLy8gb2JqZWN0IHRoYXQgaGFzIG5vIGRhdGEgYXQgYWxsCgogICAgICBpZiAoKCFpZCB8fCAhY2FjaGVbaWRdIHx8ICFpc0V2ZW50cyAmJiAhcHZ0ICYmICFjYWNoZVtpZF0uZGF0YSkgJiYgZ2V0QnlOYW1lICYmIF9kYXRhID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghaWQpIHsKICAgICAgICAvLyBPbmx5IERPTSBub2RlcyBuZWVkIGEgbmV3IHVuaXF1ZSBJRCBmb3IgZWFjaCBlbGVtZW50IHNpbmNlIHRoZWlyIGRhdGEKICAgICAgICAvLyBlbmRzIHVwIGluIHRoZSBnbG9iYWwgY2FjaGUKICAgICAgICBpZiAoaXNOb2RlKSB7CiAgICAgICAgICBlbGVtW2ludGVybmFsS2V5XSA9IGlkID0gKytqUXVlcnkudXVpZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWQgPSBpbnRlcm5hbEtleTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghY2FjaGVbaWRdKSB7CiAgICAgICAgY2FjaGVbaWRdID0ge307IC8vIEF2b2lkcyBleHBvc2luZyBqUXVlcnkgbWV0YWRhdGEgb24gcGxhaW4gSlMgb2JqZWN0cyB3aGVuIHRoZSBvYmplY3QKICAgICAgICAvLyBpcyBzZXJpYWxpemVkIHVzaW5nIEpTT04uc3RyaW5naWZ5CgogICAgICAgIGlmICghaXNOb2RlKSB7CiAgICAgICAgICBjYWNoZVtpZF0udG9KU09OID0galF1ZXJ5Lm5vb3A7CiAgICAgICAgfQogICAgICB9IC8vIEFuIG9iamVjdCBjYW4gYmUgcGFzc2VkIHRvIGpRdWVyeS5kYXRhIGluc3RlYWQgb2YgYSBrZXkvdmFsdWUgcGFpcjsgdGhpcyBnZXRzCiAgICAgIC8vIHNoYWxsb3cgY29waWVkIG92ZXIgb250byB0aGUgZXhpc3RpbmcgY2FjaGUKCgogICAgICBpZiAoX3R5cGVvZihuYW1lKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIG5hbWUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICBpZiAocHZ0KSB7CiAgICAgICAgICBjYWNoZVtpZF0gPSBqUXVlcnkuZXh0ZW5kKGNhY2hlW2lkXSwgbmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNhY2hlW2lkXS5kYXRhID0galF1ZXJ5LmV4dGVuZChjYWNoZVtpZF0uZGF0YSwgbmFtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBwcml2YXRlQ2FjaGUgPSB0aGlzQ2FjaGUgPSBjYWNoZVtpZF07IC8vIGpRdWVyeSBkYXRhKCkgaXMgc3RvcmVkIGluIGEgc2VwYXJhdGUgb2JqZWN0IGluc2lkZSB0aGUgb2JqZWN0J3MgaW50ZXJuYWwgZGF0YQogICAgICAvLyBjYWNoZSBpbiBvcmRlciB0byBhdm9pZCBrZXkgY29sbGlzaW9ucyBiZXR3ZWVuIGludGVybmFsIGRhdGEgYW5kIHVzZXItZGVmaW5lZAogICAgICAvLyBkYXRhLgoKICAgICAgaWYgKCFwdnQpIHsKICAgICAgICBpZiAoIXRoaXNDYWNoZS5kYXRhKSB7CiAgICAgICAgICB0aGlzQ2FjaGUuZGF0YSA9IHt9OwogICAgICAgIH0KCiAgICAgICAgdGhpc0NhY2hlID0gdGhpc0NhY2hlLmRhdGE7CiAgICAgIH0KCiAgICAgIGlmIChfZGF0YSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpc0NhY2hlW2pRdWVyeS5jYW1lbENhc2UobmFtZSldID0gX2RhdGE7CiAgICAgIH0gLy8gVXNlcnMgc2hvdWxkIG5vdCBhdHRlbXB0IHRvIGluc3BlY3QgdGhlIGludGVybmFsIGV2ZW50cyBvYmplY3QgdXNpbmcgalF1ZXJ5LmRhdGEsCiAgICAgIC8vIGl0IGlzIHVuZG9jdW1lbnRlZCBhbmQgc3ViamVjdCB0byBjaGFuZ2UuIEJ1dCBkb2VzIGFueW9uZSBsaXN0ZW4/IE5vLgoKCiAgICAgIGlmIChpc0V2ZW50cyAmJiAhdGhpc0NhY2hlW25hbWVdKSB7CiAgICAgICAgcmV0dXJuIHByaXZhdGVDYWNoZS5ldmVudHM7CiAgICAgIH0gLy8gQ2hlY2sgZm9yIGJvdGggY29udmVydGVkLXRvLWNhbWVsIGFuZCBub24tY29udmVydGVkIGRhdGEgcHJvcGVydHkgbmFtZXMKICAgICAgLy8gSWYgYSBkYXRhIHByb3BlcnR5IHdhcyBzcGVjaWZpZWQKCgogICAgICBpZiAoZ2V0QnlOYW1lKSB7CiAgICAgICAgLy8gRmlyc3QgVHJ5IHRvIGZpbmQgYXMtaXMgcHJvcGVydHkgZGF0YQogICAgICAgIHJldCA9IHRoaXNDYWNoZVtuYW1lXTsgLy8gVGVzdCBmb3IgbnVsbHx1bmRlZmluZWQgcHJvcGVydHkgZGF0YQoKICAgICAgICBpZiAocmV0ID09IG51bGwpIHsKICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBjYW1lbENhc2VkIHByb3BlcnR5CiAgICAgICAgICByZXQgPSB0aGlzQ2FjaGVbalF1ZXJ5LmNhbWVsQ2FzZShuYW1lKV07CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldCA9IHRoaXNDYWNoZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJldDsKICAgIH0sCiAgICByZW1vdmVEYXRhOiBmdW5jdGlvbiByZW1vdmVEYXRhKGVsZW0sIG5hbWUsIHB2dAogICAgLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8KICAgICkgewogICAgICBpZiAoIWpRdWVyeS5hY2NlcHREYXRhKGVsZW0pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGhpc0NhY2hlLAogICAgICAgICAgaSwKICAgICAgICAgIGwsCiAgICAgICAgICAvLyBSZWZlcmVuY2UgdG8gaW50ZXJuYWwgZGF0YSBjYWNoZSBrZXkKICAgICAgaW50ZXJuYWxLZXkgPSBqUXVlcnkuZXhwYW5kbywKICAgICAgICAgIGlzTm9kZSA9IGVsZW0ubm9kZVR5cGUsCiAgICAgICAgICAvLyBTZWUgalF1ZXJ5LmRhdGEgZm9yIG1vcmUgaW5mb3JtYXRpb24KICAgICAgY2FjaGUgPSBpc05vZGUgPyBqUXVlcnkuY2FjaGUgOiBlbGVtLAogICAgICAgICAgLy8gU2VlIGpRdWVyeS5kYXRhIGZvciBtb3JlIGluZm9ybWF0aW9uCiAgICAgIGlkID0gaXNOb2RlID8gZWxlbVtpbnRlcm5hbEtleV0gOiBpbnRlcm5hbEtleTsgLy8gSWYgdGhlcmUgaXMgYWxyZWFkeSBubyBjYWNoZSBlbnRyeSBmb3IgdGhpcyBvYmplY3QsIHRoZXJlIGlzIG5vCiAgICAgIC8vIHB1cnBvc2UgaW4gY29udGludWluZwoKICAgICAgaWYgKCFjYWNoZVtpZF0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChuYW1lKSB7CiAgICAgICAgdGhpc0NhY2hlID0gcHZ0ID8gY2FjaGVbaWRdIDogY2FjaGVbaWRdLmRhdGE7CgogICAgICAgIGlmICh0aGlzQ2FjaGUpIHsKICAgICAgICAgIC8vIFN1cHBvcnQgYXJyYXkgb3Igc3BhY2Ugc2VwYXJhdGVkIHN0cmluZyBuYW1lcyBmb3IgZGF0YSBrZXlzCiAgICAgICAgICBpZiAoIWpRdWVyeS5pc0FycmF5KG5hbWUpKSB7CiAgICAgICAgICAgIC8vIHRyeSB0aGUgc3RyaW5nIGFzIGEga2V5IGJlZm9yZSBhbnkgbWFuaXB1bGF0aW9uCiAgICAgICAgICAgIGlmIChuYW1lIGluIHRoaXNDYWNoZSkgewogICAgICAgICAgICAgIG5hbWUgPSBbbmFtZV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gc3BsaXQgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gYnkgc3BhY2VzIHVubGVzcyBhIGtleSB3aXRoIHRoZSBzcGFjZXMgZXhpc3RzCiAgICAgICAgICAgICAgbmFtZSA9IGpRdWVyeS5jYW1lbENhc2UobmFtZSk7CgogICAgICAgICAgICAgIGlmIChuYW1lIGluIHRoaXNDYWNoZSkgewogICAgICAgICAgICAgICAgbmFtZSA9IFtuYW1lXTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3BsaXQoIiAiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gbmFtZS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgZGVsZXRlIHRoaXNDYWNoZVtuYW1lW2ldXTsKICAgICAgICAgIH0gLy8gSWYgdGhlcmUgaXMgbm8gZGF0YSBsZWZ0IGluIHRoZSBjYWNoZSwgd2Ugd2FudCB0byBjb250aW51ZQogICAgICAgICAgLy8gYW5kIGxldCB0aGUgY2FjaGUgb2JqZWN0IGl0c2VsZiBnZXQgZGVzdHJveWVkCgoKICAgICAgICAgIGlmICghKHB2dCA/IGlzRW1wdHlEYXRhT2JqZWN0IDogalF1ZXJ5LmlzRW1wdHlPYmplY3QpKHRoaXNDYWNoZSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBTZWUgalF1ZXJ5LmRhdGEgZm9yIG1vcmUgaW5mb3JtYXRpb24KCgogICAgICBpZiAoIXB2dCkgewogICAgICAgIGRlbGV0ZSBjYWNoZVtpZF0uZGF0YTsgLy8gRG9uJ3QgZGVzdHJveSB0aGUgcGFyZW50IGNhY2hlIHVubGVzcyB0aGUgaW50ZXJuYWwgZGF0YSBvYmplY3QKICAgICAgICAvLyBoYWQgYmVlbiB0aGUgb25seSB0aGluZyBsZWZ0IGluIGl0CgogICAgICAgIGlmICghaXNFbXB0eURhdGFPYmplY3QoY2FjaGVbaWRdKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSAvLyBCcm93c2VycyB0aGF0IGZhaWwgZXhwYW5kbyBkZWxldGlvbiBhbHNvIHJlZnVzZSB0byBkZWxldGUgZXhwYW5kb3Mgb24KICAgICAgLy8gdGhlIHdpbmRvdywgYnV0IGl0IHdpbGwgYWxsb3cgaXQgb24gYWxsIG90aGVyIEpTIG9iamVjdHM7IG90aGVyIGJyb3dzZXJzCiAgICAgIC8vIGRvbid0IGNhcmUKICAgICAgLy8gRW5zdXJlIHRoYXQgYGNhY2hlYCBpcyBub3QgYSB3aW5kb3cgb2JqZWN0ICMxMDA4MAoKCiAgICAgIGlmIChqUXVlcnkuc3VwcG9ydC5kZWxldGVFeHBhbmRvIHx8ICFjYWNoZS5zZXRJbnRlcnZhbCkgewogICAgICAgIGRlbGV0ZSBjYWNoZVtpZF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FjaGVbaWRdID0gbnVsbDsKICAgICAgfSAvLyBXZSBkZXN0cm95ZWQgdGhlIGNhY2hlIGFuZCBuZWVkIHRvIGVsaW1pbmF0ZSB0aGUgZXhwYW5kbyBvbiB0aGUgbm9kZSB0byBhdm9pZAogICAgICAvLyBmYWxzZSBsb29rdXBzIGluIHRoZSBjYWNoZSBmb3IgZW50cmllcyB0aGF0IG5vIGxvbmdlciBleGlzdAoKCiAgICAgIGlmIChpc05vZGUpIHsKICAgICAgICAvLyBJRSBkb2VzIG5vdCBhbGxvdyB1cyB0byBkZWxldGUgZXhwYW5kbyBwcm9wZXJ0aWVzIGZyb20gbm9kZXMsCiAgICAgICAgLy8gbm9yIGRvZXMgaXQgaGF2ZSBhIHJlbW92ZUF0dHJpYnV0ZSBmdW5jdGlvbiBvbiBEb2N1bWVudCBub2RlczsKICAgICAgICAvLyB3ZSBtdXN0IGhhbmRsZSBhbGwgb2YgdGhlc2UgY2FzZXMKICAgICAgICBpZiAoalF1ZXJ5LnN1cHBvcnQuZGVsZXRlRXhwYW5kbykgewogICAgICAgICAgZGVsZXRlIGVsZW1baW50ZXJuYWxLZXldOwogICAgICAgIH0gZWxzZSBpZiAoZWxlbS5yZW1vdmVBdHRyaWJ1dGUpIHsKICAgICAgICAgIGVsZW0ucmVtb3ZlQXR0cmlidXRlKGludGVybmFsS2V5KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxlbVtpbnRlcm5hbEtleV0gPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIEZvciBpbnRlcm5hbCB1c2Ugb25seS4KICAgIF9kYXRhOiBmdW5jdGlvbiBfZGF0YShlbGVtLCBuYW1lLCBkYXRhKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZGF0YShlbGVtLCBuYW1lLCBkYXRhLCB0cnVlKTsKICAgIH0sCiAgICAvLyBBIG1ldGhvZCBmb3IgZGV0ZXJtaW5pbmcgaWYgYSBET00gbm9kZSBjYW4gaGFuZGxlIHRoZSBkYXRhIGV4cGFuZG8KICAgIGFjY2VwdERhdGE6IGZ1bmN0aW9uIGFjY2VwdERhdGEoZWxlbSkgewogICAgICBpZiAoZWxlbS5ub2RlTmFtZSkgewogICAgICAgIHZhciBtYXRjaCA9IGpRdWVyeS5ub0RhdGFbZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTsKCiAgICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgICByZXR1cm4gIShtYXRjaCA9PT0gdHJ1ZSB8fCBlbGVtLmdldEF0dHJpYnV0ZSgiY2xhc3NpZCIpICE9PSBtYXRjaCk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9KTsKICBqUXVlcnkuZm4uZXh0ZW5kKHsKICAgIGRhdGE6IGZ1bmN0aW9uIGRhdGEoa2V5LCB2YWx1ZSkgewogICAgICB2YXIgcGFydHMsCiAgICAgICAgICBwYXJ0LAogICAgICAgICAgYXR0ciwKICAgICAgICAgIG5hbWUsCiAgICAgICAgICBsLAogICAgICAgICAgZWxlbSA9IHRoaXNbMF0sCiAgICAgICAgICBpID0gMCwKICAgICAgICAgIGRhdGEgPSBudWxsOyAvLyBHZXRzIGFsbCB2YWx1ZXMKCiAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmICh0aGlzLmxlbmd0aCkgewogICAgICAgICAgZGF0YSA9IGpRdWVyeS5kYXRhKGVsZW0pOwoKICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxICYmICFqUXVlcnkuX2RhdGEoZWxlbSwgInBhcnNlZEF0dHJzIikpIHsKICAgICAgICAgICAgYXR0ciA9IGVsZW0uYXR0cmlidXRlczsKCiAgICAgICAgICAgIGZvciAobCA9IGF0dHIubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgICAgbmFtZSA9IGF0dHJbaV0ubmFtZTsKCiAgICAgICAgICAgICAgaWYgKG5hbWUuaW5kZXhPZigiZGF0YS0iKSA9PT0gMCkgewogICAgICAgICAgICAgICAgbmFtZSA9IGpRdWVyeS5jYW1lbENhc2UobmFtZS5zdWJzdHJpbmcoNSkpOwogICAgICAgICAgICAgICAgZGF0YUF0dHIoZWxlbSwgbmFtZSwgZGF0YVtuYW1lXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBqUXVlcnkuX2RhdGEoZWxlbSwgInBhcnNlZEF0dHJzIiwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgfSAvLyBTZXRzIG11bHRpcGxlIHZhbHVlcwoKCiAgICAgIGlmIChfdHlwZW9mKGtleSkgPT09ICJvYmplY3QiKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBqUXVlcnkuZGF0YSh0aGlzLCBrZXkpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBwYXJ0cyA9IGtleS5zcGxpdCgiLiIsIDIpOwogICAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdID8gIi4iICsgcGFydHNbMV0gOiAiIjsKICAgICAgcGFydCA9IHBhcnRzWzFdICsgIiEiOwogICAgICByZXR1cm4galF1ZXJ5LmFjY2Vzcyh0aGlzLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZGF0YSA9IHRoaXMudHJpZ2dlckhhbmRsZXIoImdldERhdGEiICsgcGFydCwgW3BhcnRzWzBdXSk7IC8vIFRyeSB0byBmZXRjaCBhbnkgaW50ZXJuYWxseSBzdG9yZWQgZGF0YSBmaXJzdAoKICAgICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQgJiYgZWxlbSkgewogICAgICAgICAgICBkYXRhID0galF1ZXJ5LmRhdGEoZWxlbSwga2V5KTsKICAgICAgICAgICAgZGF0YSA9IGRhdGFBdHRyKGVsZW0sIGtleSwgZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCAmJiBwYXJ0c1sxXSA/IHRoaXMuZGF0YShwYXJ0c1swXSkgOiBkYXRhOwogICAgICAgIH0KCiAgICAgICAgcGFydHNbMV0gPSB2YWx1ZTsKICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHNlbGYgPSBqUXVlcnkodGhpcyk7CiAgICAgICAgICBzZWxmLnRyaWdnZXJIYW5kbGVyKCJzZXREYXRhIiArIHBhcnQsIHBhcnRzKTsKICAgICAgICAgIGpRdWVyeS5kYXRhKHRoaXMsIGtleSwgdmFsdWUpOwogICAgICAgICAgc2VsZi50cmlnZ2VySGFuZGxlcigiY2hhbmdlRGF0YSIgKyBwYXJ0LCBwYXJ0cyk7CiAgICAgICAgfSk7CiAgICAgIH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSwgbnVsbCwgZmFsc2UpOwogICAgfSwKICAgIHJlbW92ZURhdGE6IGZ1bmN0aW9uIHJlbW92ZURhdGEoa2V5KSB7CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGpRdWVyeS5yZW1vdmVEYXRhKHRoaXMsIGtleSk7CiAgICAgIH0pOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBkYXRhQXR0cihlbGVtLCBrZXksIGRhdGEpIHsKICAgIC8vIElmIG5vdGhpbmcgd2FzIGZvdW5kIGludGVybmFsbHksIHRyeSB0byBmZXRjaCBhbnkKICAgIC8vIGRhdGEgZnJvbSB0aGUgSFRNTDUgZGF0YS0qIGF0dHJpYnV0ZQogICAgaWYgKGRhdGEgPT09IHVuZGVmaW5lZCAmJiBlbGVtLm5vZGVUeXBlID09PSAxKSB7CiAgICAgIHZhciBuYW1lID0gImRhdGEtIiArIGtleS5yZXBsYWNlKHJtdWx0aURhc2gsICItJDEiKS50b0xvd2VyQ2FzZSgpOwogICAgICBkYXRhID0gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSk7CgogICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICJzdHJpbmciKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGRhdGEgPSBkYXRhID09PSAidHJ1ZSIgPyB0cnVlIDogZGF0YSA9PT0gImZhbHNlIiA/IGZhbHNlIDogZGF0YSA9PT0gIm51bGwiID8gbnVsbCA6IGpRdWVyeS5pc051bWVyaWMoZGF0YSkgPyArZGF0YSA6IHJicmFjZS50ZXN0KGRhdGEpID8galF1ZXJ5LnBhcnNlSlNPTihkYXRhKSA6IGRhdGE7CiAgICAgICAgfSBjYXRjaCAoZSkge30gLy8gTWFrZSBzdXJlIHdlIHNldCB0aGUgZGF0YSBzbyBpdCBpc24ndCBjaGFuZ2VkIGxhdGVyCgoKICAgICAgICBqUXVlcnkuZGF0YShlbGVtLCBrZXksIGRhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9IC8vIGNoZWNrcyBhIGNhY2hlIG9iamVjdCBmb3IgZW1wdGluZXNzCgoKICBmdW5jdGlvbiBpc0VtcHR5RGF0YU9iamVjdChvYmopIHsKICAgIGZvciAodmFyIG5hbWUgaW4gb2JqKSB7CiAgICAgIC8vIGlmIHRoZSBwdWJsaWMgZGF0YSBvYmplY3QgaXMgZW1wdHksIHRoZSBwcml2YXRlIGlzIHN0aWxsIGVtcHR5CiAgICAgIGlmIChuYW1lID09PSAiZGF0YSIgJiYgalF1ZXJ5LmlzRW1wdHlPYmplY3Qob2JqW25hbWVdKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAobmFtZSAhPT0gInRvSlNPTiIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGhhbmRsZVF1ZXVlTWFya0RlZmVyKGVsZW0sIHR5cGUsIHNyYykgewogICAgdmFyIGRlZmVyRGF0YUtleSA9IHR5cGUgKyAiZGVmZXIiLAogICAgICAgIHF1ZXVlRGF0YUtleSA9IHR5cGUgKyAicXVldWUiLAogICAgICAgIG1hcmtEYXRhS2V5ID0gdHlwZSArICJtYXJrIiwKICAgICAgICBkZWZlciA9IGpRdWVyeS5fZGF0YShlbGVtLCBkZWZlckRhdGFLZXkpOwoKICAgIGlmIChkZWZlciAmJiAoc3JjID09PSAicXVldWUiIHx8ICFqUXVlcnkuX2RhdGEoZWxlbSwgcXVldWVEYXRhS2V5KSkgJiYgKHNyYyA9PT0gIm1hcmsiIHx8ICFqUXVlcnkuX2RhdGEoZWxlbSwgbWFya0RhdGFLZXkpKSkgewogICAgICAvLyBHaXZlIHJvb20gZm9yIGhhcmQtY29kZWQgY2FsbGJhY2tzIHRvIGZpcmUgZmlyc3QKICAgICAgLy8gYW5kIGV2ZW50dWFsbHkgbWFyay9xdWV1ZSBzb21ldGhpbmcgZWxzZSBvbiB0aGUgZWxlbWVudAogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWpRdWVyeS5fZGF0YShlbGVtLCBxdWV1ZURhdGFLZXkpICYmICFqUXVlcnkuX2RhdGEoZWxlbSwgbWFya0RhdGFLZXkpKSB7CiAgICAgICAgICBqUXVlcnkucmVtb3ZlRGF0YShlbGVtLCBkZWZlckRhdGFLZXksIHRydWUpOwogICAgICAgICAgZGVmZXIuZmlyZSgpOwogICAgICAgIH0KICAgICAgfSwgMCk7CiAgICB9CiAgfQoKICBqUXVlcnkuZXh0ZW5kKHsKICAgIF9tYXJrOiBmdW5jdGlvbiBfbWFyayhlbGVtLCB0eXBlKSB7CiAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgdHlwZSA9ICh0eXBlIHx8ICJmeCIpICsgIm1hcmsiOwoKICAgICAgICBqUXVlcnkuX2RhdGEoZWxlbSwgdHlwZSwgKGpRdWVyeS5fZGF0YShlbGVtLCB0eXBlKSB8fCAwKSArIDEpOwogICAgICB9CiAgICB9LAogICAgX3VubWFyazogZnVuY3Rpb24gX3VubWFyayhmb3JjZSwgZWxlbSwgdHlwZSkgewogICAgICBpZiAoZm9yY2UgIT09IHRydWUpIHsKICAgICAgICB0eXBlID0gZWxlbTsKICAgICAgICBlbGVtID0gZm9yY2U7CiAgICAgICAgZm9yY2UgPSBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKGVsZW0pIHsKICAgICAgICB0eXBlID0gdHlwZSB8fCAiZngiOwogICAgICAgIHZhciBrZXkgPSB0eXBlICsgIm1hcmsiLAogICAgICAgICAgICBjb3VudCA9IGZvcmNlID8gMCA6IChqUXVlcnkuX2RhdGEoZWxlbSwga2V5KSB8fCAxKSAtIDE7CgogICAgICAgIGlmIChjb3VudCkgewogICAgICAgICAgalF1ZXJ5Ll9kYXRhKGVsZW0sIGtleSwgY291bnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBqUXVlcnkucmVtb3ZlRGF0YShlbGVtLCBrZXksIHRydWUpOwogICAgICAgICAgaGFuZGxlUXVldWVNYXJrRGVmZXIoZWxlbSwgdHlwZSwgIm1hcmsiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBxdWV1ZTogZnVuY3Rpb24gcXVldWUoZWxlbSwgdHlwZSwgZGF0YSkgewogICAgICB2YXIgcTsKCiAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgdHlwZSA9ICh0eXBlIHx8ICJmeCIpICsgInF1ZXVlIjsKICAgICAgICBxID0galF1ZXJ5Ll9kYXRhKGVsZW0sIHR5cGUpOyAvLyBTcGVlZCB1cCBkZXF1ZXVlIGJ5IGdldHRpbmcgb3V0IHF1aWNrbHkgaWYgdGhpcyBpcyBqdXN0IGEgbG9va3VwCgogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICBpZiAoIXEgfHwgalF1ZXJ5LmlzQXJyYXkoZGF0YSkpIHsKICAgICAgICAgICAgcSA9IGpRdWVyeS5fZGF0YShlbGVtLCB0eXBlLCBqUXVlcnkubWFrZUFycmF5KGRhdGEpKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHEucHVzaChkYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBxIHx8IFtdOwogICAgICB9CiAgICB9LAogICAgZGVxdWV1ZTogZnVuY3Rpb24gZGVxdWV1ZShlbGVtLCB0eXBlKSB7CiAgICAgIHR5cGUgPSB0eXBlIHx8ICJmeCI7CiAgICAgIHZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZShlbGVtLCB0eXBlKSwKICAgICAgICAgIGZuID0gcXVldWUuc2hpZnQoKSwKICAgICAgICAgIGhvb2tzID0ge307IC8vIElmIHRoZSBmeCBxdWV1ZSBpcyBkZXF1ZXVlZCwgYWx3YXlzIHJlbW92ZSB0aGUgcHJvZ3Jlc3Mgc2VudGluZWwKCiAgICAgIGlmIChmbiA9PT0gImlucHJvZ3Jlc3MiKSB7CiAgICAgICAgZm4gPSBxdWV1ZS5zaGlmdCgpOwogICAgICB9CgogICAgICBpZiAoZm4pIHsKICAgICAgICAvLyBBZGQgYSBwcm9ncmVzcyBzZW50aW5lbCB0byBwcmV2ZW50IHRoZSBmeCBxdWV1ZSBmcm9tIGJlaW5nCiAgICAgICAgLy8gYXV0b21hdGljYWxseSBkZXF1ZXVlZAogICAgICAgIGlmICh0eXBlID09PSAiZngiKSB7CiAgICAgICAgICBxdWV1ZS51bnNoaWZ0KCJpbnByb2dyZXNzIik7CiAgICAgICAgfQoKICAgICAgICBqUXVlcnkuX2RhdGEoZWxlbSwgdHlwZSArICIucnVuIiwgaG9va3MpOwoKICAgICAgICBmbi5jYWxsKGVsZW0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGpRdWVyeS5kZXF1ZXVlKGVsZW0sIHR5cGUpOwogICAgICAgIH0sIGhvb2tzKTsKICAgICAgfQoKICAgICAgaWYgKCFxdWV1ZS5sZW5ndGgpIHsKICAgICAgICBqUXVlcnkucmVtb3ZlRGF0YShlbGVtLCB0eXBlICsgInF1ZXVlICIgKyB0eXBlICsgIi5ydW4iLCB0cnVlKTsKICAgICAgICBoYW5kbGVRdWV1ZU1hcmtEZWZlcihlbGVtLCB0eXBlLCAicXVldWUiKTsKICAgICAgfQogICAgfQogIH0pOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgcXVldWU6IGZ1bmN0aW9uIHF1ZXVlKHR5cGUsIGRhdGEpIHsKICAgICAgdmFyIHNldHRlciA9IDI7CgogICAgICBpZiAodHlwZW9mIHR5cGUgIT09ICJzdHJpbmciKSB7CiAgICAgICAgZGF0YSA9IHR5cGU7CiAgICAgICAgdHlwZSA9ICJmeCI7CiAgICAgICAgc2V0dGVyLS07CiAgICAgIH0KCiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgc2V0dGVyKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeS5xdWV1ZSh0aGlzWzBdLCB0eXBlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/IHRoaXMgOiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSh0aGlzLCB0eXBlLCBkYXRhKTsKCiAgICAgICAgaWYgKHR5cGUgPT09ICJmeCIgJiYgcXVldWVbMF0gIT09ICJpbnByb2dyZXNzIikgewogICAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZXF1ZXVlOiBmdW5jdGlvbiBkZXF1ZXVlKHR5cGUpIHsKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIEJhc2VkIG9mZiBvZiB0aGUgcGx1Z2luIGJ5IENsaW50IEhlbGZlcnMsIHdpdGggcGVybWlzc2lvbi4KICAgIC8vIGh0dHA6Ly9ibGluZHNpZ25hbHMuY29tL2luZGV4LnBocC8yMDA5LzA3L2pxdWVyeS1kZWxheS8KICAgIGRlbGF5OiBmdW5jdGlvbiBkZWxheSh0aW1lLCB0eXBlKSB7CiAgICAgIHRpbWUgPSBqUXVlcnkuZnggPyBqUXVlcnkuZnguc3BlZWRzW3RpbWVdIHx8IHRpbWUgOiB0aW1lOwogICAgICB0eXBlID0gdHlwZSB8fCAiZngiOwogICAgICByZXR1cm4gdGhpcy5xdWV1ZSh0eXBlLCBmdW5jdGlvbiAobmV4dCwgaG9va3MpIHsKICAgICAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQobmV4dCwgdGltZSk7CgogICAgICAgIGhvb2tzLnN0b3AgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LAogICAgY2xlYXJRdWV1ZTogZnVuY3Rpb24gY2xlYXJRdWV1ZSh0eXBlKSB7CiAgICAgIHJldHVybiB0aGlzLnF1ZXVlKHR5cGUgfHwgImZ4IiwgW10pOwogICAgfSwKICAgIC8vIEdldCBhIHByb21pc2UgcmVzb2x2ZWQgd2hlbiBxdWV1ZXMgb2YgYSBjZXJ0YWluIHR5cGUKICAgIC8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KQogICAgcHJvbWlzZTogZnVuY3Rpb24gcHJvbWlzZSh0eXBlLCBvYmplY3QpIHsKICAgICAgaWYgKHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIikgewogICAgICAgIG9iamVjdCA9IHR5cGU7CiAgICAgICAgdHlwZSA9IHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgdHlwZSA9IHR5cGUgfHwgImZ4IjsKICAgICAgdmFyIGRlZmVyID0galF1ZXJ5LkRlZmVycmVkKCksCiAgICAgICAgICBlbGVtZW50cyA9IHRoaXMsCiAgICAgICAgICBpID0gZWxlbWVudHMubGVuZ3RoLAogICAgICAgICAgY291bnQgPSAxLAogICAgICAgICAgZGVmZXJEYXRhS2V5ID0gdHlwZSArICJkZWZlciIsCiAgICAgICAgICBxdWV1ZURhdGFLZXkgPSB0eXBlICsgInF1ZXVlIiwKICAgICAgICAgIG1hcmtEYXRhS2V5ID0gdHlwZSArICJtYXJrIiwKICAgICAgICAgIHRtcDsKCiAgICAgIGZ1bmN0aW9uIHJlc29sdmUoKSB7CiAgICAgICAgaWYgKCEgLS1jb3VudCkgewogICAgICAgICAgZGVmZXIucmVzb2x2ZVdpdGgoZWxlbWVudHMsIFtlbGVtZW50c10pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIGlmICh0bXAgPSBqUXVlcnkuZGF0YShlbGVtZW50c1tpXSwgZGVmZXJEYXRhS2V5LCB1bmRlZmluZWQsIHRydWUpIHx8IChqUXVlcnkuZGF0YShlbGVtZW50c1tpXSwgcXVldWVEYXRhS2V5LCB1bmRlZmluZWQsIHRydWUpIHx8IGpRdWVyeS5kYXRhKGVsZW1lbnRzW2ldLCBtYXJrRGF0YUtleSwgdW5kZWZpbmVkLCB0cnVlKSkgJiYgalF1ZXJ5LmRhdGEoZWxlbWVudHNbaV0sIGRlZmVyRGF0YUtleSwgalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgdHJ1ZSkpIHsKICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgICB0bXAuYWRkKHJlc29sdmUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzb2x2ZSgpOwogICAgICByZXR1cm4gZGVmZXIucHJvbWlzZShvYmplY3QpOwogICAgfQogIH0pOwogIHZhciByY2xhc3MgPSAvW1xuXHRccl0vZywKICAgICAgcnNwYWNlID0gL1xzKy8sCiAgICAgIHJyZXR1cm4gPSAvXHIvZywKICAgICAgcnR5cGUgPSAvXig/OmJ1dHRvbnxpbnB1dCkkL2ksCiAgICAgIHJmb2N1c2FibGUgPSAvXig/OmJ1dHRvbnxpbnB1dHxvYmplY3R8c2VsZWN0fHRleHRhcmVhKSQvaSwKICAgICAgcmNsaWNrYWJsZSA9IC9eYSg/OnJlYSk/JC9pLAogICAgICByYm9vbGVhbiA9IC9eKD86YXV0b2ZvY3VzfGF1dG9wbGF5fGFzeW5jfGNoZWNrZWR8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWR8c2VsZWN0ZWQpJC9pLAogICAgICBnZXRTZXRBdHRyaWJ1dGUgPSBqUXVlcnkuc3VwcG9ydC5nZXRTZXRBdHRyaWJ1dGUsCiAgICAgIG5vZGVIb29rLAogICAgICBib29sSG9vaywKICAgICAgZml4U3BlY2lmaWVkOwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgYXR0cjogZnVuY3Rpb24gYXR0cihuYW1lLCB2YWx1ZSkgewogICAgICByZXR1cm4galF1ZXJ5LmFjY2Vzcyh0aGlzLCBqUXVlcnkuYXR0ciwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxKTsKICAgIH0sCiAgICByZW1vdmVBdHRyOiBmdW5jdGlvbiByZW1vdmVBdHRyKG5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgalF1ZXJ5LnJlbW92ZUF0dHIodGhpcywgbmFtZSk7CiAgICAgIH0pOwogICAgfSwKICAgIHByb3A6IGZ1bmN0aW9uIHByb3AobmFtZSwgdmFsdWUpIHsKICAgICAgcmV0dXJuIGpRdWVyeS5hY2Nlc3ModGhpcywgalF1ZXJ5LnByb3AsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSk7CiAgICB9LAogICAgcmVtb3ZlUHJvcDogZnVuY3Rpb24gcmVtb3ZlUHJvcChuYW1lKSB7CiAgICAgIG5hbWUgPSBqUXVlcnkucHJvcEZpeFtuYW1lXSB8fCBuYW1lOwogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyB0cnkvY2F0Y2ggaGFuZGxlcyBjYXNlcyB3aGVyZSBJRSBiYWxrcyAoc3VjaCBhcyByZW1vdmluZyBhIHByb3BlcnR5IG9uIHdpbmRvdykKICAgICAgICB0cnkgewogICAgICAgICAgdGhpc1tuYW1lXSA9IHVuZGVmaW5lZDsKICAgICAgICAgIGRlbGV0ZSB0aGlzW25hbWVdOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIH0pOwogICAgfSwKICAgIGFkZENsYXNzOiBmdW5jdGlvbiBhZGRDbGFzcyh2YWx1ZSkgewogICAgICB2YXIgY2xhc3NOYW1lcywgaSwgbCwgZWxlbSwgc2V0Q2xhc3MsIGMsIGNsOwoKICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKSkgewogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGopIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS5hZGRDbGFzcyh2YWx1ZS5jYWxsKHRoaXMsIGosIHRoaXMuY2xhc3NOYW1lKSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciKSB7CiAgICAgICAgY2xhc3NOYW1lcyA9IHZhbHVlLnNwbGl0KHJzcGFjZSk7CgogICAgICAgIGZvciAoaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgZWxlbSA9IHRoaXNbaV07CgogICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgaWYgKCFlbGVtLmNsYXNzTmFtZSAmJiBjbGFzc05hbWVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgICAgIGVsZW0uY2xhc3NOYW1lID0gdmFsdWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2V0Q2xhc3MgPSAiICIgKyBlbGVtLmNsYXNzTmFtZSArICIgIjsKCiAgICAgICAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHsKICAgICAgICAgICAgICAgIGlmICghfnNldENsYXNzLmluZGV4T2YoIiAiICsgY2xhc3NOYW1lc1tjXSArICIgIikpIHsKICAgICAgICAgICAgICAgICAgc2V0Q2xhc3MgKz0gY2xhc3NOYW1lc1tjXSArICIgIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGVsZW0uY2xhc3NOYW1lID0galF1ZXJ5LnRyaW0oc2V0Q2xhc3MpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICByZW1vdmVDbGFzczogZnVuY3Rpb24gcmVtb3ZlQ2xhc3ModmFsdWUpIHsKICAgICAgdmFyIGNsYXNzTmFtZXMsIGksIGwsIGVsZW0sIGNsYXNzTmFtZSwgYywgY2w7CgogICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24odmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaikgewogICAgICAgICAgalF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKHZhbHVlLmNhbGwodGhpcywgaiwgdGhpcy5jbGFzc05hbWUpKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGNsYXNzTmFtZXMgPSAodmFsdWUgfHwgIiIpLnNwbGl0KHJzcGFjZSk7CgogICAgICAgIGZvciAoaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgZWxlbSA9IHRoaXNbaV07CgogICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgZWxlbS5jbGFzc05hbWUpIHsKICAgICAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICAgICAgY2xhc3NOYW1lID0gKCIgIiArIGVsZW0uY2xhc3NOYW1lICsgIiAiKS5yZXBsYWNlKHJjbGFzcywgIiAiKTsKCiAgICAgICAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHsKICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKCIgIiArIGNsYXNzTmFtZXNbY10gKyAiICIsICIgIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBlbGVtLmNsYXNzTmFtZSA9IGpRdWVyeS50cmltKGNsYXNzTmFtZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZWxlbS5jbGFzc05hbWUgPSAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uIHRvZ2dsZUNsYXNzKHZhbHVlLCBzdGF0ZVZhbCkgewogICAgICB2YXIgdHlwZSA9IF90eXBlb2YodmFsdWUpLAogICAgICAgICAgaXNCb29sID0gdHlwZW9mIHN0YXRlVmFsID09PSAiYm9vbGVhbiI7CgogICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24odmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaSkgewogICAgICAgICAgalF1ZXJ5KHRoaXMpLnRvZ2dsZUNsYXNzKHZhbHVlLmNhbGwodGhpcywgaSwgdGhpcy5jbGFzc05hbWUsIHN0YXRlVmFsKSwgc3RhdGVWYWwpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIC8vIHRvZ2dsZSBpbmRpdmlkdWFsIGNsYXNzIG5hbWVzCiAgICAgICAgICB2YXIgY2xhc3NOYW1lLAogICAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICAgIHNlbGYgPSBqUXVlcnkodGhpcyksCiAgICAgICAgICAgICAgc3RhdGUgPSBzdGF0ZVZhbCwKICAgICAgICAgICAgICBjbGFzc05hbWVzID0gdmFsdWUuc3BsaXQocnNwYWNlKTsKCiAgICAgICAgICB3aGlsZSAoY2xhc3NOYW1lID0gY2xhc3NOYW1lc1tpKytdKSB7CiAgICAgICAgICAgIC8vIGNoZWNrIGVhY2ggY2xhc3NOYW1lIGdpdmVuLCBzcGFjZSBzZXBlcmF0ZWQgbGlzdAogICAgICAgICAgICBzdGF0ZSA9IGlzQm9vbCA/IHN0YXRlIDogIXNlbGYuaGFzQ2xhc3MoY2xhc3NOYW1lKTsKICAgICAgICAgICAgc2VsZltzdGF0ZSA/ICJhZGRDbGFzcyIgOiAicmVtb3ZlQ2xhc3MiXShjbGFzc05hbWUpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gInVuZGVmaW5lZCIgfHwgdHlwZSA9PT0gImJvb2xlYW4iKSB7CiAgICAgICAgICBpZiAodGhpcy5jbGFzc05hbWUpIHsKICAgICAgICAgICAgLy8gc3RvcmUgY2xhc3NOYW1lIGlmIHNldAogICAgICAgICAgICBqUXVlcnkuX2RhdGEodGhpcywgIl9fY2xhc3NOYW1lX18iLCB0aGlzLmNsYXNzTmFtZSk7CiAgICAgICAgICB9IC8vIHRvZ2dsZSB3aG9sZSBjbGFzc05hbWUKCgogICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZSB8fCB2YWx1ZSA9PT0gZmFsc2UgPyAiIiA6IGpRdWVyeS5fZGF0YSh0aGlzLCAiX19jbGFzc05hbWVfXyIpIHx8ICIiOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaGFzQ2xhc3M6IGZ1bmN0aW9uIGhhc0NsYXNzKHNlbGVjdG9yKSB7CiAgICAgIHZhciBjbGFzc05hbWUgPSAiICIgKyBzZWxlY3RvciArICIgIiwKICAgICAgICAgIGkgPSAwLAogICAgICAgICAgbCA9IHRoaXMubGVuZ3RoOwoKICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgICBpZiAodGhpc1tpXS5ub2RlVHlwZSA9PT0gMSAmJiAoIiAiICsgdGhpc1tpXS5jbGFzc05hbWUgKyAiICIpLnJlcGxhY2UocmNsYXNzLCAiICIpLmluZGV4T2YoY2xhc3NOYW1lKSA+IC0xKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICB2YWw6IGZ1bmN0aW9uIHZhbCh2YWx1ZSkgewogICAgICB2YXIgaG9va3MsCiAgICAgICAgICByZXQsCiAgICAgICAgICBpc0Z1bmN0aW9uLAogICAgICAgICAgZWxlbSA9IHRoaXNbMF07CgogICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgaG9va3MgPSBqUXVlcnkudmFsSG9va3NbZWxlbS50eXBlXSB8fCBqUXVlcnkudmFsSG9va3NbZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTsKCiAgICAgICAgICBpZiAoaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCAidmFsdWUiKSkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgICAgfQoKICAgICAgICAgIHJldCA9IGVsZW0udmFsdWU7CiAgICAgICAgICByZXR1cm4gdHlwZW9mIHJldCA9PT0gInN0cmluZyIgPyAvLyBoYW5kbGUgbW9zdCBjb21tb24gc3RyaW5nIGNhc2VzCiAgICAgICAgICByZXQucmVwbGFjZShycmV0dXJuLCAiIikgOiAvLyBoYW5kbGUgY2FzZXMgd2hlcmUgdmFsdWUgaXMgbnVsbC91bmRlZiBvciBudW1iZXIKICAgICAgICAgIHJldCA9PSBudWxsID8gIiIgOiByZXQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSk7CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICB2YXIgc2VsZiA9IGpRdWVyeSh0aGlzKSwKICAgICAgICAgICAgdmFsOwoKICAgICAgICBpZiAodGhpcy5ub2RlVHlwZSAhPT0gMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzRnVuY3Rpb24pIHsKICAgICAgICAgIHZhbCA9IHZhbHVlLmNhbGwodGhpcywgaSwgc2VsZi52YWwoKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhbCA9IHZhbHVlOwogICAgICAgIH0gLy8gVHJlYXQgbnVsbC91bmRlZmluZWQgYXMgIiI7IGNvbnZlcnQgbnVtYmVycyB0byBzdHJpbmcKCgogICAgICAgIGlmICh2YWwgPT0gbnVsbCkgewogICAgICAgICAgdmFsID0gIiI7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAibnVtYmVyIikgewogICAgICAgICAgdmFsICs9ICIiOwogICAgICAgIH0gZWxzZSBpZiAoalF1ZXJ5LmlzQXJyYXkodmFsKSkgewogICAgICAgICAgdmFsID0galF1ZXJ5Lm1hcCh2YWwsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICByZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICIiIDogdmFsdWUgKyAiIjsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaG9va3MgPSBqUXVlcnkudmFsSG9va3NbdGhpcy50eXBlXSB8fCBqUXVlcnkudmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTsgLy8gSWYgc2V0IHJldHVybnMgdW5kZWZpbmVkLCBmYWxsIGJhY2sgdG8gbm9ybWFsIHNldHRpbmcKCiAgICAgICAgaWYgKCFob29rcyB8fCAhKCJzZXQiIGluIGhvb2tzKSB8fCBob29rcy5zZXQodGhpcywgdmFsLCAidmFsdWUiKSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSk7CiAgalF1ZXJ5LmV4dGVuZCh7CiAgICB2YWxIb29rczogewogICAgICBvcHRpb246IHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldChlbGVtKSB7CiAgICAgICAgICAvLyBhdHRyaWJ1dGVzLnZhbHVlIGlzIHVuZGVmaW5lZCBpbiBCbGFja2JlcnJ5IDQuNyBidXQKICAgICAgICAgIC8vIHVzZXMgLnZhbHVlLiBTZWUgIzY5MzIKICAgICAgICAgIHZhciB2YWwgPSBlbGVtLmF0dHJpYnV0ZXMudmFsdWU7CiAgICAgICAgICByZXR1cm4gIXZhbCB8fCB2YWwuc3BlY2lmaWVkID8gZWxlbS52YWx1ZSA6IGVsZW0udGV4dDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNlbGVjdDogewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0pIHsKICAgICAgICAgIHZhciB2YWx1ZSwKICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgIG1heCwKICAgICAgICAgICAgICBvcHRpb24sCiAgICAgICAgICAgICAgaW5kZXggPSBlbGVtLnNlbGVjdGVkSW5kZXgsCiAgICAgICAgICAgICAgdmFsdWVzID0gW10sCiAgICAgICAgICAgICAgb3B0aW9ucyA9IGVsZW0ub3B0aW9ucywKICAgICAgICAgICAgICBvbmUgPSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIjsgLy8gTm90aGluZyB3YXMgc2VsZWN0ZWQKCiAgICAgICAgICBpZiAoaW5kZXggPCAwKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfSAvLyBMb29wIHRocm91Z2ggYWxsIHRoZSBzZWxlY3RlZCBvcHRpb25zCgoKICAgICAgICAgIGkgPSBvbmUgPyBpbmRleCA6IDA7CiAgICAgICAgICBtYXggPSBvbmUgPyBpbmRleCArIDEgOiBvcHRpb25zLmxlbmd0aDsKCiAgICAgICAgICBmb3IgKDsgaSA8IG1heDsgaSsrKSB7CiAgICAgICAgICAgIG9wdGlvbiA9IG9wdGlvbnNbaV07IC8vIERvbid0IHJldHVybiBvcHRpb25zIHRoYXQgYXJlIGRpc2FibGVkIG9yIGluIGEgZGlzYWJsZWQgb3B0Z3JvdXAKCiAgICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQgJiYgKGpRdWVyeS5zdXBwb3J0Lm9wdERpc2FibGVkID8gIW9wdGlvbi5kaXNhYmxlZCA6IG9wdGlvbi5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIikgPT09IG51bGwpICYmICghb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQgfHwgIWpRdWVyeS5ub2RlTmFtZShvcHRpb24ucGFyZW50Tm9kZSwgIm9wdGdyb3VwIikpKSB7CiAgICAgICAgICAgICAgLy8gR2V0IHRoZSBzcGVjaWZpYyB2YWx1ZSBmb3IgdGhlIG9wdGlvbgogICAgICAgICAgICAgIHZhbHVlID0galF1ZXJ5KG9wdGlvbikudmFsKCk7IC8vIFdlIGRvbid0IG5lZWQgYW4gYXJyYXkgZm9yIG9uZSBzZWxlY3RzCgogICAgICAgICAgICAgIGlmIChvbmUpIHsKICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgICAgICB9IC8vIE11bHRpLVNlbGVjdHMgcmV0dXJuIGFuIGFycmF5CgoKICAgICAgICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy8gRml4ZXMgQnVnICMyNTUxIC0tIHNlbGVjdC52YWwoKSBicm9rZW4gaW4gSUUgYWZ0ZXIgZm9ybS5yZXNldCgpCgoKICAgICAgICAgIGlmIChvbmUgJiYgIXZhbHVlcy5sZW5ndGggJiYgb3B0aW9ucy5sZW5ndGgpIHsKICAgICAgICAgICAgcmV0dXJuIGpRdWVyeShvcHRpb25zW2luZGV4XSkudmFsKCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHZhbHVlczsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVsZW0sIHZhbHVlKSB7CiAgICAgICAgICB2YXIgdmFsdWVzID0galF1ZXJ5Lm1ha2VBcnJheSh2YWx1ZSk7CiAgICAgICAgICBqUXVlcnkoZWxlbSkuZmluZCgib3B0aW9uIikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBqUXVlcnkuaW5BcnJheShqUXVlcnkodGhpcykudmFsKCksIHZhbHVlcykgPj0gMDsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmICghdmFsdWVzLmxlbmd0aCkgewogICAgICAgICAgICBlbGVtLnNlbGVjdGVkSW5kZXggPSAtMTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdmFsdWVzOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGF0dHJGbjogewogICAgICB2YWw6IHRydWUsCiAgICAgIGNzczogdHJ1ZSwKICAgICAgaHRtbDogdHJ1ZSwKICAgICAgdGV4dDogdHJ1ZSwKICAgICAgZGF0YTogdHJ1ZSwKICAgICAgd2lkdGg6IHRydWUsCiAgICAgIGhlaWdodDogdHJ1ZSwKICAgICAgb2Zmc2V0OiB0cnVlCiAgICB9LAogICAgYXR0cjogZnVuY3Rpb24gYXR0cihlbGVtLCBuYW1lLCB2YWx1ZSwgcGFzcykgewogICAgICB2YXIgcmV0LAogICAgICAgICAgaG9va3MsCiAgICAgICAgICBub3R4bWwsCiAgICAgICAgICBuVHlwZSA9IGVsZW0ubm9kZVR5cGU7IC8vIGRvbid0IGdldC9zZXQgYXR0cmlidXRlcyBvbiB0ZXh0LCBjb21tZW50IGFuZCBhdHRyaWJ1dGUgbm9kZXMKCiAgICAgIGlmICghZWxlbSB8fCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHBhc3MgJiYgbmFtZSBpbiBqUXVlcnkuYXR0ckZuKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeShlbGVtKVtuYW1lXSh2YWx1ZSk7CiAgICAgIH0gLy8gRmFsbGJhY2sgdG8gcHJvcCB3aGVuIGF0dHJpYnV0ZXMgYXJlIG5vdCBzdXBwb3J0ZWQKCgogICAgICBpZiAodHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlID09PSAidW5kZWZpbmVkIikgewogICAgICAgIHJldHVybiBqUXVlcnkucHJvcChlbGVtLCBuYW1lLCB2YWx1ZSk7CiAgICAgIH0KCiAgICAgIG5vdHhtbCA9IG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoZWxlbSk7IC8vIEFsbCBhdHRyaWJ1dGVzIGFyZSBsb3dlcmNhc2UKICAgICAgLy8gR3JhYiBuZWNlc3NhcnkgaG9vayBpZiBvbmUgaXMgZGVmaW5lZAoKICAgICAgaWYgKG5vdHhtbCkgewogICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgaG9va3MgPSBqUXVlcnkuYXR0ckhvb2tzW25hbWVdIHx8IChyYm9vbGVhbi50ZXN0KG5hbWUpID8gYm9vbEhvb2sgOiBub2RlSG9vayk7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICBqUXVlcnkucmVtb3ZlQXR0cihlbGVtLCBuYW1lKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgaWYgKGhvb2tzICYmICJzZXQiIGluIGhvb2tzICYmIG5vdHhtbCAmJiAocmV0ID0gaG9va3Muc2V0KGVsZW0sIHZhbHVlLCBuYW1lKSkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUobmFtZSwgIiIgKyB2YWx1ZSk7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmIG5vdHhtbCAmJiAocmV0ID0gaG9va3MuZ2V0KGVsZW0sIG5hbWUpKSAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0ID0gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSk7IC8vIE5vbi1leGlzdGVudCBhdHRyaWJ1dGVzIHJldHVybiBudWxsLCB3ZSBub3JtYWxpemUgdG8gdW5kZWZpbmVkCgogICAgICAgIHJldHVybiByZXQgPT09IG51bGwgPyB1bmRlZmluZWQgOiByZXQ7CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVBdHRyOiBmdW5jdGlvbiByZW1vdmVBdHRyKGVsZW0sIHZhbHVlKSB7CiAgICAgIHZhciBwcm9wTmFtZSwKICAgICAgICAgIGF0dHJOYW1lcywKICAgICAgICAgIG5hbWUsCiAgICAgICAgICBsLAogICAgICAgICAgaXNCb29sLAogICAgICAgICAgaSA9IDA7CgogICAgICBpZiAodmFsdWUgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgIGF0dHJOYW1lcyA9IHZhbHVlLnRvTG93ZXJDYXNlKCkuc3BsaXQocnNwYWNlKTsKICAgICAgICBsID0gYXR0ck5hbWVzLmxlbmd0aDsKCiAgICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgIG5hbWUgPSBhdHRyTmFtZXNbaV07CgogICAgICAgICAgaWYgKG5hbWUpIHsKICAgICAgICAgICAgcHJvcE5hbWUgPSBqUXVlcnkucHJvcEZpeFtuYW1lXSB8fCBuYW1lOwogICAgICAgICAgICBpc0Jvb2wgPSByYm9vbGVhbi50ZXN0KG5hbWUpOyAvLyBTZWUgIzk2OTkgZm9yIGV4cGxhbmF0aW9uIG9mIHRoaXMgYXBwcm9hY2ggKHNldHRpbmcgZmlyc3QsIHRoZW4gcmVtb3ZhbCkKICAgICAgICAgICAgLy8gRG8gbm90IGRvIHRoaXMgZm9yIGJvb2xlYW4gYXR0cmlidXRlcyAoc2VlICMxMDg3MCkKCiAgICAgICAgICAgIGlmICghaXNCb29sKSB7CiAgICAgICAgICAgICAgalF1ZXJ5LmF0dHIoZWxlbSwgbmFtZSwgIiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShnZXRTZXRBdHRyaWJ1dGUgPyBuYW1lIDogcHJvcE5hbWUpOyAvLyBTZXQgY29ycmVzcG9uZGluZyBwcm9wZXJ0eSB0byBmYWxzZSBmb3IgYm9vbGVhbiBhdHRyaWJ1dGVzCgogICAgICAgICAgICBpZiAoaXNCb29sICYmIHByb3BOYW1lIGluIGVsZW0pIHsKICAgICAgICAgICAgICBlbGVtW3Byb3BOYW1lXSA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXR0ckhvb2tzOiB7CiAgICAgIHR5cGU6IHsKICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbGVtLCB2YWx1ZSkgewogICAgICAgICAgLy8gV2UgY2FuJ3QgYWxsb3cgdGhlIHR5cGUgcHJvcGVydHkgdG8gYmUgY2hhbmdlZCAoc2luY2UgaXQgY2F1c2VzIHByb2JsZW1zIGluIElFKQogICAgICAgICAgaWYgKHJ0eXBlLnRlc3QoZWxlbS5ub2RlTmFtZSkgJiYgZWxlbS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgIGpRdWVyeS5lcnJvcigidHlwZSBwcm9wZXJ0eSBjYW4ndCBiZSBjaGFuZ2VkIik7CiAgICAgICAgICB9IGVsc2UgaWYgKCFqUXVlcnkuc3VwcG9ydC5yYWRpb1ZhbHVlICYmIHZhbHVlID09PSAicmFkaW8iICYmIGpRdWVyeS5ub2RlTmFtZShlbGVtLCAiaW5wdXQiKSkgewogICAgICAgICAgICAvLyBTZXR0aW5nIHRoZSB0eXBlIG9uIGEgcmFkaW8gYnV0dG9uIGFmdGVyIHRoZSB2YWx1ZSByZXNldHMgdGhlIHZhbHVlIGluIElFNi05CiAgICAgICAgICAgIC8vIFJlc2V0IHZhbHVlIHRvIGl0J3MgZGVmYXVsdCBpbiBjYXNlIHR5cGUgaXMgc2V0IGFmdGVyIHZhbHVlCiAgICAgICAgICAgIC8vIFRoaXMgaXMgZm9yIGVsZW1lbnQgY3JlYXRpb24KICAgICAgICAgICAgdmFyIHZhbCA9IGVsZW0udmFsdWU7CiAgICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKCJ0eXBlIiwgdmFsdWUpOwoKICAgICAgICAgICAgaWYgKHZhbCkgewogICAgICAgICAgICAgIGVsZW0udmFsdWUgPSB2YWw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIFVzZSB0aGUgdmFsdWUgcHJvcGVydHkgZm9yIGJhY2sgY29tcGF0CiAgICAgIC8vIFVzZSB0aGUgbm9kZUhvb2sgZm9yIGJ1dHRvbiBlbGVtZW50cyBpbiBJRTYvNyAoIzE5NTQpCiAgICAgIHZhbHVlOiB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSwgbmFtZSkgewogICAgICAgICAgaWYgKG5vZGVIb29rICYmIGpRdWVyeS5ub2RlTmFtZShlbGVtLCAiYnV0dG9uIikpIHsKICAgICAgICAgICAgcmV0dXJuIG5vZGVIb29rLmdldChlbGVtLCBuYW1lKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmFtZSBpbiBlbGVtID8gZWxlbS52YWx1ZSA6IG51bGw7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbGVtLCB2YWx1ZSwgbmFtZSkgewogICAgICAgICAgaWYgKG5vZGVIb29rICYmIGpRdWVyeS5ub2RlTmFtZShlbGVtLCAiYnV0dG9uIikpIHsKICAgICAgICAgICAgcmV0dXJuIG5vZGVIb29rLnNldChlbGVtLCB2YWx1ZSwgbmFtZSk7CiAgICAgICAgICB9IC8vIERvZXMgbm90IHJldHVybiBzbyB0aGF0IHNldEF0dHJpYnV0ZSBpcyBhbHNvIHVzZWQKCgogICAgICAgICAgZWxlbS52YWx1ZSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHByb3BGaXg6IHsKICAgICAgdGFiaW5kZXg6ICJ0YWJJbmRleCIsCiAgICAgIHJlYWRvbmx5OiAicmVhZE9ubHkiLAogICAgICAiZm9yIjogImh0bWxGb3IiLAogICAgICAiY2xhc3MiOiAiY2xhc3NOYW1lIiwKICAgICAgbWF4bGVuZ3RoOiAibWF4TGVuZ3RoIiwKICAgICAgY2VsbHNwYWNpbmc6ICJjZWxsU3BhY2luZyIsCiAgICAgIGNlbGxwYWRkaW5nOiAiY2VsbFBhZGRpbmciLAogICAgICByb3dzcGFuOiAicm93U3BhbiIsCiAgICAgIGNvbHNwYW46ICJjb2xTcGFuIiwKICAgICAgdXNlbWFwOiAidXNlTWFwIiwKICAgICAgZnJhbWVib3JkZXI6ICJmcmFtZUJvcmRlciIsCiAgICAgIGNvbnRlbnRlZGl0YWJsZTogImNvbnRlbnRFZGl0YWJsZSIKICAgIH0sCiAgICBwcm9wOiBmdW5jdGlvbiBwcm9wKGVsZW0sIG5hbWUsIHZhbHVlKSB7CiAgICAgIHZhciByZXQsCiAgICAgICAgICBob29rcywKICAgICAgICAgIG5vdHhtbCwKICAgICAgICAgIG5UeXBlID0gZWxlbS5ub2RlVHlwZTsgLy8gZG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwoKICAgICAgaWYgKCFlbGVtIHx8IG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBub3R4bWwgPSBuVHlwZSAhPT0gMSB8fCAhalF1ZXJ5LmlzWE1MRG9jKGVsZW0pOwoKICAgICAgaWYgKG5vdHhtbCkgewogICAgICAgIC8vIEZpeCBuYW1lIGFuZCBhdHRhY2ggaG9va3MKICAgICAgICBuYW1lID0galF1ZXJ5LnByb3BGaXhbbmFtZV0gfHwgbmFtZTsKICAgICAgICBob29rcyA9IGpRdWVyeS5wcm9wSG9va3NbbmFtZV07CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGhvb2tzICYmICJzZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5zZXQoZWxlbSwgdmFsdWUsIG5hbWUpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZWxlbVtuYW1lXSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCBuYW1lKSkgIT09IG51bGwpIHsKICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBlbGVtW25hbWVdOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHByb3BIb29rczogewogICAgICB0YWJJbmRleDogewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0pIHsKICAgICAgICAgIC8vIGVsZW0udGFiSW5kZXggZG9lc24ndCBhbHdheXMgcmV0dXJuIHRoZSBjb3JyZWN0IHZhbHVlIHdoZW4gaXQgaGFzbid0IGJlZW4gZXhwbGljaXRseSBzZXQKICAgICAgICAgIC8vIGh0dHA6Ly9mbHVpZHByb2plY3Qub3JnL2Jsb2cvMjAwOC8wMS8wOS9nZXR0aW5nLXNldHRpbmctYW5kLXJlbW92aW5nLXRhYmluZGV4LXZhbHVlcy13aXRoLWphdmFzY3JpcHQvCiAgICAgICAgICB2YXIgYXR0cmlidXRlTm9kZSA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSgidGFiaW5kZXgiKTsKICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVOb2RlICYmIGF0dHJpYnV0ZU5vZGUuc3BlY2lmaWVkID8gcGFyc2VJbnQoYXR0cmlidXRlTm9kZS52YWx1ZSwgMTApIDogcmZvY3VzYWJsZS50ZXN0KGVsZW0ubm9kZU5hbWUpIHx8IHJjbGlja2FibGUudGVzdChlbGVtLm5vZGVOYW1lKSAmJiBlbGVtLmhyZWYgPyAwIDogdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOyAvLyBBZGQgdGhlIHRhYkluZGV4IHByb3BIb29rIHRvIGF0dHJIb29rcyBmb3IgYmFjay1jb21wYXQgKGRpZmZlcmVudCBjYXNlIGlzIGludGVudGlvbmFsKQoKICBqUXVlcnkuYXR0ckhvb2tzLnRhYmluZGV4ID0galF1ZXJ5LnByb3BIb29rcy50YWJJbmRleDsgLy8gSG9vayBmb3IgYm9vbGVhbiBhdHRyaWJ1dGVzCgogIGJvb2xIb29rID0gewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSwgbmFtZSkgewogICAgICAvLyBBbGlnbiBib29sZWFuIGF0dHJpYnV0ZXMgd2l0aCBjb3JyZXNwb25kaW5nIHByb3BlcnRpZXMKICAgICAgLy8gRmFsbCBiYWNrIHRvIGF0dHJpYnV0ZSBwcmVzZW5jZSB3aGVyZSBzb21lIGJvb2xlYW5zIGFyZSBub3Qgc3VwcG9ydGVkCiAgICAgIHZhciBhdHRyTm9kZSwKICAgICAgICAgIHByb3BlcnR5ID0galF1ZXJ5LnByb3AoZWxlbSwgbmFtZSk7CiAgICAgIHJldHVybiBwcm9wZXJ0eSA9PT0gdHJ1ZSB8fCB0eXBlb2YgcHJvcGVydHkgIT09ICJib29sZWFuIiAmJiAoYXR0ck5vZGUgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpICYmIGF0dHJOb2RlLm5vZGVWYWx1ZSAhPT0gZmFsc2UgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOiB1bmRlZmluZWQ7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUsIG5hbWUpIHsKICAgICAgdmFyIHByb3BOYW1lOwoKICAgICAgaWYgKHZhbHVlID09PSBmYWxzZSkgewogICAgICAgIC8vIFJlbW92ZSBib29sZWFuIGF0dHJpYnV0ZXMgd2hlbiBzZXQgdG8gZmFsc2UKICAgICAgICBqUXVlcnkucmVtb3ZlQXR0cihlbGVtLCBuYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyB2YWx1ZSBpcyB0cnVlIHNpbmNlIHdlIGtub3cgYXQgdGhpcyBwb2ludCBpdCdzIHR5cGUgYm9vbGVhbiBhbmQgbm90IGZhbHNlCiAgICAgICAgLy8gU2V0IGJvb2xlYW4gYXR0cmlidXRlcyB0byB0aGUgc2FtZSBuYW1lIGFuZCBzZXQgdGhlIERPTSBwcm9wZXJ0eQogICAgICAgIHByb3BOYW1lID0galF1ZXJ5LnByb3BGaXhbbmFtZV0gfHwgbmFtZTsKCiAgICAgICAgaWYgKHByb3BOYW1lIGluIGVsZW0pIHsKICAgICAgICAgIC8vIE9ubHkgc2V0IHRoZSBJREwgc3BlY2lmaWNhbGx5IGlmIGl0IGFscmVhZHkgZXhpc3RzIG9uIHRoZSBlbGVtZW50CiAgICAgICAgICBlbGVtW3Byb3BOYW1lXSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShuYW1lLCBuYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgICB9CgogICAgICByZXR1cm4gbmFtZTsKICAgIH0KICB9OyAvLyBJRTYvNyBkbyBub3Qgc3VwcG9ydCBnZXR0aW5nL3NldHRpbmcgc29tZSBhdHRyaWJ1dGVzIHdpdGggZ2V0L3NldEF0dHJpYnV0ZQoKICBpZiAoIWdldFNldEF0dHJpYnV0ZSkgewogICAgZml4U3BlY2lmaWVkID0gewogICAgICBuYW1lOiB0cnVlLAogICAgICBpZDogdHJ1ZSwKICAgICAgY29vcmRzOiB0cnVlCiAgICB9OyAvLyBVc2UgdGhpcyBmb3IgYW55IGF0dHJpYnV0ZSBpbiBJRTYvNwogICAgLy8gVGhpcyBmaXhlcyBhbG1vc3QgZXZlcnkgSUU2LzcgaXNzdWUKCiAgICBub2RlSG9vayA9IGpRdWVyeS52YWxIb29rcy5idXR0b24gPSB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0sIG5hbWUpIHsKICAgICAgICB2YXIgcmV0OwogICAgICAgIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKTsKICAgICAgICByZXR1cm4gcmV0ICYmIChmaXhTcGVjaWZpZWRbbmFtZV0gPyByZXQubm9kZVZhbHVlICE9PSAiIiA6IHJldC5zcGVjaWZpZWQpID8gcmV0Lm5vZGVWYWx1ZSA6IHVuZGVmaW5lZDsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUsIG5hbWUpIHsKICAgICAgICAvLyBTZXQgdGhlIGV4aXN0aW5nIG9yIGNyZWF0ZSBhIG5ldyBhdHRyaWJ1dGUgbm9kZQogICAgICAgIHZhciByZXQgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSk7CgogICAgICAgIGlmICghcmV0KSB7CiAgICAgICAgICByZXQgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUobmFtZSk7CiAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZU5vZGUocmV0KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXQubm9kZVZhbHVlID0gdmFsdWUgKyAiIjsKICAgICAgfQogICAgfTsgLy8gQXBwbHkgdGhlIG5vZGVIb29rIHRvIHRhYmluZGV4CgogICAgalF1ZXJ5LmF0dHJIb29rcy50YWJpbmRleC5zZXQgPSBub2RlSG9vay5zZXQ7IC8vIFNldCB3aWR0aCBhbmQgaGVpZ2h0IHRvIGF1dG8gaW5zdGVhZCBvZiAwIG9uIGVtcHR5IHN0cmluZyggQnVnICM4MTUwICkKICAgIC8vIFRoaXMgaXMgZm9yIHJlbW92YWxzCgogICAgalF1ZXJ5LmVhY2goWyJ3aWR0aCIsICJoZWlnaHQiXSwgZnVuY3Rpb24gKGksIG5hbWUpIHsKICAgICAgalF1ZXJ5LmF0dHJIb29rc1tuYW1lXSA9IGpRdWVyeS5leHRlbmQoalF1ZXJ5LmF0dHJIb29rc1tuYW1lXSwgewogICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVsZW0sIHZhbHVlKSB7CiAgICAgICAgICBpZiAodmFsdWUgPT09ICIiKSB7CiAgICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKG5hbWUsICJhdXRvIik7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7IC8vIFNldCBjb250ZW50ZWRpdGFibGUgdG8gZmFsc2Ugb24gcmVtb3ZhbHMoIzEwNDI5KQogICAgLy8gU2V0dGluZyB0byBlbXB0eSBzdHJpbmcgdGhyb3dzIGFuIGVycm9yIGFzIGFuIGludmFsaWQgdmFsdWUKCiAgICBqUXVlcnkuYXR0ckhvb2tzLmNvbnRlbnRlZGl0YWJsZSA9IHsKICAgICAgZ2V0OiBub2RlSG9vay5nZXQsCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVsZW0sIHZhbHVlLCBuYW1lKSB7CiAgICAgICAgaWYgKHZhbHVlID09PSAiIikgewogICAgICAgICAgdmFsdWUgPSAiZmFsc2UiOwogICAgICAgIH0KCiAgICAgICAgbm9kZUhvb2suc2V0KGVsZW0sIHZhbHVlLCBuYW1lKTsKICAgICAgfQogICAgfTsKICB9IC8vIFNvbWUgYXR0cmlidXRlcyByZXF1aXJlIGEgc3BlY2lhbCBjYWxsIG9uIElFCgoKICBpZiAoIWpRdWVyeS5zdXBwb3J0LmhyZWZOb3JtYWxpemVkKSB7CiAgICBqUXVlcnkuZWFjaChbImhyZWYiLCAic3JjIiwgIndpZHRoIiwgImhlaWdodCJdLCBmdW5jdGlvbiAoaSwgbmFtZSkgewogICAgICBqUXVlcnkuYXR0ckhvb2tzW25hbWVdID0galF1ZXJ5LmV4dGVuZChqUXVlcnkuYXR0ckhvb2tzW25hbWVdLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSkgewogICAgICAgICAgdmFyIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUsIDIpOwogICAgICAgICAgcmV0dXJuIHJldCA9PT0gbnVsbCA/IHVuZGVmaW5lZCA6IHJldDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBpZiAoIWpRdWVyeS5zdXBwb3J0LnN0eWxlKSB7CiAgICBqUXVlcnkuYXR0ckhvb2tzLnN0eWxlID0gewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldChlbGVtKSB7CiAgICAgICAgLy8gUmV0dXJuIHVuZGVmaW5lZCBpbiB0aGUgY2FzZSBvZiBlbXB0eSBzdHJpbmcKICAgICAgICAvLyBOb3JtYWxpemUgdG8gbG93ZXJjYXNlIHNpbmNlIElFIHVwcGVyY2FzZXMgY3NzIHByb3BlcnR5IG5hbWVzCiAgICAgICAgcmV0dXJuIGVsZW0uc3R5bGUuY3NzVGV4dC50b0xvd2VyQ2FzZSgpIHx8IHVuZGVmaW5lZDsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZWxlbSwgdmFsdWUpIHsKICAgICAgICByZXR1cm4gZWxlbS5zdHlsZS5jc3NUZXh0ID0gIiIgKyB2YWx1ZTsKICAgICAgfQogICAgfTsKICB9IC8vIFNhZmFyaSBtaXMtcmVwb3J0cyB0aGUgZGVmYXVsdCBzZWxlY3RlZCBwcm9wZXJ0eSBvZiBhbiBvcHRpb24KICAvLyBBY2Nlc3NpbmcgdGhlIHBhcmVudCdzIHNlbGVjdGVkSW5kZXggcHJvcGVydHkgZml4ZXMgaXQKCgogIGlmICghalF1ZXJ5LnN1cHBvcnQub3B0U2VsZWN0ZWQpIHsKICAgIGpRdWVyeS5wcm9wSG9va3Muc2VsZWN0ZWQgPSBqUXVlcnkuZXh0ZW5kKGpRdWVyeS5wcm9wSG9va3Muc2VsZWN0ZWQsIHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSkgewogICAgICAgIHZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CgogICAgICAgIGlmIChwYXJlbnQpIHsKICAgICAgICAgIHBhcmVudC5zZWxlY3RlZEluZGV4OyAvLyBNYWtlIHN1cmUgdGhhdCBpdCBhbHNvIHdvcmtzIHdpdGggb3B0Z3JvdXBzLCBzZWUgIzU3MDEKCiAgICAgICAgICBpZiAocGFyZW50LnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgcGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9KTsKICB9IC8vIElFNi83IGNhbGwgZW5jdHlwZSBlbmNvZGluZwoKCiAgaWYgKCFqUXVlcnkuc3VwcG9ydC5lbmN0eXBlKSB7CiAgICBqUXVlcnkucHJvcEZpeC5lbmN0eXBlID0gImVuY29kaW5nIjsKICB9IC8vIFJhZGlvcyBhbmQgY2hlY2tib3hlcyBnZXR0ZXIvc2V0dGVyCgoKICBpZiAoIWpRdWVyeS5zdXBwb3J0LmNoZWNrT24pIHsKICAgIGpRdWVyeS5lYWNoKFsicmFkaW8iLCAiY2hlY2tib3giXSwgZnVuY3Rpb24gKCkgewogICAgICBqUXVlcnkudmFsSG9va3NbdGhpc10gPSB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSkgewogICAgICAgICAgLy8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIGluIFdlYmtpdCAiIiBpcyByZXR1cm5lZCBpbnN0ZWFkIG9mICJvbiIgaWYgYSB2YWx1ZSBpc24ndCBzcGVjaWZpZWQKICAgICAgICAgIHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgidmFsdWUiKSA9PT0gbnVsbCA/ICJvbiIgOiBlbGVtLnZhbHVlOwogICAgICAgIH0KICAgICAgfTsKICAgIH0pOwogIH0KCiAgalF1ZXJ5LmVhY2goWyJyYWRpbyIsICJjaGVja2JveCJdLCBmdW5jdGlvbiAoKSB7CiAgICBqUXVlcnkudmFsSG9va3NbdGhpc10gPSBqUXVlcnkuZXh0ZW5kKGpRdWVyeS52YWxIb29rc1t0aGlzXSwgewogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbGVtLCB2YWx1ZSkgewogICAgICAgIGlmIChqUXVlcnkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICAgIHJldHVybiBlbGVtLmNoZWNrZWQgPSBqUXVlcnkuaW5BcnJheShqUXVlcnkoZWxlbSkudmFsKCksIHZhbHVlKSA+PSAwOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfSk7CgogIHZhciByZm9ybUVsZW1zID0gL14oPzp0ZXh0YXJlYXxpbnB1dHxzZWxlY3QpJC9pLAogICAgICBydHlwZW5hbWVzcGFjZSA9IC9eKFteXC5dKik/KD86XC4oLispKT8kLywKICAgICAgcmhvdmVySGFjayA9IC8oPzpefFxzKWhvdmVyKFwuXFMrKT9cYi8sCiAgICAgIHJrZXlFdmVudCA9IC9ea2V5LywKICAgICAgcm1vdXNlRXZlbnQgPSAvXig/Om1vdXNlfGNvbnRleHRtZW51KXxjbGljay8sCiAgICAgIHJmb2N1c01vcnBoID0gL14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLAogICAgICBycXVpY2tJcyA9IC9eKFx3KikoPzojKFtcd1wtXSspKT8oPzpcLihbXHdcLV0rKSk/JC8sCiAgICAgIHF1aWNrUGFyc2UgPSBmdW5jdGlvbiBxdWlja1BhcnNlKHNlbGVjdG9yKSB7CiAgICB2YXIgcXVpY2sgPSBycXVpY2tJcy5leGVjKHNlbGVjdG9yKTsKCiAgICBpZiAocXVpY2spIHsKICAgICAgLy8gICAwICAxICAgIDIgICAzCiAgICAgIC8vIFsgXywgdGFnLCBpZCwgY2xhc3MgXQogICAgICBxdWlja1sxXSA9IChxdWlja1sxXSB8fCAiIikudG9Mb3dlckNhc2UoKTsKICAgICAgcXVpY2tbM10gPSBxdWlja1szXSAmJiBuZXcgUmVnRXhwKCIoPzpefFxccykiICsgcXVpY2tbM10gKyAiKD86XFxzfCQpIik7CiAgICB9CgogICAgcmV0dXJuIHF1aWNrOwogIH0sCiAgICAgIHF1aWNrSXMgPSBmdW5jdGlvbiBxdWlja0lzKGVsZW0sIG0pIHsKICAgIHZhciBhdHRycyA9IGVsZW0uYXR0cmlidXRlcyB8fCB7fTsKICAgIHJldHVybiAoIW1bMV0gfHwgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBtWzFdKSAmJiAoIW1bMl0gfHwgKGF0dHJzLmlkIHx8IHt9KS52YWx1ZSA9PT0gbVsyXSkgJiYgKCFtWzNdIHx8IG1bM10udGVzdCgoYXR0cnNbImNsYXNzIl0gfHwge30pLnZhbHVlKSk7CiAgfSwKICAgICAgaG92ZXJIYWNrID0gZnVuY3Rpb24gaG92ZXJIYWNrKGV2ZW50cykgewogICAgcmV0dXJuIGpRdWVyeS5ldmVudC5zcGVjaWFsLmhvdmVyID8gZXZlbnRzIDogZXZlbnRzLnJlcGxhY2UocmhvdmVySGFjaywgIm1vdXNlZW50ZXIkMSBtb3VzZWxlYXZlJDEiKTsKICB9OwogIC8qCiAgICogSGVscGVyIGZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgZXZlbnRzIC0tIG5vdCBwYXJ0IG9mIHRoZSBwdWJsaWMgaW50ZXJmYWNlLgogICAqIFByb3BzIHRvIERlYW4gRWR3YXJkcycgYWRkRXZlbnQgbGlicmFyeSBmb3IgbWFueSBvZiB0aGUgaWRlYXMuCiAgICovCgoKICBqUXVlcnkuZXZlbnQgPSB7CiAgICBhZGQ6IGZ1bmN0aW9uIGFkZChlbGVtLCB0eXBlcywgaGFuZGxlciwgZGF0YSwgc2VsZWN0b3IpIHsKICAgICAgdmFyIGVsZW1EYXRhLCBfZXZlbnRIYW5kbGUsIGV2ZW50cywgdCwgdG5zLCB0eXBlLCBuYW1lc3BhY2VzLCBoYW5kbGVPYmosIGhhbmRsZU9iakluLCBxdWljaywgaGFuZGxlcnMsIHNwZWNpYWw7IC8vIERvbid0IGF0dGFjaCBldmVudHMgdG8gbm9EYXRhIG9yIHRleHQvY29tbWVudCBub2RlcyAoYWxsb3cgcGxhaW4gb2JqZWN0cyB0aG8pCgoKICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCB8fCAhdHlwZXMgfHwgIWhhbmRsZXIgfHwgIShlbGVtRGF0YSA9IGpRdWVyeS5fZGF0YShlbGVtKSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gQ2FsbGVyIGNhbiBwYXNzIGluIGFuIG9iamVjdCBvZiBjdXN0b20gZGF0YSBpbiBsaWV1IG9mIHRoZSBoYW5kbGVyCgoKICAgICAgaWYgKGhhbmRsZXIuaGFuZGxlcikgewogICAgICAgIGhhbmRsZU9iakluID0gaGFuZGxlcjsKICAgICAgICBoYW5kbGVyID0gaGFuZGxlT2JqSW4uaGFuZGxlcjsKICAgICAgICBzZWxlY3RvciA9IGhhbmRsZU9iakluLnNlbGVjdG9yOwogICAgICB9IC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBoYW5kbGVyIGhhcyBhIHVuaXF1ZSBJRCwgdXNlZCB0byBmaW5kL3JlbW92ZSBpdCBsYXRlcgoKCiAgICAgIGlmICghaGFuZGxlci5ndWlkKSB7CiAgICAgICAgaGFuZGxlci5ndWlkID0galF1ZXJ5Lmd1aWQrKzsKICAgICAgfSAvLyBJbml0IHRoZSBlbGVtZW50J3MgZXZlbnQgc3RydWN0dXJlIGFuZCBtYWluIGhhbmRsZXIsIGlmIHRoaXMgaXMgdGhlIGZpcnN0CgoKICAgICAgZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzOwoKICAgICAgaWYgKCFldmVudHMpIHsKICAgICAgICBlbGVtRGF0YS5ldmVudHMgPSBldmVudHMgPSB7fTsKICAgICAgfQoKICAgICAgX2V2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlOwoKICAgICAgaWYgKCFfZXZlbnRIYW5kbGUpIHsKICAgICAgICBlbGVtRGF0YS5oYW5kbGUgPSBfZXZlbnRIYW5kbGUgPSBmdW5jdGlvbiBldmVudEhhbmRsZShlKSB7CiAgICAgICAgICAvLyBEaXNjYXJkIHRoZSBzZWNvbmQgZXZlbnQgb2YgYSBqUXVlcnkuZXZlbnQudHJpZ2dlcigpIGFuZAogICAgICAgICAgLy8gd2hlbiBhbiBldmVudCBpcyBjYWxsZWQgYWZ0ZXIgYSBwYWdlIGhhcyB1bmxvYWRlZAogICAgICAgICAgcmV0dXJuIHR5cGVvZiBqUXVlcnkgIT09ICJ1bmRlZmluZWQiICYmICghZSB8fCBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICE9PSBlLnR5cGUpID8galF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmFwcGx5KF9ldmVudEhhbmRsZS5lbGVtLCBhcmd1bWVudHMpIDogdW5kZWZpbmVkOwogICAgICAgIH07IC8vIEFkZCBlbGVtIGFzIGEgcHJvcGVydHkgb2YgdGhlIGhhbmRsZSBmbiB0byBwcmV2ZW50IGEgbWVtb3J5IGxlYWsgd2l0aCBJRSBub24tbmF0aXZlIGV2ZW50cwoKCiAgICAgICAgX2V2ZW50SGFuZGxlLmVsZW0gPSBlbGVtOwogICAgICB9IC8vIEhhbmRsZSBtdWx0aXBsZSBldmVudHMgc2VwYXJhdGVkIGJ5IGEgc3BhY2UKICAgICAgLy8galF1ZXJ5KC4uLikuYmluZCgibW91c2VvdmVyIG1vdXNlb3V0IiwgZm4pOwoKCiAgICAgIHR5cGVzID0galF1ZXJ5LnRyaW0oaG92ZXJIYWNrKHR5cGVzKSkuc3BsaXQoIiAiKTsKCiAgICAgIGZvciAodCA9IDA7IHQgPCB0eXBlcy5sZW5ndGg7IHQrKykgewogICAgICAgIHRucyA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWModHlwZXNbdF0pIHx8IFtdOwogICAgICAgIHR5cGUgPSB0bnNbMV07CiAgICAgICAgbmFtZXNwYWNlcyA9ICh0bnNbMl0gfHwgIiIpLnNwbGl0KCIuIikuc29ydCgpOyAvLyBJZiBldmVudCBjaGFuZ2VzIGl0cyB0eXBlLCB1c2UgdGhlIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBjaGFuZ2VkIHR5cGUKCiAgICAgICAgc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsW3R5cGVdIHx8IHt9OyAvLyBJZiBzZWxlY3RvciBkZWZpbmVkLCBkZXRlcm1pbmUgc3BlY2lhbCBldmVudCBhcGkgdHlwZSwgb3RoZXJ3aXNlIGdpdmVuIHR5cGUKCiAgICAgICAgdHlwZSA9IChzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSkgfHwgdHlwZTsgLy8gVXBkYXRlIHNwZWNpYWwgYmFzZWQgb24gbmV3bHkgcmVzZXQgdHlwZQoKICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307IC8vIGhhbmRsZU9iaiBpcyBwYXNzZWQgdG8gYWxsIGV2ZW50IGhhbmRsZXJzCgogICAgICAgIGhhbmRsZU9iaiA9IGpRdWVyeS5leHRlbmQoewogICAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICAgIG9yaWdUeXBlOiB0bnNbMV0sCiAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgaGFuZGxlcjogaGFuZGxlciwKICAgICAgICAgIGd1aWQ6IGhhbmRsZXIuZ3VpZCwKICAgICAgICAgIHNlbGVjdG9yOiBzZWxlY3RvciwKICAgICAgICAgIHF1aWNrOiBzZWxlY3RvciAmJiBxdWlja1BhcnNlKHNlbGVjdG9yKSwKICAgICAgICAgIG5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKCIuIikKICAgICAgICB9LCBoYW5kbGVPYmpJbik7IC8vIEluaXQgdGhlIGV2ZW50IGhhbmRsZXIgcXVldWUgaWYgd2UncmUgdGhlIGZpcnN0CgogICAgICAgIGhhbmRsZXJzID0gZXZlbnRzW3R5cGVdOwoKICAgICAgICBpZiAoIWhhbmRsZXJzKSB7CiAgICAgICAgICBoYW5kbGVycyA9IGV2ZW50c1t0eXBlXSA9IFtdOwogICAgICAgICAgaGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7IC8vIE9ubHkgdXNlIGFkZEV2ZW50TGlzdGVuZXIvYXR0YWNoRXZlbnQgaWYgdGhlIHNwZWNpYWwgZXZlbnRzIGhhbmRsZXIgcmV0dXJucyBmYWxzZQoKICAgICAgICAgIGlmICghc3BlY2lhbC5zZXR1cCB8fCBzcGVjaWFsLnNldHVwLmNhbGwoZWxlbSwgZGF0YSwgbmFtZXNwYWNlcywgX2V2ZW50SGFuZGxlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgLy8gQmluZCB0aGUgZ2xvYmFsIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGVsZW1lbnQKICAgICAgICAgICAgaWYgKGVsZW0uYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBfZXZlbnRIYW5kbGUsIGZhbHNlKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtLmF0dGFjaEV2ZW50KSB7CiAgICAgICAgICAgICAgZWxlbS5hdHRhY2hFdmVudCgib24iICsgdHlwZSwgX2V2ZW50SGFuZGxlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHNwZWNpYWwuYWRkKSB7CiAgICAgICAgICBzcGVjaWFsLmFkZC5jYWxsKGVsZW0sIGhhbmRsZU9iaik7CgogICAgICAgICAgaWYgKCFoYW5kbGVPYmouaGFuZGxlci5ndWlkKSB7CiAgICAgICAgICAgIGhhbmRsZU9iai5oYW5kbGVyLmd1aWQgPSBoYW5kbGVyLmd1aWQ7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgdG8gdGhlIGVsZW1lbnQncyBoYW5kbGVyIGxpc3QsIGRlbGVnYXRlcyBpbiBmcm9udAoKCiAgICAgICAgaWYgKHNlbGVjdG9yKSB7CiAgICAgICAgICBoYW5kbGVycy5zcGxpY2UoaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLCAwLCBoYW5kbGVPYmopOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoYW5kbGVycy5wdXNoKGhhbmRsZU9iaik7CiAgICAgICAgfSAvLyBLZWVwIHRyYWNrIG9mIHdoaWNoIGV2ZW50cyBoYXZlIGV2ZXIgYmVlbiB1c2VkLCBmb3IgZXZlbnQgb3B0aW1pemF0aW9uCgoKICAgICAgICBqUXVlcnkuZXZlbnQuZ2xvYmFsW3R5cGVdID0gdHJ1ZTsKICAgICAgfSAvLyBOdWxsaWZ5IGVsZW0gdG8gcHJldmVudCBtZW1vcnkgbGVha3MgaW4gSUUKCgogICAgICBlbGVtID0gbnVsbDsKICAgIH0sCiAgICBnbG9iYWw6IHt9LAogICAgLy8gRGV0YWNoIGFuIGV2ZW50IG9yIHNldCBvZiBldmVudHMgZnJvbSBhbiBlbGVtZW50CiAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShlbGVtLCB0eXBlcywgaGFuZGxlciwgc2VsZWN0b3IsIG1hcHBlZFR5cGVzKSB7CiAgICAgIHZhciBlbGVtRGF0YSA9IGpRdWVyeS5oYXNEYXRhKGVsZW0pICYmIGpRdWVyeS5fZGF0YShlbGVtKSwKICAgICAgICAgIHQsCiAgICAgICAgICB0bnMsCiAgICAgICAgICB0eXBlLAogICAgICAgICAgb3JpZ1R5cGUsCiAgICAgICAgICBuYW1lc3BhY2VzLAogICAgICAgICAgb3JpZ0NvdW50LAogICAgICAgICAgaiwKICAgICAgICAgIGV2ZW50cywKICAgICAgICAgIHNwZWNpYWwsCiAgICAgICAgICBoYW5kbGUsCiAgICAgICAgICBldmVudFR5cGUsCiAgICAgICAgICBoYW5kbGVPYmo7CgogICAgICBpZiAoIWVsZW1EYXRhIHx8ICEoZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzKSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBPbmNlIGZvciBlYWNoIHR5cGUubmFtZXNwYWNlIGluIHR5cGVzOyB0eXBlIG1heSBiZSBvbWl0dGVkCgoKICAgICAgdHlwZXMgPSBqUXVlcnkudHJpbShob3ZlckhhY2sodHlwZXMgfHwgIiIpKS5zcGxpdCgiICIpOwoKICAgICAgZm9yICh0ID0gMDsgdCA8IHR5cGVzLmxlbmd0aDsgdCsrKSB7CiAgICAgICAgdG5zID0gcnR5cGVuYW1lc3BhY2UuZXhlYyh0eXBlc1t0XSkgfHwgW107CiAgICAgICAgdHlwZSA9IG9yaWdUeXBlID0gdG5zWzFdOwogICAgICAgIG5hbWVzcGFjZXMgPSB0bnNbMl07IC8vIFVuYmluZCBhbGwgZXZlbnRzIChvbiB0aGlzIG5hbWVzcGFjZSwgaWYgcHJvdmlkZWQpIGZvciB0aGUgZWxlbWVudAoKICAgICAgICBpZiAoIXR5cGUpIHsKICAgICAgICAgIGZvciAodHlwZSBpbiBldmVudHMpIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnJlbW92ZShlbGVtLCB0eXBlICsgdHlwZXNbdF0sIGhhbmRsZXIsIHNlbGVjdG9yLCB0cnVlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFt0eXBlXSB8fCB7fTsKICAgICAgICB0eXBlID0gKHNlbGVjdG9yID8gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgOiBzcGVjaWFsLmJpbmRUeXBlKSB8fCB0eXBlOwogICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1t0eXBlXSB8fCBbXTsKICAgICAgICBvcmlnQ291bnQgPSBldmVudFR5cGUubGVuZ3RoOwogICAgICAgIG5hbWVzcGFjZXMgPSBuYW1lc3BhY2VzID8gbmV3IFJlZ0V4cCgiKF58XFwuKSIgKyBuYW1lc3BhY2VzLnNwbGl0KCIuIikuc29ydCgpLmpvaW4oIlxcLig/Oi4qXFwuKT8iKSArICIoXFwufCQpIikgOiBudWxsOyAvLyBSZW1vdmUgbWF0Y2hpbmcgZXZlbnRzCgogICAgICAgIGZvciAoaiA9IDA7IGogPCBldmVudFR5cGUubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGhhbmRsZU9iaiA9IGV2ZW50VHlwZVtqXTsKCiAgICAgICAgICBpZiAoKG1hcHBlZFR5cGVzIHx8IG9yaWdUeXBlID09PSBoYW5kbGVPYmoub3JpZ1R5cGUpICYmICghaGFuZGxlciB8fCBoYW5kbGVyLmd1aWQgPT09IGhhbmRsZU9iai5ndWlkKSAmJiAoIW5hbWVzcGFjZXMgfHwgbmFtZXNwYWNlcy50ZXN0KGhhbmRsZU9iai5uYW1lc3BhY2UpKSAmJiAoIXNlbGVjdG9yIHx8IHNlbGVjdG9yID09PSBoYW5kbGVPYmouc2VsZWN0b3IgfHwgc2VsZWN0b3IgPT09ICIqKiIgJiYgaGFuZGxlT2JqLnNlbGVjdG9yKSkgewogICAgICAgICAgICBldmVudFR5cGUuc3BsaWNlKGotLSwgMSk7CgogICAgICAgICAgICBpZiAoaGFuZGxlT2JqLnNlbGVjdG9yKSB7CiAgICAgICAgICAgICAgZXZlbnRUeXBlLmRlbGVnYXRlQ291bnQtLTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHNwZWNpYWwucmVtb3ZlKSB7CiAgICAgICAgICAgICAgc3BlY2lhbC5yZW1vdmUuY2FsbChlbGVtLCBoYW5kbGVPYmopOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZW1vdmUgZ2VuZXJpYyBldmVudCBoYW5kbGVyIGlmIHdlIHJlbW92ZWQgc29tZXRoaW5nIGFuZCBubyBtb3JlIGhhbmRsZXJzIGV4aXN0CiAgICAgICAgLy8gKGF2b2lkcyBwb3RlbnRpYWwgZm9yIGVuZGxlc3MgcmVjdXJzaW9uIGR1cmluZyByZW1vdmFsIG9mIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMpCgoKICAgICAgICBpZiAoZXZlbnRUeXBlLmxlbmd0aCA9PT0gMCAmJiBvcmlnQ291bnQgIT09IGV2ZW50VHlwZS5sZW5ndGgpIHsKICAgICAgICAgIGlmICghc3BlY2lhbC50ZWFyZG93biB8fCBzcGVjaWFsLnRlYXJkb3duLmNhbGwoZWxlbSwgbmFtZXNwYWNlcykgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGpRdWVyeS5yZW1vdmVFdmVudChlbGVtLCB0eXBlLCBlbGVtRGF0YS5oYW5kbGUpOwogICAgICAgICAgfQoKICAgICAgICAgIGRlbGV0ZSBldmVudHNbdHlwZV07CiAgICAgICAgfQogICAgICB9IC8vIFJlbW92ZSB0aGUgZXhwYW5kbyBpZiBpdCdzIG5vIGxvbmdlciB1c2VkCgoKICAgICAgaWYgKGpRdWVyeS5pc0VtcHR5T2JqZWN0KGV2ZW50cykpIHsKICAgICAgICBoYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGU7CgogICAgICAgIGlmIChoYW5kbGUpIHsKICAgICAgICAgIGhhbmRsZS5lbGVtID0gbnVsbDsKICAgICAgICB9IC8vIHJlbW92ZURhdGEgYWxzbyBjaGVja3MgZm9yIGVtcHRpbmVzcyBhbmQgY2xlYXJzIHRoZSBleHBhbmRvIGlmIGVtcHR5CiAgICAgICAgLy8gc28gdXNlIGl0IGluc3RlYWQgb2YgZGVsZXRlCgoKICAgICAgICBqUXVlcnkucmVtb3ZlRGF0YShlbGVtLCBbImV2ZW50cyIsICJoYW5kbGUiXSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBFdmVudHMgdGhhdCBhcmUgc2FmZSB0byBzaG9ydC1jaXJjdWl0IGlmIG5vIGhhbmRsZXJzIGFyZSBhdHRhY2hlZC4KICAgIC8vIE5hdGl2ZSBET00gZXZlbnRzIHNob3VsZCBub3QgYmUgYWRkZWQsIHRoZXkgbWF5IGhhdmUgaW5saW5lIGhhbmRsZXJzLgogICAgY3VzdG9tRXZlbnQ6IHsKICAgICAgImdldERhdGEiOiB0cnVlLAogICAgICAic2V0RGF0YSI6IHRydWUsCiAgICAgICJjaGFuZ2VEYXRhIjogdHJ1ZQogICAgfSwKICAgIHRyaWdnZXI6IGZ1bmN0aW9uIHRyaWdnZXIoZXZlbnQsIGRhdGEsIGVsZW0sIG9ubHlIYW5kbGVycykgewogICAgICAvLyBEb24ndCBkbyBldmVudHMgb24gdGV4dCBhbmQgY29tbWVudCBub2RlcwogICAgICBpZiAoZWxlbSAmJiAoZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4KSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBFdmVudCBvYmplY3Qgb3IgZXZlbnQgdHlwZQoKCiAgICAgIHZhciB0eXBlID0gZXZlbnQudHlwZSB8fCBldmVudCwKICAgICAgICAgIG5hbWVzcGFjZXMgPSBbXSwKICAgICAgICAgIGNhY2hlLAogICAgICAgICAgZXhjbHVzaXZlLAogICAgICAgICAgaSwKICAgICAgICAgIGN1ciwKICAgICAgICAgIG9sZCwKICAgICAgICAgIG9udHlwZSwKICAgICAgICAgIHNwZWNpYWwsCiAgICAgICAgICBoYW5kbGUsCiAgICAgICAgICBldmVudFBhdGgsCiAgICAgICAgICBidWJibGVUeXBlOyAvLyBmb2N1cy9ibHVyIG1vcnBocyB0byBmb2N1c2luL291dDsgZW5zdXJlIHdlJ3JlIG5vdCBmaXJpbmcgdGhlbSByaWdodCBub3cKCiAgICAgIGlmIChyZm9jdXNNb3JwaC50ZXN0KHR5cGUgKyBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHR5cGUuaW5kZXhPZigiISIpID49IDApIHsKICAgICAgICAvLyBFeGNsdXNpdmUgZXZlbnRzIHRyaWdnZXIgb25seSBmb3IgdGhlIGV4YWN0IGV2ZW50IChubyBuYW1lc3BhY2VzKQogICAgICAgIHR5cGUgPSB0eXBlLnNsaWNlKDAsIC0xKTsKICAgICAgICBleGNsdXNpdmUgPSB0cnVlOwogICAgICB9CgogICAgICBpZiAodHlwZS5pbmRleE9mKCIuIikgPj0gMCkgewogICAgICAgIC8vIE5hbWVzcGFjZWQgdHJpZ2dlcjsgY3JlYXRlIGEgcmVnZXhwIHRvIG1hdGNoIGV2ZW50IHR5cGUgaW4gaGFuZGxlKCkKICAgICAgICBuYW1lc3BhY2VzID0gdHlwZS5zcGxpdCgiLiIpOwogICAgICAgIHR5cGUgPSBuYW1lc3BhY2VzLnNoaWZ0KCk7CiAgICAgICAgbmFtZXNwYWNlcy5zb3J0KCk7CiAgICAgIH0KCiAgICAgIGlmICgoIWVsZW0gfHwgalF1ZXJ5LmV2ZW50LmN1c3RvbUV2ZW50W3R5cGVdKSAmJiAhalF1ZXJ5LmV2ZW50Lmdsb2JhbFt0eXBlXSkgewogICAgICAgIC8vIE5vIGpRdWVyeSBoYW5kbGVycyBmb3IgdGhpcyBldmVudCB0eXBlLCBhbmQgaXQgY2FuJ3QgaGF2ZSBpbmxpbmUgaGFuZGxlcnMKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gQ2FsbGVyIGNhbiBwYXNzIGluIGFuIEV2ZW50LCBPYmplY3QsIG9yIGp1c3QgYW4gZXZlbnQgdHlwZSBzdHJpbmcKCgogICAgICBldmVudCA9IF90eXBlb2YoZXZlbnQpID09PSAib2JqZWN0IiA/IC8vIGpRdWVyeS5FdmVudCBvYmplY3QKICAgICAgZXZlbnRbalF1ZXJ5LmV4cGFuZG9dID8gZXZlbnQgOiAvLyBPYmplY3QgbGl0ZXJhbAogICAgICBuZXcgalF1ZXJ5LkV2ZW50KHR5cGUsIGV2ZW50KSA6IC8vIEp1c3QgdGhlIGV2ZW50IHR5cGUgKHN0cmluZykKICAgICAgbmV3IGpRdWVyeS5FdmVudCh0eXBlKTsKICAgICAgZXZlbnQudHlwZSA9IHR5cGU7CiAgICAgIGV2ZW50LmlzVHJpZ2dlciA9IHRydWU7CiAgICAgIGV2ZW50LmV4Y2x1c2l2ZSA9IGV4Y2x1c2l2ZTsKICAgICAgZXZlbnQubmFtZXNwYWNlID0gbmFtZXNwYWNlcy5qb2luKCIuIik7CiAgICAgIGV2ZW50Lm5hbWVzcGFjZV9yZSA9IGV2ZW50Lm5hbWVzcGFjZSA/IG5ldyBSZWdFeHAoIihefFxcLikiICsgbmFtZXNwYWNlcy5qb2luKCJcXC4oPzouKlxcLik/IikgKyAiKFxcLnwkKSIpIDogbnVsbDsKICAgICAgb250eXBlID0gdHlwZS5pbmRleE9mKCI6IikgPCAwID8gIm9uIiArIHR5cGUgOiAiIjsgLy8gSGFuZGxlIGEgZ2xvYmFsIHRyaWdnZXIKCiAgICAgIGlmICghZWxlbSkgewogICAgICAgIC8vIFRPRE86IFN0b3AgdGF1bnRpbmcgdGhlIGRhdGEgY2FjaGU7IHJlbW92ZSBnbG9iYWwgZXZlbnRzIGFuZCBhbHdheXMgYXR0YWNoIHRvIGRvY3VtZW50CiAgICAgICAgY2FjaGUgPSBqUXVlcnkuY2FjaGU7CgogICAgICAgIGZvciAoaSBpbiBjYWNoZSkgewogICAgICAgICAgaWYgKGNhY2hlW2ldLmV2ZW50cyAmJiBjYWNoZVtpXS5ldmVudHNbdHlwZV0pIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoZXZlbnQsIGRhdGEsIGNhY2hlW2ldLmhhbmRsZS5lbGVtLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGVhbiB1cCB0aGUgZXZlbnQgaW4gY2FzZSBpdCBpcyBiZWluZyByZXVzZWQKCgogICAgICBldmVudC5yZXN1bHQgPSB1bmRlZmluZWQ7CgogICAgICBpZiAoIWV2ZW50LnRhcmdldCkgewogICAgICAgIGV2ZW50LnRhcmdldCA9IGVsZW07CiAgICAgIH0gLy8gQ2xvbmUgYW55IGluY29taW5nIGRhdGEgYW5kIHByZXBlbmQgdGhlIGV2ZW50LCBjcmVhdGluZyB0aGUgaGFuZGxlciBhcmcgbGlzdAoKCiAgICAgIGRhdGEgPSBkYXRhICE9IG51bGwgPyBqUXVlcnkubWFrZUFycmF5KGRhdGEpIDogW107CiAgICAgIGRhdGEudW5zaGlmdChldmVudCk7IC8vIEFsbG93IHNwZWNpYWwgZXZlbnRzIHRvIGRyYXcgb3V0c2lkZSB0aGUgbGluZXMKCiAgICAgIHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFt0eXBlXSB8fCB7fTsKCiAgICAgIGlmIChzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmlnZ2VyLmFwcGx5KGVsZW0sIGRhdGEpID09PSBmYWxzZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBEZXRlcm1pbmUgZXZlbnQgcHJvcGFnYXRpb24gcGF0aCBpbiBhZHZhbmNlLCBwZXIgVzNDIGV2ZW50cyBzcGVjICgjOTk1MSkKICAgICAgLy8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNCkKCgogICAgICBldmVudFBhdGggPSBbW2VsZW0sIHNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZV1dOwoKICAgICAgaWYgKCFvbmx5SGFuZGxlcnMgJiYgIXNwZWNpYWwubm9CdWJibGUgJiYgIWpRdWVyeS5pc1dpbmRvdyhlbGVtKSkgewogICAgICAgIGJ1YmJsZVR5cGUgPSBzcGVjaWFsLmRlbGVnYXRlVHlwZSB8fCB0eXBlOwogICAgICAgIGN1ciA9IHJmb2N1c01vcnBoLnRlc3QoYnViYmxlVHlwZSArIHR5cGUpID8gZWxlbSA6IGVsZW0ucGFyZW50Tm9kZTsKICAgICAgICBvbGQgPSBudWxsOwoKICAgICAgICBmb3IgKDsgY3VyOyBjdXIgPSBjdXIucGFyZW50Tm9kZSkgewogICAgICAgICAgZXZlbnRQYXRoLnB1c2goW2N1ciwgYnViYmxlVHlwZV0pOwogICAgICAgICAgb2xkID0gY3VyOwogICAgICAgIH0gLy8gT25seSBhZGQgd2luZG93IGlmIHdlIGdvdCB0byBkb2N1bWVudCAoZS5nLiwgbm90IHBsYWluIG9iaiBvciBkZXRhY2hlZCBET00pCgoKICAgICAgICBpZiAob2xkICYmIG9sZCA9PT0gZWxlbS5vd25lckRvY3VtZW50KSB7CiAgICAgICAgICBldmVudFBhdGgucHVzaChbb2xkLmRlZmF1bHRWaWV3IHx8IG9sZC5wYXJlbnRXaW5kb3cgfHwgd2luZG93LCBidWJibGVUeXBlXSk7CiAgICAgICAgfQogICAgICB9IC8vIEZpcmUgaGFuZGxlcnMgb24gdGhlIGV2ZW50IHBhdGgKCgogICAgICBmb3IgKGkgPSAwOyBpIDwgZXZlbnRQYXRoLmxlbmd0aCAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKTsgaSsrKSB7CiAgICAgICAgY3VyID0gZXZlbnRQYXRoW2ldWzBdOwogICAgICAgIGV2ZW50LnR5cGUgPSBldmVudFBhdGhbaV1bMV07CiAgICAgICAgaGFuZGxlID0gKGpRdWVyeS5fZGF0YShjdXIsICJldmVudHMiKSB8fCB7fSlbZXZlbnQudHlwZV0gJiYgalF1ZXJ5Ll9kYXRhKGN1ciwgImhhbmRsZSIpOwoKICAgICAgICBpZiAoaGFuZGxlKSB7CiAgICAgICAgICBoYW5kbGUuYXBwbHkoY3VyLCBkYXRhKTsKICAgICAgICB9IC8vIE5vdGUgdGhhdCB0aGlzIGlzIGEgYmFyZSBKUyBmdW5jdGlvbiBhbmQgbm90IGEgalF1ZXJ5IGhhbmRsZXIKCgogICAgICAgIGhhbmRsZSA9IG9udHlwZSAmJiBjdXJbb250eXBlXTsKCiAgICAgICAgaWYgKGhhbmRsZSAmJiBqUXVlcnkuYWNjZXB0RGF0YShjdXIpICYmIGhhbmRsZS5hcHBseShjdXIsIGRhdGEpID09PSBmYWxzZSkgewogICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGV2ZW50LnR5cGUgPSB0eXBlOyAvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93CgogICAgICBpZiAoIW9ubHlIYW5kbGVycyAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHsKICAgICAgICBpZiAoKCFzcGVjaWFsLl9kZWZhdWx0IHx8IHNwZWNpYWwuX2RlZmF1bHQuYXBwbHkoZWxlbS5vd25lckRvY3VtZW50LCBkYXRhKSA9PT0gZmFsc2UpICYmICEodHlwZSA9PT0gImNsaWNrIiAmJiBqUXVlcnkubm9kZU5hbWUoZWxlbSwgImEiKSkgJiYgalF1ZXJ5LmFjY2VwdERhdGEoZWxlbSkpIHsKICAgICAgICAgIC8vIENhbGwgYSBuYXRpdmUgRE9NIG1ldGhvZCBvbiB0aGUgdGFyZ2V0IHdpdGggdGhlIHNhbWUgbmFtZSBuYW1lIGFzIHRoZSBldmVudC4KICAgICAgICAgIC8vIENhbid0IHVzZSBhbiAuaXNGdW5jdGlvbigpIGNoZWNrIGhlcmUgYmVjYXVzZSBJRTYvNyBmYWlscyB0aGF0IHRlc3QuCiAgICAgICAgICAvLyBEb24ndCBkbyBkZWZhdWx0IGFjdGlvbnMgb24gd2luZG93LCB0aGF0J3Mgd2hlcmUgZ2xvYmFsIHZhcmlhYmxlcyBiZSAoIzYxNzApCiAgICAgICAgICAvLyBJRTw5IGRpZXMgb24gZm9jdXMvYmx1ciB0byBoaWRkZW4gZWxlbWVudCAoIzE0ODYpCiAgICAgICAgICBpZiAob250eXBlICYmIGVsZW1bdHlwZV0gJiYgKHR5cGUgIT09ICJmb2N1cyIgJiYgdHlwZSAhPT0gImJsdXIiIHx8IGV2ZW50LnRhcmdldC5vZmZzZXRXaWR0aCAhPT0gMCkgJiYgIWpRdWVyeS5pc1dpbmRvdyhlbGVtKSkgewogICAgICAgICAgICAvLyBEb24ndCByZS10cmlnZ2VyIGFuIG9uRk9PIGV2ZW50IHdoZW4gd2UgY2FsbCBpdHMgRk9PKCkgbWV0aG9kCiAgICAgICAgICAgIG9sZCA9IGVsZW1bb250eXBlXTsKCiAgICAgICAgICAgIGlmIChvbGQpIHsKICAgICAgICAgICAgICBlbGVtW29udHlwZV0gPSBudWxsOwogICAgICAgICAgICB9IC8vIFByZXZlbnQgcmUtdHJpZ2dlcmluZyBvZiB0aGUgc2FtZSBldmVudCwgc2luY2Ugd2UgYWxyZWFkeSBidWJibGVkIGl0IGFib3ZlCgoKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHR5cGU7CiAgICAgICAgICAgIGVsZW1bdHlwZV0oKTsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHVuZGVmaW5lZDsKCiAgICAgICAgICAgIGlmIChvbGQpIHsKICAgICAgICAgICAgICBlbGVtW29udHlwZV0gPSBvbGQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBldmVudC5yZXN1bHQ7CiAgICB9LAogICAgZGlzcGF0Y2g6IGZ1bmN0aW9uIGRpc3BhdGNoKGV2ZW50KSB7CiAgICAgIC8vIE1ha2UgYSB3cml0YWJsZSBqUXVlcnkuRXZlbnQgZnJvbSB0aGUgbmF0aXZlIGV2ZW50IG9iamVjdAogICAgICBldmVudCA9IGpRdWVyeS5ldmVudC5maXgoZXZlbnQgfHwgd2luZG93LmV2ZW50KTsKICAgICAgdmFyIGhhbmRsZXJzID0gKGpRdWVyeS5fZGF0YSh0aGlzLCAiZXZlbnRzIikgfHwge30pW2V2ZW50LnR5cGVdIHx8IFtdLAogICAgICAgICAgZGVsZWdhdGVDb3VudCA9IGhhbmRsZXJzLmRlbGVnYXRlQ291bnQsCiAgICAgICAgICBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDApLAogICAgICAgICAgcnVuX2FsbCA9ICFldmVudC5leGNsdXNpdmUgJiYgIWV2ZW50Lm5hbWVzcGFjZSwKICAgICAgICAgIHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFtldmVudC50eXBlXSB8fCB7fSwKICAgICAgICAgIGhhbmRsZXJRdWV1ZSA9IFtdLAogICAgICAgICAgaSwKICAgICAgICAgIGosCiAgICAgICAgICBjdXIsCiAgICAgICAgICBqcWN1ciwKICAgICAgICAgIHJldCwKICAgICAgICAgIHNlbE1hdGNoLAogICAgICAgICAgbWF0Y2hlZCwKICAgICAgICAgIG1hdGNoZXMsCiAgICAgICAgICBoYW5kbGVPYmosCiAgICAgICAgICBzZWwsCiAgICAgICAgICByZWxhdGVkOyAvLyBVc2UgdGhlIGZpeC1lZCBqUXVlcnkuRXZlbnQgcmF0aGVyIHRoYW4gdGhlIChyZWFkLW9ubHkpIG5hdGl2ZSBldmVudAoKICAgICAgYXJnc1swXSA9IGV2ZW50OwogICAgICBldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7IC8vIENhbGwgdGhlIHByZURpc3BhdGNoIGhvb2sgZm9yIHRoZSBtYXBwZWQgdHlwZSwgYW5kIGxldCBpdCBiYWlsIGlmIGRlc2lyZWQKCiAgICAgIGlmIChzcGVjaWFsLnByZURpc3BhdGNoICYmIHNwZWNpYWwucHJlRGlzcGF0Y2guY2FsbCh0aGlzLCBldmVudCkgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIERldGVybWluZSBoYW5kbGVycyB0aGF0IHNob3VsZCBydW4gaWYgdGhlcmUgYXJlIGRlbGVnYXRlZCBldmVudHMKICAgICAgLy8gQXZvaWQgbm9uLWxlZnQtY2xpY2sgYnViYmxpbmcgaW4gRmlyZWZveCAoIzM4NjEpCgoKICAgICAgaWYgKGRlbGVnYXRlQ291bnQgJiYgIShldmVudC5idXR0b24gJiYgZXZlbnQudHlwZSA9PT0gImNsaWNrIikpIHsKICAgICAgICAvLyBQcmVnZW5lcmF0ZSBhIHNpbmdsZSBqUXVlcnkgb2JqZWN0IGZvciByZXVzZSB3aXRoIC5pcygpCiAgICAgICAganFjdXIgPSBqUXVlcnkodGhpcyk7CiAgICAgICAganFjdXIuY29udGV4dCA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzOwoKICAgICAgICBmb3IgKGN1ciA9IGV2ZW50LnRhcmdldDsgY3VyICE9IHRoaXM7IGN1ciA9IGN1ci5wYXJlbnROb2RlIHx8IHRoaXMpIHsKICAgICAgICAgIC8vIERvbid0IHByb2Nlc3MgZXZlbnRzIG9uIGRpc2FibGVkIGVsZW1lbnRzICgjNjkxMSwgIzgxNjUpCiAgICAgICAgICBpZiAoY3VyLmRpc2FibGVkICE9PSB0cnVlKSB7CiAgICAgICAgICAgIHNlbE1hdGNoID0ge307CiAgICAgICAgICAgIG1hdGNoZXMgPSBbXTsKICAgICAgICAgICAganFjdXJbMF0gPSBjdXI7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZGVsZWdhdGVDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaGFuZGxlT2JqID0gaGFuZGxlcnNbaV07CiAgICAgICAgICAgICAgc2VsID0gaGFuZGxlT2JqLnNlbGVjdG9yOwoKICAgICAgICAgICAgICBpZiAoc2VsTWF0Y2hbc2VsXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBzZWxNYXRjaFtzZWxdID0gaGFuZGxlT2JqLnF1aWNrID8gcXVpY2tJcyhjdXIsIGhhbmRsZU9iai5xdWljaykgOiBqcWN1ci5pcyhzZWwpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHNlbE1hdGNoW3NlbF0pIHsKICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaChoYW5kbGVPYmopOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgaGFuZGxlclF1ZXVlLnB1c2goewogICAgICAgICAgICAgICAgZWxlbTogY3VyLAogICAgICAgICAgICAgICAgbWF0Y2hlczogbWF0Y2hlcwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIEFkZCB0aGUgcmVtYWluaW5nIChkaXJlY3RseS1ib3VuZCkgaGFuZGxlcnMKCgogICAgICBpZiAoaGFuZGxlcnMubGVuZ3RoID4gZGVsZWdhdGVDb3VudCkgewogICAgICAgIGhhbmRsZXJRdWV1ZS5wdXNoKHsKICAgICAgICAgIGVsZW06IHRoaXMsCiAgICAgICAgICBtYXRjaGVzOiBoYW5kbGVycy5zbGljZShkZWxlZ2F0ZUNvdW50KQogICAgICAgIH0pOwogICAgICB9IC8vIFJ1biBkZWxlZ2F0ZXMgZmlyc3Q7IHRoZXkgbWF5IHdhbnQgdG8gc3RvcCBwcm9wYWdhdGlvbiBiZW5lYXRoIHVzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IGhhbmRsZXJRdWV1ZS5sZW5ndGggJiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCk7IGkrKykgewogICAgICAgIG1hdGNoZWQgPSBoYW5kbGVyUXVldWVbaV07CiAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldCA9IG1hdGNoZWQuZWxlbTsKCiAgICAgICAgZm9yIChqID0gMDsgaiA8IG1hdGNoZWQubWF0Y2hlcy5sZW5ndGggJiYgIWV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCk7IGorKykgewogICAgICAgICAgaGFuZGxlT2JqID0gbWF0Y2hlZC5tYXRjaGVzW2pdOyAvLyBUcmlnZ2VyZWQgZXZlbnQgbXVzdCBlaXRoZXIgMSkgYmUgbm9uLWV4Y2x1c2l2ZSBhbmQgaGF2ZSBubyBuYW1lc3BhY2UsIG9yCiAgICAgICAgICAvLyAyKSBoYXZlIG5hbWVzcGFjZShzKSBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBpbiB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS4KCiAgICAgICAgICBpZiAocnVuX2FsbCB8fCAhZXZlbnQubmFtZXNwYWNlICYmICFoYW5kbGVPYmoubmFtZXNwYWNlIHx8IGV2ZW50Lm5hbWVzcGFjZV9yZSAmJiBldmVudC5uYW1lc3BhY2VfcmUudGVzdChoYW5kbGVPYmoubmFtZXNwYWNlKSkgewogICAgICAgICAgICBldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7CiAgICAgICAgICAgIGV2ZW50LmhhbmRsZU9iaiA9IGhhbmRsZU9iajsKICAgICAgICAgICAgcmV0ID0gKChqUXVlcnkuZXZlbnQuc3BlY2lhbFtoYW5kbGVPYmoub3JpZ1R5cGVdIHx8IHt9KS5oYW5kbGUgfHwgaGFuZGxlT2JqLmhhbmRsZXIpLmFwcGx5KG1hdGNoZWQuZWxlbSwgYXJncyk7CgogICAgICAgICAgICBpZiAocmV0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBldmVudC5yZXN1bHQgPSByZXQ7CgogICAgICAgICAgICAgIGlmIChyZXQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENhbGwgdGhlIHBvc3REaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUKCgogICAgICBpZiAoc3BlY2lhbC5wb3N0RGlzcGF0Y2gpIHsKICAgICAgICBzcGVjaWFsLnBvc3REaXNwYXRjaC5jYWxsKHRoaXMsIGV2ZW50KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGV2ZW50LnJlc3VsdDsKICAgIH0sCiAgICAvLyBJbmNsdWRlcyBzb21lIGV2ZW50IHByb3BzIHNoYXJlZCBieSBLZXlFdmVudCBhbmQgTW91c2VFdmVudAogICAgLy8gKioqIGF0dHJDaGFuZ2UgYXR0ck5hbWUgcmVsYXRlZE5vZGUgc3JjRWxlbWVudCAgYXJlIG5vdCBub3JtYWxpemVkLCBub24tVzNDLCBkZXByZWNhdGVkLCB3aWxsIGJlIHJlbW92ZWQgaW4gMS44ICoqKgogICAgcHJvcHM6ICJhdHRyQ2hhbmdlIGF0dHJOYW1lIHJlbGF0ZWROb2RlIHNyY0VsZW1lbnQgYWx0S2V5IGJ1YmJsZXMgY2FuY2VsYWJsZSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZXZlbnRQaGFzZSBtZXRhS2V5IHJlbGF0ZWRUYXJnZXQgc2hpZnRLZXkgdGFyZ2V0IHRpbWVTdGFtcCB2aWV3IHdoaWNoIi5zcGxpdCgiICIpLAogICAgZml4SG9va3M6IHt9LAogICAga2V5SG9va3M6IHsKICAgICAgcHJvcHM6ICJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLAogICAgICBmaWx0ZXI6IGZ1bmN0aW9uIGZpbHRlcihldmVudCwgb3JpZ2luYWwpIHsKICAgICAgICAvLyBBZGQgd2hpY2ggZm9yIGtleSBldmVudHMKICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT0gbnVsbCkgewogICAgICAgICAgZXZlbnQud2hpY2ggPSBvcmlnaW5hbC5jaGFyQ29kZSAhPSBudWxsID8gb3JpZ2luYWwuY2hhckNvZGUgOiBvcmlnaW5hbC5rZXlDb2RlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGV2ZW50OwogICAgICB9CiAgICB9LAogICAgbW91c2VIb29rczogewogICAgICBwcm9wczogImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBmcm9tRWxlbWVudCBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSwKICAgICAgZmlsdGVyOiBmdW5jdGlvbiBmaWx0ZXIoZXZlbnQsIG9yaWdpbmFsKSB7CiAgICAgICAgdmFyIGV2ZW50RG9jLAogICAgICAgICAgICBkb2MsCiAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgIGJ1dHRvbiA9IG9yaWdpbmFsLmJ1dHRvbiwKICAgICAgICAgICAgZnJvbUVsZW1lbnQgPSBvcmlnaW5hbC5mcm9tRWxlbWVudDsgLy8gQ2FsY3VsYXRlIHBhZ2VYL1kgaWYgbWlzc2luZyBhbmQgY2xpZW50WC9ZIGF2YWlsYWJsZQoKICAgICAgICBpZiAoZXZlbnQucGFnZVggPT0gbnVsbCAmJiBvcmlnaW5hbC5jbGllbnRYICE9IG51bGwpIHsKICAgICAgICAgIGV2ZW50RG9jID0gZXZlbnQudGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CiAgICAgICAgICBkb2MgPSBldmVudERvYy5kb2N1bWVudEVsZW1lbnQ7CiAgICAgICAgICBib2R5ID0gZXZlbnREb2MuYm9keTsKICAgICAgICAgIGV2ZW50LnBhZ2VYID0gb3JpZ2luYWwuY2xpZW50WCArIChkb2MgJiYgZG9jLnNjcm9sbExlZnQgfHwgYm9keSAmJiBib2R5LnNjcm9sbExlZnQgfHwgMCkgLSAoZG9jICYmIGRvYy5jbGllbnRMZWZ0IHx8IGJvZHkgJiYgYm9keS5jbGllbnRMZWZ0IHx8IDApOwogICAgICAgICAgZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsgKGRvYyAmJiBkb2Muc2Nyb2xsVG9wIHx8IGJvZHkgJiYgYm9keS5zY3JvbGxUb3AgfHwgMCkgLSAoZG9jICYmIGRvYy5jbGllbnRUb3AgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCB8fCAwKTsKICAgICAgICB9IC8vIEFkZCByZWxhdGVkVGFyZ2V0LCBpZiBuZWNlc3NhcnkKCgogICAgICAgIGlmICghZXZlbnQucmVsYXRlZFRhcmdldCAmJiBmcm9tRWxlbWVudCkgewogICAgICAgICAgZXZlbnQucmVsYXRlZFRhcmdldCA9IGZyb21FbGVtZW50ID09PSBldmVudC50YXJnZXQgPyBvcmlnaW5hbC50b0VsZW1lbnQgOiBmcm9tRWxlbWVudDsKICAgICAgICB9IC8vIEFkZCB3aGljaCBmb3IgY2xpY2s6IDEgPT09IGxlZnQ7IDIgPT09IG1pZGRsZTsgMyA9PT0gcmlnaHQKICAgICAgICAvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdAoKCiAgICAgICAgaWYgKCFldmVudC53aGljaCAmJiBidXR0b24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZXZlbnQud2hpY2ggPSBidXR0b24gJiAxID8gMSA6IGJ1dHRvbiAmIDIgPyAzIDogYnV0dG9uICYgNCA/IDIgOiAwOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGV2ZW50OwogICAgICB9CiAgICB9LAogICAgZml4OiBmdW5jdGlvbiBmaXgoZXZlbnQpIHsKICAgICAgaWYgKGV2ZW50W2pRdWVyeS5leHBhbmRvXSkgewogICAgICAgIHJldHVybiBldmVudDsKICAgICAgfSAvLyBDcmVhdGUgYSB3cml0YWJsZSBjb3B5IG9mIHRoZSBldmVudCBvYmplY3QgYW5kIG5vcm1hbGl6ZSBzb21lIHByb3BlcnRpZXMKCgogICAgICB2YXIgaSwKICAgICAgICAgIHByb3AsCiAgICAgICAgICBvcmlnaW5hbEV2ZW50ID0gZXZlbnQsCiAgICAgICAgICBmaXhIb29rID0galF1ZXJ5LmV2ZW50LmZpeEhvb2tzW2V2ZW50LnR5cGVdIHx8IHt9LAogICAgICAgICAgY29weSA9IGZpeEhvb2sucHJvcHMgPyB0aGlzLnByb3BzLmNvbmNhdChmaXhIb29rLnByb3BzKSA6IHRoaXMucHJvcHM7CiAgICAgIGV2ZW50ID0galF1ZXJ5LkV2ZW50KG9yaWdpbmFsRXZlbnQpOwoKICAgICAgZm9yIChpID0gY29weS5sZW5ndGg7IGk7KSB7CiAgICAgICAgcHJvcCA9IGNvcHlbLS1pXTsKICAgICAgICBldmVudFtwcm9wXSA9IG9yaWdpbmFsRXZlbnRbcHJvcF07CiAgICAgIH0gLy8gRml4IHRhcmdldCBwcm9wZXJ0eSwgaWYgbmVjZXNzYXJ5ICgjMTkyNSwgSUUgNi83LzggJiBTYWZhcmkyKQoKCiAgICAgIGlmICghZXZlbnQudGFyZ2V0KSB7CiAgICAgICAgZXZlbnQudGFyZ2V0ID0gb3JpZ2luYWxFdmVudC5zcmNFbGVtZW50IHx8IGRvY3VtZW50OwogICAgICB9IC8vIFRhcmdldCBzaG91bGQgbm90IGJlIGEgdGV4dCBub2RlICgjNTA0LCBTYWZhcmkpCgoKICAgICAgaWYgKGV2ZW50LnRhcmdldC5ub2RlVHlwZSA9PT0gMykgewogICAgICAgIGV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlOwogICAgICB9IC8vIEZvciBtb3VzZS9rZXkgZXZlbnRzOyBhZGQgbWV0YUtleSBpZiBpdCdzIG5vdCB0aGVyZSAoIzMzNjgsIElFNi83LzgpCgoKICAgICAgaWYgKGV2ZW50Lm1ldGFLZXkgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGV2ZW50Lm1ldGFLZXkgPSBldmVudC5jdHJsS2V5OwogICAgICB9CgogICAgICByZXR1cm4gZml4SG9vay5maWx0ZXIgPyBmaXhIb29rLmZpbHRlcihldmVudCwgb3JpZ2luYWxFdmVudCkgOiBldmVudDsKICAgIH0sCiAgICBzcGVjaWFsOiB7CiAgICAgIHJlYWR5OiB7CiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSByZWFkeSBldmVudCBpcyBzZXR1cAogICAgICAgIHNldHVwOiBqUXVlcnkuYmluZFJlYWR5CiAgICAgIH0sCiAgICAgIGxvYWQ6IHsKICAgICAgICAvLyBQcmV2ZW50IHRyaWdnZXJlZCBpbWFnZS5sb2FkIGV2ZW50cyBmcm9tIGJ1YmJsaW5nIHRvIHdpbmRvdy5sb2FkCiAgICAgICAgbm9CdWJibGU6IHRydWUKICAgICAgfSwKICAgICAgZm9jdXM6IHsKICAgICAgICBkZWxlZ2F0ZVR5cGU6ICJmb2N1c2luIgogICAgICB9LAogICAgICBibHVyOiB7CiAgICAgICAgZGVsZWdhdGVUeXBlOiAiZm9jdXNvdXQiCiAgICAgIH0sCiAgICAgIGJlZm9yZXVubG9hZDogewogICAgICAgIHNldHVwOiBmdW5jdGlvbiBzZXR1cChkYXRhLCBuYW1lc3BhY2VzLCBldmVudEhhbmRsZSkgewogICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIGRvIHRoaXMgc3BlY2lhbCBjYXNlIG9uIHdpbmRvd3MKICAgICAgICAgIGlmIChqUXVlcnkuaXNXaW5kb3codGhpcykpIHsKICAgICAgICAgICAgdGhpcy5vbmJlZm9yZXVubG9hZCA9IGV2ZW50SGFuZGxlOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdGVhcmRvd246IGZ1bmN0aW9uIHRlYXJkb3duKG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlKSB7CiAgICAgICAgICBpZiAodGhpcy5vbmJlZm9yZXVubG9hZCA9PT0gZXZlbnRIYW5kbGUpIHsKICAgICAgICAgICAgdGhpcy5vbmJlZm9yZXVubG9hZCA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2ltdWxhdGU6IGZ1bmN0aW9uIHNpbXVsYXRlKHR5cGUsIGVsZW0sIGV2ZW50LCBidWJibGUpIHsKICAgICAgLy8gUGlnZ3liYWNrIG9uIGEgZG9ub3IgZXZlbnQgdG8gc2ltdWxhdGUgYSBkaWZmZXJlbnQgb25lLgogICAgICAvLyBGYWtlIG9yaWdpbmFsRXZlbnQgdG8gYXZvaWQgZG9ub3IncyBzdG9wUHJvcGFnYXRpb24sIGJ1dCBpZiB0aGUKICAgICAgLy8gc2ltdWxhdGVkIGV2ZW50IHByZXZlbnRzIGRlZmF1bHQgdGhlbiB3ZSBkbyB0aGUgc2FtZSBvbiB0aGUgZG9ub3IuCiAgICAgIHZhciBlID0galF1ZXJ5LmV4dGVuZChuZXcgalF1ZXJ5LkV2ZW50KCksIGV2ZW50LCB7CiAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICBpc1NpbXVsYXRlZDogdHJ1ZSwKICAgICAgICBvcmlnaW5hbEV2ZW50OiB7fQogICAgICB9KTsKCiAgICAgIGlmIChidWJibGUpIHsKICAgICAgICBqUXVlcnkuZXZlbnQudHJpZ2dlcihlLCBudWxsLCBlbGVtKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBqUXVlcnkuZXZlbnQuZGlzcGF0Y2guY2FsbChlbGVtLCBlKTsKICAgICAgfQoKICAgICAgaWYgKGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9CiAgICB9CiAgfTsgLy8gU29tZSBwbHVnaW5zIGFyZSB1c2luZywgYnV0IGl0J3MgdW5kb2N1bWVudGVkL2RlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZC4KICAvLyBUaGUgMS43IHNwZWNpYWwgZXZlbnQgaW50ZXJmYWNlIHNob3VsZCBwcm92aWRlIGFsbCB0aGUgaG9va3MgbmVlZGVkIG5vdy4KCiAgalF1ZXJ5LmV2ZW50LmhhbmRsZSA9IGpRdWVyeS5ldmVudC5kaXNwYXRjaDsKICBqUXVlcnkucmVtb3ZlRXZlbnQgPSBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyID8gZnVuY3Rpb24gKGVsZW0sIHR5cGUsIGhhbmRsZSkgewogICAgaWYgKGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcikgewogICAgICBlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlLCBmYWxzZSk7CiAgICB9CiAgfSA6IGZ1bmN0aW9uIChlbGVtLCB0eXBlLCBoYW5kbGUpIHsKICAgIGlmIChlbGVtLmRldGFjaEV2ZW50KSB7CiAgICAgIGVsZW0uZGV0YWNoRXZlbnQoIm9uIiArIHR5cGUsIGhhbmRsZSk7CiAgICB9CiAgfTsKCiAgalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24gKHNyYywgcHJvcHMpIHsKICAgIC8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCB0aGUgJ25ldycga2V5d29yZAogICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIGpRdWVyeS5FdmVudCkpIHsKICAgICAgcmV0dXJuIG5ldyBqUXVlcnkuRXZlbnQoc3JjLCBwcm9wcyk7CiAgICB9IC8vIEV2ZW50IG9iamVjdAoKCiAgICBpZiAoc3JjICYmIHNyYy50eXBlKSB7CiAgICAgIHRoaXMub3JpZ2luYWxFdmVudCA9IHNyYzsKICAgICAgdGhpcy50eXBlID0gc3JjLnR5cGU7IC8vIEV2ZW50cyBidWJibGluZyB1cCB0aGUgZG9jdW1lbnQgbWF5IGhhdmUgYmVlbiBtYXJrZWQgYXMgcHJldmVudGVkCiAgICAgIC8vIGJ5IGEgaGFuZGxlciBsb3dlciBkb3duIHRoZSB0cmVlOyByZWZsZWN0IHRoZSBjb3JyZWN0IHZhbHVlLgoKICAgICAgdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fCBzcmMucmV0dXJuVmFsdWUgPT09IGZhbHNlIHx8IHNyYy5nZXRQcmV2ZW50RGVmYXVsdCAmJiBzcmMuZ2V0UHJldmVudERlZmF1bHQoKSA/IHJldHVyblRydWUgOiByZXR1cm5GYWxzZTsgLy8gRXZlbnQgdHlwZQogICAgfSBlbHNlIHsKICAgICAgdGhpcy50eXBlID0gc3JjOwogICAgfSAvLyBQdXQgZXhwbGljaXRseSBwcm92aWRlZCBwcm9wZXJ0aWVzIG9udG8gdGhlIGV2ZW50IG9iamVjdAoKCiAgICBpZiAocHJvcHMpIHsKICAgICAgalF1ZXJ5LmV4dGVuZCh0aGlzLCBwcm9wcyk7CiAgICB9IC8vIENyZWF0ZSBhIHRpbWVzdGFtcCBpZiBpbmNvbWluZyBldmVudCBkb2Vzbid0IGhhdmUgb25lCgoKICAgIHRoaXMudGltZVN0YW1wID0gc3JjICYmIHNyYy50aW1lU3RhbXAgfHwgalF1ZXJ5Lm5vdygpOyAvLyBNYXJrIGl0IGFzIGZpeGVkCgogICAgdGhpc1tqUXVlcnkuZXhwYW5kb10gPSB0cnVlOwogIH07CgogIGZ1bmN0aW9uIHJldHVybkZhbHNlKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0gLy8galF1ZXJ5LkV2ZW50IGlzIGJhc2VkIG9uIERPTTMgRXZlbnRzIGFzIHNwZWNpZmllZCBieSB0aGUgRUNNQVNjcmlwdCBMYW5ndWFnZSBCaW5kaW5nCiAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMy9XRC1ET00tTGV2ZWwtMy1FdmVudHMtMjAwMzAzMzEvZWNtYS1zY3JpcHQtYmluZGluZy5odG1sCgoKICBqUXVlcnkuRXZlbnQucHJvdG90eXBlID0gewogICAgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KCkgewogICAgICB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IHJldHVyblRydWU7CiAgICAgIHZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OwoKICAgICAgaWYgKCFlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIGlmIHByZXZlbnREZWZhdWx0IGV4aXN0cyBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgoKICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIG90aGVyd2lzZSBzZXQgdGhlIHJldHVyblZhbHVlIHByb3BlcnR5IG9mIHRoZSBvcmlnaW5hbCBldmVudCB0byBmYWxzZSAoSUUpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgc3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24oKSB7CiAgICAgIHRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwogICAgICB2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCiAgICAgIGlmICghZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBpZiBzdG9wUHJvcGFnYXRpb24gZXhpc3RzIHJ1biBpdCBvbiB0aGUgb3JpZ2luYWwgZXZlbnQKCgogICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9IC8vIG90aGVyd2lzZSBzZXQgdGhlIGNhbmNlbEJ1YmJsZSBwcm9wZXJ0eSBvZiB0aGUgb3JpZ2luYWwgZXZlbnQgdG8gdHJ1ZSAoSUUpCgoKICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlOwogICAgfSwKICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24gc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkgewogICAgICB0aGlzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTsKICAgICAgdGhpcy5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0sCiAgICBpc0RlZmF1bHRQcmV2ZW50ZWQ6IHJldHVybkZhbHNlLAogICAgaXNQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLAogICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlCiAgfTsgLy8gQ3JlYXRlIG1vdXNlZW50ZXIvbGVhdmUgZXZlbnRzIHVzaW5nIG1vdXNlb3Zlci9vdXQgYW5kIGV2ZW50LXRpbWUgY2hlY2tzCgogIGpRdWVyeS5lYWNoKHsKICAgIG1vdXNlZW50ZXI6ICJtb3VzZW92ZXIiLAogICAgbW91c2VsZWF2ZTogIm1vdXNlb3V0IgogIH0sIGZ1bmN0aW9uIChvcmlnLCBmaXgpIHsKICAgIGpRdWVyeS5ldmVudC5zcGVjaWFsW29yaWddID0gewogICAgICBkZWxlZ2F0ZVR5cGU6IGZpeCwKICAgICAgYmluZFR5cGU6IGZpeCwKICAgICAgaGFuZGxlOiBmdW5jdGlvbiBoYW5kbGUoZXZlbnQpIHsKICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcywKICAgICAgICAgICAgcmVsYXRlZCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQsCiAgICAgICAgICAgIGhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iaiwKICAgICAgICAgICAgc2VsZWN0b3IgPSBoYW5kbGVPYmouc2VsZWN0b3IsCiAgICAgICAgICAgIHJldDsgLy8gRm9yIG1vdXNlbnRlci9sZWF2ZSBjYWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0LgogICAgICAgIC8vIE5COiBObyByZWxhdGVkVGFyZ2V0IGlmIHRoZSBtb3VzZSBsZWZ0L2VudGVyZWQgdGhlIGJyb3dzZXIgd2luZG93CgogICAgICAgIGlmICghcmVsYXRlZCB8fCByZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyh0YXJnZXQsIHJlbGF0ZWQpKSB7CiAgICAgICAgICBldmVudC50eXBlID0gaGFuZGxlT2JqLm9yaWdUeXBlOwogICAgICAgICAgcmV0ID0gaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIGV2ZW50LnR5cGUgPSBmaXg7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0OwogICAgICB9CiAgICB9OwogIH0pOyAvLyBJRSBzdWJtaXQgZGVsZWdhdGlvbgoKICBpZiAoIWpRdWVyeS5zdXBwb3J0LnN1Ym1pdEJ1YmJsZXMpIHsKICAgIGpRdWVyeS5ldmVudC5zcGVjaWFsLnN1Ym1pdCA9IHsKICAgICAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKCkgewogICAgICAgIC8vIE9ubHkgbmVlZCB0aGlzIGZvciBkZWxlZ2F0ZWQgZm9ybSBzdWJtaXQgZXZlbnRzCiAgICAgICAgaWYgKGpRdWVyeS5ub2RlTmFtZSh0aGlzLCAiZm9ybSIpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSAvLyBMYXp5LWFkZCBhIHN1Ym1pdCBoYW5kbGVyIHdoZW4gYSBkZXNjZW5kYW50IGZvcm0gbWF5IHBvdGVudGlhbGx5IGJlIHN1Ym1pdHRlZAoKCiAgICAgICAgalF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCAiY2xpY2suX3N1Ym1pdCBrZXlwcmVzcy5fc3VibWl0IiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIC8vIE5vZGUgbmFtZSBjaGVjayBhdm9pZHMgYSBWTUwtcmVsYXRlZCBjcmFzaCBpbiBJRSAoIzk4MDcpCiAgICAgICAgICB2YXIgZWxlbSA9IGUudGFyZ2V0LAogICAgICAgICAgICAgIGZvcm0gPSBqUXVlcnkubm9kZU5hbWUoZWxlbSwgImlucHV0IikgfHwgalF1ZXJ5Lm5vZGVOYW1lKGVsZW0sICJidXR0b24iKSA/IGVsZW0uZm9ybSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICBpZiAoZm9ybSAmJiAhZm9ybS5fc3VibWl0X2F0dGFjaGVkKSB7CiAgICAgICAgICAgIGpRdWVyeS5ldmVudC5hZGQoZm9ybSwgInN1Ym1pdC5fc3VibWl0IiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgZXZlbnQuX3N1Ym1pdF9idWJibGUgPSB0cnVlOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZm9ybS5fc3VibWl0X2F0dGFjaGVkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsgLy8gcmV0dXJuIHVuZGVmaW5lZCBzaW5jZSB3ZSBkb24ndCBuZWVkIGFuIGV2ZW50IGxpc3RlbmVyCiAgICAgIH0sCiAgICAgIHBvc3REaXNwYXRjaDogZnVuY3Rpb24gcG9zdERpc3BhdGNoKGV2ZW50KSB7CiAgICAgICAgLy8gSWYgZm9ybSB3YXMgc3VibWl0dGVkIGJ5IHRoZSB1c2VyLCBidWJibGUgdGhlIGV2ZW50IHVwIHRoZSB0cmVlCiAgICAgICAgaWYgKGV2ZW50Ll9zdWJtaXRfYnViYmxlKSB7CiAgICAgICAgICBkZWxldGUgZXZlbnQuX3N1Ym1pdF9idWJibGU7CgogICAgICAgICAgaWYgKHRoaXMucGFyZW50Tm9kZSAmJiAhZXZlbnQuaXNUcmlnZ2VyKSB7CiAgICAgICAgICAgIGpRdWVyeS5ldmVudC5zaW11bGF0ZSgic3VibWl0IiwgdGhpcy5wYXJlbnROb2RlLCBldmVudCwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB0ZWFyZG93bjogZnVuY3Rpb24gdGVhcmRvd24oKSB7CiAgICAgICAgLy8gT25seSBuZWVkIHRoaXMgZm9yIGRlbGVnYXRlZCBmb3JtIHN1Ym1pdCBldmVudHMKICAgICAgICBpZiAoalF1ZXJ5Lm5vZGVOYW1lKHRoaXMsICJmb3JtIikpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IC8vIFJlbW92ZSBkZWxlZ2F0ZWQgaGFuZGxlcnM7IGNsZWFuRGF0YSBldmVudHVhbGx5IHJlYXBzIHN1Ym1pdCBoYW5kbGVycyBhdHRhY2hlZCBhYm92ZQoKCiAgICAgICAgalF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCAiLl9zdWJtaXQiKTsKICAgICAgfQogICAgfTsKICB9IC8vIElFIGNoYW5nZSBkZWxlZ2F0aW9uIGFuZCBjaGVja2JveC9yYWRpbyBmaXgKCgogIGlmICghalF1ZXJ5LnN1cHBvcnQuY2hhbmdlQnViYmxlcykgewogICAgalF1ZXJ5LmV2ZW50LnNwZWNpYWwuY2hhbmdlID0gewogICAgICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICAgICAgaWYgKHJmb3JtRWxlbXMudGVzdCh0aGlzLm5vZGVOYW1lKSkgewogICAgICAgICAgLy8gSUUgZG9lc24ndCBmaXJlIGNoYW5nZSBvbiBhIGNoZWNrL3JhZGlvIHVudGlsIGJsdXI7IHRyaWdnZXIgaXQgb24gY2xpY2sKICAgICAgICAgIC8vIGFmdGVyIGEgcHJvcGVydHljaGFuZ2UuIEVhdCB0aGUgYmx1ci1jaGFuZ2UgaW4gc3BlY2lhbC5jaGFuZ2UuaGFuZGxlLgogICAgICAgICAgLy8gVGhpcyBzdGlsbCBmaXJlcyBvbmNoYW5nZSBhIHNlY29uZCB0aW1lIGZvciBjaGVjay9yYWRpbyBhZnRlciBibHVyLgogICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiB8fCB0aGlzLnR5cGUgPT09ICJyYWRpbyIpIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCAicHJvcGVydHljaGFuZ2UuX2NoYW5nZSIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgIGlmIChldmVudC5vcmlnaW5hbEV2ZW50LnByb3BlcnR5TmFtZSA9PT0gImNoZWNrZWQiKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9qdXN0X2NoYW5nZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGpRdWVyeS5ldmVudC5hZGQodGhpcywgImNsaWNrLl9jaGFuZ2UiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5fanVzdF9jaGFuZ2VkICYmICFldmVudC5pc1RyaWdnZXIpIHsKICAgICAgICAgICAgICAgIHRoaXMuX2p1c3RfY2hhbmdlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCJjaGFuZ2UiLCB0aGlzLCBldmVudCwgdHJ1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSAvLyBEZWxlZ2F0ZWQgZXZlbnQ7IGxhenktYWRkIGEgY2hhbmdlIGhhbmRsZXIgb24gZGVzY2VuZGFudCBpbnB1dHMKCgogICAgICAgIGpRdWVyeS5ldmVudC5hZGQodGhpcywgImJlZm9yZWFjdGl2YXRlLl9jaGFuZ2UiLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIGVsZW0gPSBlLnRhcmdldDsKCiAgICAgICAgICBpZiAocmZvcm1FbGVtcy50ZXN0KGVsZW0ubm9kZU5hbWUpICYmICFlbGVtLl9jaGFuZ2VfYXR0YWNoZWQpIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LmFkZChlbGVtLCAiY2hhbmdlLl9jaGFuZ2UiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnROb2RlICYmICFldmVudC5pc1NpbXVsYXRlZCAmJiAhZXZlbnQuaXNUcmlnZ2VyKSB7CiAgICAgICAgICAgICAgICBqUXVlcnkuZXZlbnQuc2ltdWxhdGUoImNoYW5nZSIsIHRoaXMucGFyZW50Tm9kZSwgZXZlbnQsIHRydWUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGVsZW0uX2NoYW5nZV9hdHRhY2hlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGhhbmRsZTogZnVuY3Rpb24gaGFuZGxlKGV2ZW50KSB7CiAgICAgICAgdmFyIGVsZW0gPSBldmVudC50YXJnZXQ7IC8vIFN3YWxsb3cgbmF0aXZlIGNoYW5nZSBldmVudHMgZnJvbSBjaGVja2JveC9yYWRpbywgd2UgYWxyZWFkeSB0cmlnZ2VyZWQgdGhlbSBhYm92ZQoKICAgICAgICBpZiAodGhpcyAhPT0gZWxlbSB8fCBldmVudC5pc1NpbXVsYXRlZCB8fCBldmVudC5pc1RyaWdnZXIgfHwgZWxlbS50eXBlICE9PSAicmFkaW8iICYmIGVsZW0udHlwZSAhPT0gImNoZWNrYm94IikgewogICAgICAgICAgcmV0dXJuIGV2ZW50LmhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0ZWFyZG93bjogZnVuY3Rpb24gdGVhcmRvd24oKSB7CiAgICAgICAgalF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCAiLl9jaGFuZ2UiKTsKICAgICAgICByZXR1cm4gcmZvcm1FbGVtcy50ZXN0KHRoaXMubm9kZU5hbWUpOwogICAgICB9CiAgICB9OwogIH0gLy8gQ3JlYXRlICJidWJibGluZyIgZm9jdXMgYW5kIGJsdXIgZXZlbnRzCgoKICBpZiAoIWpRdWVyeS5zdXBwb3J0LmZvY3VzaW5CdWJibGVzKSB7CiAgICBqUXVlcnkuZWFjaCh7CiAgICAgIGZvY3VzOiAiZm9jdXNpbiIsCiAgICAgIGJsdXI6ICJmb2N1c291dCIKICAgIH0sIGZ1bmN0aW9uIChvcmlnLCBmaXgpIHsKICAgICAgLy8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIHdoaWxlIHNvbWVvbmUgd2FudHMgZm9jdXNpbi9mb2N1c291dAogICAgICB2YXIgYXR0YWNoZXMgPSAwLAogICAgICAgICAgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoZXZlbnQpIHsKICAgICAgICBqUXVlcnkuZXZlbnQuc2ltdWxhdGUoZml4LCBldmVudC50YXJnZXQsIGpRdWVyeS5ldmVudC5maXgoZXZlbnQpLCB0cnVlKTsKICAgICAgfTsKCiAgICAgIGpRdWVyeS5ldmVudC5zcGVjaWFsW2ZpeF0gPSB7CiAgICAgICAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKCkgewogICAgICAgICAgaWYgKGF0dGFjaGVzKysgPT09IDApIHsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihvcmlnLCBoYW5kbGVyLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRlYXJkb3duOiBmdW5jdGlvbiB0ZWFyZG93bigpIHsKICAgICAgICAgIGlmICgtLWF0dGFjaGVzID09PSAwKSB7CiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIob3JpZywgaGFuZGxlciwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgfSk7CiAgfQoKICBqUXVlcnkuZm4uZXh0ZW5kKHsKICAgIG9uOiBmdW5jdGlvbiBvbih0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLAogICAgLypJTlRFUk5BTCovCiAgICBvbmUpIHsKICAgICAgdmFyIG9yaWdGbiwgdHlwZTsgLy8gVHlwZXMgY2FuIGJlIGEgbWFwIG9mIHR5cGVzL2hhbmRsZXJzCgogICAgICBpZiAoX3R5cGVvZih0eXBlcykgPT09ICJvYmplY3QiKSB7CiAgICAgICAgLy8gKCB0eXBlcy1PYmplY3QsIHNlbGVjdG9yLCBkYXRhICkKICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIikgewogICAgICAgICAgLy8gJiYgc2VsZWN0b3IgIT0gbnVsbAogICAgICAgICAgLy8gKCB0eXBlcy1PYmplY3QsIGRhdGEgKQogICAgICAgICAgZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7CiAgICAgICAgICBzZWxlY3RvciA9IHVuZGVmaW5lZDsKICAgICAgICB9CgogICAgICAgIGZvciAodHlwZSBpbiB0eXBlcykgewogICAgICAgICAgdGhpcy5vbih0eXBlLCBzZWxlY3RvciwgZGF0YSwgdHlwZXNbdHlwZV0sIG9uZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgaWYgKGRhdGEgPT0gbnVsbCAmJiBmbiA9PSBudWxsKSB7CiAgICAgICAgLy8gKCB0eXBlcywgZm4gKQogICAgICAgIGZuID0gc2VsZWN0b3I7CiAgICAgICAgZGF0YSA9IHNlbGVjdG9yID0gdW5kZWZpbmVkOwogICAgICB9IGVsc2UgaWYgKGZuID09IG51bGwpIHsKICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIikgewogICAgICAgICAgLy8gKCB0eXBlcywgc2VsZWN0b3IsIGZuICkKICAgICAgICAgIGZuID0gZGF0YTsKICAgICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vICggdHlwZXMsIGRhdGEsIGZuICkKICAgICAgICAgIGZuID0gZGF0YTsKICAgICAgICAgIGRhdGEgPSBzZWxlY3RvcjsKICAgICAgICAgIHNlbGVjdG9yID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZuID09PSBmYWxzZSkgewogICAgICAgIGZuID0gcmV0dXJuRmFsc2U7CiAgICAgIH0gZWxzZSBpZiAoIWZuKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGlmIChvbmUgPT09IDEpIHsKICAgICAgICBvcmlnRm4gPSBmbjsKCiAgICAgICAgZm4gPSBmdW5jdGlvbiBmbihldmVudCkgewogICAgICAgICAgLy8gQ2FuIHVzZSBhbiBlbXB0eSBzZXQsIHNpbmNlIGV2ZW50IGNvbnRhaW5zIHRoZSBpbmZvCiAgICAgICAgICBqUXVlcnkoKS5vZmYoZXZlbnQpOwogICAgICAgICAgcmV0dXJuIG9yaWdGbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07IC8vIFVzZSBzYW1lIGd1aWQgc28gY2FsbGVyIGNhbiByZW1vdmUgdXNpbmcgb3JpZ0ZuCgoKICAgICAgICBmbi5ndWlkID0gb3JpZ0ZuLmd1aWQgfHwgKG9yaWdGbi5ndWlkID0galF1ZXJ5Lmd1aWQrKyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGpRdWVyeS5ldmVudC5hZGQodGhpcywgdHlwZXMsIGZuLCBkYXRhLCBzZWxlY3Rvcik7CiAgICAgIH0pOwogICAgfSwKICAgIG9uZTogZnVuY3Rpb24gb25lKHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4pIHsKICAgICAgcmV0dXJuIHRoaXMub24odHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgMSk7CiAgICB9LAogICAgb2ZmOiBmdW5jdGlvbiBvZmYodHlwZXMsIHNlbGVjdG9yLCBmbikgewogICAgICBpZiAodHlwZXMgJiYgdHlwZXMucHJldmVudERlZmF1bHQgJiYgdHlwZXMuaGFuZGxlT2JqKSB7CiAgICAgICAgLy8gKCBldmVudCApICBkaXNwYXRjaGVkIGpRdWVyeS5FdmVudAogICAgICAgIHZhciBoYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CiAgICAgICAgalF1ZXJ5KHR5cGVzLmRlbGVnYXRlVGFyZ2V0KS5vZmYoaGFuZGxlT2JqLm5hbWVzcGFjZSA/IGhhbmRsZU9iai5vcmlnVHlwZSArICIuIiArIGhhbmRsZU9iai5uYW1lc3BhY2UgOiBoYW5kbGVPYmoub3JpZ1R5cGUsIGhhbmRsZU9iai5zZWxlY3RvciwgaGFuZGxlT2JqLmhhbmRsZXIpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBpZiAoX3R5cGVvZih0eXBlcykgPT09ICJvYmplY3QiKSB7CiAgICAgICAgLy8gKCB0eXBlcy1vYmplY3QgWywgc2VsZWN0b3JdICkKICAgICAgICBmb3IgKHZhciB0eXBlIGluIHR5cGVzKSB7CiAgICAgICAgICB0aGlzLm9mZih0eXBlLCBzZWxlY3RvciwgdHlwZXNbdHlwZV0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGlmIChzZWxlY3RvciA9PT0gZmFsc2UgfHwgdHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgLy8gKCB0eXBlcyBbLCBmbl0gKQogICAgICAgIGZuID0gc2VsZWN0b3I7CiAgICAgICAgc2VsZWN0b3IgPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIGlmIChmbiA9PT0gZmFsc2UpIHsKICAgICAgICBmbiA9IHJldHVybkZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBqUXVlcnkuZXZlbnQucmVtb3ZlKHRoaXMsIHR5cGVzLCBmbiwgc2VsZWN0b3IpOwogICAgICB9KTsKICAgIH0sCiAgICBiaW5kOiBmdW5jdGlvbiBiaW5kKHR5cGVzLCBkYXRhLCBmbikgewogICAgICByZXR1cm4gdGhpcy5vbih0eXBlcywgbnVsbCwgZGF0YSwgZm4pOwogICAgfSwKICAgIHVuYmluZDogZnVuY3Rpb24gdW5iaW5kKHR5cGVzLCBmbikgewogICAgICByZXR1cm4gdGhpcy5vZmYodHlwZXMsIG51bGwsIGZuKTsKICAgIH0sCiAgICBsaXZlOiBmdW5jdGlvbiBsaXZlKHR5cGVzLCBkYXRhLCBmbikgewogICAgICBqUXVlcnkodGhpcy5jb250ZXh0KS5vbih0eXBlcywgdGhpcy5zZWxlY3RvciwgZGF0YSwgZm4pOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBkaWU6IGZ1bmN0aW9uIGRpZSh0eXBlcywgZm4pIHsKICAgICAgalF1ZXJ5KHRoaXMuY29udGV4dCkub2ZmKHR5cGVzLCB0aGlzLnNlbGVjdG9yIHx8ICIqKiIsIGZuKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgZGVsZWdhdGU6IGZ1bmN0aW9uIGRlbGVnYXRlKHNlbGVjdG9yLCB0eXBlcywgZGF0YSwgZm4pIHsKICAgICAgcmV0dXJuIHRoaXMub24odHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbik7CiAgICB9LAogICAgdW5kZWxlZ2F0ZTogZnVuY3Rpb24gdW5kZWxlZ2F0ZShzZWxlY3RvciwgdHlwZXMsIGZuKSB7CiAgICAgIC8vICggbmFtZXNwYWNlICkgb3IgKCBzZWxlY3RvciwgdHlwZXMgWywgZm5dICkKICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT0gMSA/IHRoaXMub2ZmKHNlbGVjdG9yLCAiKioiKSA6IHRoaXMub2ZmKHR5cGVzLCBzZWxlY3RvciwgZm4pOwogICAgfSwKICAgIHRyaWdnZXI6IGZ1bmN0aW9uIHRyaWdnZXIodHlwZSwgZGF0YSkgewogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBqUXVlcnkuZXZlbnQudHJpZ2dlcih0eXBlLCBkYXRhLCB0aGlzKTsKICAgICAgfSk7CiAgICB9LAogICAgdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uIHRyaWdnZXJIYW5kbGVyKHR5cGUsIGRhdGEpIHsKICAgICAgaWYgKHRoaXNbMF0pIHsKICAgICAgICByZXR1cm4galF1ZXJ5LmV2ZW50LnRyaWdnZXIodHlwZSwgZGF0YSwgdGhpc1swXSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0sCiAgICB0b2dnbGU6IGZ1bmN0aW9uIHRvZ2dsZShmbikgewogICAgICAvLyBTYXZlIHJlZmVyZW5jZSB0byBhcmd1bWVudHMgZm9yIGFjY2VzcyBpbiBjbG9zdXJlCiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLAogICAgICAgICAgZ3VpZCA9IGZuLmd1aWQgfHwgalF1ZXJ5Lmd1aWQrKywKICAgICAgICAgIGkgPSAwLAogICAgICAgICAgdG9nZ2xlciA9IGZ1bmN0aW9uIHRvZ2dsZXIoZXZlbnQpIHsKICAgICAgICAvLyBGaWd1cmUgb3V0IHdoaWNoIGZ1bmN0aW9uIHRvIGV4ZWN1dGUKICAgICAgICB2YXIgbGFzdFRvZ2dsZSA9IChqUXVlcnkuX2RhdGEodGhpcywgImxhc3RUb2dnbGUiICsgZm4uZ3VpZCkgfHwgMCkgJSBpOwoKICAgICAgICBqUXVlcnkuX2RhdGEodGhpcywgImxhc3RUb2dnbGUiICsgZm4uZ3VpZCwgbGFzdFRvZ2dsZSArIDEpOyAvLyBNYWtlIHN1cmUgdGhhdCBjbGlja3Mgc3RvcAoKCiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gYW5kIGV4ZWN1dGUgdGhlIGZ1bmN0aW9uCgogICAgICAgIHJldHVybiBhcmdzW2xhc3RUb2dnbGVdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgZmFsc2U7CiAgICAgIH07IC8vIGxpbmsgYWxsIHRoZSBmdW5jdGlvbnMsIHNvIGFueSBvZiB0aGVtIGNhbiB1bmJpbmQgdGhpcyBjbGljayBoYW5kbGVyCgoKICAgICAgdG9nZ2xlci5ndWlkID0gZ3VpZDsKCiAgICAgIHdoaWxlIChpIDwgYXJncy5sZW5ndGgpIHsKICAgICAgICBhcmdzW2krK10uZ3VpZCA9IGd1aWQ7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmNsaWNrKHRvZ2dsZXIpOwogICAgfSwKICAgIGhvdmVyOiBmdW5jdGlvbiBob3Zlcihmbk92ZXIsIGZuT3V0KSB7CiAgICAgIHJldHVybiB0aGlzLm1vdXNlZW50ZXIoZm5PdmVyKS5tb3VzZWxlYXZlKGZuT3V0IHx8IGZuT3Zlcik7CiAgICB9CiAgfSk7CiAgalF1ZXJ5LmVhY2goKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAiICsgIm1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlICIgKyAiY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvciBjb250ZXh0bWVudSIpLnNwbGl0KCIgIiksIGZ1bmN0aW9uIChpLCBuYW1lKSB7CiAgICAvLyBIYW5kbGUgZXZlbnQgYmluZGluZwogICAgalF1ZXJ5LmZuW25hbWVdID0gZnVuY3Rpb24gKGRhdGEsIGZuKSB7CiAgICAgIGlmIChmbiA9PSBudWxsKSB7CiAgICAgICAgZm4gPSBkYXRhOwogICAgICAgIGRhdGEgPSBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPyB0aGlzLm9uKG5hbWUsIG51bGwsIGRhdGEsIGZuKSA6IHRoaXMudHJpZ2dlcihuYW1lKTsKICAgIH07CgogICAgaWYgKGpRdWVyeS5hdHRyRm4pIHsKICAgICAgalF1ZXJ5LmF0dHJGbltuYW1lXSA9IHRydWU7CiAgICB9CgogICAgaWYgKHJrZXlFdmVudC50ZXN0KG5hbWUpKSB7CiAgICAgIGpRdWVyeS5ldmVudC5maXhIb29rc1tuYW1lXSA9IGpRdWVyeS5ldmVudC5rZXlIb29rczsKICAgIH0KCiAgICBpZiAocm1vdXNlRXZlbnQudGVzdChuYW1lKSkgewogICAgICBqUXVlcnkuZXZlbnQuZml4SG9va3NbbmFtZV0gPSBqUXVlcnkuZXZlbnQubW91c2VIb29rczsKICAgIH0KICB9KTsKICAvKiEKICAgKiBTaXp6bGUgQ1NTIFNlbGVjdG9yIEVuZ2luZQogICAqICBDb3B5cmlnaHQgMjAxMSwgVGhlIERvam8gRm91bmRhdGlvbgogICAqICBSZWxlYXNlZCB1bmRlciB0aGUgTUlULCBCU0QsIGFuZCBHUEwgTGljZW5zZXMuCiAgICogIE1vcmUgaW5mb3JtYXRpb246IGh0dHA6Ly9zaXp6bGVqcy5jb20vCiAgICovCgogIChmdW5jdGlvbiAoKSB7CiAgICB2YXIgY2h1bmtlciA9IC8oKD86XCgoPzpcKFteKCldK1wpfFteKCldKykrXCl8XFsoPzpcW1teXFtcXV0qXF18WyciXVteJyJdKlsnIl18W15cW1xdJyJdKykrXF18XFwufFteID4rfiwoXFtcXF0rKSt8Wz4rfl0pKFxzKixccyopPygoPzoufFxyfFxuKSopL2csCiAgICAgICAgZXhwYW5kbyA9ICJzaXpjYWNoZSIgKyAoTWF0aC5yYW5kb20oKSArICcnKS5yZXBsYWNlKCcuJywgJycpLAogICAgICAgIGRvbmUgPSAwLAogICAgICAgIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICBoYXNEdXBsaWNhdGUgPSBmYWxzZSwKICAgICAgICBiYXNlSGFzRHVwbGljYXRlID0gdHJ1ZSwKICAgICAgICByQmFja3NsYXNoID0gL1xcL2csCiAgICAgICAgclJldHVybiA9IC9cclxuL2csCiAgICAgICAgck5vbldvcmQgPSAvXFcvOyAvLyBIZXJlIHdlIGNoZWNrIGlmIHRoZSBKYXZhU2NyaXB0IGVuZ2luZSBpcyB1c2luZyBzb21lIHNvcnQgb2YKICAgIC8vIG9wdGltaXphdGlvbiB3aGVyZSBpdCBkb2VzIG5vdCBhbHdheXMgY2FsbCBvdXIgY29tcGFyaXNpb24KICAgIC8vIGZ1bmN0aW9uLiBJZiB0aGF0IGlzIHRoZSBjYXNlLCBkaXNjYXJkIHRoZSBoYXNEdXBsaWNhdGUgdmFsdWUuCiAgICAvLyAgIFRodXMgZmFyIHRoYXQgaW5jbHVkZXMgR29vZ2xlIENocm9tZS4KCiAgICBbMCwgMF0uc29ydChmdW5jdGlvbiAoKSB7CiAgICAgIGJhc2VIYXNEdXBsaWNhdGUgPSBmYWxzZTsKICAgICAgcmV0dXJuIDA7CiAgICB9KTsKCiAgICB2YXIgX1NpenpsZTIgPSBmdW5jdGlvbiBTaXp6bGUoc2VsZWN0b3IsIGNvbnRleHQsIHJlc3VsdHMsIHNlZWQpIHsKICAgICAgcmVzdWx0cyA9IHJlc3VsdHMgfHwgW107CiAgICAgIGNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50OwogICAgICB2YXIgb3JpZ0NvbnRleHQgPSBjb250ZXh0OwoKICAgICAgaWYgKGNvbnRleHQubm9kZVR5cGUgIT09IDEgJiYgY29udGV4dC5ub2RlVHlwZSAhPT0gOSkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgaWYgKCFzZWxlY3RvciB8fCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICAgIH0KCiAgICAgIHZhciBtLAogICAgICAgICAgc2V0LAogICAgICAgICAgY2hlY2tTZXQsCiAgICAgICAgICBleHRyYSwKICAgICAgICAgIHJldCwKICAgICAgICAgIGN1ciwKICAgICAgICAgIHBvcCwKICAgICAgICAgIGksCiAgICAgICAgICBwcnVuZSA9IHRydWUsCiAgICAgICAgICBjb250ZXh0WE1MID0gX1NpenpsZTIuaXNYTUwoY29udGV4dCksCiAgICAgICAgICBwYXJ0cyA9IFtdLAogICAgICAgICAgc29GYXIgPSBzZWxlY3RvcjsgLy8gUmVzZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBjaHVua2VyIHJlZ2V4cCAoc3RhcnQgZnJvbSBoZWFkKQoKCiAgICAgIGRvIHsKICAgICAgICBjaHVua2VyLmV4ZWMoIiIpOwogICAgICAgIG0gPSBjaHVua2VyLmV4ZWMoc29GYXIpOwoKICAgICAgICBpZiAobSkgewogICAgICAgICAgc29GYXIgPSBtWzNdOwogICAgICAgICAgcGFydHMucHVzaChtWzFdKTsKCiAgICAgICAgICBpZiAobVsyXSkgewogICAgICAgICAgICBleHRyYSA9IG1bM107CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAobSk7CgogICAgICBpZiAocGFydHMubGVuZ3RoID4gMSAmJiBvcmlnUE9TLmV4ZWMoc2VsZWN0b3IpKSB7CiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMiAmJiBFeHByLnJlbGF0aXZlW3BhcnRzWzBdXSkgewogICAgICAgICAgc2V0ID0gcG9zUHJvY2VzcyhwYXJ0c1swXSArIHBhcnRzWzFdLCBjb250ZXh0LCBzZWVkKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2V0ID0gRXhwci5yZWxhdGl2ZVtwYXJ0c1swXV0gPyBbY29udGV4dF0gOiBfU2l6emxlMihwYXJ0cy5zaGlmdCgpLCBjb250ZXh0KTsKCiAgICAgICAgICB3aGlsZSAocGFydHMubGVuZ3RoKSB7CiAgICAgICAgICAgIHNlbGVjdG9yID0gcGFydHMuc2hpZnQoKTsKCiAgICAgICAgICAgIGlmIChFeHByLnJlbGF0aXZlW3NlbGVjdG9yXSkgewogICAgICAgICAgICAgIHNlbGVjdG9yICs9IHBhcnRzLnNoaWZ0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNldCA9IHBvc1Byb2Nlc3Moc2VsZWN0b3IsIHNldCwgc2VlZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRha2UgYSBzaG9ydGN1dCBhbmQgc2V0IHRoZSBjb250ZXh0IGlmIHRoZSByb290IHNlbGVjdG9yIGlzIGFuIElECiAgICAgICAgLy8gKGJ1dCBub3QgaWYgaXQnbGwgYmUgZmFzdGVyIGlmIHRoZSBpbm5lciBzZWxlY3RvciBpcyBhbiBJRCkKICAgICAgICBpZiAoIXNlZWQgJiYgcGFydHMubGVuZ3RoID4gMSAmJiBjb250ZXh0Lm5vZGVUeXBlID09PSA5ICYmICFjb250ZXh0WE1MICYmIEV4cHIubWF0Y2guSUQudGVzdChwYXJ0c1swXSkgJiYgIUV4cHIubWF0Y2guSUQudGVzdChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSkpIHsKICAgICAgICAgIHJldCA9IF9TaXp6bGUyLmZpbmQocGFydHMuc2hpZnQoKSwgY29udGV4dCwgY29udGV4dFhNTCk7CiAgICAgICAgICBjb250ZXh0ID0gcmV0LmV4cHIgPyBfU2l6emxlMi5maWx0ZXIocmV0LmV4cHIsIHJldC5zZXQpWzBdIDogcmV0LnNldFswXTsKICAgICAgICB9CgogICAgICAgIGlmIChjb250ZXh0KSB7CiAgICAgICAgICByZXQgPSBzZWVkID8gewogICAgICAgICAgICBleHByOiBwYXJ0cy5wb3AoKSwKICAgICAgICAgICAgc2V0OiBtYWtlQXJyYXkoc2VlZCkKICAgICAgICAgIH0gOiBfU2l6emxlMi5maW5kKHBhcnRzLnBvcCgpLCBwYXJ0cy5sZW5ndGggPT09IDEgJiYgKHBhcnRzWzBdID09PSAifiIgfHwgcGFydHNbMF0gPT09ICIrIikgJiYgY29udGV4dC5wYXJlbnROb2RlID8gY29udGV4dC5wYXJlbnROb2RlIDogY29udGV4dCwgY29udGV4dFhNTCk7CiAgICAgICAgICBzZXQgPSByZXQuZXhwciA/IF9TaXp6bGUyLmZpbHRlcihyZXQuZXhwciwgcmV0LnNldCkgOiByZXQuc2V0OwoKICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNoZWNrU2V0ID0gbWFrZUFycmF5KHNldCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcnVuZSA9IGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHdoaWxlIChwYXJ0cy5sZW5ndGgpIHsKICAgICAgICAgICAgY3VyID0gcGFydHMucG9wKCk7CiAgICAgICAgICAgIHBvcCA9IGN1cjsKCiAgICAgICAgICAgIGlmICghRXhwci5yZWxhdGl2ZVtjdXJdKSB7CiAgICAgICAgICAgICAgY3VyID0gIiI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcG9wID0gcGFydHMucG9wKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChwb3AgPT0gbnVsbCkgewogICAgICAgICAgICAgIHBvcCA9IGNvbnRleHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEV4cHIucmVsYXRpdmVbY3VyXShjaGVja1NldCwgcG9wLCBjb250ZXh0WE1MKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2hlY2tTZXQgPSBwYXJ0cyA9IFtdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFjaGVja1NldCkgewogICAgICAgIGNoZWNrU2V0ID0gc2V0OwogICAgICB9CgogICAgICBpZiAoIWNoZWNrU2V0KSB7CiAgICAgICAgX1NpenpsZTIuZXJyb3IoY3VyIHx8IHNlbGVjdG9yKTsKICAgICAgfQoKICAgICAgaWYgKHRvU3RyaW5nLmNhbGwoY2hlY2tTZXQpID09PSAiW29iamVjdCBBcnJheV0iKSB7CiAgICAgICAgaWYgKCFwcnVuZSkgewogICAgICAgICAgcmVzdWx0cy5wdXNoLmFwcGx5KHJlc3VsdHMsIGNoZWNrU2V0KTsKICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQgJiYgY29udGV4dC5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgZm9yIChpID0gMDsgY2hlY2tTZXRbaV0gIT0gbnVsbDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjaGVja1NldFtpXSAmJiAoY2hlY2tTZXRbaV0gPT09IHRydWUgfHwgY2hlY2tTZXRbaV0ubm9kZVR5cGUgPT09IDEgJiYgX1NpenpsZTIuY29udGFpbnMoY29udGV4dCwgY2hlY2tTZXRbaV0pKSkgewogICAgICAgICAgICAgIHJlc3VsdHMucHVzaChzZXRbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAoaSA9IDA7IGNoZWNrU2V0W2ldICE9IG51bGw7IGkrKykgewogICAgICAgICAgICBpZiAoY2hlY2tTZXRbaV0gJiYgY2hlY2tTZXRbaV0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICByZXN1bHRzLnB1c2goc2V0W2ldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBtYWtlQXJyYXkoY2hlY2tTZXQsIHJlc3VsdHMpOwogICAgICB9CgogICAgICBpZiAoZXh0cmEpIHsKICAgICAgICBfU2l6emxlMihleHRyYSwgb3JpZ0NvbnRleHQsIHJlc3VsdHMsIHNlZWQpOwoKICAgICAgICBfU2l6emxlMi51bmlxdWVTb3J0KHJlc3VsdHMpOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0czsKICAgIH07CgogICAgX1NpenpsZTIudW5pcXVlU29ydCA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgIGlmIChzb3J0T3JkZXIpIHsKICAgICAgICBoYXNEdXBsaWNhdGUgPSBiYXNlSGFzRHVwbGljYXRlOwogICAgICAgIHJlc3VsdHMuc29ydChzb3J0T3JkZXIpOwoKICAgICAgICBpZiAoaGFzRHVwbGljYXRlKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHJlc3VsdHNbaV0gPT09IHJlc3VsdHNbaSAtIDFdKSB7CiAgICAgICAgICAgICAgcmVzdWx0cy5zcGxpY2UoaS0tLCAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICB9OwoKICAgIF9TaXp6bGUyLm1hdGNoZXMgPSBmdW5jdGlvbiAoZXhwciwgc2V0KSB7CiAgICAgIHJldHVybiBfU2l6emxlMihleHByLCBudWxsLCBudWxsLCBzZXQpOwogICAgfTsKCiAgICBfU2l6emxlMi5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlvbiAobm9kZSwgZXhwcikgewogICAgICByZXR1cm4gX1NpenpsZTIoZXhwciwgbnVsbCwgbnVsbCwgW25vZGVdKS5sZW5ndGggPiAwOwogICAgfTsKCiAgICBfU2l6emxlMi5maW5kID0gZnVuY3Rpb24gKGV4cHIsIGNvbnRleHQsIGlzWE1MKSB7CiAgICAgIHZhciBzZXQsIGksIGxlbiwgbWF0Y2gsIHR5cGUsIGxlZnQ7CgogICAgICBpZiAoIWV4cHIpIHsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0KCiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IEV4cHIub3JkZXIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICB0eXBlID0gRXhwci5vcmRlcltpXTsKCiAgICAgICAgaWYgKG1hdGNoID0gRXhwci5sZWZ0TWF0Y2hbdHlwZV0uZXhlYyhleHByKSkgewogICAgICAgICAgbGVmdCA9IG1hdGNoWzFdOwogICAgICAgICAgbWF0Y2guc3BsaWNlKDEsIDEpOwoKICAgICAgICAgIGlmIChsZWZ0LnN1YnN0cihsZWZ0Lmxlbmd0aCAtIDEpICE9PSAiXFwiKSB7CiAgICAgICAgICAgIG1hdGNoWzFdID0gKG1hdGNoWzFdIHx8ICIiKS5yZXBsYWNlKHJCYWNrc2xhc2gsICIiKTsKICAgICAgICAgICAgc2V0ID0gRXhwci5maW5kW3R5cGVdKG1hdGNoLCBjb250ZXh0LCBpc1hNTCk7CgogICAgICAgICAgICBpZiAoc2V0ICE9IG51bGwpIHsKICAgICAgICAgICAgICBleHByID0gZXhwci5yZXBsYWNlKEV4cHIubWF0Y2hbdHlwZV0sICIiKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFzZXQpIHsKICAgICAgICBzZXQgPSB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgPyBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikgOiBbXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBzZXQ6IHNldCwKICAgICAgICBleHByOiBleHByCiAgICAgIH07CiAgICB9OwoKICAgIF9TaXp6bGUyLmZpbHRlciA9IGZ1bmN0aW9uIChleHByLCBzZXQsIGlucGxhY2UsIG5vdCkgewogICAgICB2YXIgbWF0Y2gsCiAgICAgICAgICBhbnlGb3VuZCwKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBmb3VuZCwKICAgICAgICAgIGl0ZW0sCiAgICAgICAgICBmaWx0ZXIsCiAgICAgICAgICBsZWZ0LAogICAgICAgICAgaSwKICAgICAgICAgIHBhc3MsCiAgICAgICAgICBvbGQgPSBleHByLAogICAgICAgICAgcmVzdWx0ID0gW10sCiAgICAgICAgICBjdXJMb29wID0gc2V0LAogICAgICAgICAgaXNYTUxGaWx0ZXIgPSBzZXQgJiYgc2V0WzBdICYmIF9TaXp6bGUyLmlzWE1MKHNldFswXSk7CgogICAgICB3aGlsZSAoZXhwciAmJiBzZXQubGVuZ3RoKSB7CiAgICAgICAgZm9yICh0eXBlIGluIEV4cHIuZmlsdGVyKSB7CiAgICAgICAgICBpZiAoKG1hdGNoID0gRXhwci5sZWZ0TWF0Y2hbdHlwZV0uZXhlYyhleHByKSkgIT0gbnVsbCAmJiBtYXRjaFsyXSkgewogICAgICAgICAgICBmaWx0ZXIgPSBFeHByLmZpbHRlclt0eXBlXTsKICAgICAgICAgICAgbGVmdCA9IG1hdGNoWzFdOwogICAgICAgICAgICBhbnlGb3VuZCA9IGZhbHNlOwogICAgICAgICAgICBtYXRjaC5zcGxpY2UoMSwgMSk7CgogICAgICAgICAgICBpZiAobGVmdC5zdWJzdHIobGVmdC5sZW5ndGggLSAxKSA9PT0gIlxcIikgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY3VyTG9vcCA9PT0gcmVzdWx0KSB7CiAgICAgICAgICAgICAgcmVzdWx0ID0gW107CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChFeHByLnByZUZpbHRlclt0eXBlXSkgewogICAgICAgICAgICAgIG1hdGNoID0gRXhwci5wcmVGaWx0ZXJbdHlwZV0obWF0Y2gsIGN1ckxvb3AsIGlucGxhY2UsIHJlc3VsdCwgbm90LCBpc1hNTEZpbHRlcik7CgogICAgICAgICAgICAgIGlmICghbWF0Y2gpIHsKICAgICAgICAgICAgICAgIGFueUZvdW5kID0gZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2ggPT09IHRydWUpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgICAgICAgZm9yIChpID0gMDsgKGl0ZW0gPSBjdXJMb29wW2ldKSAhPSBudWxsOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIGZvdW5kID0gZmlsdGVyKGl0ZW0sIG1hdGNoLCBpLCBjdXJMb29wKTsKICAgICAgICAgICAgICAgICAgcGFzcyA9IG5vdCBeIGZvdW5kOwoKICAgICAgICAgICAgICAgICAgaWYgKGlucGxhY2UgJiYgZm91bmQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGlmIChwYXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICBhbnlGb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGN1ckxvb3BbaV0gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFzcykgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGl0ZW0pOwogICAgICAgICAgICAgICAgICAgIGFueUZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGZvdW5kICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBpZiAoIWlucGxhY2UpIHsKICAgICAgICAgICAgICAgIGN1ckxvb3AgPSByZXN1bHQ7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBleHByID0gZXhwci5yZXBsYWNlKEV4cHIubWF0Y2hbdHlwZV0sICIiKTsKCiAgICAgICAgICAgICAgaWYgKCFhbnlGb3VuZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IC8vIEltcHJvcGVyIGV4cHJlc3Npb24KCgogICAgICAgIGlmIChleHByID09PSBvbGQpIHsKICAgICAgICAgIGlmIChhbnlGb3VuZCA9PSBudWxsKSB7CiAgICAgICAgICAgIF9TaXp6bGUyLmVycm9yKGV4cHIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBvbGQgPSBleHByOwogICAgICB9CgogICAgICByZXR1cm4gY3VyTG9vcDsKICAgIH07CgogICAgX1NpenpsZTIuZXJyb3IgPSBmdW5jdGlvbiAobXNnKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIiArIG1zZyk7CiAgICB9OwogICAgLyoqCiAgICAgKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciByZXRyZWl2aW5nIHRoZSB0ZXh0IHZhbHVlIG9mIGFuIGFycmF5IG9mIERPTSBub2RlcwogICAgICogQHBhcmFtIHtBcnJheXxFbGVtZW50fSBlbGVtCiAgICAgKi8KCgogICAgdmFyIGdldFRleHQgPSBfU2l6emxlMi5nZXRUZXh0ID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgdmFyIGksCiAgICAgICAgICBub2RlLAogICAgICAgICAgbm9kZVR5cGUgPSBlbGVtLm5vZGVUeXBlLAogICAgICAgICAgcmV0ID0gIiI7CgogICAgICBpZiAobm9kZVR5cGUpIHsKICAgICAgICBpZiAobm9kZVR5cGUgPT09IDEgfHwgbm9kZVR5cGUgPT09IDkgfHwgbm9kZVR5cGUgPT09IDExKSB7CiAgICAgICAgICAvLyBVc2UgdGV4dENvbnRlbnQgfHwgaW5uZXJUZXh0IGZvciBlbGVtZW50cwogICAgICAgICAgaWYgKHR5cGVvZiBlbGVtLnRleHRDb250ZW50ID09PSAnc3RyaW5nJykgewogICAgICAgICAgICByZXR1cm4gZWxlbS50ZXh0Q29udGVudDsKICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVsZW0uaW5uZXJUZXh0ID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAvLyBSZXBsYWNlIElFJ3MgY2FycmlhZ2UgcmV0dXJucwogICAgICAgICAgICByZXR1cm4gZWxlbS5pbm5lclRleHQucmVwbGFjZShyUmV0dXJuLCAnJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBUcmF2ZXJzZSBpdCdzIGNoaWxkcmVuCiAgICAgICAgICAgIGZvciAoZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcpIHsKICAgICAgICAgICAgICByZXQgKz0gZ2V0VGV4dChlbGVtKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAobm9kZVR5cGUgPT09IDMgfHwgbm9kZVR5cGUgPT09IDQpIHsKICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVWYWx1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSWYgbm8gbm9kZVR5cGUsIHRoaXMgaXMgZXhwZWN0ZWQgdG8gYmUgYW4gYXJyYXkKICAgICAgICBmb3IgKGkgPSAwOyBub2RlID0gZWxlbVtpXTsgaSsrKSB7CiAgICAgICAgICAvLyBEbyBub3QgdHJhdmVyc2UgY29tbWVudCBub2RlcwogICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgIT09IDgpIHsKICAgICAgICAgICAgcmV0ICs9IGdldFRleHQobm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfTsKCiAgICB2YXIgRXhwciA9IF9TaXp6bGUyLnNlbGVjdG9ycyA9IHsKICAgICAgb3JkZXI6IFsiSUQiLCAiTkFNRSIsICJUQUciXSwKICAgICAgbWF0Y2g6IHsKICAgICAgICBJRDogLyMoKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKykvLAogICAgICAgIENMQVNTOiAvXC4oKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKykvLAogICAgICAgIE5BTUU6IC9cW25hbWU9WyciXSooKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKylbJyJdKlxdLywKICAgICAgICBBVFRSOiAvXFtccyooKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKylccyooPzooXFM/PSlccyooPzooWyciXSkoLio/KVwzfCgjPyg/Oltcd1x1MDBjMC1cdUZGRkZcLV18XFwuKSopfCl8KVxzKlxdLywKICAgICAgICBUQUc6IC9eKCg/Oltcd1x1MDBjMC1cdUZGRkZcKlwtXXxcXC4pKykvLAogICAgICAgIENISUxEOiAvOihvbmx5fG50aHxsYXN0fGZpcnN0KS1jaGlsZCg/OlwoXHMqKGV2ZW58b2RkfCg/OlsrXC1dP1xkK3woPzpbK1wtXT9cZCopP25ccyooPzpbK1wtXVxzKlxkKyk/KSlccypcKSk/LywKICAgICAgICBQT1M6IC86KG50aHxlcXxndHxsdHxmaXJzdHxsYXN0fGV2ZW58b2RkKSg/OlwoKFxkKilcKSk/KD89W15cLV18JCkvLAogICAgICAgIFBTRVVETzogLzooKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKykoPzpcKChbJyJdPykoKD86XChbXlwpXStcKXxbXlwoXCldKikrKVwyXCkpPy8KICAgICAgfSwKICAgICAgbGVmdE1hdGNoOiB7fSwKICAgICAgYXR0ck1hcDogewogICAgICAgICJjbGFzcyI6ICJjbGFzc05hbWUiLAogICAgICAgICJmb3IiOiAiaHRtbEZvciIKICAgICAgfSwKICAgICAgYXR0ckhhbmRsZTogewogICAgICAgIGhyZWY6IGZ1bmN0aW9uIGhyZWYoZWxlbSkgewogICAgICAgICAgcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCJocmVmIik7CiAgICAgICAgfSwKICAgICAgICB0eXBlOiBmdW5jdGlvbiB0eXBlKGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgidHlwZSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcmVsYXRpdmU6IHsKICAgICAgICAiKyI6IGZ1bmN0aW9uIF8oY2hlY2tTZXQsIHBhcnQpIHsKICAgICAgICAgIHZhciBpc1BhcnRTdHIgPSB0eXBlb2YgcGFydCA9PT0gInN0cmluZyIsCiAgICAgICAgICAgICAgaXNUYWcgPSBpc1BhcnRTdHIgJiYgIXJOb25Xb3JkLnRlc3QocGFydCksCiAgICAgICAgICAgICAgaXNQYXJ0U3RyTm90VGFnID0gaXNQYXJ0U3RyICYmICFpc1RhZzsKCiAgICAgICAgICBpZiAoaXNUYWcpIHsKICAgICAgICAgICAgcGFydCA9IHBhcnQudG9Mb3dlckNhc2UoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoZWNrU2V0Lmxlbmd0aCwgZWxlbTsgaSA8IGw7IGkrKykgewogICAgICAgICAgICBpZiAoZWxlbSA9IGNoZWNrU2V0W2ldKSB7CiAgICAgICAgICAgICAgd2hpbGUgKChlbGVtID0gZWxlbS5wcmV2aW91c1NpYmxpbmcpICYmIGVsZW0ubm9kZVR5cGUgIT09IDEpIHt9CgogICAgICAgICAgICAgIGNoZWNrU2V0W2ldID0gaXNQYXJ0U3RyTm90VGFnIHx8IGVsZW0gJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBwYXJ0ID8gZWxlbSB8fCBmYWxzZSA6IGVsZW0gPT09IHBhcnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoaXNQYXJ0U3RyTm90VGFnKSB7CiAgICAgICAgICAgIF9TaXp6bGUyLmZpbHRlcihwYXJ0LCBjaGVja1NldCwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAiPiI6IGZ1bmN0aW9uIF8oY2hlY2tTZXQsIHBhcnQpIHsKICAgICAgICAgIHZhciBlbGVtLAogICAgICAgICAgICAgIGlzUGFydFN0ciA9IHR5cGVvZiBwYXJ0ID09PSAic3RyaW5nIiwKICAgICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgICBsID0gY2hlY2tTZXQubGVuZ3RoOwoKICAgICAgICAgIGlmIChpc1BhcnRTdHIgJiYgIXJOb25Xb3JkLnRlc3QocGFydCkpIHsKICAgICAgICAgICAgcGFydCA9IHBhcnQudG9Mb3dlckNhc2UoKTsKCiAgICAgICAgICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgICAgZWxlbSA9IGNoZWNrU2V0W2ldOwoKICAgICAgICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgIGNoZWNrU2V0W2ldID0gcGFyZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IHBhcnQgPyBwYXJlbnQgOiBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgICAgZWxlbSA9IGNoZWNrU2V0W2ldOwoKICAgICAgICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgICAgICAgY2hlY2tTZXRbaV0gPSBpc1BhcnRTdHIgPyBlbGVtLnBhcmVudE5vZGUgOiBlbGVtLnBhcmVudE5vZGUgPT09IHBhcnQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoaXNQYXJ0U3RyKSB7CiAgICAgICAgICAgICAgX1NpenpsZTIuZmlsdGVyKHBhcnQsIGNoZWNrU2V0LCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgIiI6IGZ1bmN0aW9uIF8oY2hlY2tTZXQsIHBhcnQsIGlzWE1MKSB7CiAgICAgICAgICB2YXIgbm9kZUNoZWNrLAogICAgICAgICAgICAgIGRvbmVOYW1lID0gZG9uZSsrLAogICAgICAgICAgICAgIGNoZWNrRm4gPSBkaXJDaGVjazsKCiAgICAgICAgICBpZiAodHlwZW9mIHBhcnQgPT09ICJzdHJpbmciICYmICFyTm9uV29yZC50ZXN0KHBhcnQpKSB7CiAgICAgICAgICAgIHBhcnQgPSBwYXJ0LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIG5vZGVDaGVjayA9IHBhcnQ7CiAgICAgICAgICAgIGNoZWNrRm4gPSBkaXJOb2RlQ2hlY2s7CiAgICAgICAgICB9CgogICAgICAgICAgY2hlY2tGbigicGFyZW50Tm9kZSIsIHBhcnQsIGRvbmVOYW1lLCBjaGVja1NldCwgbm9kZUNoZWNrLCBpc1hNTCk7CiAgICAgICAgfSwKICAgICAgICAifiI6IGZ1bmN0aW9uIF8oY2hlY2tTZXQsIHBhcnQsIGlzWE1MKSB7CiAgICAgICAgICB2YXIgbm9kZUNoZWNrLAogICAgICAgICAgICAgIGRvbmVOYW1lID0gZG9uZSsrLAogICAgICAgICAgICAgIGNoZWNrRm4gPSBkaXJDaGVjazsKCiAgICAgICAgICBpZiAodHlwZW9mIHBhcnQgPT09ICJzdHJpbmciICYmICFyTm9uV29yZC50ZXN0KHBhcnQpKSB7CiAgICAgICAgICAgIHBhcnQgPSBwYXJ0LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIG5vZGVDaGVjayA9IHBhcnQ7CiAgICAgICAgICAgIGNoZWNrRm4gPSBkaXJOb2RlQ2hlY2s7CiAgICAgICAgICB9CgogICAgICAgICAgY2hlY2tGbigicHJldmlvdXNTaWJsaW5nIiwgcGFydCwgZG9uZU5hbWUsIGNoZWNrU2V0LCBub2RlQ2hlY2ssIGlzWE1MKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZpbmQ6IHsKICAgICAgICBJRDogZnVuY3Rpb24gSUQobWF0Y2gsIGNvbnRleHQsIGlzWE1MKSB7CiAgICAgICAgICBpZiAodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQgIT09ICJ1bmRlZmluZWQiICYmICFpc1hNTCkgewogICAgICAgICAgICB2YXIgbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQobWF0Y2hbMV0pOyAvLyBDaGVjayBwYXJlbnROb2RlIHRvIGNhdGNoIHdoZW4gQmxhY2tiZXJyeSA0LjYgcmV0dXJucwogICAgICAgICAgICAvLyBub2RlcyB0aGF0IGFyZSBubyBsb25nZXIgaW4gdGhlIGRvY3VtZW50ICM2OTYzCgogICAgICAgICAgICByZXR1cm4gbSAmJiBtLnBhcmVudE5vZGUgPyBbbV0gOiBbXTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIE5BTUU6IGZ1bmN0aW9uIE5BTUUobWF0Y2gsIGNvbnRleHQpIHsKICAgICAgICAgIGlmICh0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5TmFtZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgdmFyIHJldCA9IFtdLAogICAgICAgICAgICAgICAgcmVzdWx0cyA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeU5hbWUobWF0Y2hbMV0pOwoKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSByZXN1bHRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICAgIGlmIChyZXN1bHRzW2ldLmdldEF0dHJpYnV0ZSgibmFtZSIpID09PSBtYXRjaFsxXSkgewogICAgICAgICAgICAgICAgcmV0LnB1c2gocmVzdWx0c1tpXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmV0Lmxlbmd0aCA9PT0gMCA/IG51bGwgOiByZXQ7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBUQUc6IGZ1bmN0aW9uIFRBRyhtYXRjaCwgY29udGV4dCkgewogICAgICAgICAgaWYgKHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICByZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShtYXRjaFsxXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBwcmVGaWx0ZXI6IHsKICAgICAgICBDTEFTUzogZnVuY3Rpb24gQ0xBU1MobWF0Y2gsIGN1ckxvb3AsIGlucGxhY2UsIHJlc3VsdCwgbm90LCBpc1hNTCkgewogICAgICAgICAgbWF0Y2ggPSAiICIgKyBtYXRjaFsxXS5yZXBsYWNlKHJCYWNrc2xhc2gsICIiKSArICIgIjsKCiAgICAgICAgICBpZiAoaXNYTUwpIHsKICAgICAgICAgICAgcmV0dXJuIG1hdGNoOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBlbGVtOyAoZWxlbSA9IGN1ckxvb3BbaV0pICE9IG51bGw7IGkrKykgewogICAgICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgICAgIGlmIChub3QgXiAoZWxlbS5jbGFzc05hbWUgJiYgKCIgIiArIGVsZW0uY2xhc3NOYW1lICsgIiAiKS5yZXBsYWNlKC9bXHRcblxyXS9nLCAiICIpLmluZGV4T2YobWF0Y2gpID49IDApKSB7CiAgICAgICAgICAgICAgICBpZiAoIWlucGxhY2UpIHsKICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goZWxlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnBsYWNlKSB7CiAgICAgICAgICAgICAgICBjdXJMb29wW2ldID0gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgSUQ6IGZ1bmN0aW9uIElEKG1hdGNoKSB7CiAgICAgICAgICByZXR1cm4gbWF0Y2hbMV0ucmVwbGFjZShyQmFja3NsYXNoLCAiIik7CiAgICAgICAgfSwKICAgICAgICBUQUc6IGZ1bmN0aW9uIFRBRyhtYXRjaCwgY3VyTG9vcCkgewogICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnJlcGxhY2UockJhY2tzbGFzaCwgIiIpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgfSwKICAgICAgICBDSElMRDogZnVuY3Rpb24gQ0hJTEQobWF0Y2gpIHsKICAgICAgICAgIGlmIChtYXRjaFsxXSA9PT0gIm50aCIpIHsKICAgICAgICAgICAgaWYgKCFtYXRjaFsyXSkgewogICAgICAgICAgICAgIF9TaXp6bGUyLmVycm9yKG1hdGNoWzBdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbWF0Y2hbMl0gPSBtYXRjaFsyXS5yZXBsYWNlKC9eXCt8XHMqL2csICcnKTsgLy8gcGFyc2UgZXF1YXRpb25zIGxpa2UgJ2V2ZW4nLCAnb2RkJywgJzUnLCAnMm4nLCAnM24rMicsICc0bi0xJywgJy1uKzYnCgogICAgICAgICAgICB2YXIgdGVzdCA9IC8oLT8pKFxkKikoPzpuKFsrXC1dP1xkKikpPy8uZXhlYyhtYXRjaFsyXSA9PT0gImV2ZW4iICYmICIybiIgfHwgbWF0Y2hbMl0gPT09ICJvZGQiICYmICIybisxIiB8fCAhL1xELy50ZXN0KG1hdGNoWzJdKSAmJiAiMG4rIiArIG1hdGNoWzJdIHx8IG1hdGNoWzJdKTsgLy8gY2FsY3VsYXRlIHRoZSBudW1iZXJzIChmaXJzdCluKyhsYXN0KSBpbmNsdWRpbmcgaWYgdGhleSBhcmUgbmVnYXRpdmUKCiAgICAgICAgICAgIG1hdGNoWzJdID0gdGVzdFsxXSArICh0ZXN0WzJdIHx8IDEpIC0gMDsKICAgICAgICAgICAgbWF0Y2hbM10gPSB0ZXN0WzNdIC0gMDsKICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hbMl0pIHsKICAgICAgICAgICAgX1NpenpsZTIuZXJyb3IobWF0Y2hbMF0pOwogICAgICAgICAgfSAvLyBUT0RPOiBNb3ZlIHRvIG5vcm1hbCBjYWNoaW5nIHN5c3RlbQoKCiAgICAgICAgICBtYXRjaFswXSA9IGRvbmUrKzsKICAgICAgICAgIHJldHVybiBtYXRjaDsKICAgICAgICB9LAogICAgICAgIEFUVFI6IGZ1bmN0aW9uIEFUVFIobWF0Y2gsIGN1ckxvb3AsIGlucGxhY2UsIHJlc3VsdCwgbm90LCBpc1hNTCkgewogICAgICAgICAgdmFyIG5hbWUgPSBtYXRjaFsxXSA9IG1hdGNoWzFdLnJlcGxhY2UockJhY2tzbGFzaCwgIiIpOwoKICAgICAgICAgIGlmICghaXNYTUwgJiYgRXhwci5hdHRyTWFwW25hbWVdKSB7CiAgICAgICAgICAgIG1hdGNoWzFdID0gRXhwci5hdHRyTWFwW25hbWVdOwogICAgICAgICAgfSAvLyBIYW5kbGUgaWYgYW4gdW4tcXVvdGVkIHZhbHVlIHdhcyB1c2VkCgoKICAgICAgICAgIG1hdGNoWzRdID0gKG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8ICIiKS5yZXBsYWNlKHJCYWNrc2xhc2gsICIiKTsKCiAgICAgICAgICBpZiAobWF0Y2hbMl0gPT09ICJ+PSIpIHsKICAgICAgICAgICAgbWF0Y2hbNF0gPSAiICIgKyBtYXRjaFs0XSArICIgIjsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgfSwKICAgICAgICBQU0VVRE86IGZ1bmN0aW9uIFBTRVVETyhtYXRjaCwgY3VyTG9vcCwgaW5wbGFjZSwgcmVzdWx0LCBub3QpIHsKICAgICAgICAgIGlmIChtYXRjaFsxXSA9PT0gIm5vdCIpIHsKICAgICAgICAgICAgLy8gSWYgd2UncmUgZGVhbGluZyB3aXRoIGEgY29tcGxleCBleHByZXNzaW9uLCBvciBhIHNpbXBsZSBvbmUKICAgICAgICAgICAgaWYgKChjaHVua2VyLmV4ZWMobWF0Y2hbM10pIHx8ICIiKS5sZW5ndGggPiAxIHx8IC9eXHcvLnRlc3QobWF0Y2hbM10pKSB7CiAgICAgICAgICAgICAgbWF0Y2hbM10gPSBfU2l6emxlMihtYXRjaFszXSwgbnVsbCwgbnVsbCwgY3VyTG9vcCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdmFyIHJldCA9IF9TaXp6bGUyLmZpbHRlcihtYXRjaFszXSwgY3VyTG9vcCwgaW5wbGFjZSwgdHJ1ZSBeIG5vdCk7CgogICAgICAgICAgICAgIGlmICghaW5wbGFjZSkgewogICAgICAgICAgICAgICAgcmVzdWx0LnB1c2guYXBwbHkocmVzdWx0LCByZXQpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKEV4cHIubWF0Y2guUE9TLnRlc3QobWF0Y2hbMF0pIHx8IEV4cHIubWF0Y2guQ0hJTEQudGVzdChtYXRjaFswXSkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG1hdGNoOwogICAgICAgIH0sCiAgICAgICAgUE9TOiBmdW5jdGlvbiBQT1MobWF0Y2gpIHsKICAgICAgICAgIG1hdGNoLnVuc2hpZnQodHJ1ZSk7CiAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgfQogICAgICB9LAogICAgICBmaWx0ZXJzOiB7CiAgICAgICAgZW5hYmxlZDogZnVuY3Rpb24gZW5hYmxlZChlbGVtKSB7CiAgICAgICAgICByZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gZmFsc2UgJiYgZWxlbS50eXBlICE9PSAiaGlkZGVuIjsKICAgICAgICB9LAogICAgICAgIGRpc2FibGVkOiBmdW5jdGlvbiBkaXNhYmxlZChlbGVtKSB7CiAgICAgICAgICByZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGNoZWNrZWQ6IGZ1bmN0aW9uIGNoZWNrZWQoZWxlbSkgewogICAgICAgICAgcmV0dXJuIGVsZW0uY2hlY2tlZCA9PT0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIHNlbGVjdGVkOiBmdW5jdGlvbiBzZWxlY3RlZChlbGVtKSB7CiAgICAgICAgICAvLyBBY2Nlc3NpbmcgdGhpcyBwcm9wZXJ0eSBtYWtlcyBzZWxlY3RlZC1ieS1kZWZhdWx0CiAgICAgICAgICAvLyBvcHRpb25zIGluIFNhZmFyaSB3b3JrIHByb3Blcmx5CiAgICAgICAgICBpZiAoZWxlbS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgIGVsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4OwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBlbGVtLnNlbGVjdGVkID09PSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgcGFyZW50OiBmdW5jdGlvbiBwYXJlbnQoZWxlbSkgewogICAgICAgICAgcmV0dXJuICEhZWxlbS5maXJzdENoaWxkOwogICAgICAgIH0sCiAgICAgICAgZW1wdHk6IGZ1bmN0aW9uIGVtcHR5KGVsZW0pIHsKICAgICAgICAgIHJldHVybiAhZWxlbS5maXJzdENoaWxkOwogICAgICAgIH0sCiAgICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoZWxlbSwgaSwgbWF0Y2gpIHsKICAgICAgICAgIHJldHVybiAhIV9TaXp6bGUyKG1hdGNoWzNdLCBlbGVtKS5sZW5ndGg7CiAgICAgICAgfSwKICAgICAgICBoZWFkZXI6IGZ1bmN0aW9uIGhlYWRlcihlbGVtKSB7CiAgICAgICAgICByZXR1cm4gL2hcZC9pLnRlc3QoZWxlbS5ub2RlTmFtZSk7CiAgICAgICAgfSwKICAgICAgICB0ZXh0OiBmdW5jdGlvbiB0ZXh0KGVsZW0pIHsKICAgICAgICAgIHZhciBhdHRyID0gZWxlbS5nZXRBdHRyaWJ1dGUoInR5cGUiKSwKICAgICAgICAgICAgICB0eXBlID0gZWxlbS50eXBlOyAvLyBJRTYgYW5kIDcgd2lsbCBtYXAgZWxlbS50eXBlIHRvICd0ZXh0JyBmb3IgbmV3IEhUTUw1IHR5cGVzIChzZWFyY2gsIGV0YykKICAgICAgICAgIC8vIHVzZSBnZXRBdHRyaWJ1dGUgaW5zdGVhZCB0byB0ZXN0IHRoaXMgY2FzZQoKICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgJiYgInRleHQiID09PSB0eXBlICYmIChhdHRyID09PSB0eXBlIHx8IGF0dHIgPT09IG51bGwpOwogICAgICAgIH0sCiAgICAgICAgcmFkaW86IGZ1bmN0aW9uIHJhZGlvKGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgJiYgInJhZGlvIiA9PT0gZWxlbS50eXBlOwogICAgICAgIH0sCiAgICAgICAgY2hlY2tib3g6IGZ1bmN0aW9uIGNoZWNrYm94KGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgJiYgImNoZWNrYm94IiA9PT0gZWxlbS50eXBlOwogICAgICAgIH0sCiAgICAgICAgZmlsZTogZnVuY3Rpb24gZmlsZShlbGVtKSB7CiAgICAgICAgICByZXR1cm4gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiaW5wdXQiICYmICJmaWxlIiA9PT0gZWxlbS50eXBlOwogICAgICAgIH0sCiAgICAgICAgcGFzc3dvcmQ6IGZ1bmN0aW9uIHBhc3N3b3JkKGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgJiYgInBhc3N3b3JkIiA9PT0gZWxlbS50eXBlOwogICAgICAgIH0sCiAgICAgICAgc3VibWl0OiBmdW5jdGlvbiBzdWJtaXQoZWxlbSkgewogICAgICAgICAgdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICByZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmICJzdWJtaXQiID09PSBlbGVtLnR5cGU7CiAgICAgICAgfSwKICAgICAgICBpbWFnZTogZnVuY3Rpb24gaW1hZ2UoZWxlbSkgewogICAgICAgICAgcmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiAmJiAiaW1hZ2UiID09PSBlbGVtLnR5cGU7CiAgICAgICAgfSwKICAgICAgICByZXNldDogZnVuY3Rpb24gcmVzZXQoZWxlbSkgewogICAgICAgICAgdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICByZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmICJyZXNldCIgPT09IGVsZW0udHlwZTsKICAgICAgICB9LAogICAgICAgIGJ1dHRvbjogZnVuY3Rpb24gYnV0dG9uKGVsZW0pIHsKICAgICAgICAgIHZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgcmV0dXJuIG5hbWUgPT09ICJpbnB1dCIgJiYgImJ1dHRvbiIgPT09IGVsZW0udHlwZSB8fCBuYW1lID09PSAiYnV0dG9uIjsKICAgICAgICB9LAogICAgICAgIGlucHV0OiBmdW5jdGlvbiBpbnB1dChlbGVtKSB7CiAgICAgICAgICByZXR1cm4gL2lucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24vaS50ZXN0KGVsZW0ubm9kZU5hbWUpOwogICAgICAgIH0sCiAgICAgICAgZm9jdXM6IGZ1bmN0aW9uIGZvY3VzKGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtID09PSBlbGVtLm93bmVyRG9jdW1lbnQuYWN0aXZlRWxlbWVudDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNldEZpbHRlcnM6IHsKICAgICAgICBmaXJzdDogZnVuY3Rpb24gZmlyc3QoZWxlbSwgaSkgewogICAgICAgICAgcmV0dXJuIGkgPT09IDA7CiAgICAgICAgfSwKICAgICAgICBsYXN0OiBmdW5jdGlvbiBsYXN0KGVsZW0sIGksIG1hdGNoLCBhcnJheSkgewogICAgICAgICAgcmV0dXJuIGkgPT09IGFycmF5Lmxlbmd0aCAtIDE7CiAgICAgICAgfSwKICAgICAgICBldmVuOiBmdW5jdGlvbiBldmVuKGVsZW0sIGkpIHsKICAgICAgICAgIHJldHVybiBpICUgMiA9PT0gMDsKICAgICAgICB9LAogICAgICAgIG9kZDogZnVuY3Rpb24gb2RkKGVsZW0sIGkpIHsKICAgICAgICAgIHJldHVybiBpICUgMiA9PT0gMTsKICAgICAgICB9LAogICAgICAgIGx0OiBmdW5jdGlvbiBsdChlbGVtLCBpLCBtYXRjaCkgewogICAgICAgICAgcmV0dXJuIGkgPCBtYXRjaFszXSAtIDA7CiAgICAgICAgfSwKICAgICAgICBndDogZnVuY3Rpb24gZ3QoZWxlbSwgaSwgbWF0Y2gpIHsKICAgICAgICAgIHJldHVybiBpID4gbWF0Y2hbM10gLSAwOwogICAgICAgIH0sCiAgICAgICAgbnRoOiBmdW5jdGlvbiBudGgoZWxlbSwgaSwgbWF0Y2gpIHsKICAgICAgICAgIHJldHVybiBtYXRjaFszXSAtIDAgPT09IGk7CiAgICAgICAgfSwKICAgICAgICBlcTogZnVuY3Rpb24gZXEoZWxlbSwgaSwgbWF0Y2gpIHsKICAgICAgICAgIHJldHVybiBtYXRjaFszXSAtIDAgPT09IGk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmaWx0ZXI6IHsKICAgICAgICBQU0VVRE86IGZ1bmN0aW9uIFBTRVVETyhlbGVtLCBtYXRjaCwgaSwgYXJyYXkpIHsKICAgICAgICAgIHZhciBuYW1lID0gbWF0Y2hbMV0sCiAgICAgICAgICAgICAgZmlsdGVyID0gRXhwci5maWx0ZXJzW25hbWVdOwoKICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIGZpbHRlcihlbGVtLCBpLCBtYXRjaCwgYXJyYXkpOwogICAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAiY29udGFpbnMiKSB7CiAgICAgICAgICAgIHJldHVybiAoZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVyVGV4dCB8fCBnZXRUZXh0KFtlbGVtXSkgfHwgIiIpLmluZGV4T2YobWF0Y2hbM10pID49IDA7CiAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICJub3QiKSB7CiAgICAgICAgICAgIHZhciBub3QgPSBtYXRjaFszXTsKCiAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBsID0gbm90Lmxlbmd0aDsgaiA8IGw7IGorKykgewogICAgICAgICAgICAgIGlmIChub3Rbal0gPT09IGVsZW0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX1NpenpsZTIuZXJyb3IobmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBDSElMRDogZnVuY3Rpb24gQ0hJTEQoZWxlbSwgbWF0Y2gpIHsKICAgICAgICAgIHZhciBmaXJzdCwKICAgICAgICAgICAgICBsYXN0LAogICAgICAgICAgICAgIGRvbmVOYW1lLAogICAgICAgICAgICAgIHBhcmVudCwKICAgICAgICAgICAgICBjYWNoZSwKICAgICAgICAgICAgICBjb3VudCwKICAgICAgICAgICAgICBkaWZmLAogICAgICAgICAgICAgIHR5cGUgPSBtYXRjaFsxXSwKICAgICAgICAgICAgICBub2RlID0gZWxlbTsKCiAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgY2FzZSAib25seSI6CiAgICAgICAgICAgIGNhc2UgImZpcnN0IjoKICAgICAgICAgICAgICB3aGlsZSAobm9kZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKSB7CiAgICAgICAgICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gImZpcnN0IikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBub2RlID0gZWxlbTsKCiAgICAgICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCiAgICAgICAgICAgIGNhc2UgImxhc3QiOgogICAgICAgICAgICAgIHdoaWxlIChub2RlID0gbm9kZS5uZXh0U2libGluZykgewogICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgICAgICBjYXNlICJudGgiOgogICAgICAgICAgICAgIGZpcnN0ID0gbWF0Y2hbMl07CiAgICAgICAgICAgICAgbGFzdCA9IG1hdGNoWzNdOwoKICAgICAgICAgICAgICBpZiAoZmlyc3QgPT09IDEgJiYgbGFzdCA9PT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBkb25lTmFtZSA9IG1hdGNoWzBdOwogICAgICAgICAgICAgIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKCiAgICAgICAgICAgICAgaWYgKHBhcmVudCAmJiAocGFyZW50W2V4cGFuZG9dICE9PSBkb25lTmFtZSB8fCAhZWxlbS5ub2RlSW5kZXgpKSB7CiAgICAgICAgICAgICAgICBjb3VudCA9IDA7CgogICAgICAgICAgICAgICAgZm9yIChub2RlID0gcGFyZW50LmZpcnN0Q2hpbGQ7IG5vZGU7IG5vZGUgPSBub2RlLm5leHRTaWJsaW5nKSB7CiAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgbm9kZS5ub2RlSW5kZXggPSArK2NvdW50OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcGFyZW50W2V4cGFuZG9dID0gZG9uZU5hbWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBkaWZmID0gZWxlbS5ub2RlSW5kZXggLSBsYXN0OwoKICAgICAgICAgICAgICBpZiAoZmlyc3QgPT09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBkaWZmID09PSAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZGlmZiAlIGZpcnN0ID09PSAwICYmIGRpZmYgLyBmaXJzdCA+PSAwOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBJRDogZnVuY3Rpb24gSUQoZWxlbSwgbWF0Y2gpIHsKICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVUeXBlID09PSAxICYmIGVsZW0uZ2V0QXR0cmlidXRlKCJpZCIpID09PSBtYXRjaDsKICAgICAgICB9LAogICAgICAgIFRBRzogZnVuY3Rpb24gVEFHKGVsZW0sIG1hdGNoKSB7CiAgICAgICAgICByZXR1cm4gbWF0Y2ggPT09ICIqIiAmJiBlbGVtLm5vZGVUeXBlID09PSAxIHx8ICEhZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG1hdGNoOwogICAgICAgIH0sCiAgICAgICAgQ0xBU1M6IGZ1bmN0aW9uIENMQVNTKGVsZW0sIG1hdGNoKSB7CiAgICAgICAgICByZXR1cm4gKCIgIiArIChlbGVtLmNsYXNzTmFtZSB8fCBlbGVtLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSkgKyAiICIpLmluZGV4T2YobWF0Y2gpID4gLTE7CiAgICAgICAgfSwKICAgICAgICBBVFRSOiBmdW5jdGlvbiBBVFRSKGVsZW0sIG1hdGNoKSB7CiAgICAgICAgICB2YXIgbmFtZSA9IG1hdGNoWzFdLAogICAgICAgICAgICAgIHJlc3VsdCA9IF9TaXp6bGUyLmF0dHIgPyBfU2l6emxlMi5hdHRyKGVsZW0sIG5hbWUpIDogRXhwci5hdHRySGFuZGxlW25hbWVdID8gRXhwci5hdHRySGFuZGxlW25hbWVdKGVsZW0pIDogZWxlbVtuYW1lXSAhPSBudWxsID8gZWxlbVtuYW1lXSA6IGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUpLAogICAgICAgICAgICAgIHZhbHVlID0gcmVzdWx0ICsgIiIsCiAgICAgICAgICAgICAgdHlwZSA9IG1hdGNoWzJdLAogICAgICAgICAgICAgIGNoZWNrID0gbWF0Y2hbNF07CiAgICAgICAgICByZXR1cm4gcmVzdWx0ID09IG51bGwgPyB0eXBlID09PSAiIT0iIDogIXR5cGUgJiYgX1NpenpsZTIuYXR0ciA/IHJlc3VsdCAhPSBudWxsIDogdHlwZSA9PT0gIj0iID8gdmFsdWUgPT09IGNoZWNrIDogdHlwZSA9PT0gIio9IiA/IHZhbHVlLmluZGV4T2YoY2hlY2spID49IDAgOiB0eXBlID09PSAifj0iID8gKCIgIiArIHZhbHVlICsgIiAiKS5pbmRleE9mKGNoZWNrKSA+PSAwIDogIWNoZWNrID8gdmFsdWUgJiYgcmVzdWx0ICE9PSBmYWxzZSA6IHR5cGUgPT09ICIhPSIgPyB2YWx1ZSAhPT0gY2hlY2sgOiB0eXBlID09PSAiXj0iID8gdmFsdWUuaW5kZXhPZihjaGVjaykgPT09IDAgOiB0eXBlID09PSAiJD0iID8gdmFsdWUuc3Vic3RyKHZhbHVlLmxlbmd0aCAtIGNoZWNrLmxlbmd0aCkgPT09IGNoZWNrIDogdHlwZSA9PT0gInw9IiA/IHZhbHVlID09PSBjaGVjayB8fCB2YWx1ZS5zdWJzdHIoMCwgY2hlY2subGVuZ3RoICsgMSkgPT09IGNoZWNrICsgIi0iIDogZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBQT1M6IGZ1bmN0aW9uIFBPUyhlbGVtLCBtYXRjaCwgaSwgYXJyYXkpIHsKICAgICAgICAgIHZhciBuYW1lID0gbWF0Y2hbMl0sCiAgICAgICAgICAgICAgZmlsdGVyID0gRXhwci5zZXRGaWx0ZXJzW25hbWVdOwoKICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIGZpbHRlcihlbGVtLCBpLCBtYXRjaCwgYXJyYXkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICB2YXIgb3JpZ1BPUyA9IEV4cHIubWF0Y2guUE9TLAogICAgICAgIGZlc2NhcGUgPSBmdW5jdGlvbiBmZXNjYXBlKGFsbCwgbnVtKSB7CiAgICAgIHJldHVybiAiXFwiICsgKG51bSAtIDAgKyAxKTsKICAgIH07CgogICAgZm9yICh2YXIgdHlwZSBpbiBFeHByLm1hdGNoKSB7CiAgICAgIEV4cHIubWF0Y2hbdHlwZV0gPSBuZXcgUmVnRXhwKEV4cHIubWF0Y2hbdHlwZV0uc291cmNlICsgLyg/IVteXFtdKlxdKSg/IVteXChdKlwpKS8uc291cmNlKTsKICAgICAgRXhwci5sZWZ0TWF0Y2hbdHlwZV0gPSBuZXcgUmVnRXhwKC8oXig/Oi58XHJ8XG4pKj8pLy5zb3VyY2UgKyBFeHByLm1hdGNoW3R5cGVdLnNvdXJjZS5yZXBsYWNlKC9cXChcZCspL2csIGZlc2NhcGUpKTsKICAgIH0gLy8gRXhwb3NlIG9yaWdQT1MKICAgIC8vICJnbG9iYWwiIGFzIGluIHJlZ2FyZGxlc3Mgb2YgcmVsYXRpb24gdG8gYnJhY2tldHMvcGFyZW5zCgoKICAgIEV4cHIubWF0Y2guZ2xvYmFsUE9TID0gb3JpZ1BPUzsKCiAgICB2YXIgbWFrZUFycmF5ID0gZnVuY3Rpb24gbWFrZUFycmF5KGFycmF5LCByZXN1bHRzKSB7CiAgICAgIGFycmF5ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyYXksIDApOwoKICAgICAgaWYgKHJlc3VsdHMpIHsKICAgICAgICByZXN1bHRzLnB1c2guYXBwbHkocmVzdWx0cywgYXJyYXkpOwogICAgICAgIHJldHVybiByZXN1bHRzOwogICAgICB9CgogICAgICByZXR1cm4gYXJyYXk7CiAgICB9OyAvLyBQZXJmb3JtIGEgc2ltcGxlIGNoZWNrIHRvIGRldGVybWluZSBpZiB0aGUgYnJvd3NlciBpcyBjYXBhYmxlIG9mCiAgICAvLyBjb252ZXJ0aW5nIGEgTm9kZUxpc3QgdG8gYW4gYXJyYXkgdXNpbmcgYnVpbHRpbiBtZXRob2RzLgogICAgLy8gQWxzbyB2ZXJpZmllcyB0aGF0IHRoZSByZXR1cm5lZCBhcnJheSBob2xkcyBET00gbm9kZXMKICAgIC8vICh3aGljaCBpcyBub3QgdGhlIGNhc2UgaW4gdGhlIEJsYWNrYmVycnkgYnJvd3NlcikKCgogICAgdHJ5IHsKICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNoaWxkTm9kZXMsIDApWzBdLm5vZGVUeXBlOyAvLyBQcm92aWRlIGEgZmFsbGJhY2sgbWV0aG9kIGlmIGl0IGRvZXMgbm90IHdvcmsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbWFrZUFycmF5ID0gZnVuY3Rpb24gbWFrZUFycmF5KGFycmF5LCByZXN1bHRzKSB7CiAgICAgICAgdmFyIGkgPSAwLAogICAgICAgICAgICByZXQgPSByZXN1bHRzIHx8IFtdOwoKICAgICAgICBpZiAodG9TdHJpbmcuY2FsbChhcnJheSkgPT09ICJbb2JqZWN0IEFycmF5XSIpIHsKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHJldCwgYXJyYXkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodHlwZW9mIGFycmF5Lmxlbmd0aCA9PT0gIm51bWJlciIpIHsKICAgICAgICAgICAgZm9yICh2YXIgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICAgIHJldC5wdXNoKGFycmF5W2ldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yICg7IGFycmF5W2ldOyBpKyspIHsKICAgICAgICAgICAgICByZXQucHVzaChhcnJheVtpXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH07CiAgICB9CgogICAgdmFyIHNvcnRPcmRlciwgc2libGluZ0NoZWNrOwoKICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24pIHsKICAgICAgc29ydE9yZGVyID0gZnVuY3Rpb24gc29ydE9yZGVyKGEsIGIpIHsKICAgICAgICBpZiAoYSA9PT0gYikgewogICAgICAgICAgaGFzRHVwbGljYXRlID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIHx8ICFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSB7CiAgICAgICAgICByZXR1cm4gYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiA/IC0xIDogMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpICYgNCA/IC0xIDogMTsKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIHNvcnRPcmRlciA9IGZ1bmN0aW9uIHNvcnRPcmRlcihhLCBiKSB7CiAgICAgICAgLy8gVGhlIG5vZGVzIGFyZSBpZGVudGljYWwsIHdlIGNhbiBleGl0IGVhcmx5CiAgICAgICAgaWYgKGEgPT09IGIpIHsKICAgICAgICAgIGhhc0R1cGxpY2F0ZSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gMDsgLy8gRmFsbGJhY2sgdG8gdXNpbmcgc291cmNlSW5kZXggKGluIElFKSBpZiBpdCdzIGF2YWlsYWJsZSBvbiBib3RoIG5vZGVzCiAgICAgICAgfSBlbHNlIGlmIChhLnNvdXJjZUluZGV4ICYmIGIuc291cmNlSW5kZXgpIHsKICAgICAgICAgIHJldHVybiBhLnNvdXJjZUluZGV4IC0gYi5zb3VyY2VJbmRleDsKICAgICAgICB9CgogICAgICAgIHZhciBhbCwKICAgICAgICAgICAgYmwsCiAgICAgICAgICAgIGFwID0gW10sCiAgICAgICAgICAgIGJwID0gW10sCiAgICAgICAgICAgIGF1cCA9IGEucGFyZW50Tm9kZSwKICAgICAgICAgICAgYnVwID0gYi5wYXJlbnROb2RlLAogICAgICAgICAgICBjdXIgPSBhdXA7IC8vIElmIHRoZSBub2RlcyBhcmUgc2libGluZ3MgKG9yIGlkZW50aWNhbCkgd2UgY2FuIGRvIGEgcXVpY2sgY2hlY2sKCiAgICAgICAgaWYgKGF1cCA9PT0gYnVwKSB7CiAgICAgICAgICByZXR1cm4gc2libGluZ0NoZWNrKGEsIGIpOyAvLyBJZiBubyBwYXJlbnRzIHdlcmUgZm91bmQgdGhlbiB0aGUgbm9kZXMgYXJlIGRpc2Nvbm5lY3RlZAogICAgICAgIH0gZWxzZSBpZiAoIWF1cCkgewogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0gZWxzZSBpZiAoIWJ1cCkgewogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfSAvLyBPdGhlcndpc2UgdGhleSdyZSBzb21ld2hlcmUgZWxzZSBpbiB0aGUgdHJlZSBzbyB3ZSBuZWVkCiAgICAgICAgLy8gdG8gYnVpbGQgdXAgYSBmdWxsIGxpc3Qgb2YgdGhlIHBhcmVudE5vZGVzIGZvciBjb21wYXJpc29uCgoKICAgICAgICB3aGlsZSAoY3VyKSB7CiAgICAgICAgICBhcC51bnNoaWZ0KGN1cik7CiAgICAgICAgICBjdXIgPSBjdXIucGFyZW50Tm9kZTsKICAgICAgICB9CgogICAgICAgIGN1ciA9IGJ1cDsKCiAgICAgICAgd2hpbGUgKGN1cikgewogICAgICAgICAgYnAudW5zaGlmdChjdXIpOwogICAgICAgICAgY3VyID0gY3VyLnBhcmVudE5vZGU7CiAgICAgICAgfQoKICAgICAgICBhbCA9IGFwLmxlbmd0aDsKICAgICAgICBibCA9IGJwLmxlbmd0aDsgLy8gU3RhcnQgd2Fsa2luZyBkb3duIHRoZSB0cmVlIGxvb2tpbmcgZm9yIGEgZGlzY3JlcGFuY3kKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbCAmJiBpIDwgYmw7IGkrKykgewogICAgICAgICAgaWYgKGFwW2ldICE9PSBicFtpXSkgewogICAgICAgICAgICByZXR1cm4gc2libGluZ0NoZWNrKGFwW2ldLCBicFtpXSk7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBXZSBlbmRlZCBzb21lcGxhY2UgdXAgdGhlIHRyZWUgc28gZG8gYSBzaWJsaW5nIGNoZWNrCgoKICAgICAgICByZXR1cm4gaSA9PT0gYWwgPyBzaWJsaW5nQ2hlY2soYSwgYnBbaV0sIC0xKSA6IHNpYmxpbmdDaGVjayhhcFtpXSwgYiwgMSk7CiAgICAgIH07CgogICAgICBzaWJsaW5nQ2hlY2sgPSBmdW5jdGlvbiBzaWJsaW5nQ2hlY2soYSwgYiwgcmV0KSB7CiAgICAgICAgaWYgKGEgPT09IGIpIHsKICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgfQoKICAgICAgICB2YXIgY3VyID0gYS5uZXh0U2libGluZzsKCiAgICAgICAgd2hpbGUgKGN1cikgewogICAgICAgICAgaWYgKGN1ciA9PT0gYikgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICB9CgogICAgICAgICAgY3VyID0gY3VyLm5leHRTaWJsaW5nOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIDE7CiAgICAgIH07CiAgICB9IC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgYnJvd3NlciByZXR1cm5zIGVsZW1lbnRzIGJ5IG5hbWUgd2hlbgogICAgLy8gcXVlcnlpbmcgYnkgZ2V0RWxlbWVudEJ5SWQgKGFuZCBwcm92aWRlIGEgd29ya2Fyb3VuZCkKCgogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgLy8gV2UncmUgZ29pbmcgdG8gaW5qZWN0IGEgZmFrZSBpbnB1dCBlbGVtZW50IHdpdGggYSBzcGVjaWZpZWQgbmFtZQogICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLAogICAgICAgICAgaWQgPSAic2NyaXB0IiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpLAogICAgICAgICAgcm9vdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgICAgZm9ybS5pbm5lckhUTUwgPSAiPGEgbmFtZT0nIiArIGlkICsgIicvPiI7IC8vIEluamVjdCBpdCBpbnRvIHRoZSByb290IGVsZW1lbnQsIGNoZWNrIGl0cyBzdGF0dXMsIGFuZCByZW1vdmUgaXQgcXVpY2tseQoKICAgICAgcm9vdC5pbnNlcnRCZWZvcmUoZm9ybSwgcm9vdC5maXJzdENoaWxkKTsgLy8gVGhlIHdvcmthcm91bmQgaGFzIHRvIGRvIGFkZGl0aW9uYWwgY2hlY2tzIGFmdGVyIGEgZ2V0RWxlbWVudEJ5SWQKICAgICAgLy8gV2hpY2ggc2xvd3MgdGhpbmdzIGRvd24gZm9yIG90aGVyIGJyb3dzZXJzIChoZW5jZSB0aGUgYnJhbmNoaW5nKQoKICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSkgewogICAgICAgIEV4cHIuZmluZC5JRCA9IGZ1bmN0aW9uIChtYXRjaCwgY29udGV4dCwgaXNYTUwpIHsKICAgICAgICAgIGlmICh0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCAhPT0gInVuZGVmaW5lZCIgJiYgIWlzWE1MKSB7CiAgICAgICAgICAgIHZhciBtID0gY29udGV4dC5nZXRFbGVtZW50QnlJZChtYXRjaFsxXSk7CiAgICAgICAgICAgIHJldHVybiBtID8gbS5pZCA9PT0gbWF0Y2hbMV0gfHwgdHlwZW9mIG0uZ2V0QXR0cmlidXRlTm9kZSAhPT0gInVuZGVmaW5lZCIgJiYgbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpLm5vZGVWYWx1ZSA9PT0gbWF0Y2hbMV0gPyBbbV0gOiB1bmRlZmluZWQgOiBbXTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBFeHByLmZpbHRlci5JRCA9IGZ1bmN0aW9uIChlbGVtLCBtYXRjaCkgewogICAgICAgICAgdmFyIG5vZGUgPSB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlICE9PSAidW5kZWZpbmVkIiAmJiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7CiAgICAgICAgICByZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiBub2RlICYmIG5vZGUubm9kZVZhbHVlID09PSBtYXRjaDsKICAgICAgICB9OwogICAgICB9CgogICAgICByb290LnJlbW92ZUNoaWxkKGZvcm0pOyAvLyByZWxlYXNlIG1lbW9yeSBpbiBJRQoKICAgICAgcm9vdCA9IGZvcm0gPSBudWxsOwogICAgfSkoKTsKCiAgICAoZnVuY3Rpb24gKCkgewogICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIGJyb3dzZXIgcmV0dXJucyBvbmx5IGVsZW1lbnRzCiAgICAgIC8vIHdoZW4gZG9pbmcgZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKQogICAgICAvLyBDcmVhdGUgYSBmYWtlIGVsZW1lbnQKICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBkaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlQ29tbWVudCgiIikpOyAvLyBNYWtlIHN1cmUgbm8gY29tbWVudHMgYXJlIGZvdW5kCgogICAgICBpZiAoZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoID4gMCkgewogICAgICAgIEV4cHIuZmluZC5UQUcgPSBmdW5jdGlvbiAobWF0Y2gsIGNvbnRleHQpIHsKICAgICAgICAgIHZhciByZXN1bHRzID0gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShtYXRjaFsxXSk7IC8vIEZpbHRlciBvdXQgcG9zc2libGUgY29tbWVudHMKCiAgICAgICAgICBpZiAobWF0Y2hbMV0gPT09ICIqIikgewogICAgICAgICAgICB2YXIgdG1wID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgcmVzdWx0c1tpXTsgaSsrKSB7CiAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbaV0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICAgIHRtcC5wdXNoKHJlc3VsdHNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVzdWx0cyA9IHRtcDsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzdWx0czsKICAgICAgICB9OwogICAgICB9IC8vIENoZWNrIHRvIHNlZSBpZiBhbiBhdHRyaWJ1dGUgcmV0dXJucyBub3JtYWxpemVkIGhyZWYgYXR0cmlidXRlcwoKCiAgICAgIGRpdi5pbm5lckhUTUwgPSAiPGEgaHJlZj0nIyc+PC9hPiI7CgogICAgICBpZiAoZGl2LmZpcnN0Q2hpbGQgJiYgdHlwZW9mIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSAhPT0gInVuZGVmaW5lZCIgJiYgZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIikgIT09ICIjIikgewogICAgICAgIEV4cHIuYXR0ckhhbmRsZS5ocmVmID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgIHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgiaHJlZiIsIDIpOwogICAgICAgIH07CiAgICAgIH0gLy8gcmVsZWFzZSBtZW1vcnkgaW4gSUUKCgogICAgICBkaXYgPSBudWxsOwogICAgfSkoKTsKCiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCkgewogICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBvbGRTaXp6bGUgPSBfU2l6emxlMiwKICAgICAgICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksCiAgICAgICAgICAgIGlkID0gIl9fc2l6emxlX18iOwogICAgICAgIGRpdi5pbm5lckhUTUwgPSAiPHAgY2xhc3M9J1RFU1QnPjwvcD4iOyAvLyBTYWZhcmkgY2FuJ3QgaGFuZGxlIHVwcGVyY2FzZSBvciB1bmljb2RlIGNoYXJhY3RlcnMgd2hlbgogICAgICAgIC8vIGluIHF1aXJrcyBtb2RlLgoKICAgICAgICBpZiAoZGl2LnF1ZXJ5U2VsZWN0b3JBbGwgJiYgZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIi5URVNUIikubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfU2l6emxlMiA9IGZ1bmN0aW9uIF9TaXp6bGUocXVlcnksIGNvbnRleHQsIGV4dHJhLCBzZWVkKSB7CiAgICAgICAgICBjb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDsgLy8gT25seSB1c2UgcXVlcnlTZWxlY3RvckFsbCBvbiBub24tWE1MIGRvY3VtZW50cwogICAgICAgICAgLy8gKElEIHNlbGVjdG9ycyBkb24ndCB3b3JrIGluIG5vbi1IVE1MIGRvY3VtZW50cykKCiAgICAgICAgICBpZiAoIXNlZWQgJiYgIV9TaXp6bGUyLmlzWE1MKGNvbnRleHQpKSB7CiAgICAgICAgICAgIC8vIFNlZSBpZiB3ZSBmaW5kIGEgc2VsZWN0b3IgdG8gc3BlZWQgdXAKICAgICAgICAgICAgdmFyIG1hdGNoID0gL14oXHcrJCl8XlwuKFtcd1wtXSskKXxeIyhbXHdcLV0rJCkvLmV4ZWMocXVlcnkpOwoKICAgICAgICAgICAgaWYgKG1hdGNoICYmIChjb250ZXh0Lm5vZGVUeXBlID09PSAxIHx8IGNvbnRleHQubm9kZVR5cGUgPT09IDkpKSB7CiAgICAgICAgICAgICAgLy8gU3BlZWQtdXA6IFNpenpsZSgiVEFHIikKICAgICAgICAgICAgICBpZiAobWF0Y2hbMV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBtYWtlQXJyYXkoY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShxdWVyeSksIGV4dHJhKTsgLy8gU3BlZWQtdXA6IFNpenpsZSgiLkNMQVNTIikKICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoWzJdICYmIEV4cHIuZmluZC5DTEFTUyAmJiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtYWtlQXJyYXkoY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG1hdGNoWzJdKSwgZXh0cmEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNvbnRleHQubm9kZVR5cGUgPT09IDkpIHsKICAgICAgICAgICAgICAvLyBTcGVlZC11cDogU2l6emxlKCJib2R5IikKICAgICAgICAgICAgICAvLyBUaGUgYm9keSBlbGVtZW50IG9ubHkgZXhpc3RzIG9uY2UsIG9wdGltaXplIGZpbmRpbmcgaXQKICAgICAgICAgICAgICBpZiAocXVlcnkgPT09ICJib2R5IiAmJiBjb250ZXh0LmJvZHkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtYWtlQXJyYXkoW2NvbnRleHQuYm9keV0sIGV4dHJhKTsgLy8gU3BlZWQtdXA6IFNpenpsZSgiI0lEIikKICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoICYmIG1hdGNoWzNdKSB7CiAgICAgICAgICAgICAgICB2YXIgZWxlbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQobWF0Y2hbM10pOyAvLyBDaGVjayBwYXJlbnROb2RlIHRvIGNhdGNoIHdoZW4gQmxhY2tiZXJyeSA0LjYgcmV0dXJucwogICAgICAgICAgICAgICAgLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2MwoKICAgICAgICAgICAgICAgIGlmIChlbGVtICYmIGVsZW0ucGFyZW50Tm9kZSkgewogICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgSUUgYW5kIE9wZXJhIHJldHVybiBpdGVtcwogICAgICAgICAgICAgICAgICAvLyBieSBuYW1lIGluc3RlYWQgb2YgSUQKICAgICAgICAgICAgICAgICAgaWYgKGVsZW0uaWQgPT09IG1hdGNoWzNdKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ha2VBcnJheShbZWxlbV0sIGV4dHJhKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ha2VBcnJheShbXSwgZXh0cmEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBtYWtlQXJyYXkoY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSwgZXh0cmEpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKHFzYUVycm9yKSB7fSAvLyBxU0Egd29ya3Mgc3RyYW5nZWx5IG9uIEVsZW1lbnQtcm9vdGVkIHF1ZXJpZXMKICAgICAgICAgICAgICAvLyBXZSBjYW4gd29yayBhcm91bmQgdGhpcyBieSBzcGVjaWZ5aW5nIGFuIGV4dHJhIElEIG9uIHRoZSByb290CiAgICAgICAgICAgICAgLy8gYW5kIHdvcmtpbmcgdXAgZnJvbSB0aGVyZSAoVGhhbmtzIHRvIEFuZHJldyBEdXBvbnQgZm9yIHRoZSB0ZWNobmlxdWUpCiAgICAgICAgICAgICAgLy8gSUUgOCBkb2Vzbid0IHdvcmsgb24gb2JqZWN0IGVsZW1lbnRzCgogICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubm9kZVR5cGUgPT09IDEgJiYgY29udGV4dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAib2JqZWN0IikgewogICAgICAgICAgICAgIHZhciBvbGRDb250ZXh0ID0gY29udGV4dCwKICAgICAgICAgICAgICAgICAgb2xkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoImlkIiksCiAgICAgICAgICAgICAgICAgIG5pZCA9IG9sZCB8fCBpZCwKICAgICAgICAgICAgICAgICAgaGFzUGFyZW50ID0gY29udGV4dC5wYXJlbnROb2RlLAogICAgICAgICAgICAgICAgICByZWxhdGl2ZUhpZXJhcmNoeVNlbGVjdG9yID0gL15ccypbK35dLy50ZXN0KHF1ZXJ5KTsKCiAgICAgICAgICAgICAgaWYgKCFvbGQpIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuc2V0QXR0cmlidXRlKCJpZCIsIG5pZCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5pZCA9IG5pZC5yZXBsYWNlKC8nL2csICJcXCQmIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAocmVsYXRpdmVIaWVyYXJjaHlTZWxlY3RvciAmJiBoYXNQYXJlbnQpIHsKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKCFyZWxhdGl2ZUhpZXJhcmNoeVNlbGVjdG9yIHx8IGhhc1BhcmVudCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gbWFrZUFycmF5KGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCgiW2lkPSciICsgbmlkICsgIiddICIgKyBxdWVyeSksIGV4dHJhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChwc2V1ZG9FcnJvcikge30gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoIW9sZCkgewogICAgICAgICAgICAgICAgICBvbGRDb250ZXh0LnJlbW92ZUF0dHJpYnV0ZSgiaWQiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gb2xkU2l6emxlKHF1ZXJ5LCBjb250ZXh0LCBleHRyYSwgc2VlZCk7CiAgICAgICAgfTsKCiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvbGRTaXp6bGUpIHsKICAgICAgICAgIF9TaXp6bGUyW3Byb3BdID0gb2xkU2l6emxlW3Byb3BdOwogICAgICAgIH0gLy8gcmVsZWFzZSBtZW1vcnkgaW4gSUUKCgogICAgICAgIGRpdiA9IG51bGw7CiAgICAgIH0pKCk7CiAgICB9CgogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGh0bWwgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsCiAgICAgICAgICBtYXRjaGVzID0gaHRtbC5tYXRjaGVzU2VsZWN0b3IgfHwgaHRtbC5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgaHRtbC53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgaHRtbC5tc01hdGNoZXNTZWxlY3RvcjsKCiAgICAgIGlmIChtYXRjaGVzKSB7CiAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIGl0J3MgcG9zc2libGUgdG8gZG8gbWF0Y2hlc1NlbGVjdG9yCiAgICAgICAgLy8gb24gYSBkaXNjb25uZWN0ZWQgbm9kZSAoSUUgOSBmYWlscyB0aGlzKQogICAgICAgIHZhciBkaXNjb25uZWN0ZWRNYXRjaCA9ICFtYXRjaGVzLmNhbGwoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksICJkaXYiKSwKICAgICAgICAgICAgcHNldWRvV29ya3MgPSBmYWxzZTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIGZhaWwgd2l0aCBhbiBleGNlcHRpb24KICAgICAgICAgIC8vIEdlY2tvIGRvZXMgbm90IGVycm9yLCByZXR1cm5zIGZhbHNlIGluc3RlYWQKICAgICAgICAgIG1hdGNoZXMuY2FsbChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICJbdGVzdCE9JyddOnNpenpsZSIpOwogICAgICAgIH0gY2F0Y2ggKHBzZXVkb0Vycm9yKSB7CiAgICAgICAgICBwc2V1ZG9Xb3JrcyA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBfU2l6emxlMi5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlvbiAobm9kZSwgZXhwcikgewogICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRlIHNlbGVjdG9ycyBhcmUgcXVvdGVkCiAgICAgICAgICBleHByID0gZXhwci5yZXBsYWNlKC9cPVxzKihbXiciXF1dKilccypcXS9nLCAiPSckMSddIik7CgogICAgICAgICAgaWYgKCFfU2l6emxlMi5pc1hNTChub2RlKSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChwc2V1ZG9Xb3JrcyB8fCAhRXhwci5tYXRjaC5QU0VVRE8udGVzdChleHByKSAmJiAhLyE9Ly50ZXN0KGV4cHIpKSB7CiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gbWF0Y2hlcy5jYWxsKG5vZGUsIGV4cHIpOyAvLyBJRSA5J3MgbWF0Y2hlc1NlbGVjdG9yIHJldHVybnMgZmFsc2Ugb24gZGlzY29ubmVjdGVkIG5vZGVzCgogICAgICAgICAgICAgICAgaWYgKHJldCB8fCAhZGlzY29ubmVjdGVkTWF0Y2ggfHwgLy8gQXMgd2VsbCwgZGlzY29ubmVjdGVkIG5vZGVzIGFyZSBzYWlkIHRvIGJlIGluIGEgZG9jdW1lbnQKICAgICAgICAgICAgICAgIC8vIGZyYWdtZW50IGluIElFIDksIHNvIGNoZWNrIGZvciB0aGF0CiAgICAgICAgICAgICAgICBub2RlLmRvY3VtZW50ICYmIG5vZGUuZG9jdW1lbnQubm9kZVR5cGUgIT09IDExKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfU2l6emxlMihleHByLCBudWxsLCBudWxsLCBbbm9kZV0pLmxlbmd0aCA+IDA7CiAgICAgICAgfTsKICAgICAgfQogICAgfSkoKTsKCiAgICAoZnVuY3Rpb24gKCkgewogICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGRpdi5pbm5lckhUTUwgPSAiPGRpdiBjbGFzcz0ndGVzdCBlJz48L2Rpdj48ZGl2IGNsYXNzPSd0ZXN0Jz48L2Rpdj4iOyAvLyBPcGVyYSBjYW4ndCBmaW5kIGEgc2Vjb25kIGNsYXNzbmFtZSAoaW4gOS42KQogICAgICAvLyBBbHNvLCBtYWtlIHN1cmUgdGhhdCBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIGFjdHVhbGx5IGV4aXN0cwoKICAgICAgaWYgKCFkaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSB8fCBkaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZSIpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBTYWZhcmkgY2FjaGVzIGNsYXNzIGF0dHJpYnV0ZXMsIGRvZXNuJ3QgY2F0Y2ggY2hhbmdlcyAoaW4gMy4yKQoKCiAgICAgIGRpdi5sYXN0Q2hpbGQuY2xhc3NOYW1lID0gImUiOwoKICAgICAgaWYgKGRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoID09PSAxKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBFeHByLm9yZGVyLnNwbGljZSgxLCAwLCAiQ0xBU1MiKTsKCiAgICAgIEV4cHIuZmluZC5DTEFTUyA9IGZ1bmN0aW9uIChtYXRjaCwgY29udGV4dCwgaXNYTUwpIHsKICAgICAgICBpZiAodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAhPT0gInVuZGVmaW5lZCIgJiYgIWlzWE1MKSB7CiAgICAgICAgICByZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG1hdGNoWzFdKTsKICAgICAgICB9CiAgICAgIH07IC8vIHJlbGVhc2UgbWVtb3J5IGluIElFCgoKICAgICAgZGl2ID0gbnVsbDsKICAgIH0pKCk7CgogICAgZnVuY3Rpb24gZGlyTm9kZUNoZWNrKGRpciwgY3VyLCBkb25lTmFtZSwgY2hlY2tTZXQsIG5vZGVDaGVjaywgaXNYTUwpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjaGVja1NldC5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgZWxlbSA9IGNoZWNrU2V0W2ldOwoKICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgdmFyIG1hdGNoID0gZmFsc2U7CiAgICAgICAgICBlbGVtID0gZWxlbVtkaXJdOwoKICAgICAgICAgIHdoaWxlIChlbGVtKSB7CiAgICAgICAgICAgIGlmIChlbGVtW2V4cGFuZG9dID09PSBkb25lTmFtZSkgewogICAgICAgICAgICAgIG1hdGNoID0gY2hlY2tTZXRbZWxlbS5zaXpzZXRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAhaXNYTUwpIHsKICAgICAgICAgICAgICBlbGVtW2V4cGFuZG9dID0gZG9uZU5hbWU7CiAgICAgICAgICAgICAgZWxlbS5zaXpzZXQgPSBpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBjdXIpIHsKICAgICAgICAgICAgICBtYXRjaCA9IGVsZW07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVsZW0gPSBlbGVtW2Rpcl07CiAgICAgICAgICB9CgogICAgICAgICAgY2hlY2tTZXRbaV0gPSBtYXRjaDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkaXJDaGVjayhkaXIsIGN1ciwgZG9uZU5hbWUsIGNoZWNrU2V0LCBub2RlQ2hlY2ssIGlzWE1MKSB7CiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2hlY2tTZXQubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgdmFyIGVsZW0gPSBjaGVja1NldFtpXTsKCiAgICAgICAgaWYgKGVsZW0pIHsKICAgICAgICAgIHZhciBtYXRjaCA9IGZhbHNlOwogICAgICAgICAgZWxlbSA9IGVsZW1bZGlyXTsKCiAgICAgICAgICB3aGlsZSAoZWxlbSkgewogICAgICAgICAgICBpZiAoZWxlbVtleHBhbmRvXSA9PT0gZG9uZU5hbWUpIHsKICAgICAgICAgICAgICBtYXRjaCA9IGNoZWNrU2V0W2VsZW0uc2l6c2V0XTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICBpZiAoIWlzWE1MKSB7CiAgICAgICAgICAgICAgICBlbGVtW2V4cGFuZG9dID0gZG9uZU5hbWU7CiAgICAgICAgICAgICAgICBlbGVtLnNpenNldCA9IGk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGN1ciAhPT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICAgIGlmIChlbGVtID09PSBjdXIpIHsKICAgICAgICAgICAgICAgICAgbWF0Y2ggPSB0cnVlOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9TaXp6bGUyLmZpbHRlcihjdXIsIFtlbGVtXSkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbWF0Y2ggPSBlbGVtOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBlbGVtID0gZWxlbVtkaXJdOwogICAgICAgICAgfQoKICAgICAgICAgIGNoZWNrU2V0W2ldID0gbWF0Y2g7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jb250YWlucykgewogICAgICBfU2l6emxlMi5jb250YWlucyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuIGEgIT09IGIgJiYgKGEuY29udGFpbnMgPyBhLmNvbnRhaW5zKGIpIDogdHJ1ZSk7CiAgICAgIH07CiAgICB9IGVsc2UgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbikgewogICAgICBfU2l6emxlMi5jb250YWlucyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuICEhKGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikgJiAxNik7CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBfU2l6emxlMi5jb250YWlucyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH07CiAgICB9CgogICAgX1NpenpsZTIuaXNYTUwgPSBmdW5jdGlvbiAoZWxlbSkgewogICAgICAvLyBkb2N1bWVudEVsZW1lbnQgaXMgdmVyaWZpZWQgZm9yIGNhc2VzIHdoZXJlIGl0IGRvZXNuJ3QgeWV0IGV4aXN0CiAgICAgIC8vIChzdWNoIGFzIGxvYWRpbmcgaWZyYW1lcyBpbiBJRSAtICM0ODMzKQogICAgICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gKGVsZW0gPyBlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSA6IDApLmRvY3VtZW50RWxlbWVudDsKICAgICAgcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhUTUwiIDogZmFsc2U7CiAgICB9OwoKICAgIHZhciBwb3NQcm9jZXNzID0gZnVuY3Rpb24gcG9zUHJvY2VzcyhzZWxlY3RvciwgY29udGV4dCwgc2VlZCkgewogICAgICB2YXIgbWF0Y2gsCiAgICAgICAgICB0bXBTZXQgPSBbXSwKICAgICAgICAgIGxhdGVyID0gIiIsCiAgICAgICAgICByb290ID0gY29udGV4dC5ub2RlVHlwZSA/IFtjb250ZXh0XSA6IGNvbnRleHQ7IC8vIFBvc2l0aW9uIHNlbGVjdG9ycyBtdXN0IGJlIGRvbmUgYWZ0ZXIgdGhlIGZpbHRlcgogICAgICAvLyBBbmQgc28gbXVzdCA6bm90KHBvc2l0aW9uYWwpIHNvIHdlIG1vdmUgYWxsIFBTRVVET3MgdG8gdGhlIGVuZAoKICAgICAgd2hpbGUgKG1hdGNoID0gRXhwci5tYXRjaC5QU0VVRE8uZXhlYyhzZWxlY3RvcikpIHsKICAgICAgICBsYXRlciArPSBtYXRjaFswXTsKICAgICAgICBzZWxlY3RvciA9IHNlbGVjdG9yLnJlcGxhY2UoRXhwci5tYXRjaC5QU0VVRE8sICIiKTsKICAgICAgfQoKICAgICAgc2VsZWN0b3IgPSBFeHByLnJlbGF0aXZlW3NlbGVjdG9yXSA/IHNlbGVjdG9yICsgIioiIDogc2VsZWN0b3I7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJvb3QubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgX1NpenpsZTIoc2VsZWN0b3IsIHJvb3RbaV0sIHRtcFNldCwgc2VlZCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfU2l6emxlMi5maWx0ZXIobGF0ZXIsIHRtcFNldCk7CiAgICB9OyAvLyBFWFBPU0UKICAgIC8vIE92ZXJyaWRlIHNpenpsZSBhdHRyaWJ1dGUgcmV0cmlldmFsCgoKICAgIF9TaXp6bGUyLmF0dHIgPSBqUXVlcnkuYXR0cjsKICAgIF9TaXp6bGUyLnNlbGVjdG9ycy5hdHRyTWFwID0ge307CiAgICBqUXVlcnkuZmluZCA9IF9TaXp6bGUyOwogICAgalF1ZXJ5LmV4cHIgPSBfU2l6emxlMi5zZWxlY3RvcnM7CiAgICBqUXVlcnkuZXhwclsiOiJdID0galF1ZXJ5LmV4cHIuZmlsdGVyczsKICAgIGpRdWVyeS51bmlxdWUgPSBfU2l6emxlMi51bmlxdWVTb3J0OwogICAgalF1ZXJ5LnRleHQgPSBfU2l6emxlMi5nZXRUZXh0OwogICAgalF1ZXJ5LmlzWE1MRG9jID0gX1NpenpsZTIuaXNYTUw7CiAgICBqUXVlcnkuY29udGFpbnMgPSBfU2l6emxlMi5jb250YWluczsKICB9KSgpOwoKICB2YXIgcnVudGlsID0gL1VudGlsJC8sCiAgICAgIHJwYXJlbnRzcHJldiA9IC9eKD86cGFyZW50c3xwcmV2VW50aWx8cHJldkFsbCkvLAogICAgICAvLyBOb3RlOiBUaGlzIFJlZ0V4cCBzaG91bGQgYmUgaW1wcm92ZWQsIG9yIGxpa2VseSBwdWxsZWQgZnJvbSBTaXp6bGUKICBybXVsdGlzZWxlY3RvciA9IC8sLywKICAgICAgaXNTaW1wbGUgPSAvXi5bXjojXFtcLixdKiQvLAogICAgICBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZSwKICAgICAgUE9TID0galF1ZXJ5LmV4cHIubWF0Y2guZ2xvYmFsUE9TLAogICAgICAvLyBtZXRob2RzIGd1YXJhbnRlZWQgdG8gcHJvZHVjZSBhIHVuaXF1ZSBzZXQgd2hlbiBzdGFydGluZyBmcm9tIGEgdW5pcXVlIHNldAogIGd1YXJhbnRlZWRVbmlxdWUgPSB7CiAgICBjaGlsZHJlbjogdHJ1ZSwKICAgIGNvbnRlbnRzOiB0cnVlLAogICAgbmV4dDogdHJ1ZSwKICAgIHByZXY6IHRydWUKICB9OwogIGpRdWVyeS5mbi5leHRlbmQoewogICAgZmluZDogZnVuY3Rpb24gZmluZChzZWxlY3RvcikgewogICAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgICBpLAogICAgICAgICAgbDsKCiAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeShzZWxlY3RvcikuZmlsdGVyKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGZvciAoaSA9IDAsIGwgPSBzZWxmLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICBpZiAoalF1ZXJ5LmNvbnRhaW5zKHNlbGZbaV0sIHRoaXMpKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIHJldCA9IHRoaXMucHVzaFN0YWNrKCIiLCAiZmluZCIsIHNlbGVjdG9yKSwKICAgICAgICAgIGxlbmd0aCwKICAgICAgICAgIG4sCiAgICAgICAgICByOwoKICAgICAgZm9yIChpID0gMCwgbCA9IHRoaXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgbGVuZ3RoID0gcmV0Lmxlbmd0aDsKICAgICAgICBqUXVlcnkuZmluZChzZWxlY3RvciwgdGhpc1tpXSwgcmV0KTsKCiAgICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgcmVzdWx0cyBhcmUgdW5pcXVlCiAgICAgICAgICBmb3IgKG4gPSBsZW5ndGg7IG4gPCByZXQubGVuZ3RoOyBuKyspIHsKICAgICAgICAgICAgZm9yIChyID0gMDsgciA8IGxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgICAgaWYgKHJldFtyXSA9PT0gcmV0W25dKSB7CiAgICAgICAgICAgICAgICByZXQuc3BsaWNlKG4tLSwgMSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXQ7CiAgICB9LAogICAgaGFzOiBmdW5jdGlvbiBoYXModGFyZ2V0KSB7CiAgICAgIHZhciB0YXJnZXRzID0galF1ZXJ5KHRhcmdldCk7CiAgICAgIHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbiAoKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0YXJnZXRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgaWYgKGpRdWVyeS5jb250YWlucyh0aGlzLCB0YXJnZXRzW2ldKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIG5vdDogZnVuY3Rpb24gbm90KHNlbGVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayh3aW5ub3codGhpcywgc2VsZWN0b3IsIGZhbHNlKSwgIm5vdCIsIHNlbGVjdG9yKTsKICAgIH0sCiAgICBmaWx0ZXI6IGZ1bmN0aW9uIGZpbHRlcihzZWxlY3RvcikgewogICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2sod2lubm93KHRoaXMsIHNlbGVjdG9yLCB0cnVlKSwgImZpbHRlciIsIHNlbGVjdG9yKTsKICAgIH0sCiAgICBpczogZnVuY3Rpb24gaXMoc2VsZWN0b3IpIHsKICAgICAgcmV0dXJuICEhc2VsZWN0b3IgJiYgKHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgPyAvLyBJZiB0aGlzIGlzIGEgcG9zaXRpb25hbCBzZWxlY3RvciwgY2hlY2sgbWVtYmVyc2hpcCBpbiB0aGUgcmV0dXJuZWQgc2V0CiAgICAgIC8vIHNvICQoInA6Zmlyc3QiKS5pcygicDpsYXN0Iikgd29uJ3QgcmV0dXJuIHRydWUgZm9yIGEgZG9jIHdpdGggdHdvICJwIi4KICAgICAgUE9TLnRlc3Qoc2VsZWN0b3IpID8galF1ZXJ5KHNlbGVjdG9yLCB0aGlzLmNvbnRleHQpLmluZGV4KHRoaXNbMF0pID49IDAgOiBqUXVlcnkuZmlsdGVyKHNlbGVjdG9yLCB0aGlzKS5sZW5ndGggPiAwIDogdGhpcy5maWx0ZXIoc2VsZWN0b3IpLmxlbmd0aCA+IDApOwogICAgfSwKICAgIGNsb3Nlc3Q6IGZ1bmN0aW9uIGNsb3Nlc3Qoc2VsZWN0b3JzLCBjb250ZXh0KSB7CiAgICAgIHZhciByZXQgPSBbXSwKICAgICAgICAgIGksCiAgICAgICAgICBsLAogICAgICAgICAgY3VyID0gdGhpc1swXTsgLy8gQXJyYXkgKGRlcHJlY2F0ZWQgYXMgb2YgalF1ZXJ5IDEuNykKCiAgICAgIGlmIChqUXVlcnkuaXNBcnJheShzZWxlY3RvcnMpKSB7CiAgICAgICAgdmFyIGxldmVsID0gMTsKCiAgICAgICAgd2hpbGUgKGN1ciAmJiBjdXIub3duZXJEb2N1bWVudCAmJiBjdXIgIT09IGNvbnRleHQpIHsKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZWxlY3RvcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGpRdWVyeShjdXIpLmlzKHNlbGVjdG9yc1tpXSkpIHsKICAgICAgICAgICAgICByZXQucHVzaCh7CiAgICAgICAgICAgICAgICBzZWxlY3Rvcjogc2VsZWN0b3JzW2ldLAogICAgICAgICAgICAgICAgZWxlbTogY3VyLAogICAgICAgICAgICAgICAgbGV2ZWw6IGxldmVsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBjdXIgPSBjdXIucGFyZW50Tm9kZTsKICAgICAgICAgIGxldmVsKys7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0OwogICAgICB9IC8vIFN0cmluZwoKCiAgICAgIHZhciBwb3MgPSBQT1MudGVzdChzZWxlY3RvcnMpIHx8IHR5cGVvZiBzZWxlY3RvcnMgIT09ICJzdHJpbmciID8galF1ZXJ5KHNlbGVjdG9ycywgY29udGV4dCB8fCB0aGlzLmNvbnRleHQpIDogMDsKCiAgICAgIGZvciAoaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGN1ciA9IHRoaXNbaV07CgogICAgICAgIHdoaWxlIChjdXIpIHsKICAgICAgICAgIGlmIChwb3MgPyBwb3MuaW5kZXgoY3VyKSA+IC0xIDogalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1ciwgc2VsZWN0b3JzKSkgewogICAgICAgICAgICByZXQucHVzaChjdXIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGN1ciA9IGN1ci5wYXJlbnROb2RlOwoKICAgICAgICAgICAgaWYgKCFjdXIgfHwgIWN1ci5vd25lckRvY3VtZW50IHx8IGN1ciA9PT0gY29udGV4dCB8fCBjdXIubm9kZVR5cGUgPT09IDExKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldCA9IHJldC5sZW5ndGggPiAxID8galF1ZXJ5LnVuaXF1ZShyZXQpIDogcmV0OwogICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2socmV0LCAiY2xvc2VzdCIsIHNlbGVjdG9ycyk7CiAgICB9LAogICAgLy8gRGV0ZXJtaW5lIHRoZSBwb3NpdGlvbiBvZiBhbiBlbGVtZW50IHdpdGhpbgogICAgLy8gdGhlIG1hdGNoZWQgc2V0IG9mIGVsZW1lbnRzCiAgICBpbmRleDogZnVuY3Rpb24gaW5kZXgoZWxlbSkgewogICAgICAvLyBObyBhcmd1bWVudCwgcmV0dXJuIGluZGV4IGluIHBhcmVudAogICAgICBpZiAoIWVsZW0pIHsKICAgICAgICByZXR1cm4gdGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUgPyB0aGlzLnByZXZBbGwoKS5sZW5ndGggOiAtMTsKICAgICAgfSAvLyBpbmRleCBpbiBzZWxlY3RvcgoKCiAgICAgIGlmICh0eXBlb2YgZWxlbSA9PT0gInN0cmluZyIpIHsKICAgICAgICByZXR1cm4galF1ZXJ5LmluQXJyYXkodGhpc1swXSwgalF1ZXJ5KGVsZW0pKTsKICAgICAgfSAvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBkZXNpcmVkIGVsZW1lbnQKCgogICAgICByZXR1cm4galF1ZXJ5LmluQXJyYXkoIC8vIElmIGl0IHJlY2VpdmVzIGEgalF1ZXJ5IG9iamVjdCwgdGhlIGZpcnN0IGVsZW1lbnQgaXMgdXNlZAogICAgICBlbGVtLmpxdWVyeSA/IGVsZW1bMF0gOiBlbGVtLCB0aGlzKTsKICAgIH0sCiAgICBhZGQ6IGZ1bmN0aW9uIGFkZChzZWxlY3RvciwgY29udGV4dCkgewogICAgICB2YXIgc2V0ID0gdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiA/IGpRdWVyeShzZWxlY3RvciwgY29udGV4dCkgOiBqUXVlcnkubWFrZUFycmF5KHNlbGVjdG9yICYmIHNlbGVjdG9yLm5vZGVUeXBlID8gW3NlbGVjdG9yXSA6IHNlbGVjdG9yKSwKICAgICAgICAgIGFsbCA9IGpRdWVyeS5tZXJnZSh0aGlzLmdldCgpLCBzZXQpOwogICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soaXNEaXNjb25uZWN0ZWQoc2V0WzBdKSB8fCBpc0Rpc2Nvbm5lY3RlZChhbGxbMF0pID8gYWxsIDogalF1ZXJ5LnVuaXF1ZShhbGwpKTsKICAgIH0sCiAgICBhbmRTZWxmOiBmdW5jdGlvbiBhbmRTZWxmKCkgewogICAgICByZXR1cm4gdGhpcy5hZGQodGhpcy5wcmV2T2JqZWN0KTsKICAgIH0KICB9KTsgLy8gQSBwYWluZnVsbHkgc2ltcGxlIGNoZWNrIHRvIHNlZSBpZiBhbiBlbGVtZW50IGlzIGRpc2Nvbm5lY3RlZAogIC8vIGZyb20gYSBkb2N1bWVudCAoc2hvdWxkIGJlIGltcHJvdmVkLCB3aGVyZSBmZWFzaWJsZSkuCgogIGZ1bmN0aW9uIGlzRGlzY29ubmVjdGVkKG5vZGUpIHsKICAgIHJldHVybiAhbm9kZSB8fCAhbm9kZS5wYXJlbnROb2RlIHx8IG5vZGUucGFyZW50Tm9kZS5ub2RlVHlwZSA9PT0gMTE7CiAgfQoKICBqUXVlcnkuZWFjaCh7CiAgICBwYXJlbnQ6IGZ1bmN0aW9uIHBhcmVudChlbGVtKSB7CiAgICAgIHZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CiAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlICE9PSAxMSA/IHBhcmVudCA6IG51bGw7CiAgICB9LAogICAgcGFyZW50czogZnVuY3Rpb24gcGFyZW50cyhlbGVtKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZGlyKGVsZW0sICJwYXJlbnROb2RlIik7CiAgICB9LAogICAgcGFyZW50c1VudGlsOiBmdW5jdGlvbiBwYXJlbnRzVW50aWwoZWxlbSwgaSwgdW50aWwpIHsKICAgICAgcmV0dXJuIGpRdWVyeS5kaXIoZWxlbSwgInBhcmVudE5vZGUiLCB1bnRpbCk7CiAgICB9LAogICAgbmV4dDogZnVuY3Rpb24gbmV4dChlbGVtKSB7CiAgICAgIHJldHVybiBqUXVlcnkubnRoKGVsZW0sIDIsICJuZXh0U2libGluZyIpOwogICAgfSwKICAgIHByZXY6IGZ1bmN0aW9uIHByZXYoZWxlbSkgewogICAgICByZXR1cm4galF1ZXJ5Lm50aChlbGVtLCAyLCAicHJldmlvdXNTaWJsaW5nIik7CiAgICB9LAogICAgbmV4dEFsbDogZnVuY3Rpb24gbmV4dEFsbChlbGVtKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZGlyKGVsZW0sICJuZXh0U2libGluZyIpOwogICAgfSwKICAgIHByZXZBbGw6IGZ1bmN0aW9uIHByZXZBbGwoZWxlbSkgewogICAgICByZXR1cm4galF1ZXJ5LmRpcihlbGVtLCAicHJldmlvdXNTaWJsaW5nIik7CiAgICB9LAogICAgbmV4dFVudGlsOiBmdW5jdGlvbiBuZXh0VW50aWwoZWxlbSwgaSwgdW50aWwpIHsKICAgICAgcmV0dXJuIGpRdWVyeS5kaXIoZWxlbSwgIm5leHRTaWJsaW5nIiwgdW50aWwpOwogICAgfSwKICAgIHByZXZVbnRpbDogZnVuY3Rpb24gcHJldlVudGlsKGVsZW0sIGksIHVudGlsKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZGlyKGVsZW0sICJwcmV2aW91c1NpYmxpbmciLCB1bnRpbCk7CiAgICB9LAogICAgc2libGluZ3M6IGZ1bmN0aW9uIHNpYmxpbmdzKGVsZW0pIHsKICAgICAgcmV0dXJuIGpRdWVyeS5zaWJsaW5nKChlbGVtLnBhcmVudE5vZGUgfHwge30pLmZpcnN0Q2hpbGQsIGVsZW0pOwogICAgfSwKICAgIGNoaWxkcmVuOiBmdW5jdGlvbiBjaGlsZHJlbihlbGVtKSB7CiAgICAgIHJldHVybiBqUXVlcnkuc2libGluZyhlbGVtLmZpcnN0Q2hpbGQpOwogICAgfSwKICAgIGNvbnRlbnRzOiBmdW5jdGlvbiBjb250ZW50cyhlbGVtKSB7CiAgICAgIHJldHVybiBqUXVlcnkubm9kZU5hbWUoZWxlbSwgImlmcmFtZSIpID8gZWxlbS5jb250ZW50RG9jdW1lbnQgfHwgZWxlbS5jb250ZW50V2luZG93LmRvY3VtZW50IDogalF1ZXJ5Lm1ha2VBcnJheShlbGVtLmNoaWxkTm9kZXMpOwogICAgfQogIH0sIGZ1bmN0aW9uIChuYW1lLCBmbikgewogICAgalF1ZXJ5LmZuW25hbWVdID0gZnVuY3Rpb24gKHVudGlsLCBzZWxlY3RvcikgewogICAgICB2YXIgcmV0ID0galF1ZXJ5Lm1hcCh0aGlzLCBmbiwgdW50aWwpOwoKICAgICAgaWYgKCFydW50aWwudGVzdChuYW1lKSkgewogICAgICAgIHNlbGVjdG9yID0gdW50aWw7CiAgICAgIH0KCiAgICAgIGlmIChzZWxlY3RvciAmJiB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0ID0galF1ZXJ5LmZpbHRlcihzZWxlY3RvciwgcmV0KTsKICAgICAgfQoKICAgICAgcmV0ID0gdGhpcy5sZW5ndGggPiAxICYmICFndWFyYW50ZWVkVW5pcXVlW25hbWVdID8galF1ZXJ5LnVuaXF1ZShyZXQpIDogcmV0OwoKICAgICAgaWYgKCh0aGlzLmxlbmd0aCA+IDEgfHwgcm11bHRpc2VsZWN0b3IudGVzdChzZWxlY3RvcikpICYmIHJwYXJlbnRzcHJldi50ZXN0KG5hbWUpKSB7CiAgICAgICAgcmV0ID0gcmV0LnJldmVyc2UoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHJldCwgbmFtZSwgc2xpY2UuY2FsbChhcmd1bWVudHMpLmpvaW4oIiwiKSk7CiAgICB9OwogIH0pOwogIGpRdWVyeS5leHRlbmQoewogICAgZmlsdGVyOiBmdW5jdGlvbiBmaWx0ZXIoZXhwciwgZWxlbXMsIG5vdCkgewogICAgICBpZiAobm90KSB7CiAgICAgICAgZXhwciA9ICI6bm90KCIgKyBleHByICsgIikiOwogICAgICB9CgogICAgICByZXR1cm4gZWxlbXMubGVuZ3RoID09PSAxID8galF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGVsZW1zWzBdLCBleHByKSA/IFtlbGVtc1swXV0gOiBbXSA6IGpRdWVyeS5maW5kLm1hdGNoZXMoZXhwciwgZWxlbXMpOwogICAgfSwKICAgIGRpcjogZnVuY3Rpb24gZGlyKGVsZW0sIF9kaXIsIHVudGlsKSB7CiAgICAgIHZhciBtYXRjaGVkID0gW10sCiAgICAgICAgICBjdXIgPSBlbGVtW19kaXJdOwoKICAgICAgd2hpbGUgKGN1ciAmJiBjdXIubm9kZVR5cGUgIT09IDkgJiYgKHVudGlsID09PSB1bmRlZmluZWQgfHwgY3VyLm5vZGVUeXBlICE9PSAxIHx8ICFqUXVlcnkoY3VyKS5pcyh1bnRpbCkpKSB7CiAgICAgICAgaWYgKGN1ci5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgbWF0Y2hlZC5wdXNoKGN1cik7CiAgICAgICAgfQoKICAgICAgICBjdXIgPSBjdXJbX2Rpcl07CiAgICAgIH0KCiAgICAgIHJldHVybiBtYXRjaGVkOwogICAgfSwKICAgIG50aDogZnVuY3Rpb24gbnRoKGN1ciwgcmVzdWx0LCBkaXIsIGVsZW0pIHsKICAgICAgcmVzdWx0ID0gcmVzdWx0IHx8IDE7CiAgICAgIHZhciBudW0gPSAwOwoKICAgICAgZm9yICg7IGN1cjsgY3VyID0gY3VyW2Rpcl0pIHsKICAgICAgICBpZiAoY3VyLm5vZGVUeXBlID09PSAxICYmICsrbnVtID09PSByZXN1bHQpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGN1cjsKICAgIH0sCiAgICBzaWJsaW5nOiBmdW5jdGlvbiBzaWJsaW5nKG4sIGVsZW0pIHsKICAgICAgdmFyIHIgPSBbXTsKCiAgICAgIGZvciAoOyBuOyBuID0gbi5uZXh0U2libGluZykgewogICAgICAgIGlmIChuLm5vZGVUeXBlID09PSAxICYmIG4gIT09IGVsZW0pIHsKICAgICAgICAgIHIucHVzaChuKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogIH0pOyAvLyBJbXBsZW1lbnQgdGhlIGlkZW50aWNhbCBmdW5jdGlvbmFsaXR5IGZvciBmaWx0ZXIgYW5kIG5vdAoKICBmdW5jdGlvbiB3aW5ub3coZWxlbWVudHMsIHF1YWxpZmllciwga2VlcCkgewogICAgLy8gQ2FuJ3QgcGFzcyBudWxsIG9yIHVuZGVmaW5lZCB0byBpbmRleE9mIGluIEZpcmVmb3ggNAogICAgLy8gU2V0IHRvIDAgdG8gc2tpcCBzdHJpbmcgY2hlY2sKICAgIHF1YWxpZmllciA9IHF1YWxpZmllciB8fCAwOwoKICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihxdWFsaWZpZXIpKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cywgZnVuY3Rpb24gKGVsZW0sIGkpIHsKICAgICAgICB2YXIgcmV0VmFsID0gISFxdWFsaWZpZXIuY2FsbChlbGVtLCBpLCBlbGVtKTsKICAgICAgICByZXR1cm4gcmV0VmFsID09PSBrZWVwOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAocXVhbGlmaWVyLm5vZGVUeXBlKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cywgZnVuY3Rpb24gKGVsZW0sIGkpIHsKICAgICAgICByZXR1cm4gZWxlbSA9PT0gcXVhbGlmaWVyID09PSBrZWVwOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIHF1YWxpZmllciA9PT0gInN0cmluZyIpIHsKICAgICAgdmFyIGZpbHRlcmVkID0galF1ZXJ5LmdyZXAoZWxlbWVudHMsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgcmV0dXJuIGVsZW0ubm9kZVR5cGUgPT09IDE7CiAgICAgIH0pOwoKICAgICAgaWYgKGlzU2ltcGxlLnRlc3QocXVhbGlmaWVyKSkgewogICAgICAgIHJldHVybiBqUXVlcnkuZmlsdGVyKHF1YWxpZmllciwgZmlsdGVyZWQsICFrZWVwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBxdWFsaWZpZXIgPSBqUXVlcnkuZmlsdGVyKHF1YWxpZmllciwgZmlsdGVyZWQpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGpRdWVyeS5ncmVwKGVsZW1lbnRzLCBmdW5jdGlvbiAoZWxlbSwgaSkgewogICAgICByZXR1cm4galF1ZXJ5LmluQXJyYXkoZWxlbSwgcXVhbGlmaWVyKSA+PSAwID09PSBrZWVwOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVTYWZlRnJhZ21lbnQoZG9jdW1lbnQpIHsKICAgIHZhciBsaXN0ID0gbm9kZU5hbWVzLnNwbGl0KCJ8IiksCiAgICAgICAgc2FmZUZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CgogICAgaWYgKHNhZmVGcmFnLmNyZWF0ZUVsZW1lbnQpIHsKICAgICAgd2hpbGUgKGxpc3QubGVuZ3RoKSB7CiAgICAgICAgc2FmZUZyYWcuY3JlYXRlRWxlbWVudChsaXN0LnBvcCgpKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzYWZlRnJhZzsKICB9CgogIHZhciBub2RlTmFtZXMgPSAiYWJicnxhcnRpY2xlfGFzaWRlfGF1ZGlvfGJkaXxjYW52YXN8ZGF0YXxkYXRhbGlzdHxkZXRhaWxzfGZpZ2NhcHRpb258ZmlndXJlfGZvb3RlcnwiICsgImhlYWRlcnxoZ3JvdXB8bWFya3xtZXRlcnxuYXZ8b3V0cHV0fHByb2dyZXNzfHNlY3Rpb258c3VtbWFyeXx0aW1lfHZpZGVvIiwKICAgICAgcmlubGluZWpRdWVyeSA9IC8galF1ZXJ5XGQrPSIoPzpcZCt8bnVsbCkiL2csCiAgICAgIHJsZWFkaW5nV2hpdGVzcGFjZSA9IC9eXHMrLywKICAgICAgcnhodG1sVGFnID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1x3Ol0rKVtePl0qKVwvPi9pZywKICAgICAgcnRhZ05hbWUgPSAvPChbXHc6XSspLywKICAgICAgcnRib2R5ID0gLzx0Ym9keS9pLAogICAgICByaHRtbCA9IC88fCYjP1x3KzsvLAogICAgICBybm9Jbm5lcmh0bWwgPSAvPCg/OnNjcmlwdHxzdHlsZSkvaSwKICAgICAgcm5vY2FjaGUgPSAvPCg/OnNjcmlwdHxvYmplY3R8ZW1iZWR8b3B0aW9ufHN0eWxlKS9pLAogICAgICBybm9zaGltY2FjaGUgPSBuZXcgUmVnRXhwKCI8KD86IiArIG5vZGVOYW1lcyArICIpW1xccy8+XSIsICJpIiksCiAgICAgIC8vIGNoZWNrZWQ9ImNoZWNrZWQiIG9yIGNoZWNrZWQKICByY2hlY2tlZCA9IC9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLAogICAgICByc2NyaXB0VHlwZSA9IC9cLyhqYXZhfGVjbWEpc2NyaXB0L2ksCiAgICAgIHJjbGVhblNjcmlwdCA9IC9eXHMqPCEoPzpcW0NEQVRBXFt8XC1cLSkvLAogICAgICB3cmFwTWFwID0gewogICAgb3B0aW9uOiBbMSwgIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCAiPC9zZWxlY3Q+Il0sCiAgICBsZWdlbmQ6IFsxLCAiPGZpZWxkc2V0PiIsICI8L2ZpZWxkc2V0PiJdLAogICAgdGhlYWQ6IFsxLCAiPHRhYmxlPiIsICI8L3RhYmxlPiJdLAogICAgdHI6IFsyLCAiPHRhYmxlPjx0Ym9keT4iLCAiPC90Ym9keT48L3RhYmxlPiJdLAogICAgdGQ6IFszLCAiPHRhYmxlPjx0Ym9keT48dHI+IiwgIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLAogICAgY29sOiBbMiwgIjx0YWJsZT48dGJvZHk+PC90Ym9keT48Y29sZ3JvdXA+IiwgIjwvY29sZ3JvdXA+PC90YWJsZT4iXSwKICAgIGFyZWE6IFsxLCAiPG1hcD4iLCAiPC9tYXA+Il0sCiAgICBfZGVmYXVsdDogWzAsICIiLCAiIl0KICB9LAogICAgICBzYWZlRnJhZ21lbnQgPSBjcmVhdGVTYWZlRnJhZ21lbnQoZG9jdW1lbnQpOwogIHdyYXBNYXAub3B0Z3JvdXAgPSB3cmFwTWFwLm9wdGlvbjsKICB3cmFwTWFwLnRib2R5ID0gd3JhcE1hcC50Zm9vdCA9IHdyYXBNYXAuY29sZ3JvdXAgPSB3cmFwTWFwLmNhcHRpb24gPSB3cmFwTWFwLnRoZWFkOwogIHdyYXBNYXAudGggPSB3cmFwTWFwLnRkOyAvLyBJRSBjYW4ndCBzZXJpYWxpemUgPGxpbms+IGFuZCA8c2NyaXB0PiB0YWdzIG5vcm1hbGx5CgogIGlmICghalF1ZXJ5LnN1cHBvcnQuaHRtbFNlcmlhbGl6ZSkgewogICAgd3JhcE1hcC5fZGVmYXVsdCA9IFsxLCAiZGl2PGRpdj4iLCAiPC9kaXY+Il07CiAgfQoKICBqUXVlcnkuZm4uZXh0ZW5kKHsKICAgIHRleHQ6IGZ1bmN0aW9uIHRleHQodmFsdWUpIHsKICAgICAgcmV0dXJuIGpRdWVyeS5hY2Nlc3ModGhpcywgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPyBqUXVlcnkudGV4dCh0aGlzKSA6IHRoaXMuZW1wdHkoKS5hcHBlbmQoKHRoaXNbMF0gJiYgdGhpc1swXS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50KS5jcmVhdGVUZXh0Tm9kZSh2YWx1ZSkpOwogICAgICB9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCk7CiAgICB9LAogICAgd3JhcEFsbDogZnVuY3Rpb24gd3JhcEFsbChodG1sKSB7CiAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihodG1sKSkgewogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS53cmFwQWxsKGh0bWwuY2FsbCh0aGlzLCBpKSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzWzBdKSB7CiAgICAgICAgLy8gVGhlIGVsZW1lbnRzIHRvIHdyYXAgdGhlIHRhcmdldCBhcm91bmQKICAgICAgICB2YXIgd3JhcCA9IGpRdWVyeShodG1sLCB0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKHRydWUpOwoKICAgICAgICBpZiAodGhpc1swXS5wYXJlbnROb2RlKSB7CiAgICAgICAgICB3cmFwLmluc2VydEJlZm9yZSh0aGlzWzBdKTsKICAgICAgICB9CgogICAgICAgIHdyYXAubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtID0gdGhpczsKCiAgICAgICAgICB3aGlsZSAoZWxlbS5maXJzdENoaWxkICYmIGVsZW0uZmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgICBlbGVtID0gZWxlbS5maXJzdENoaWxkOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBlbGVtOwogICAgICAgIH0pLmFwcGVuZCh0aGlzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgd3JhcElubmVyOiBmdW5jdGlvbiB3cmFwSW5uZXIoaHRtbCkgewogICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24oaHRtbCkpIHsKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICBqUXVlcnkodGhpcykud3JhcElubmVyKGh0bWwuY2FsbCh0aGlzLCBpKSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzZWxmID0galF1ZXJ5KHRoaXMpLAogICAgICAgICAgICBjb250ZW50cyA9IHNlbGYuY29udGVudHMoKTsKCiAgICAgICAgaWYgKGNvbnRlbnRzLmxlbmd0aCkgewogICAgICAgICAgY29udGVudHMud3JhcEFsbChodG1sKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VsZi5hcHBlbmQoaHRtbCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICB3cmFwOiBmdW5jdGlvbiB3cmFwKGh0bWwpIHsKICAgICAgdmFyIGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbihodG1sKTsKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaSkgewogICAgICAgIGpRdWVyeSh0aGlzKS53cmFwQWxsKGlzRnVuY3Rpb24gPyBodG1sLmNhbGwodGhpcywgaSkgOiBodG1sKTsKICAgICAgfSk7CiAgICB9LAogICAgdW53cmFwOiBmdW5jdGlvbiB1bndyYXAoKSB7CiAgICAgIHJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghalF1ZXJ5Lm5vZGVOYW1lKHRoaXMsICJib2R5IikpIHsKICAgICAgICAgIGpRdWVyeSh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpOwogICAgICAgIH0KICAgICAgfSkuZW5kKCk7CiAgICB9LAogICAgYXBwZW5kOiBmdW5jdGlvbiBhcHBlbmQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgdHJ1ZSwgZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChlbGVtKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHByZXBlbmQ6IGZ1bmN0aW9uIHByZXBlbmQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgdHJ1ZSwgZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgdGhpcy5pbnNlcnRCZWZvcmUoZWxlbSwgdGhpcy5maXJzdENoaWxkKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGJlZm9yZTogZnVuY3Rpb24gYmVmb3JlKCkgewogICAgICBpZiAodGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUpIHsKICAgICAgICByZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsIGZhbHNlLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLCB0aGlzKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgICAgdmFyIHNldCA9IGpRdWVyeS5jbGVhbihhcmd1bWVudHMpOwogICAgICAgIHNldC5wdXNoLmFwcGx5KHNldCwgdGhpcy50b0FycmF5KCkpOwogICAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhzZXQsICJiZWZvcmUiLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9LAogICAgYWZ0ZXI6IGZ1bmN0aW9uIGFmdGVyKCkgewogICAgICBpZiAodGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUpIHsKICAgICAgICByZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsIGZhbHNlLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLCB0aGlzLm5leHRTaWJsaW5nKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgICAgdmFyIHNldCA9IHRoaXMucHVzaFN0YWNrKHRoaXMsICJhZnRlciIsIGFyZ3VtZW50cyk7CiAgICAgICAgc2V0LnB1c2guYXBwbHkoc2V0LCBqUXVlcnkuY2xlYW4oYXJndW1lbnRzKSk7CiAgICAgICAgcmV0dXJuIHNldDsKICAgICAgfQogICAgfSwKICAgIC8vIGtlZXBEYXRhIGlzIGZvciBpbnRlcm5hbCB1c2Ugb25seS0tZG8gbm90IGRvY3VtZW50CiAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShzZWxlY3Rvciwga2VlcERhdGEpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGVsZW07IChlbGVtID0gdGhpc1tpXSkgIT0gbnVsbDsgaSsrKSB7CiAgICAgICAgaWYgKCFzZWxlY3RvciB8fCBqUXVlcnkuZmlsdGVyKHNlbGVjdG9yLCBbZWxlbV0pLmxlbmd0aCkgewogICAgICAgICAgaWYgKCFrZWVwRGF0YSAmJiBlbGVtLm5vZGVUeXBlID09PSAxKSB7CiAgICAgICAgICAgIGpRdWVyeS5jbGVhbkRhdGEoZWxlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTsKICAgICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShbZWxlbV0pOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChlbGVtLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgZWxlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgZW1wdHk6IGZ1bmN0aW9uIGVtcHR5KCkgewogICAgICBmb3IgKHZhciBpID0gMCwgZWxlbTsgKGVsZW0gPSB0aGlzW2ldKSAhPSBudWxsOyBpKyspIHsKICAgICAgICAvLyBSZW1vdmUgZWxlbWVudCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3MKICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShlbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpOwogICAgICAgIH0gLy8gUmVtb3ZlIGFueSByZW1haW5pbmcgbm9kZXMKCgogICAgICAgIHdoaWxlIChlbGVtLmZpcnN0Q2hpbGQpIHsKICAgICAgICAgIGVsZW0ucmVtb3ZlQ2hpbGQoZWxlbS5maXJzdENoaWxkKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGNsb25lOiBmdW5jdGlvbiBjbG9uZShkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cykgewogICAgICBkYXRhQW5kRXZlbnRzID0gZGF0YUFuZEV2ZW50cyA9PSBudWxsID8gZmFsc2UgOiBkYXRhQW5kRXZlbnRzOwogICAgICBkZWVwRGF0YUFuZEV2ZW50cyA9IGRlZXBEYXRhQW5kRXZlbnRzID09IG51bGwgPyBkYXRhQW5kRXZlbnRzIDogZGVlcERhdGFBbmRFdmVudHM7CiAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGpRdWVyeS5jbG9uZSh0aGlzLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyk7CiAgICAgIH0pOwogICAgfSwKICAgIGh0bWw6IGZ1bmN0aW9uIGh0bWwodmFsdWUpIHsKICAgICAgcmV0dXJuIGpRdWVyeS5hY2Nlc3ModGhpcywgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFyIGVsZW0gPSB0aGlzWzBdIHx8IHt9LAogICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgbCA9IHRoaXMubGVuZ3RoOwoKICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuIGVsZW0ubm9kZVR5cGUgPT09IDEgPyBlbGVtLmlubmVySFRNTC5yZXBsYWNlKHJpbmxpbmVqUXVlcnksICIiKSA6IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiAmJiAhcm5vSW5uZXJodG1sLnRlc3QodmFsdWUpICYmIChqUXVlcnkuc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZSB8fCAhcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QodmFsdWUpKSAmJiAhd3JhcE1hcFsocnRhZ05hbWUuZXhlYyh2YWx1ZSkgfHwgWyIiLCAiIl0pWzFdLnRvTG93ZXJDYXNlKCldKSB7CiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UocnhodG1sVGFnLCAiPCQxPjwvJDI+Iik7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgICAvLyBSZW1vdmUgZWxlbWVudCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3MKICAgICAgICAgICAgICBlbGVtID0gdGhpc1tpXSB8fCB7fTsKCiAgICAgICAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgICAgIGpRdWVyeS5jbGVhbkRhdGEoZWxlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTsKICAgICAgICAgICAgICAgIGVsZW0uaW5uZXJIVE1MID0gdmFsdWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBlbGVtID0gMDsgLy8gSWYgdXNpbmcgaW5uZXJIVE1MIHRocm93cyBhbiBleGNlcHRpb24sIHVzZSB0aGUgZmFsbGJhY2sgbWV0aG9kCiAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH0KCiAgICAgICAgaWYgKGVsZW0pIHsKICAgICAgICAgIHRoaXMuZW1wdHkoKS5hcHBlbmQodmFsdWUpOwogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGgpOwogICAgfSwKICAgIHJlcGxhY2VXaXRoOiBmdW5jdGlvbiByZXBsYWNlV2l0aCh2YWx1ZSkgewogICAgICBpZiAodGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUpIHsKICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgZWxlbWVudHMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NIGJlZm9yZSB0aGV5IGFyZSBpbnNlcnRlZAogICAgICAgIC8vIHRoaXMgY2FuIGhlbHAgZml4IHJlcGxhY2luZyBhIHBhcmVudCB3aXRoIGNoaWxkIGVsZW1lbnRzCiAgICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaSkgewogICAgICAgICAgICB2YXIgc2VsZiA9IGpRdWVyeSh0aGlzKSwKICAgICAgICAgICAgICAgIG9sZCA9IHNlbGYuaHRtbCgpOwogICAgICAgICAgICBzZWxmLnJlcGxhY2VXaXRoKHZhbHVlLmNhbGwodGhpcywgaSwgb2xkKSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJzdHJpbmciKSB7CiAgICAgICAgICB2YWx1ZSA9IGpRdWVyeSh2YWx1ZSkuZGV0YWNoKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBuZXh0ID0gdGhpcy5uZXh0U2libGluZywKICAgICAgICAgICAgICBwYXJlbnQgPSB0aGlzLnBhcmVudE5vZGU7CiAgICAgICAgICBqUXVlcnkodGhpcykucmVtb3ZlKCk7CgogICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgalF1ZXJ5KG5leHQpLmJlZm9yZSh2YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBqUXVlcnkocGFyZW50KS5hcHBlbmQodmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCA/IHRoaXMucHVzaFN0YWNrKGpRdWVyeShqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZSgpIDogdmFsdWUpLCAicmVwbGFjZVdpdGgiLCB2YWx1ZSkgOiB0aGlzOwogICAgICB9CiAgICB9LAogICAgZGV0YWNoOiBmdW5jdGlvbiBkZXRhY2goc2VsZWN0b3IpIHsKICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlKHNlbGVjdG9yLCB0cnVlKTsKICAgIH0sCiAgICBkb21NYW5pcDogZnVuY3Rpb24gZG9tTWFuaXAoYXJncywgdGFibGUsIGNhbGxiYWNrKSB7CiAgICAgIHZhciByZXN1bHRzLAogICAgICAgICAgZmlyc3QsCiAgICAgICAgICBmcmFnbWVudCwKICAgICAgICAgIHBhcmVudCwKICAgICAgICAgIHZhbHVlID0gYXJnc1swXSwKICAgICAgICAgIHNjcmlwdHMgPSBbXTsgLy8gV2UgY2FuJ3QgY2xvbmVOb2RlIGZyYWdtZW50cyB0aGF0IGNvbnRhaW4gY2hlY2tlZCwgaW4gV2ViS2l0CgogICAgICBpZiAoIWpRdWVyeS5zdXBwb3J0LmNoZWNrQ2xvbmUgJiYgYXJndW1lbnRzLmxlbmd0aCA9PT0gMyAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmIHJjaGVja2VkLnRlc3QodmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBqUXVlcnkodGhpcykuZG9tTWFuaXAoYXJncywgdGFibGUsIGNhbGxiYWNrLCB0cnVlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKSkgewogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICAgIHZhciBzZWxmID0galF1ZXJ5KHRoaXMpOwogICAgICAgICAgYXJnc1swXSA9IHZhbHVlLmNhbGwodGhpcywgaSwgdGFibGUgPyBzZWxmLmh0bWwoKSA6IHVuZGVmaW5lZCk7CiAgICAgICAgICBzZWxmLmRvbU1hbmlwKGFyZ3MsIHRhYmxlLCBjYWxsYmFjayk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzWzBdKSB7CiAgICAgICAgcGFyZW50ID0gdmFsdWUgJiYgdmFsdWUucGFyZW50Tm9kZTsgLy8gSWYgd2UncmUgaW4gYSBmcmFnbWVudCwganVzdCB1c2UgdGhhdCBpbnN0ZWFkIG9mIGJ1aWxkaW5nIGEgbmV3IG9uZQoKICAgICAgICBpZiAoalF1ZXJ5LnN1cHBvcnQucGFyZW50Tm9kZSAmJiBwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlID09PSAxMSAmJiBwYXJlbnQuY2hpbGROb2Rlcy5sZW5ndGggPT09IHRoaXMubGVuZ3RoKSB7CiAgICAgICAgICByZXN1bHRzID0gewogICAgICAgICAgICBmcmFnbWVudDogcGFyZW50CiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHRzID0galF1ZXJ5LmJ1aWxkRnJhZ21lbnQoYXJncywgdGhpcywgc2NyaXB0cyk7CiAgICAgICAgfQoKICAgICAgICBmcmFnbWVudCA9IHJlc3VsdHMuZnJhZ21lbnQ7CgogICAgICAgIGlmIChmcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgZmlyc3QgPSBmcmFnbWVudCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZpcnN0ID0gZnJhZ21lbnQuZmlyc3RDaGlsZDsKICAgICAgICB9CgogICAgICAgIGlmIChmaXJzdCkgewogICAgICAgICAgdGFibGUgPSB0YWJsZSAmJiBqUXVlcnkubm9kZU5hbWUoZmlyc3QsICJ0ciIpOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5sZW5ndGgsIGxhc3RJbmRleCA9IGwgLSAxOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGFibGUgPyByb290KHRoaXNbaV0sIGZpcnN0KSA6IHRoaXNbaV0sIC8vIE1ha2Ugc3VyZSB0aGF0IHdlIGRvIG5vdCBsZWFrIG1lbW9yeSBieSBpbmFkdmVydGVudGx5IGRpc2NhcmRpbmcKICAgICAgICAgICAgLy8gdGhlIG9yaWdpbmFsIGZyYWdtZW50ICh3aGljaCBtaWdodCBoYXZlIGF0dGFjaGVkIGRhdGEpIGluc3RlYWQgb2YKICAgICAgICAgICAgLy8gdXNpbmcgaXQ7IGluIGFkZGl0aW9uLCB1c2UgdGhlIG9yaWdpbmFsIGZyYWdtZW50IG9iamVjdCBmb3IgdGhlIGxhc3QKICAgICAgICAgICAgLy8gaXRlbSBpbnN0ZWFkIG9mIGZpcnN0IGJlY2F1c2UgaXQgY2FuIGVuZCB1cCBiZWluZyBlbXB0aWVkIGluY29ycmVjdGx5CiAgICAgICAgICAgIC8vIGluIGNlcnRhaW4gc2l0dWF0aW9ucyAoQnVnICM4MDcwKS4KICAgICAgICAgICAgLy8gRnJhZ21lbnRzIGZyb20gdGhlIGZyYWdtZW50IGNhY2hlIG11c3QgYWx3YXlzIGJlIGNsb25lZCBhbmQgbmV2ZXIgdXNlZAogICAgICAgICAgICAvLyBpbiBwbGFjZS4KICAgICAgICAgICAgcmVzdWx0cy5jYWNoZWFibGUgfHwgbCA+IDEgJiYgaSA8IGxhc3RJbmRleCA/IGpRdWVyeS5jbG9uZShmcmFnbWVudCwgdHJ1ZSwgdHJ1ZSkgOiBmcmFnbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc2NyaXB0cy5sZW5ndGgpIHsKICAgICAgICAgIGpRdWVyeS5lYWNoKHNjcmlwdHMsIGZ1bmN0aW9uIChpLCBlbGVtKSB7CiAgICAgICAgICAgIGlmIChlbGVtLnNyYykgewogICAgICAgICAgICAgIGpRdWVyeS5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAgICAgZ2xvYmFsOiBmYWxzZSwKICAgICAgICAgICAgICAgIHVybDogZWxlbS5zcmMsCiAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICBkYXRhVHlwZTogInNjcmlwdCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBqUXVlcnkuZ2xvYmFsRXZhbCgoZWxlbS50ZXh0IHx8IGVsZW0udGV4dENvbnRlbnQgfHwgZWxlbS5pbm5lckhUTUwgfHwgIiIpLnJlcGxhY2UocmNsZWFuU2NyaXB0LCAiLyokMCovIikpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZWxlbS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgICAgZWxlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiByb290KGVsZW0sIGN1cikgewogICAgcmV0dXJuIGpRdWVyeS5ub2RlTmFtZShlbGVtLCAidGFibGUiKSA/IGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IilbMF0gfHwgZWxlbS5hcHBlbmRDaGlsZChlbGVtLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGJvZHkiKSkgOiBlbGVtOwogIH0KCiAgZnVuY3Rpb24gY2xvbmVDb3B5RXZlbnQoc3JjLCBkZXN0KSB7CiAgICBpZiAoZGVzdC5ub2RlVHlwZSAhPT0gMSB8fCAhalF1ZXJ5Lmhhc0RhdGEoc3JjKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHR5cGUsCiAgICAgICAgaSwKICAgICAgICBsLAogICAgICAgIG9sZERhdGEgPSBqUXVlcnkuX2RhdGEoc3JjKSwKICAgICAgICBjdXJEYXRhID0galF1ZXJ5Ll9kYXRhKGRlc3QsIG9sZERhdGEpLAogICAgICAgIGV2ZW50cyA9IG9sZERhdGEuZXZlbnRzOwoKICAgIGlmIChldmVudHMpIHsKICAgICAgZGVsZXRlIGN1ckRhdGEuaGFuZGxlOwogICAgICBjdXJEYXRhLmV2ZW50cyA9IHt9OwoKICAgICAgZm9yICh0eXBlIGluIGV2ZW50cykgewogICAgICAgIGZvciAoaSA9IDAsIGwgPSBldmVudHNbdHlwZV0ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBqUXVlcnkuZXZlbnQuYWRkKGRlc3QsIHR5cGUsIGV2ZW50c1t0eXBlXVtpXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIG1ha2UgdGhlIGNsb25lZCBwdWJsaWMgZGF0YSBvYmplY3QgYSBjb3B5IGZyb20gdGhlIG9yaWdpbmFsCgoKICAgIGlmIChjdXJEYXRhLmRhdGEpIHsKICAgICAgY3VyRGF0YS5kYXRhID0galF1ZXJ5LmV4dGVuZCh7fSwgY3VyRGF0YS5kYXRhKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNsb25lRml4QXR0cmlidXRlcyhzcmMsIGRlc3QpIHsKICAgIHZhciBub2RlTmFtZTsgLy8gV2UgZG8gbm90IG5lZWQgdG8gZG8gYW55dGhpbmcgZm9yIG5vbi1FbGVtZW50cwoKICAgIGlmIChkZXN0Lm5vZGVUeXBlICE9PSAxKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gY2xlYXJBdHRyaWJ1dGVzIHJlbW92ZXMgdGhlIGF0dHJpYnV0ZXMsIHdoaWNoIHdlIGRvbid0IHdhbnQsCiAgICAvLyBidXQgYWxzbyByZW1vdmVzIHRoZSBhdHRhY2hFdmVudCBldmVudHMsIHdoaWNoIHdlICpkbyogd2FudAoKCiAgICBpZiAoZGVzdC5jbGVhckF0dHJpYnV0ZXMpIHsKICAgICAgZGVzdC5jbGVhckF0dHJpYnV0ZXMoKTsKICAgIH0gLy8gbWVyZ2VBdHRyaWJ1dGVzLCBpbiBjb250cmFzdCwgb25seSBtZXJnZXMgYmFjayBvbiB0aGUKICAgIC8vIG9yaWdpbmFsIGF0dHJpYnV0ZXMsIG5vdCB0aGUgZXZlbnRzCgoKICAgIGlmIChkZXN0Lm1lcmdlQXR0cmlidXRlcykgewogICAgICBkZXN0Lm1lcmdlQXR0cmlidXRlcyhzcmMpOwogICAgfQoKICAgIG5vZGVOYW1lID0gZGVzdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyAvLyBJRTYtOCBmYWlsIHRvIGNsb25lIGNoaWxkcmVuIGluc2lkZSBvYmplY3QgZWxlbWVudHMgdGhhdCB1c2UKICAgIC8vIHRoZSBwcm9wcmlldGFyeSBjbGFzc2lkIGF0dHJpYnV0ZSB2YWx1ZSAocmF0aGVyIHRoYW4gdGhlIHR5cGUKICAgIC8vIGF0dHJpYnV0ZSkgdG8gaWRlbnRpZnkgdGhlIHR5cGUgb2YgY29udGVudCB0byBkaXNwbGF5CgogICAgaWYgKG5vZGVOYW1lID09PSAib2JqZWN0IikgewogICAgICBkZXN0Lm91dGVySFRNTCA9IHNyYy5vdXRlckhUTUw7CiAgICB9IGVsc2UgaWYgKG5vZGVOYW1lID09PSAiaW5wdXQiICYmIChzcmMudHlwZSA9PT0gImNoZWNrYm94IiB8fCBzcmMudHlwZSA9PT0gInJhZGlvIikpIHsKICAgICAgLy8gSUU2LTggZmFpbHMgdG8gcGVyc2lzdCB0aGUgY2hlY2tlZCBzdGF0ZSBvZiBhIGNsb25lZCBjaGVja2JveAogICAgICAvLyBvciByYWRpbyBidXR0b24uIFdvcnNlLCBJRTYtNyBmYWlsIHRvIGdpdmUgdGhlIGNsb25lZCBlbGVtZW50CiAgICAgIC8vIGEgY2hlY2tlZCBhcHBlYXJhbmNlIGlmIHRoZSBkZWZhdWx0Q2hlY2tlZCB2YWx1ZSBpc24ndCBhbHNvIHNldAogICAgICBpZiAoc3JjLmNoZWNrZWQpIHsKICAgICAgICBkZXN0LmRlZmF1bHRDaGVja2VkID0gZGVzdC5jaGVja2VkID0gc3JjLmNoZWNrZWQ7CiAgICAgIH0gLy8gSUU2LTcgZ2V0IGNvbmZ1c2VkIGFuZCBlbmQgdXAgc2V0dGluZyB0aGUgdmFsdWUgb2YgYSBjbG9uZWQKICAgICAgLy8gY2hlY2tib3gvcmFkaW8gYnV0dG9uIHRvIGFuIGVtcHR5IHN0cmluZyBpbnN0ZWFkIG9mICJvbiIKCgogICAgICBpZiAoZGVzdC52YWx1ZSAhPT0gc3JjLnZhbHVlKSB7CiAgICAgICAgZGVzdC52YWx1ZSA9IHNyYy52YWx1ZTsKICAgICAgfSAvLyBJRTYtOCBmYWlscyB0byByZXR1cm4gdGhlIHNlbGVjdGVkIG9wdGlvbiB0byB0aGUgZGVmYXVsdCBzZWxlY3RlZAogICAgICAvLyBzdGF0ZSB3aGVuIGNsb25pbmcgb3B0aW9ucwoKICAgIH0gZWxzZSBpZiAobm9kZU5hbWUgPT09ICJvcHRpb24iKSB7CiAgICAgIGRlc3Quc2VsZWN0ZWQgPSBzcmMuZGVmYXVsdFNlbGVjdGVkOyAvLyBJRTYtOCBmYWlscyB0byBzZXQgdGhlIGRlZmF1bHRWYWx1ZSB0byB0aGUgY29ycmVjdCB2YWx1ZSB3aGVuCiAgICAgIC8vIGNsb25pbmcgb3RoZXIgdHlwZXMgb2YgaW5wdXQgZmllbGRzCiAgICB9IGVsc2UgaWYgKG5vZGVOYW1lID09PSAiaW5wdXQiIHx8IG5vZGVOYW1lID09PSAidGV4dGFyZWEiKSB7CiAgICAgIGRlc3QuZGVmYXVsdFZhbHVlID0gc3JjLmRlZmF1bHRWYWx1ZTsgLy8gSUUgYmxhbmtzIGNvbnRlbnRzIHdoZW4gY2xvbmluZyBzY3JpcHRzCiAgICB9IGVsc2UgaWYgKG5vZGVOYW1lID09PSAic2NyaXB0IiAmJiBkZXN0LnRleHQgIT09IHNyYy50ZXh0KSB7CiAgICAgIGRlc3QudGV4dCA9IHNyYy50ZXh0OwogICAgfSAvLyBFdmVudCBkYXRhIGdldHMgcmVmZXJlbmNlZCBpbnN0ZWFkIG9mIGNvcGllZCBpZiB0aGUgZXhwYW5kbwogICAgLy8gZ2V0cyBjb3BpZWQgdG9vCgoKICAgIGRlc3QucmVtb3ZlQXR0cmlidXRlKGpRdWVyeS5leHBhbmRvKTsgLy8gQ2xlYXIgZmxhZ3MgZm9yIGJ1YmJsaW5nIHNwZWNpYWwgY2hhbmdlL3N1Ym1pdCBldmVudHMsIHRoZXkgbXVzdAogICAgLy8gYmUgcmVhdHRhY2hlZCB3aGVuIHRoZSBuZXdseSBjbG9uZWQgZXZlbnRzIGFyZSBmaXJzdCBhY3RpdmF0ZWQKCiAgICBkZXN0LnJlbW92ZUF0dHJpYnV0ZSgiX3N1Ym1pdF9hdHRhY2hlZCIpOwogICAgZGVzdC5yZW1vdmVBdHRyaWJ1dGUoIl9jaGFuZ2VfYXR0YWNoZWQiKTsKICB9CgogIGpRdWVyeS5idWlsZEZyYWdtZW50ID0gZnVuY3Rpb24gKGFyZ3MsIG5vZGVzLCBzY3JpcHRzKSB7CiAgICB2YXIgZnJhZ21lbnQsCiAgICAgICAgY2FjaGVhYmxlLAogICAgICAgIGNhY2hlcmVzdWx0cywKICAgICAgICBkb2MsCiAgICAgICAgZmlyc3QgPSBhcmdzWzBdOyAvLyBub2RlcyBtYXkgY29udGFpbiBlaXRoZXIgYW4gZXhwbGljaXQgZG9jdW1lbnQgb2JqZWN0LAogICAgLy8gYSBqUXVlcnkgY29sbGVjdGlvbiBvciBjb250ZXh0IG9iamVjdC4KICAgIC8vIElmIG5vZGVzWzBdIGNvbnRhaW5zIGEgdmFsaWQgb2JqZWN0IHRvIGFzc2lnbiB0byBkb2MKCiAgICBpZiAobm9kZXMgJiYgbm9kZXNbMF0pIHsKICAgICAgZG9jID0gbm9kZXNbMF0ub3duZXJEb2N1bWVudCB8fCBub2Rlc1swXTsKICAgIH0gLy8gRW5zdXJlIHRoYXQgYW4gYXR0ciBvYmplY3QgZG9lc24ndCBpbmNvcnJlY3RseSBzdGFuZCBpbiBhcyBhIGRvY3VtZW50IG9iamVjdAogICAgLy8gQ2hyb21lIGFuZCBGaXJlZm94IHNlZW0gdG8gYWxsb3cgdGhpcyB0byBvY2N1ciBhbmQgd2lsbCB0aHJvdyBleGNlcHRpb24KICAgIC8vIEZpeGVzICM4OTUwCgoKICAgIGlmICghZG9jLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQpIHsKICAgICAgZG9jID0gZG9jdW1lbnQ7CiAgICB9IC8vIE9ubHkgY2FjaGUgInNtYWxsIiAoMS8yIEtCKSBIVE1MIHN0cmluZ3MgdGhhdCBhcmUgYXNzb2NpYXRlZCB3aXRoIHRoZSBtYWluIGRvY3VtZW50CiAgICAvLyBDbG9uaW5nIG9wdGlvbnMgbG9zZXMgdGhlIHNlbGVjdGVkIHN0YXRlLCBzbyBkb24ndCBjYWNoZSB0aGVtCiAgICAvLyBJRSA2IGRvZXNuJ3QgbGlrZSBpdCB3aGVuIHlvdSBwdXQgPG9iamVjdD4gb3IgPGVtYmVkPiBlbGVtZW50cyBpbiBhIGZyYWdtZW50CiAgICAvLyBBbHNvLCBXZWJLaXQgZG9lcyBub3QgY2xvbmUgJ2NoZWNrZWQnIGF0dHJpYnV0ZXMgb24gY2xvbmVOb2RlLCBzbyBkb24ndCBjYWNoZQogICAgLy8gTGFzdGx5LCBJRTYsNyw4IHdpbGwgbm90IGNvcnJlY3RseSByZXVzZSBjYWNoZWQgZnJhZ21lbnRzIHRoYXQgd2VyZSBjcmVhdGVkIGZyb20gdW5rbm93biBlbGVtcyAjMTA1MDEKCgogICAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmIHR5cGVvZiBmaXJzdCA9PT0gInN0cmluZyIgJiYgZmlyc3QubGVuZ3RoIDwgNTEyICYmIGRvYyA9PT0gZG9jdW1lbnQgJiYgZmlyc3QuY2hhckF0KDApID09PSAiPCIgJiYgIXJub2NhY2hlLnRlc3QoZmlyc3QpICYmIChqUXVlcnkuc3VwcG9ydC5jaGVja0Nsb25lIHx8ICFyY2hlY2tlZC50ZXN0KGZpcnN0KSkgJiYgKGpRdWVyeS5zdXBwb3J0Lmh0bWw1Q2xvbmUgfHwgIXJub3NoaW1jYWNoZS50ZXN0KGZpcnN0KSkpIHsKICAgICAgY2FjaGVhYmxlID0gdHJ1ZTsKICAgICAgY2FjaGVyZXN1bHRzID0galF1ZXJ5LmZyYWdtZW50c1tmaXJzdF07CgogICAgICBpZiAoY2FjaGVyZXN1bHRzICYmIGNhY2hlcmVzdWx0cyAhPT0gMSkgewogICAgICAgIGZyYWdtZW50ID0gY2FjaGVyZXN1bHRzOwogICAgICB9CiAgICB9CgogICAgaWYgKCFmcmFnbWVudCkgewogICAgICBmcmFnbWVudCA9IGRvYy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIGpRdWVyeS5jbGVhbihhcmdzLCBkb2MsIGZyYWdtZW50LCBzY3JpcHRzKTsKICAgIH0KCiAgICBpZiAoY2FjaGVhYmxlKSB7CiAgICAgIGpRdWVyeS5mcmFnbWVudHNbZmlyc3RdID0gY2FjaGVyZXN1bHRzID8gZnJhZ21lbnQgOiAxOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGZyYWdtZW50OiBmcmFnbWVudCwKICAgICAgY2FjaGVhYmxlOiBjYWNoZWFibGUKICAgIH07CiAgfTsKCiAgalF1ZXJ5LmZyYWdtZW50cyA9IHt9OwogIGpRdWVyeS5lYWNoKHsKICAgIGFwcGVuZFRvOiAiYXBwZW5kIiwKICAgIHByZXBlbmRUbzogInByZXBlbmQiLAogICAgaW5zZXJ0QmVmb3JlOiAiYmVmb3JlIiwKICAgIGluc2VydEFmdGVyOiAiYWZ0ZXIiLAogICAgcmVwbGFjZUFsbDogInJlcGxhY2VXaXRoIgogIH0sIGZ1bmN0aW9uIChuYW1lLCBvcmlnaW5hbCkgewogICAgalF1ZXJ5LmZuW25hbWVdID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgIHZhciByZXQgPSBbXSwKICAgICAgICAgIGluc2VydCA9IGpRdWVyeShzZWxlY3RvciksCiAgICAgICAgICBwYXJlbnQgPSB0aGlzLmxlbmd0aCA9PT0gMSAmJiB0aGlzWzBdLnBhcmVudE5vZGU7CgogICAgICBpZiAocGFyZW50ICYmIHBhcmVudC5ub2RlVHlwZSA9PT0gMTEgJiYgcGFyZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICYmIGluc2VydC5sZW5ndGggPT09IDEpIHsKICAgICAgICBpbnNlcnRbb3JpZ2luYWxdKHRoaXNbMF0pOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaW5zZXJ0Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgdmFyIGVsZW1zID0gKGkgPiAwID8gdGhpcy5jbG9uZSh0cnVlKSA6IHRoaXMpLmdldCgpOwogICAgICAgICAgalF1ZXJ5KGluc2VydFtpXSlbb3JpZ2luYWxdKGVsZW1zKTsKICAgICAgICAgIHJldCA9IHJldC5jb25jYXQoZWxlbXMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHJldCwgbmFtZSwgaW5zZXJ0LnNlbGVjdG9yKTsKICAgICAgfQogICAgfTsKICB9KTsKCiAgZnVuY3Rpb24gZ2V0QWxsKGVsZW0pIHsKICAgIGlmICh0eXBlb2YgZWxlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgcmV0dXJuIGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGVsZW0ucXVlcnlTZWxlY3RvckFsbCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgcmV0dXJuIGVsZW0ucXVlcnlTZWxlY3RvckFsbCgiKiIpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIFtdOwogICAgfQogIH0gLy8gVXNlZCBpbiBjbGVhbiwgZml4ZXMgdGhlIGRlZmF1bHRDaGVja2VkIHByb3BlcnR5CgoKICBmdW5jdGlvbiBmaXhEZWZhdWx0Q2hlY2tlZChlbGVtKSB7CiAgICBpZiAoZWxlbS50eXBlID09PSAiY2hlY2tib3giIHx8IGVsZW0udHlwZSA9PT0gInJhZGlvIikgewogICAgICBlbGVtLmRlZmF1bHRDaGVja2VkID0gZWxlbS5jaGVja2VkOwogICAgfQogIH0gLy8gRmluZHMgYWxsIGlucHV0cyBhbmQgcGFzc2VzIHRoZW0gdG8gZml4RGVmYXVsdENoZWNrZWQKCgogIGZ1bmN0aW9uIGZpbmRJbnB1dHMoZWxlbSkgewogICAgdmFyIG5vZGVOYW1lID0gKGVsZW0ubm9kZU5hbWUgfHwgIiIpLnRvTG93ZXJDYXNlKCk7CgogICAgaWYgKG5vZGVOYW1lID09PSAiaW5wdXQiKSB7CiAgICAgIGZpeERlZmF1bHRDaGVja2VkKGVsZW0pOyAvLyBTa2lwIHNjcmlwdHMsIGdldCBvdGhlciBjaGlsZHJlbgogICAgfSBlbHNlIGlmIChub2RlTmFtZSAhPT0gInNjcmlwdCIgJiYgdHlwZW9mIGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGpRdWVyeS5ncmVwKGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IiksIGZpeERlZmF1bHRDaGVja2VkKTsKICAgIH0KICB9IC8vIERlcml2ZWQgRnJvbTogaHR0cDovL3d3dy5pZWNzcy5jb20vc2hpbXByb3ZlL2phdmFzY3JpcHQvc2hpbXByb3ZlLjEtMC0xLmpzCgoKICBmdW5jdGlvbiBzaGltQ2xvbmVOb2RlKGVsZW0pIHsKICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIHNhZmVGcmFnbWVudC5hcHBlbmRDaGlsZChkaXYpOwogICAgZGl2LmlubmVySFRNTCA9IGVsZW0ub3V0ZXJIVE1MOwogICAgcmV0dXJuIGRpdi5maXJzdENoaWxkOwogIH0KCiAgalF1ZXJ5LmV4dGVuZCh7CiAgICBjbG9uZTogZnVuY3Rpb24gY2xvbmUoZWxlbSwgZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMpIHsKICAgICAgdmFyIHNyY0VsZW1lbnRzLAogICAgICAgICAgZGVzdEVsZW1lbnRzLAogICAgICAgICAgaSwKICAgICAgICAgIC8vIElFPD04IGRvZXMgbm90IHByb3Blcmx5IGNsb25lIGRldGFjaGVkLCB1bmtub3duIGVsZW1lbnQgbm9kZXMKICAgICAgY2xvbmUgPSBqUXVlcnkuc3VwcG9ydC5odG1sNUNsb25lIHx8IGpRdWVyeS5pc1hNTERvYyhlbGVtKSB8fCAhcm5vc2hpbWNhY2hlLnRlc3QoIjwiICsgZWxlbS5ub2RlTmFtZSArICI+IikgPyBlbGVtLmNsb25lTm9kZSh0cnVlKSA6IHNoaW1DbG9uZU5vZGUoZWxlbSk7CgogICAgICBpZiAoKCFqUXVlcnkuc3VwcG9ydC5ub0Nsb25lRXZlbnQgfHwgIWpRdWVyeS5zdXBwb3J0Lm5vQ2xvbmVDaGVja2VkKSAmJiAoZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBlbGVtLm5vZGVUeXBlID09PSAxMSkgJiYgIWpRdWVyeS5pc1hNTERvYyhlbGVtKSkgewogICAgICAgIC8vIElFIGNvcGllcyBldmVudHMgYm91bmQgdmlhIGF0dGFjaEV2ZW50IHdoZW4gdXNpbmcgY2xvbmVOb2RlLgogICAgICAgIC8vIENhbGxpbmcgZGV0YWNoRXZlbnQgb24gdGhlIGNsb25lIHdpbGwgYWxzbyByZW1vdmUgdGhlIGV2ZW50cwogICAgICAgIC8vIGZyb20gdGhlIG9yaWdpbmFsLiBJbiBvcmRlciB0byBnZXQgYXJvdW5kIHRoaXMsIHdlIHVzZSBzb21lCiAgICAgICAgLy8gcHJvcHJpZXRhcnkgbWV0aG9kcyB0byBjbGVhciB0aGUgZXZlbnRzLiBUaGFua3MgdG8gTW9vVG9vbHMKICAgICAgICAvLyBndXlzIGZvciB0aGlzIGhvdG5lc3MuCiAgICAgICAgY2xvbmVGaXhBdHRyaWJ1dGVzKGVsZW0sIGNsb25lKTsgLy8gVXNpbmcgU2l6emxlIGhlcmUgaXMgY3Jhenkgc2xvdywgc28gd2UgdXNlIGdldEVsZW1lbnRzQnlUYWdOYW1lIGluc3RlYWQKCiAgICAgICAgc3JjRWxlbWVudHMgPSBnZXRBbGwoZWxlbSk7CiAgICAgICAgZGVzdEVsZW1lbnRzID0gZ2V0QWxsKGNsb25lKTsgLy8gV2VpcmQgaXRlcmF0aW9uIGJlY2F1c2UgSUUgd2lsbCByZXBsYWNlIHRoZSBsZW5ndGggcHJvcGVydHkKICAgICAgICAvLyB3aXRoIGFuIGVsZW1lbnQgaWYgeW91IGFyZSBjbG9uaW5nIHRoZSBib2R5IGFuZCBvbmUgb2YgdGhlCiAgICAgICAgLy8gZWxlbWVudHMgb24gdGhlIHBhZ2UgaGFzIGEgbmFtZSBvciBpZCBvZiAibGVuZ3RoIgoKICAgICAgICBmb3IgKGkgPSAwOyBzcmNFbGVtZW50c1tpXTsgKytpKSB7CiAgICAgICAgICAvLyBFbnN1cmUgdGhhdCB0aGUgZGVzdGluYXRpb24gbm9kZSBpcyBub3QgbnVsbDsgRml4ZXMgIzk1ODcKICAgICAgICAgIGlmIChkZXN0RWxlbWVudHNbaV0pIHsKICAgICAgICAgICAgY2xvbmVGaXhBdHRyaWJ1dGVzKHNyY0VsZW1lbnRzW2ldLCBkZXN0RWxlbWVudHNbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBDb3B5IHRoZSBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgdG8gdGhlIGNsb25lCgoKICAgICAgaWYgKGRhdGFBbmRFdmVudHMpIHsKICAgICAgICBjbG9uZUNvcHlFdmVudChlbGVtLCBjbG9uZSk7CgogICAgICAgIGlmIChkZWVwRGF0YUFuZEV2ZW50cykgewogICAgICAgICAgc3JjRWxlbWVudHMgPSBnZXRBbGwoZWxlbSk7CiAgICAgICAgICBkZXN0RWxlbWVudHMgPSBnZXRBbGwoY2xvbmUpOwoKICAgICAgICAgIGZvciAoaSA9IDA7IHNyY0VsZW1lbnRzW2ldOyArK2kpIHsKICAgICAgICAgICAgY2xvbmVDb3B5RXZlbnQoc3JjRWxlbWVudHNbaV0sIGRlc3RFbGVtZW50c1tpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBzcmNFbGVtZW50cyA9IGRlc3RFbGVtZW50cyA9IG51bGw7IC8vIFJldHVybiB0aGUgY2xvbmVkIHNldAoKICAgICAgcmV0dXJuIGNsb25lOwogICAgfSwKICAgIGNsZWFuOiBmdW5jdGlvbiBjbGVhbihlbGVtcywgY29udGV4dCwgZnJhZ21lbnQsIHNjcmlwdHMpIHsKICAgICAgdmFyIGNoZWNrU2NyaXB0VHlwZSwKICAgICAgICAgIHNjcmlwdCwKICAgICAgICAgIGosCiAgICAgICAgICByZXQgPSBbXTsKICAgICAgY29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7IC8vICFjb250ZXh0LmNyZWF0ZUVsZW1lbnQgZmFpbHMgaW4gSUUgd2l0aCBhbiBlcnJvciBidXQgcmV0dXJucyB0eXBlb2YgJ29iamVjdCcKCiAgICAgIGlmICh0eXBlb2YgY29udGV4dC5jcmVhdGVFbGVtZW50ID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNvbnRleHQgPSBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dFswXSAmJiBjb250ZXh0WzBdLm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwLCBlbGVtOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKyspIHsKICAgICAgICBpZiAodHlwZW9mIGVsZW0gPT09ICJudW1iZXIiKSB7CiAgICAgICAgICBlbGVtICs9ICIiOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFlbGVtKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIENvbnZlcnQgaHRtbCBzdHJpbmcgaW50byBET00gbm9kZXMKCgogICAgICAgIGlmICh0eXBlb2YgZWxlbSA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIGlmICghcmh0bWwudGVzdChlbGVtKSkgewogICAgICAgICAgICBlbGVtID0gY29udGV4dC5jcmVhdGVUZXh0Tm9kZShlbGVtKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEZpeCAiWEhUTUwiLXN0eWxlIHRhZ3MgaW4gYWxsIGJyb3dzZXJzCiAgICAgICAgICAgIGVsZW0gPSBlbGVtLnJlcGxhY2UocnhodG1sVGFnLCAiPCQxPjwvJDI+Iik7IC8vIFRyaW0gd2hpdGVzcGFjZSwgb3RoZXJ3aXNlIGluZGV4T2Ygd29uJ3Qgd29yayBhcyBleHBlY3RlZAoKICAgICAgICAgICAgdmFyIHRhZyA9IChydGFnTmFtZS5leGVjKGVsZW0pIHx8IFsiIiwgIiJdKVsxXS50b0xvd2VyQ2FzZSgpLAogICAgICAgICAgICAgICAgd3JhcCA9IHdyYXBNYXBbdGFnXSB8fCB3cmFwTWFwLl9kZWZhdWx0LAogICAgICAgICAgICAgICAgZGVwdGggPSB3cmFwWzBdLAogICAgICAgICAgICAgICAgZGl2ID0gY29udGV4dC5jcmVhdGVFbGVtZW50KCJkaXYiKSwKICAgICAgICAgICAgICAgIHNhZmVDaGlsZE5vZGVzID0gc2FmZUZyYWdtZW50LmNoaWxkTm9kZXMsCiAgICAgICAgICAgICAgICByZW1vdmU7IC8vIEFwcGVuZCB3cmFwcGVyIGVsZW1lbnQgdG8gdW5rbm93biBlbGVtZW50IHNhZmUgZG9jIGZyYWdtZW50CgogICAgICAgICAgICBpZiAoY29udGV4dCA9PT0gZG9jdW1lbnQpIHsKICAgICAgICAgICAgICAvLyBVc2UgdGhlIGZyYWdtZW50IHdlJ3ZlIGFscmVhZHkgY3JlYXRlZCBmb3IgdGhpcyBkb2N1bWVudAogICAgICAgICAgICAgIHNhZmVGcmFnbWVudC5hcHBlbmRDaGlsZChkaXYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIFVzZSBhIGZyYWdtZW50IGNyZWF0ZWQgd2l0aCB0aGUgb3duZXIgZG9jdW1lbnQKICAgICAgICAgICAgICBjcmVhdGVTYWZlRnJhZ21lbnQoY29udGV4dCkuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgICAgICAgfSAvLyBHbyB0byBodG1sIGFuZCBiYWNrLCB0aGVuIHBlZWwgb2ZmIGV4dHJhIHdyYXBwZXJzCgoKICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IHdyYXBbMV0gKyBlbGVtICsgd3JhcFsyXTsgLy8gTW92ZSB0byB0aGUgcmlnaHQgZGVwdGgKCiAgICAgICAgICAgIHdoaWxlIChkZXB0aC0tKSB7CiAgICAgICAgICAgICAgZGl2ID0gZGl2Lmxhc3RDaGlsZDsKICAgICAgICAgICAgfSAvLyBSZW1vdmUgSUUncyBhdXRvaW5zZXJ0ZWQgPHRib2R5PiBmcm9tIHRhYmxlIGZyYWdtZW50cwoKCiAgICAgICAgICAgIGlmICghalF1ZXJ5LnN1cHBvcnQudGJvZHkpIHsKICAgICAgICAgICAgICAvLyBTdHJpbmcgd2FzIGEgPHRhYmxlPiwgKm1heSogaGF2ZSBzcHVyaW91cyA8dGJvZHk+CiAgICAgICAgICAgICAgdmFyIGhhc0JvZHkgPSBydGJvZHkudGVzdChlbGVtKSwKICAgICAgICAgICAgICAgICAgdGJvZHkgPSB0YWcgPT09ICJ0YWJsZSIgJiYgIWhhc0JvZHkgPyBkaXYuZmlyc3RDaGlsZCAmJiBkaXYuZmlyc3RDaGlsZC5jaGlsZE5vZGVzIDogLy8gU3RyaW5nIHdhcyBhIGJhcmUgPHRoZWFkPiBvciA8dGZvb3Q+CiAgICAgICAgICAgICAgd3JhcFsxXSA9PT0gIjx0YWJsZT4iICYmICFoYXNCb2R5ID8gZGl2LmNoaWxkTm9kZXMgOiBbXTsKCiAgICAgICAgICAgICAgZm9yIChqID0gdGJvZHkubGVuZ3RoIC0gMTsgaiA+PSAwOyAtLWopIHsKICAgICAgICAgICAgICAgIGlmIChqUXVlcnkubm9kZU5hbWUodGJvZHlbal0sICJ0Ym9keSIpICYmICF0Ym9keVtqXS5jaGlsZE5vZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICB0Ym9keVtqXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRib2R5W2pdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gLy8gSUUgY29tcGxldGVseSBraWxscyBsZWFkaW5nIHdoaXRlc3BhY2Ugd2hlbiBpbm5lckhUTUwgaXMgdXNlZAoKCiAgICAgICAgICAgIGlmICghalF1ZXJ5LnN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UgJiYgcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoZWxlbSkpIHsKICAgICAgICAgICAgICBkaXYuaW5zZXJ0QmVmb3JlKGNvbnRleHQuY3JlYXRlVGV4dE5vZGUocmxlYWRpbmdXaGl0ZXNwYWNlLmV4ZWMoZWxlbSlbMF0pLCBkaXYuZmlyc3RDaGlsZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVsZW0gPSBkaXYuY2hpbGROb2RlczsgLy8gQ2xlYXIgZWxlbWVudHMgZnJvbSBEb2N1bWVudEZyYWdtZW50IChzYWZlRnJhZ21lbnQgb3Igb3RoZXJ3aXNlKQogICAgICAgICAgICAvLyB0byBhdm9pZCBob2FyZGluZyBlbGVtZW50cy4gRml4ZXMgIzExMzU2CgogICAgICAgICAgICBpZiAoZGl2KSB7CiAgICAgICAgICAgICAgZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGl2KTsgLy8gR3VhcmQgYWdhaW5zdCAtMSBpbmRleCBleGNlcHRpb25zIGluIEZGMy42CgogICAgICAgICAgICAgIGlmIChzYWZlQ2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICByZW1vdmUgPSBzYWZlQ2hpbGROb2Rlc1tzYWZlQ2hpbGROb2Rlcy5sZW5ndGggLSAxXTsKCiAgICAgICAgICAgICAgICBpZiAocmVtb3ZlICYmIHJlbW92ZS5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgICAgICAgIHJlbW92ZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJlbW92ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZXNldHMgZGVmYXVsdENoZWNrZWQgZm9yIGFueSByYWRpb3MgYW5kIGNoZWNrYm94ZXMKICAgICAgICAvLyBhYm91dCB0byBiZSBhcHBlbmRlZCB0byB0aGUgRE9NIGluIElFIDYvNyAoIzgwNjApCgoKICAgICAgICB2YXIgbGVuOwoKICAgICAgICBpZiAoIWpRdWVyeS5zdXBwb3J0LmFwcGVuZENoZWNrZWQpIHsKICAgICAgICAgIGlmIChlbGVtWzBdICYmIHR5cGVvZiAobGVuID0gZWxlbS5sZW5ndGgpID09PSAibnVtYmVyIikgewogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbGVuOyBqKyspIHsKICAgICAgICAgICAgICBmaW5kSW5wdXRzKGVsZW1bal0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmaW5kSW5wdXRzKGVsZW0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUpIHsKICAgICAgICAgIHJldC5wdXNoKGVsZW0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXQgPSBqUXVlcnkubWVyZ2UocmV0LCBlbGVtKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChmcmFnbWVudCkgewogICAgICAgIGNoZWNrU2NyaXB0VHlwZSA9IGZ1bmN0aW9uIGNoZWNrU2NyaXB0VHlwZShlbGVtKSB7CiAgICAgICAgICByZXR1cm4gIWVsZW0udHlwZSB8fCByc2NyaXB0VHlwZS50ZXN0KGVsZW0udHlwZSk7CiAgICAgICAgfTsKCiAgICAgICAgZm9yIChpID0gMDsgcmV0W2ldOyBpKyspIHsKICAgICAgICAgIHNjcmlwdCA9IHJldFtpXTsKCiAgICAgICAgICBpZiAoc2NyaXB0cyAmJiBqUXVlcnkubm9kZU5hbWUoc2NyaXB0LCAic2NyaXB0IikgJiYgKCFzY3JpcHQudHlwZSB8fCByc2NyaXB0VHlwZS50ZXN0KHNjcmlwdC50eXBlKSkpIHsKICAgICAgICAgICAgc2NyaXB0cy5wdXNoKHNjcmlwdC5wYXJlbnROb2RlID8gc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KSA6IHNjcmlwdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoc2NyaXB0Lm5vZGVUeXBlID09PSAxKSB7CiAgICAgICAgICAgICAgdmFyIGpzVGFncyA9IGpRdWVyeS5ncmVwKHNjcmlwdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0IiksIGNoZWNrU2NyaXB0VHlwZSk7CiAgICAgICAgICAgICAgcmV0LnNwbGljZS5hcHBseShyZXQsIFtpICsgMSwgMF0uY29uY2F0KGpzVGFncykpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJldDsKICAgIH0sCiAgICBjbGVhbkRhdGE6IGZ1bmN0aW9uIGNsZWFuRGF0YShlbGVtcykgewogICAgICB2YXIgZGF0YSwKICAgICAgICAgIGlkLAogICAgICAgICAgY2FjaGUgPSBqUXVlcnkuY2FjaGUsCiAgICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWwsCiAgICAgICAgICBkZWxldGVFeHBhbmRvID0galF1ZXJ5LnN1cHBvcnQuZGVsZXRlRXhwYW5kbzsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBlbGVtOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKyspIHsKICAgICAgICBpZiAoZWxlbS5ub2RlTmFtZSAmJiBqUXVlcnkubm9EYXRhW2VsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWQgPSBlbGVtW2pRdWVyeS5leHBhbmRvXTsKCiAgICAgICAgaWYgKGlkKSB7CiAgICAgICAgICBkYXRhID0gY2FjaGVbaWRdOwoKICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEuZXZlbnRzKSB7CiAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gZGF0YS5ldmVudHMpIHsKICAgICAgICAgICAgICBpZiAoc3BlY2lhbFt0eXBlXSkgewogICAgICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnJlbW92ZShlbGVtLCB0eXBlKTsgLy8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1vdmUncyBvdmVyaGVhZAogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBqUXVlcnkucmVtb3ZlRXZlbnQoZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBOdWxsIHRoZSBET00gcmVmZXJlbmNlIHRvIGF2b2lkIElFNi83LzggbGVhayAoIzcwNTQpCgoKICAgICAgICAgICAgaWYgKGRhdGEuaGFuZGxlKSB7CiAgICAgICAgICAgICAgZGF0YS5oYW5kbGUuZWxlbSA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZGVsZXRlRXhwYW5kbykgewogICAgICAgICAgICBkZWxldGUgZWxlbVtqUXVlcnkuZXhwYW5kb107CiAgICAgICAgICB9IGVsc2UgaWYgKGVsZW0ucmVtb3ZlQXR0cmlidXRlKSB7CiAgICAgICAgICAgIGVsZW0ucmVtb3ZlQXR0cmlidXRlKGpRdWVyeS5leHBhbmRvKTsKICAgICAgICAgIH0KCiAgICAgICAgICBkZWxldGUgY2FjaGVbaWRdOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwogIHZhciByYWxwaGEgPSAvYWxwaGFcKFteKV0qXCkvaSwKICAgICAgcm9wYWNpdHkgPSAvb3BhY2l0eT0oW14pXSopLywKICAgICAgLy8gZml4ZWQgZm9yIElFOSwgc2VlICM4MzQ2CiAgcnVwcGVyID0gLyhbQS1aXXxebXMpL2csCiAgICAgIHJudW0gPSAvXltcLStdPyg/OlxkKlwuKT9cZCskL2ksCiAgICAgIHJudW1ub25weCA9IC9eLT8oPzpcZCpcLik/XGQrKD8hcHgpW15cZFxzXSskL2ksCiAgICAgIHJyZWxOdW0gPSAvXihbXC0rXSk9KFtcLSsuXGRlXSspLywKICAgICAgcm1hcmdpbiA9IC9ebWFyZ2luLywKICAgICAgY3NzU2hvdyA9IHsKICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLAogICAgdmlzaWJpbGl0eTogImhpZGRlbiIsCiAgICBkaXNwbGF5OiAiYmxvY2siCiAgfSwKICAgICAgLy8gb3JkZXIgaXMgaW1wb3J0YW50IQogIGNzc0V4cGFuZCA9IFsiVG9wIiwgIlJpZ2h0IiwgIkJvdHRvbSIsICJMZWZ0Il0sCiAgICAgIGN1ckNTUywKICAgICAgZ2V0Q29tcHV0ZWRTdHlsZSwKICAgICAgY3VycmVudFN0eWxlOwoKICBqUXVlcnkuZm4uY3NzID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICByZXR1cm4galF1ZXJ5LmFjY2Vzcyh0aGlzLCBmdW5jdGlvbiAoZWxlbSwgbmFtZSwgdmFsdWUpIHsKICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyBqUXVlcnkuc3R5bGUoZWxlbSwgbmFtZSwgdmFsdWUpIDogalF1ZXJ5LmNzcyhlbGVtLCBuYW1lKTsKICAgIH0sIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSk7CiAgfTsKCiAgalF1ZXJ5LmV4dGVuZCh7CiAgICAvLyBBZGQgaW4gc3R5bGUgcHJvcGVydHkgaG9va3MgZm9yIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHQKICAgIC8vIGJlaGF2aW9yIG9mIGdldHRpbmcgYW5kIHNldHRpbmcgYSBzdHlsZSBwcm9wZXJ0eQogICAgY3NzSG9va3M6IHsKICAgICAgb3BhY2l0eTogewogICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGVsZW0sIGNvbXB1dGVkKSB7CiAgICAgICAgICBpZiAoY29tcHV0ZWQpIHsKICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIGFsd2F5cyBnZXQgYSBudW1iZXIgYmFjayBmcm9tIG9wYWNpdHkKICAgICAgICAgICAgdmFyIHJldCA9IGN1ckNTUyhlbGVtLCAib3BhY2l0eSIpOwogICAgICAgICAgICByZXR1cm4gcmV0ID09PSAiIiA/ICIxIiA6IHJldDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBlbGVtLnN0eWxlLm9wYWNpdHk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8gRXhjbHVkZSB0aGUgZm9sbG93aW5nIGNzcyBwcm9wZXJ0aWVzIHRvIGFkZCBweAogICAgY3NzTnVtYmVyOiB7CiAgICAgICJmaWxsT3BhY2l0eSI6IHRydWUsCiAgICAgICJmb250V2VpZ2h0IjogdHJ1ZSwKICAgICAgImxpbmVIZWlnaHQiOiB0cnVlLAogICAgICAib3BhY2l0eSI6IHRydWUsCiAgICAgICJvcnBoYW5zIjogdHJ1ZSwKICAgICAgIndpZG93cyI6IHRydWUsCiAgICAgICJ6SW5kZXgiOiB0cnVlLAogICAgICAiem9vbSI6IHRydWUKICAgIH0sCiAgICAvLyBBZGQgaW4gcHJvcGVydGllcyB3aG9zZSBuYW1lcyB5b3Ugd2lzaCB0byBmaXggYmVmb3JlCiAgICAvLyBzZXR0aW5nIG9yIGdldHRpbmcgdGhlIHZhbHVlCiAgICBjc3NQcm9wczogewogICAgICAvLyBub3JtYWxpemUgZmxvYXQgY3NzIHByb3BlcnR5CiAgICAgICJmbG9hdCI6IGpRdWVyeS5zdXBwb3J0LmNzc0Zsb2F0ID8gImNzc0Zsb2F0IiA6ICJzdHlsZUZsb2F0IgogICAgfSwKICAgIC8vIEdldCBhbmQgc2V0IHRoZSBzdHlsZSBwcm9wZXJ0eSBvbiBhIERPTSBOb2RlCiAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUoZWxlbSwgbmFtZSwgdmFsdWUsIGV4dHJhKSB7CiAgICAgIC8vIERvbid0IHNldCBzdHlsZXMgb24gdGV4dCBhbmQgY29tbWVudCBub2RlcwogICAgICBpZiAoIWVsZW0gfHwgZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4IHx8ICFlbGVtLnN0eWxlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoKCiAgICAgIHZhciByZXQsCiAgICAgICAgICB0eXBlLAogICAgICAgICAgb3JpZ05hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKG5hbWUpLAogICAgICAgICAgc3R5bGUgPSBlbGVtLnN0eWxlLAogICAgICAgICAgaG9va3MgPSBqUXVlcnkuY3NzSG9va3Nbb3JpZ05hbWVdOwogICAgICBuYW1lID0galF1ZXJ5LmNzc1Byb3BzW29yaWdOYW1lXSB8fCBvcmlnTmFtZTsgLy8gQ2hlY2sgaWYgd2UncmUgc2V0dGluZyBhIHZhbHVlCgogICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHR5cGUgPSBfdHlwZW9mKHZhbHVlKTsgLy8gY29udmVydCByZWxhdGl2ZSBudW1iZXIgc3RyaW5ncyAoKz0gb3IgLT0pIHRvIHJlbGF0aXZlIG51bWJlcnMuICM3MzQ1CgogICAgICAgIGlmICh0eXBlID09PSAic3RyaW5nIiAmJiAocmV0ID0gcnJlbE51bS5leGVjKHZhbHVlKSkpIHsKICAgICAgICAgIHZhbHVlID0gKyhyZXRbMV0gKyAxKSAqICtyZXRbMl0gKyBwYXJzZUZsb2F0KGpRdWVyeS5jc3MoZWxlbSwgbmFtZSkpOyAvLyBGaXhlcyBidWcgIzkyMzcKCiAgICAgICAgICB0eXBlID0gIm51bWJlciI7CiAgICAgICAgfSAvLyBNYWtlIHN1cmUgdGhhdCBOYU4gYW5kIG51bGwgdmFsdWVzIGFyZW4ndCBzZXQuIFNlZTogIzcxMTYKCgogICAgICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IHR5cGUgPT09ICJudW1iZXIiICYmIGlzTmFOKHZhbHVlKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gSWYgYSBudW1iZXIgd2FzIHBhc3NlZCBpbiwgYWRkICdweCcgdG8gdGhlIChleGNlcHQgZm9yIGNlcnRhaW4gQ1NTIHByb3BlcnRpZXMpCgoKICAgICAgICBpZiAodHlwZSA9PT0gIm51bWJlciIgJiYgIWpRdWVyeS5jc3NOdW1iZXJbb3JpZ05hbWVdKSB7CiAgICAgICAgICB2YWx1ZSArPSAicHgiOwogICAgICAgIH0gLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCwgdXNlIHRoYXQgdmFsdWUsIG90aGVyd2lzZSBqdXN0IHNldCB0aGUgc3BlY2lmaWVkIHZhbHVlCgoKICAgICAgICBpZiAoIWhvb2tzIHx8ICEoInNldCIgaW4gaG9va3MpIHx8ICh2YWx1ZSA9IGhvb2tzLnNldChlbGVtLCB2YWx1ZSkpICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIC8vIFdyYXBwZWQgdG8gcHJldmVudCBJRSBmcm9tIHRocm93aW5nIGVycm9ycyB3aGVuICdpbnZhbGlkJyB2YWx1ZXMgYXJlIHByb3ZpZGVkCiAgICAgICAgICAvLyBGaXhlcyBidWcgIzU1MDkKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0eWxlW25hbWVdID0gdmFsdWU7CiAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkIGdldCB0aGUgbm9uLWNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmUKICAgICAgICBpZiAoaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCBmYWxzZSwgZXh0cmEpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0gLy8gT3RoZXJ3aXNlIGp1c3QgZ2V0IHRoZSB2YWx1ZSBmcm9tIHRoZSBzdHlsZSBvYmplY3QKCgogICAgICAgIHJldHVybiBzdHlsZVtuYW1lXTsKICAgICAgfQogICAgfSwKICAgIGNzczogZnVuY3Rpb24gY3NzKGVsZW0sIG5hbWUsIGV4dHJhKSB7CiAgICAgIHZhciByZXQsIGhvb2tzOyAvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdpdGggdGhlIHJpZ2h0IG5hbWUKCiAgICAgIG5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKG5hbWUpOwogICAgICBob29rcyA9IGpRdWVyeS5jc3NIb29rc1tuYW1lXTsKICAgICAgbmFtZSA9IGpRdWVyeS5jc3NQcm9wc1tuYW1lXSB8fCBuYW1lOyAvLyBjc3NGbG9hdCBuZWVkcyBhIHNwZWNpYWwgdHJlYXRtZW50CgogICAgICBpZiAobmFtZSA9PT0gImNzc0Zsb2F0IikgewogICAgICAgIG5hbWUgPSAiZmxvYXQiOwogICAgICB9IC8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQgZ2V0IHRoZSBjb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlCgoKICAgICAgaWYgKGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoZWxlbSwgdHJ1ZSwgZXh0cmEpKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHJldDsgLy8gT3RoZXJ3aXNlLCBpZiBhIHdheSB0byBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGV4aXN0cywgdXNlIHRoYXQKICAgICAgfSBlbHNlIGlmIChjdXJDU1MpIHsKICAgICAgICByZXR1cm4gY3VyQ1NTKGVsZW0sIG5hbWUpOwogICAgICB9CiAgICB9LAogICAgLy8gQSBtZXRob2QgZm9yIHF1aWNrbHkgc3dhcHBpbmcgaW4vb3V0IENTUyBwcm9wZXJ0aWVzIHRvIGdldCBjb3JyZWN0IGNhbGN1bGF0aW9ucwogICAgc3dhcDogZnVuY3Rpb24gc3dhcChlbGVtLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICB2YXIgb2xkID0ge30sCiAgICAgICAgICByZXQsCiAgICAgICAgICBuYW1lOyAvLyBSZW1lbWJlciB0aGUgb2xkIHZhbHVlcywgYW5kIGluc2VydCB0aGUgbmV3IG9uZXMKCiAgICAgIGZvciAobmFtZSBpbiBvcHRpb25zKSB7CiAgICAgICAgb2xkW25hbWVdID0gZWxlbS5zdHlsZVtuYW1lXTsKICAgICAgICBlbGVtLnN0eWxlW25hbWVdID0gb3B0aW9uc1tuYW1lXTsKICAgICAgfQoKICAgICAgcmV0ID0gY2FsbGJhY2suY2FsbChlbGVtKTsgLy8gUmV2ZXJ0IHRoZSBvbGQgdmFsdWVzCgogICAgICBmb3IgKG5hbWUgaW4gb3B0aW9ucykgewogICAgICAgIGVsZW0uc3R5bGVbbmFtZV0gPSBvbGRbbmFtZV07CiAgICAgIH0KCiAgICAgIHJldHVybiByZXQ7CiAgICB9CiAgfSk7IC8vIERFUFJFQ0FURUQgaW4gMS4zLCBVc2UgalF1ZXJ5LmNzcygpIGluc3RlYWQKCiAgalF1ZXJ5LmN1ckNTUyA9IGpRdWVyeS5jc3M7CgogIGlmIChkb2N1bWVudC5kZWZhdWx0VmlldyAmJiBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKSB7CiAgICBnZXRDb21wdXRlZFN0eWxlID0gZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtLCBuYW1lKSB7CiAgICAgIHZhciByZXQsCiAgICAgICAgICBkZWZhdWx0VmlldywKICAgICAgICAgIGNvbXB1dGVkU3R5bGUsCiAgICAgICAgICB3aWR0aCwKICAgICAgICAgIHN0eWxlID0gZWxlbS5zdHlsZTsKICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShydXBwZXIsICItJDEiKS50b0xvd2VyQ2FzZSgpOwoKICAgICAgaWYgKChkZWZhdWx0VmlldyA9IGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldykgJiYgKGNvbXB1dGVkU3R5bGUgPSBkZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW0sIG51bGwpKSkgewogICAgICAgIHJldCA9IGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShuYW1lKTsKCiAgICAgICAgaWYgKHJldCA9PT0gIiIgJiYgIWpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBlbGVtKSkgewogICAgICAgICAgcmV0ID0galF1ZXJ5LnN0eWxlKGVsZW0sIG5hbWUpOwogICAgICAgIH0KICAgICAgfSAvLyBBIHRyaWJ1dGUgdG8gdGhlICJhd2Vzb21lIGhhY2sgYnkgRGVhbiBFZHdhcmRzIgogICAgICAvLyBXZWJLaXQgdXNlcyAiY29tcHV0ZWQgdmFsdWUgKHBlcmNlbnRhZ2UgaWYgc3BlY2lmaWVkKSIgaW5zdGVhZCBvZiAidXNlZCB2YWx1ZSIgZm9yIG1hcmdpbnMKICAgICAgLy8gd2hpY2ggaXMgYWdhaW5zdCB0aGUgQ1NTT00gZHJhZnQgc3BlYzogaHR0cDovL2Rldi53My5vcmcvY3Nzd2cvY3Nzb20vI3Jlc29sdmVkLXZhbHVlcwoKCiAgICAgIGlmICghalF1ZXJ5LnN1cHBvcnQucGl4ZWxNYXJnaW4gJiYgY29tcHV0ZWRTdHlsZSAmJiBybWFyZ2luLnRlc3QobmFtZSkgJiYgcm51bW5vbnB4LnRlc3QocmV0KSkgewogICAgICAgIHdpZHRoID0gc3R5bGUud2lkdGg7CiAgICAgICAgc3R5bGUud2lkdGggPSByZXQ7CiAgICAgICAgcmV0ID0gY29tcHV0ZWRTdHlsZS53aWR0aDsKICAgICAgICBzdHlsZS53aWR0aCA9IHdpZHRoOwogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfTsKICB9CgogIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlKSB7CiAgICBjdXJyZW50U3R5bGUgPSBmdW5jdGlvbiBjdXJyZW50U3R5bGUoZWxlbSwgbmFtZSkgewogICAgICB2YXIgbGVmdCwKICAgICAgICAgIHJzTGVmdCwKICAgICAgICAgIHVuY29tcHV0ZWQsCiAgICAgICAgICByZXQgPSBlbGVtLmN1cnJlbnRTdHlsZSAmJiBlbGVtLmN1cnJlbnRTdHlsZVtuYW1lXSwKICAgICAgICAgIHN0eWxlID0gZWxlbS5zdHlsZTsgLy8gQXZvaWQgc2V0dGluZyByZXQgdG8gZW1wdHkgc3RyaW5nIGhlcmUKICAgICAgLy8gc28gd2UgZG9uJ3QgZGVmYXVsdCB0byBhdXRvCgogICAgICBpZiAocmV0ID09IG51bGwgJiYgc3R5bGUgJiYgKHVuY29tcHV0ZWQgPSBzdHlsZVtuYW1lXSkpIHsKICAgICAgICByZXQgPSB1bmNvbXB1dGVkOwogICAgICB9IC8vIEZyb20gdGhlIGF3ZXNvbWUgaGFjayBieSBEZWFuIEVkd2FyZHMKICAgICAgLy8gaHR0cDovL2VyaWsuZWFlLm5ldC9hcmNoaXZlcy8yMDA3LzA3LzI3LzE4LjU0LjE1LyNjb21tZW50LTEwMjI5MQogICAgICAvLyBJZiB3ZSdyZSBub3QgZGVhbGluZyB3aXRoIGEgcmVndWxhciBwaXhlbCBudW1iZXIKICAgICAgLy8gYnV0IGEgbnVtYmVyIHRoYXQgaGFzIGEgd2VpcmQgZW5kaW5nLCB3ZSBuZWVkIHRvIGNvbnZlcnQgaXQgdG8gcGl4ZWxzCgoKICAgICAgaWYgKHJudW1ub25weC50ZXN0KHJldCkpIHsKICAgICAgICAvLyBSZW1lbWJlciB0aGUgb3JpZ2luYWwgdmFsdWVzCiAgICAgICAgbGVmdCA9IHN0eWxlLmxlZnQ7CiAgICAgICAgcnNMZWZ0ID0gZWxlbS5ydW50aW1lU3R5bGUgJiYgZWxlbS5ydW50aW1lU3R5bGUubGVmdDsgLy8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dAoKICAgICAgICBpZiAocnNMZWZ0KSB7CiAgICAgICAgICBlbGVtLnJ1bnRpbWVTdHlsZS5sZWZ0ID0gZWxlbS5jdXJyZW50U3R5bGUubGVmdDsKICAgICAgICB9CgogICAgICAgIHN0eWxlLmxlZnQgPSBuYW1lID09PSAiZm9udFNpemUiID8gIjFlbSIgOiByZXQ7CiAgICAgICAgcmV0ID0gc3R5bGUucGl4ZWxMZWZ0ICsgInB4IjsgLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwoKICAgICAgICBzdHlsZS5sZWZ0ID0gbGVmdDsKCiAgICAgICAgaWYgKHJzTGVmdCkgewogICAgICAgICAgZWxlbS5ydW50aW1lU3R5bGUubGVmdCA9IHJzTGVmdDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXQgPT09ICIiID8gImF1dG8iIDogcmV0OwogICAgfTsKICB9CgogIGN1ckNTUyA9IGdldENvbXB1dGVkU3R5bGUgfHwgY3VycmVudFN0eWxlOwoKICBmdW5jdGlvbiBnZXRXaWR0aE9ySGVpZ2h0KGVsZW0sIG5hbWUsIGV4dHJhKSB7CiAgICAvLyBTdGFydCB3aXRoIG9mZnNldCBwcm9wZXJ0eQogICAgdmFyIHZhbCA9IG5hbWUgPT09ICJ3aWR0aCIgPyBlbGVtLm9mZnNldFdpZHRoIDogZWxlbS5vZmZzZXRIZWlnaHQsCiAgICAgICAgaSA9IG5hbWUgPT09ICJ3aWR0aCIgPyAxIDogMCwKICAgICAgICBsZW4gPSA0OwoKICAgIGlmICh2YWwgPiAwKSB7CiAgICAgIGlmIChleHRyYSAhPT0gImJvcmRlciIpIHsKICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSArPSAyKSB7CiAgICAgICAgICBpZiAoIWV4dHJhKSB7CiAgICAgICAgICAgIHZhbCAtPSBwYXJzZUZsb2F0KGpRdWVyeS5jc3MoZWxlbSwgInBhZGRpbmciICsgY3NzRXhwYW5kW2ldKSkgfHwgMDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZXh0cmEgPT09ICJtYXJnaW4iKSB7CiAgICAgICAgICAgIHZhbCArPSBwYXJzZUZsb2F0KGpRdWVyeS5jc3MoZWxlbSwgZXh0cmEgKyBjc3NFeHBhbmRbaV0pKSB8fCAwOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFsIC09IHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFtpXSArICJXaWR0aCIpKSB8fCAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHZhbCArICJweCI7CiAgICB9IC8vIEZhbGwgYmFjayB0byBjb21wdXRlZCB0aGVuIHVuY29tcHV0ZWQgY3NzIGlmIG5lY2Vzc2FyeQoKCiAgICB2YWwgPSBjdXJDU1MoZWxlbSwgbmFtZSk7CgogICAgaWYgKHZhbCA8IDAgfHwgdmFsID09IG51bGwpIHsKICAgICAgdmFsID0gZWxlbS5zdHlsZVtuYW1lXTsKICAgIH0gLy8gQ29tcHV0ZWQgdW5pdCBpcyBub3QgcGl4ZWxzLiBTdG9wIGhlcmUgYW5kIHJldHVybi4KCgogICAgaWYgKHJudW1ub25weC50ZXN0KHZhbCkpIHsKICAgICAgcmV0dXJuIHZhbDsKICAgIH0gLy8gTm9ybWFsaXplICIiLCBhdXRvLCBhbmQgcHJlcGFyZSBmb3IgZXh0cmEKCgogICAgdmFsID0gcGFyc2VGbG9hdCh2YWwpIHx8IDA7IC8vIEFkZCBwYWRkaW5nLCBib3JkZXIsIG1hcmdpbgoKICAgIGlmIChleHRyYSkgewogICAgICBmb3IgKDsgaSA8IGxlbjsgaSArPSAyKSB7CiAgICAgICAgdmFsICs9IHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbaV0pKSB8fCAwOwoKICAgICAgICBpZiAoZXh0cmEgIT09ICJwYWRkaW5nIikgewogICAgICAgICAgdmFsICs9IHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFtpXSArICJXaWR0aCIpKSB8fCAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKGV4dHJhID09PSAibWFyZ2luIikgewogICAgICAgICAgdmFsICs9IHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLCBleHRyYSArIGNzc0V4cGFuZFtpXSkpIHx8IDA7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHZhbCArICJweCI7CiAgfQoKICBqUXVlcnkuZWFjaChbImhlaWdodCIsICJ3aWR0aCJdLCBmdW5jdGlvbiAoaSwgbmFtZSkgewogICAgalF1ZXJ5LmNzc0hvb2tzW25hbWVdID0gewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldChlbGVtLCBjb21wdXRlZCwgZXh0cmEpIHsKICAgICAgICBpZiAoY29tcHV0ZWQpIHsKICAgICAgICAgIGlmIChlbGVtLm9mZnNldFdpZHRoICE9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRXaWR0aE9ySGVpZ2h0KGVsZW0sIG5hbWUsIGV4dHJhKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBqUXVlcnkuc3dhcChlbGVtLCBjc3NTaG93LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGdldFdpZHRoT3JIZWlnaHQoZWxlbSwgbmFtZSwgZXh0cmEpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVsZW0sIHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHJudW0udGVzdCh2YWx1ZSkgPyB2YWx1ZSArICJweCIgOiB2YWx1ZTsKICAgICAgfQogICAgfTsKICB9KTsKCiAgaWYgKCFqUXVlcnkuc3VwcG9ydC5vcGFjaXR5KSB7CiAgICBqUXVlcnkuY3NzSG9va3Mub3BhY2l0eSA9IHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoZWxlbSwgY29tcHV0ZWQpIHsKICAgICAgICAvLyBJRSB1c2VzIGZpbHRlcnMgZm9yIG9wYWNpdHkKICAgICAgICByZXR1cm4gcm9wYWNpdHkudGVzdCgoY29tcHV0ZWQgJiYgZWxlbS5jdXJyZW50U3R5bGUgPyBlbGVtLmN1cnJlbnRTdHlsZS5maWx0ZXIgOiBlbGVtLnN0eWxlLmZpbHRlcikgfHwgIiIpID8gcGFyc2VGbG9hdChSZWdFeHAuJDEpIC8gMTAwICsgIiIgOiBjb21wdXRlZCA/ICIxIiA6ICIiOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbGVtLCB2YWx1ZSkgewogICAgICAgIHZhciBzdHlsZSA9IGVsZW0uc3R5bGUsCiAgICAgICAgICAgIGN1cnJlbnRTdHlsZSA9IGVsZW0uY3VycmVudFN0eWxlLAogICAgICAgICAgICBvcGFjaXR5ID0galF1ZXJ5LmlzTnVtZXJpYyh2YWx1ZSkgPyAiYWxwaGEob3BhY2l0eT0iICsgdmFsdWUgKiAxMDAgKyAiKSIgOiAiIiwKICAgICAgICAgICAgZmlsdGVyID0gY3VycmVudFN0eWxlICYmIGN1cnJlbnRTdHlsZS5maWx0ZXIgfHwgc3R5bGUuZmlsdGVyIHx8ICIiOyAvLyBJRSBoYXMgdHJvdWJsZSB3aXRoIG9wYWNpdHkgaWYgaXQgZG9lcyBub3QgaGF2ZSBsYXlvdXQKICAgICAgICAvLyBGb3JjZSBpdCBieSBzZXR0aW5nIHRoZSB6b29tIGxldmVsCgogICAgICAgIHN0eWxlLnpvb20gPSAxOyAvLyBpZiBzZXR0aW5nIG9wYWNpdHkgdG8gMSwgYW5kIG5vIG90aGVyIGZpbHRlcnMgZXhpc3QgLSBhdHRlbXB0IHRvIHJlbW92ZSBmaWx0ZXIgYXR0cmlidXRlICM2NjUyCgogICAgICAgIGlmICh2YWx1ZSA+PSAxICYmIGpRdWVyeS50cmltKGZpbHRlci5yZXBsYWNlKHJhbHBoYSwgIiIpKSA9PT0gIiIpIHsKICAgICAgICAgIC8vIFNldHRpbmcgc3R5bGUuZmlsdGVyIHRvIG51bGwsICIiICYgIiAiIHN0aWxsIGxlYXZlICJmaWx0ZXI6IiBpbiB0aGUgY3NzVGV4dAogICAgICAgICAgLy8gaWYgImZpbHRlcjoiIGlzIHByZXNlbnQgYXQgYWxsLCBjbGVhclR5cGUgaXMgZGlzYWJsZWQsIHdlIHdhbnQgdG8gYXZvaWQgdGhpcwogICAgICAgICAgLy8gc3R5bGUucmVtb3ZlQXR0cmlidXRlIGlzIElFIE9ubHksIGJ1dCBzbyBhcHBhcmVudGx5IGlzIHRoaXMgY29kZSBwYXRoLi4uCiAgICAgICAgICBzdHlsZS5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpOyAvLyBpZiB0aGVyZSB0aGVyZSBpcyBubyBmaWx0ZXIgc3R5bGUgYXBwbGllZCBpbiBhIGNzcyBydWxlLCB3ZSBhcmUgZG9uZQoKICAgICAgICAgIGlmIChjdXJyZW50U3R5bGUgJiYgIWN1cnJlbnRTdHlsZS5maWx0ZXIpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0gLy8gb3RoZXJ3aXNlLCBzZXQgbmV3IGZpbHRlciB2YWx1ZXMKCgogICAgICAgIHN0eWxlLmZpbHRlciA9IHJhbHBoYS50ZXN0KGZpbHRlcikgPyBmaWx0ZXIucmVwbGFjZShyYWxwaGEsIG9wYWNpdHkpIDogZmlsdGVyICsgIiAiICsgb3BhY2l0eTsKICAgICAgfQogICAgfTsKICB9CgogIGpRdWVyeShmdW5jdGlvbiAoKSB7CiAgICAvLyBUaGlzIGhvb2sgY2Fubm90IGJlIGFkZGVkIHVudGlsIERPTSByZWFkeSBiZWNhdXNlIHRoZSBzdXBwb3J0IHRlc3QKICAgIC8vIGZvciBpdCBpcyBub3QgcnVuIHVudGlsIGFmdGVyIERPTSByZWFkeQogICAgaWYgKCFqUXVlcnkuc3VwcG9ydC5yZWxpYWJsZU1hcmdpblJpZ2h0KSB7CiAgICAgIGpRdWVyeS5jc3NIb29rcy5tYXJnaW5SaWdodCA9IHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldChlbGVtLCBjb21wdXRlZCkgewogICAgICAgICAgLy8gV2ViS2l0IEJ1ZyAxMzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3IgbWFyZ2luLXJpZ2h0CiAgICAgICAgICAvLyBXb3JrIGFyb3VuZCBieSB0ZW1wb3JhcmlseSBzZXR0aW5nIGVsZW1lbnQgZGlzcGxheSB0byBpbmxpbmUtYmxvY2sKICAgICAgICAgIHJldHVybiBqUXVlcnkuc3dhcChlbGVtLCB7CiAgICAgICAgICAgICJkaXNwbGF5IjogImlubGluZS1ibG9jayIKICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKGNvbXB1dGVkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGN1ckNTUyhlbGVtLCAibWFyZ2luLXJpZ2h0Iik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmV0dXJuIGVsZW0uc3R5bGUubWFyZ2luUmlnaHQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgaWYgKGpRdWVyeS5leHByICYmIGpRdWVyeS5leHByLmZpbHRlcnMpIHsKICAgIGpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgdmFyIHdpZHRoID0gZWxlbS5vZmZzZXRXaWR0aCwKICAgICAgICAgIGhlaWdodCA9IGVsZW0ub2Zmc2V0SGVpZ2h0OwogICAgICByZXR1cm4gd2lkdGggPT09IDAgJiYgaGVpZ2h0ID09PSAwIHx8ICFqUXVlcnkuc3VwcG9ydC5yZWxpYWJsZUhpZGRlbk9mZnNldHMgJiYgKGVsZW0uc3R5bGUgJiYgZWxlbS5zdHlsZS5kaXNwbGF5IHx8IGpRdWVyeS5jc3MoZWxlbSwgImRpc3BsYXkiKSkgPT09ICJub25lIjsKICAgIH07CgogICAgalF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgcmV0dXJuICFqUXVlcnkuZXhwci5maWx0ZXJzLmhpZGRlbihlbGVtKTsKICAgIH07CiAgfSAvLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzCgoKICBqUXVlcnkuZWFjaCh7CiAgICBtYXJnaW46ICIiLAogICAgcGFkZGluZzogIiIsCiAgICBib3JkZXI6ICJXaWR0aCIKICB9LCBmdW5jdGlvbiAocHJlZml4LCBzdWZmaXgpIHsKICAgIGpRdWVyeS5jc3NIb29rc1twcmVmaXggKyBzdWZmaXhdID0gewogICAgICBleHBhbmQ6IGZ1bmN0aW9uIGV4cGFuZCh2YWx1ZSkgewogICAgICAgIHZhciBpLAogICAgICAgICAgICAvLyBhc3N1bWVzIGEgc2luZ2xlIG51bWJlciBpZiBub3QgYSBzdHJpbmcKICAgICAgICBwYXJ0cyA9IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgPyB2YWx1ZS5zcGxpdCgiICIpIDogW3ZhbHVlXSwKICAgICAgICAgICAgZXhwYW5kZWQgPSB7fTsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgZXhwYW5kZWRbcHJlZml4ICsgY3NzRXhwYW5kW2ldICsgc3VmZml4XSA9IHBhcnRzW2ldIHx8IHBhcnRzW2kgLSAyXSB8fCBwYXJ0c1swXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBleHBhbmRlZDsKICAgICAgfQogICAgfTsKICB9KTsKICB2YXIgcjIwID0gLyUyMC9nLAogICAgICByYnJhY2tldCA9IC9cW1xdJC8sCiAgICAgIHJDUkxGID0gL1xyP1xuL2csCiAgICAgIHJoYXNoID0gLyMuKiQvLAogICAgICByaGVhZGVycyA9IC9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKVxyPyQvbWcsCiAgICAgIC8vIElFIGxlYXZlcyBhbiBcciBjaGFyYWN0ZXIgYXQgRU9MCiAgcmlucHV0ID0gL14oPzpjb2xvcnxkYXRlfGRhdGV0aW1lfGRhdGV0aW1lLWxvY2FsfGVtYWlsfGhpZGRlbnxtb250aHxudW1iZXJ8cGFzc3dvcmR8cmFuZ2V8c2VhcmNofHRlbHx0ZXh0fHRpbWV8dXJsfHdlZWspJC9pLAogICAgICAvLyAjNzY1MywgIzgxMjUsICM4MTUyOiBsb2NhbCBwcm90b2NvbCBkZXRlY3Rpb24KICBybG9jYWxQcm90b2NvbCA9IC9eKD86YWJvdXR8YXBwfGFwcFwtc3RvcmFnZXwuK1wtZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sCiAgICAgIHJub0NvbnRlbnQgPSAvXig/OkdFVHxIRUFEKSQvLAogICAgICBycHJvdG9jb2wgPSAvXlwvXC8vLAogICAgICBycXVlcnkgPSAvXD8vLAogICAgICByc2NyaXB0ID0gLzxzY3JpcHRcYltePF0qKD86KD8hPFwvc2NyaXB0Pik8W148XSopKjxcL3NjcmlwdD4vZ2ksCiAgICAgIHJzZWxlY3RUZXh0YXJlYSA9IC9eKD86c2VsZWN0fHRleHRhcmVhKS9pLAogICAgICByc3BhY2VzQWpheCA9IC9ccysvLAogICAgICBydHMgPSAvKFs/Jl0pXz1bXiZdKi8sCiAgICAgIHJ1cmwgPSAvXihbXHdcK1wuXC1dKzopKD86XC9cLyhbXlwvPyM6XSopKD86OihcZCspKT8pPy8sCiAgICAgIC8vIEtlZXAgYSBjb3B5IG9mIHRoZSBvbGQgbG9hZCBtZXRob2QKICBfbG9hZCA9IGpRdWVyeS5mbi5sb2FkLAoKICAvKiBQcmVmaWx0ZXJzCiAgICogMSkgVGhleSBhcmUgdXNlZnVsIHRvIGludHJvZHVjZSBjdXN0b20gZGF0YVR5cGVzIChzZWUgYWpheC9qc29ucC5qcyBmb3IgYW4gZXhhbXBsZSkKICAgKiAyKSBUaGVzZSBhcmUgY2FsbGVkOgogICAqICAgIC0gQkVGT1JFIGFza2luZyBmb3IgYSB0cmFuc3BvcnQKICAgKiAgICAtIEFGVEVSIHBhcmFtIHNlcmlhbGl6YXRpb24gKHMuZGF0YSBpcyBhIHN0cmluZyBpZiBzLnByb2Nlc3NEYXRhIGlzIHRydWUpCiAgICogMykga2V5IGlzIHRoZSBkYXRhVHlwZQogICAqIDQpIHRoZSBjYXRjaGFsbCBzeW1ib2wgIioiIGNhbiBiZSB1c2VkCiAgICogNSkgZXhlY3V0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gY29udGludWUgZG93biB0byAiKiIgaWYgbmVlZGVkCiAgICovCiAgcHJlZmlsdGVycyA9IHt9LAoKICAvKiBUcmFuc3BvcnRzIGJpbmRpbmdzCiAgICogMSkga2V5IGlzIHRoZSBkYXRhVHlwZQogICAqIDIpIHRoZSBjYXRjaGFsbCBzeW1ib2wgIioiIGNhbiBiZSB1c2VkCiAgICogMykgc2VsZWN0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28gdG8gIioiIGlmIG5lZWRlZAogICAqLwogIHRyYW5zcG9ydHMgPSB7fSwKICAgICAgLy8gRG9jdW1lbnQgbG9jYXRpb24KICBhamF4TG9jYXRpb24sCiAgICAgIC8vIERvY3VtZW50IGxvY2F0aW9uIHNlZ21lbnRzCiAgYWpheExvY1BhcnRzLAogICAgICAvLyBBdm9pZCBjb21tZW50LXByb2xvZyBjaGFyIHNlcXVlbmNlICgjMTAwOTgpOyBtdXN0IGFwcGVhc2UgbGludCBhbmQgZXZhZGUgY29tcHJlc3Npb24KICBhbGxUeXBlcyA9IFsiKi8iXSArIFsiKiJdOyAvLyAjODEzOCwgSUUgbWF5IHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZwogIC8vIGEgZmllbGQgZnJvbSB3aW5kb3cubG9jYXRpb24gaWYgZG9jdW1lbnQuZG9tYWluIGhhcyBiZWVuIHNldAoKICB0cnkgewogICAgYWpheExvY2F0aW9uID0gbG9jYXRpb24uaHJlZjsKICB9IGNhdGNoIChlKSB7CiAgICAvLyBVc2UgdGhlIGhyZWYgYXR0cmlidXRlIG9mIGFuIEEgZWxlbWVudAogICAgLy8gc2luY2UgSUUgd2lsbCBtb2RpZnkgaXQgZ2l2ZW4gZG9jdW1lbnQubG9jYXRpb24KICAgIGFqYXhMb2NhdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgIGFqYXhMb2NhdGlvbi5ocmVmID0gIiI7CiAgICBhamF4TG9jYXRpb24gPSBhamF4TG9jYXRpb24uaHJlZjsKICB9IC8vIFNlZ21lbnQgbG9jYXRpb24gaW50byBwYXJ0cwoKCiAgYWpheExvY1BhcnRzID0gcnVybC5leGVjKGFqYXhMb2NhdGlvbi50b0xvd2VyQ2FzZSgpKSB8fCBbXTsgLy8gQmFzZSAiY29uc3RydWN0b3IiIGZvciBqUXVlcnkuYWpheFByZWZpbHRlciBhbmQgalF1ZXJ5LmFqYXhUcmFuc3BvcnQKCiAgZnVuY3Rpb24gYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHN0cnVjdHVyZSkgewogICAgLy8gZGF0YVR5cGVFeHByZXNzaW9uIGlzIG9wdGlvbmFsIGFuZCBkZWZhdWx0cyB0byAiKiIKICAgIHJldHVybiBmdW5jdGlvbiAoZGF0YVR5cGVFeHByZXNzaW9uLCBmdW5jKSB7CiAgICAgIGlmICh0eXBlb2YgZGF0YVR5cGVFeHByZXNzaW9uICE9PSAic3RyaW5nIikgewogICAgICAgIGZ1bmMgPSBkYXRhVHlwZUV4cHJlc3Npb247CiAgICAgICAgZGF0YVR5cGVFeHByZXNzaW9uID0gIioiOwogICAgICB9CgogICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24oZnVuYykpIHsKICAgICAgICB2YXIgZGF0YVR5cGVzID0gZGF0YVR5cGVFeHByZXNzaW9uLnRvTG93ZXJDYXNlKCkuc3BsaXQocnNwYWNlc0FqYXgpLAogICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgbGVuZ3RoID0gZGF0YVR5cGVzLmxlbmd0aCwKICAgICAgICAgICAgZGF0YVR5cGUsCiAgICAgICAgICAgIGxpc3QsCiAgICAgICAgICAgIHBsYWNlQmVmb3JlOyAvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9uCgogICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGRhdGFUeXBlID0gZGF0YVR5cGVzW2ldOyAvLyBXZSBjb250cm9sIGlmIHdlJ3JlIGFza2VkIHRvIGFkZCBiZWZvcmUKICAgICAgICAgIC8vIGFueSBleGlzdGluZyBlbGVtZW50CgogICAgICAgICAgcGxhY2VCZWZvcmUgPSAvXlwrLy50ZXN0KGRhdGFUeXBlKTsKCiAgICAgICAgICBpZiAocGxhY2VCZWZvcmUpIHsKICAgICAgICAgICAgZGF0YVR5cGUgPSBkYXRhVHlwZS5zdWJzdHIoMSkgfHwgIioiOwogICAgICAgICAgfQoKICAgICAgICAgIGxpc3QgPSBzdHJ1Y3R1cmVbZGF0YVR5cGVdID0gc3RydWN0dXJlW2RhdGFUeXBlXSB8fCBbXTsgLy8gdGhlbiB3ZSBhZGQgdG8gdGhlIHN0cnVjdHVyZSBhY2NvcmRpbmdseQoKICAgICAgICAgIGxpc3RbcGxhY2VCZWZvcmUgPyAidW5zaGlmdCIgOiAicHVzaCJdKGZ1bmMpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9IC8vIEJhc2UgaW5zcGVjdGlvbiBmdW5jdGlvbiBmb3IgcHJlZmlsdGVycyBhbmQgdHJhbnNwb3J0cwoKCiAgZnVuY3Rpb24gaW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHMoc3RydWN0dXJlLCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSLCBkYXRhVHlwZQogIC8qIGludGVybmFsICovCiAgLCBpbnNwZWN0ZWQKICAvKiBpbnRlcm5hbCAqLwogICkgewogICAgZGF0YVR5cGUgPSBkYXRhVHlwZSB8fCBvcHRpb25zLmRhdGFUeXBlc1swXTsKICAgIGluc3BlY3RlZCA9IGluc3BlY3RlZCB8fCB7fTsKICAgIGluc3BlY3RlZFtkYXRhVHlwZV0gPSB0cnVlOwogICAgdmFyIGxpc3QgPSBzdHJ1Y3R1cmVbZGF0YVR5cGVdLAogICAgICAgIGkgPSAwLAogICAgICAgIGxlbmd0aCA9IGxpc3QgPyBsaXN0Lmxlbmd0aCA6IDAsCiAgICAgICAgZXhlY3V0ZU9ubHkgPSBzdHJ1Y3R1cmUgPT09IHByZWZpbHRlcnMsCiAgICAgICAgc2VsZWN0aW9uOwoKICAgIGZvciAoOyBpIDwgbGVuZ3RoICYmIChleGVjdXRlT25seSB8fCAhc2VsZWN0aW9uKTsgaSsrKSB7CiAgICAgIHNlbGVjdGlvbiA9IGxpc3RbaV0ob3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUik7IC8vIElmIHdlIGdvdCByZWRpcmVjdGVkIHRvIGFub3RoZXIgZGF0YVR5cGUKICAgICAgLy8gd2UgdHJ5IHRoZXJlIGlmIGV4ZWN1dGluZyBvbmx5IGFuZCBub3QgZG9uZSBhbHJlYWR5CgogICAgICBpZiAodHlwZW9mIHNlbGVjdGlvbiA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAoIWV4ZWN1dGVPbmx5IHx8IGluc3BlY3RlZFtzZWxlY3Rpb25dKSB7CiAgICAgICAgICBzZWxlY3Rpb24gPSB1bmRlZmluZWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9wdGlvbnMuZGF0YVR5cGVzLnVuc2hpZnQoc2VsZWN0aW9uKTsKICAgICAgICAgIHNlbGVjdGlvbiA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHN0cnVjdHVyZSwgb3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUiwgc2VsZWN0aW9uLCBpbnNwZWN0ZWQpOwogICAgICAgIH0KICAgICAgfQogICAgfSAvLyBJZiB3ZSdyZSBvbmx5IGV4ZWN1dGluZyBvciBub3RoaW5nIHdhcyBzZWxlY3RlZAogICAgLy8gd2UgdHJ5IHRoZSBjYXRjaGFsbCBkYXRhVHlwZSBpZiBub3QgZG9uZSBhbHJlYWR5CgoKICAgIGlmICgoZXhlY3V0ZU9ubHkgfHwgIXNlbGVjdGlvbikgJiYgIWluc3BlY3RlZFsiKiJdKSB7CiAgICAgIHNlbGVjdGlvbiA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHN0cnVjdHVyZSwgb3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUiwgIioiLCBpbnNwZWN0ZWQpOwogICAgfSAvLyB1bm5lY2Vzc2FyeSB3aGVuIG9ubHkgZXhlY3V0aW5nIChwcmVmaWx0ZXJzKQogICAgLy8gYnV0IGl0J2xsIGJlIGlnbm9yZWQgYnkgdGhlIGNhbGxlciBpbiB0aGF0IGNhc2UKCgogICAgcmV0dXJuIHNlbGVjdGlvbjsKICB9IC8vIEEgc3BlY2lhbCBleHRlbmQgZm9yIGFqYXggb3B0aW9ucwogIC8vIHRoYXQgdGFrZXMgImZsYXQiIG9wdGlvbnMgKG5vdCB0byBiZSBkZWVwIGV4dGVuZGVkKQogIC8vIEZpeGVzICM5ODg3CgoKICBmdW5jdGlvbiBhamF4RXh0ZW5kKHRhcmdldCwgc3JjKSB7CiAgICB2YXIga2V5LAogICAgICAgIGRlZXAsCiAgICAgICAgZmxhdE9wdGlvbnMgPSBqUXVlcnkuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zIHx8IHt9OwoKICAgIGZvciAoa2V5IGluIHNyYykgewogICAgICBpZiAoc3JjW2tleV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgIChmbGF0T3B0aW9uc1trZXldID8gdGFyZ2V0IDogZGVlcCB8fCAoZGVlcCA9IHt9KSlba2V5XSA9IHNyY1trZXldOwogICAgICB9CiAgICB9CgogICAgaWYgKGRlZXApIHsKICAgICAgalF1ZXJ5LmV4dGVuZCh0cnVlLCB0YXJnZXQsIGRlZXApOwogICAgfQogIH0KCiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBsb2FkOiBmdW5jdGlvbiBsb2FkKHVybCwgcGFyYW1zLCBjYWxsYmFjaykgewogICAgICBpZiAodHlwZW9mIHVybCAhPT0gInN0cmluZyIgJiYgX2xvYWQpIHsKICAgICAgICByZXR1cm4gX2xvYWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgLy8gRG9uJ3QgZG8gYSByZXF1ZXN0IGlmIG5vIGVsZW1lbnRzIGFyZSBiZWluZyByZXF1ZXN0ZWQKICAgICAgfSBlbHNlIGlmICghdGhpcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgdmFyIG9mZiA9IHVybC5pbmRleE9mKCIgIik7CgogICAgICBpZiAob2ZmID49IDApIHsKICAgICAgICB2YXIgc2VsZWN0b3IgPSB1cmwuc2xpY2Uob2ZmLCB1cmwubGVuZ3RoKTsKICAgICAgICB1cmwgPSB1cmwuc2xpY2UoMCwgb2ZmKTsKICAgICAgfSAvLyBEZWZhdWx0IHRvIGEgR0VUIHJlcXVlc3QKCgogICAgICB2YXIgdHlwZSA9ICJHRVQiOyAvLyBJZiB0aGUgc2Vjb25kIHBhcmFtZXRlciB3YXMgcHJvdmlkZWQKCiAgICAgIGlmIChwYXJhbXMpIHsKICAgICAgICAvLyBJZiBpdCdzIGEgZnVuY3Rpb24KICAgICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24ocGFyYW1zKSkgewogICAgICAgICAgLy8gV2UgYXNzdW1lIHRoYXQgaXQncyB0aGUgY2FsbGJhY2sKICAgICAgICAgIGNhbGxiYWNrID0gcGFyYW1zOwogICAgICAgICAgcGFyYW1zID0gdW5kZWZpbmVkOyAvLyBPdGhlcndpc2UsIGJ1aWxkIGEgcGFyYW0gc3RyaW5nCiAgICAgICAgfSBlbHNlIGlmIChfdHlwZW9mKHBhcmFtcykgPT09ICJvYmplY3QiKSB7CiAgICAgICAgICBwYXJhbXMgPSBqUXVlcnkucGFyYW0ocGFyYW1zLCBqUXVlcnkuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKTsKICAgICAgICAgIHR5cGUgPSAiUE9TVCI7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2VsZiA9IHRoaXM7IC8vIFJlcXVlc3QgdGhlIHJlbW90ZSBkb2N1bWVudAoKICAgICAgalF1ZXJ5LmFqYXgoewogICAgICAgIHVybDogdXJsLAogICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgZGF0YVR5cGU6ICJodG1sIiwKICAgICAgICBkYXRhOiBwYXJhbXMsCiAgICAgICAgLy8gQ29tcGxldGUgY2FsbGJhY2sgKHJlc3BvbnNlVGV4dCBpcyB1c2VkIGludGVybmFsbHkpCiAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uIGNvbXBsZXRlKGpxWEhSLCBzdGF0dXMsIHJlc3BvbnNlVGV4dCkgewogICAgICAgICAgLy8gU3RvcmUgdGhlIHJlc3BvbnNlIGFzIHNwZWNpZmllZCBieSB0aGUganFYSFIgb2JqZWN0CiAgICAgICAgICByZXNwb25zZVRleHQgPSBqcVhIUi5yZXNwb25zZVRleHQ7IC8vIElmIHN1Y2Nlc3NmdWwsIGluamVjdCB0aGUgSFRNTCBpbnRvIGFsbCB0aGUgbWF0Y2hlZCBlbGVtZW50cwoKICAgICAgICAgIGlmIChqcVhIUi5pc1Jlc29sdmVkKCkpIHsKICAgICAgICAgICAgLy8gIzQ4MjU6IEdldCB0aGUgYWN0dWFsIHJlc3BvbnNlIGluIGNhc2UKICAgICAgICAgICAgLy8gYSBkYXRhRmlsdGVyIGlzIHByZXNlbnQgaW4gYWpheFNldHRpbmdzCiAgICAgICAgICAgIGpxWEhSLmRvbmUoZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICByZXNwb25zZVRleHQgPSByOwogICAgICAgICAgICB9KTsgLy8gU2VlIGlmIGEgc2VsZWN0b3Igd2FzIHNwZWNpZmllZAoKICAgICAgICAgICAgc2VsZi5odG1sKHNlbGVjdG9yID8gLy8gQ3JlYXRlIGEgZHVtbXkgZGl2IHRvIGhvbGQgdGhlIHJlc3VsdHMKICAgICAgICAgICAgalF1ZXJ5KCI8ZGl2PiIpIC8vIGluamVjdCB0aGUgY29udGVudHMgb2YgdGhlIGRvY3VtZW50IGluLCByZW1vdmluZyB0aGUgc2NyaXB0cwogICAgICAgICAgICAvLyB0byBhdm9pZCBhbnkgJ1Blcm1pc3Npb24gRGVuaWVkJyBlcnJvcnMgaW4gSUUKICAgICAgICAgICAgLmFwcGVuZChyZXNwb25zZVRleHQucmVwbGFjZShyc2NyaXB0LCAiIikpIC8vIExvY2F0ZSB0aGUgc3BlY2lmaWVkIGVsZW1lbnRzCiAgICAgICAgICAgIC5maW5kKHNlbGVjdG9yKSA6IC8vIElmIG5vdCwganVzdCBpbmplY3QgdGhlIGZ1bGwgcmVzdWx0CiAgICAgICAgICAgIHJlc3BvbnNlVGV4dCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGNhbGxiYWNrKSB7CiAgICAgICAgICAgIHNlbGYuZWFjaChjYWxsYmFjaywgW3Jlc3BvbnNlVGV4dCwgc3RhdHVzLCBqcVhIUl0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24gc2VyaWFsaXplKCkgewogICAgICByZXR1cm4galF1ZXJ5LnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSk7CiAgICB9LAogICAgc2VyaWFsaXplQXJyYXk6IGZ1bmN0aW9uIHNlcmlhbGl6ZUFycmF5KCkgewogICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzID8galF1ZXJ5Lm1ha2VBcnJheSh0aGlzLmVsZW1lbnRzKSA6IHRoaXM7CiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSAmJiAhdGhpcy5kaXNhYmxlZCAmJiAodGhpcy5jaGVja2VkIHx8IHJzZWxlY3RUZXh0YXJlYS50ZXN0KHRoaXMubm9kZU5hbWUpIHx8IHJpbnB1dC50ZXN0KHRoaXMudHlwZSkpOwogICAgICB9KS5tYXAoZnVuY3Rpb24gKGksIGVsZW0pIHsKICAgICAgICB2YXIgdmFsID0galF1ZXJ5KHRoaXMpLnZhbCgpOwogICAgICAgIHJldHVybiB2YWwgPT0gbnVsbCA/IG51bGwgOiBqUXVlcnkuaXNBcnJheSh2YWwpID8galF1ZXJ5Lm1hcCh2YWwsIGZ1bmN0aW9uICh2YWwsIGkpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG5hbWU6IGVsZW0ubmFtZSwKICAgICAgICAgICAgdmFsdWU6IHZhbC5yZXBsYWNlKHJDUkxGLCAiXHJcbiIpCiAgICAgICAgICB9OwogICAgICAgIH0pIDogewogICAgICAgICAgbmFtZTogZWxlbS5uYW1lLAogICAgICAgICAgdmFsdWU6IHZhbC5yZXBsYWNlKHJDUkxGLCAiXHJcbiIpCiAgICAgICAgfTsKICAgICAgfSkuZ2V0KCk7CiAgICB9CiAgfSk7IC8vIEF0dGFjaCBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyBmb3IgaGFuZGxpbmcgY29tbW9uIEFKQVggZXZlbnRzCgogIGpRdWVyeS5lYWNoKCJhamF4U3RhcnQgYWpheFN0b3AgYWpheENvbXBsZXRlIGFqYXhFcnJvciBhamF4U3VjY2VzcyBhamF4U2VuZCIuc3BsaXQoIiAiKSwgZnVuY3Rpb24gKGksIG8pIHsKICAgIGpRdWVyeS5mbltvXSA9IGZ1bmN0aW9uIChmKSB7CiAgICAgIHJldHVybiB0aGlzLm9uKG8sIGYpOwogICAgfTsKICB9KTsKICBqUXVlcnkuZWFjaChbImdldCIsICJwb3N0Il0sIGZ1bmN0aW9uIChpLCBtZXRob2QpIHsKICAgIGpRdWVyeVttZXRob2RdID0gZnVuY3Rpb24gKHVybCwgZGF0YSwgY2FsbGJhY2ssIHR5cGUpIHsKICAgICAgLy8gc2hpZnQgYXJndW1lbnRzIGlmIGRhdGEgYXJndW1lbnQgd2FzIG9taXR0ZWQKICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKGRhdGEpKSB7CiAgICAgICAgdHlwZSA9IHR5cGUgfHwgY2FsbGJhY2s7CiAgICAgICAgY2FsbGJhY2sgPSBkYXRhOwogICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBqUXVlcnkuYWpheCh7CiAgICAgICAgdHlwZTogbWV0aG9kLAogICAgICAgIHVybDogdXJsLAogICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgc3VjY2VzczogY2FsbGJhY2ssCiAgICAgICAgZGF0YVR5cGU6IHR5cGUKICAgICAgfSk7CiAgICB9OwogIH0pOwogIGpRdWVyeS5leHRlbmQoewogICAgZ2V0U2NyaXB0OiBmdW5jdGlvbiBnZXRTY3JpcHQodXJsLCBjYWxsYmFjaykgewogICAgICByZXR1cm4galF1ZXJ5LmdldCh1cmwsIHVuZGVmaW5lZCwgY2FsbGJhY2ssICJzY3JpcHQiKTsKICAgIH0sCiAgICBnZXRKU09OOiBmdW5jdGlvbiBnZXRKU09OKHVybCwgZGF0YSwgY2FsbGJhY2spIHsKICAgICAgcmV0dXJuIGpRdWVyeS5nZXQodXJsLCBkYXRhLCBjYWxsYmFjaywgImpzb24iKTsKICAgIH0sCiAgICAvLyBDcmVhdGVzIGEgZnVsbCBmbGVkZ2VkIHNldHRpbmdzIG9iamVjdCBpbnRvIHRhcmdldAogICAgLy8gd2l0aCBib3RoIGFqYXhTZXR0aW5ncyBhbmQgc2V0dGluZ3MgZmllbGRzLgogICAgLy8gSWYgdGFyZ2V0IGlzIG9taXR0ZWQsIHdyaXRlcyBpbnRvIGFqYXhTZXR0aW5ncy4KICAgIGFqYXhTZXR1cDogZnVuY3Rpb24gYWpheFNldHVwKHRhcmdldCwgc2V0dGluZ3MpIHsKICAgICAgaWYgKHNldHRpbmdzKSB7CiAgICAgICAgLy8gQnVpbGRpbmcgYSBzZXR0aW5ncyBvYmplY3QKICAgICAgICBhamF4RXh0ZW5kKHRhcmdldCwgalF1ZXJ5LmFqYXhTZXR0aW5ncyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRXh0ZW5kaW5nIGFqYXhTZXR0aW5ncwogICAgICAgIHNldHRpbmdzID0gdGFyZ2V0OwogICAgICAgIHRhcmdldCA9IGpRdWVyeS5hamF4U2V0dGluZ3M7CiAgICAgIH0KCiAgICAgIGFqYXhFeHRlbmQodGFyZ2V0LCBzZXR0aW5ncyk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9LAogICAgYWpheFNldHRpbmdzOiB7CiAgICAgIHVybDogYWpheExvY2F0aW9uLAogICAgICBpc0xvY2FsOiBybG9jYWxQcm90b2NvbC50ZXN0KGFqYXhMb2NQYXJ0c1sxXSksCiAgICAgIGdsb2JhbDogdHJ1ZSwKICAgICAgdHlwZTogIkdFVCIsCiAgICAgIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKICAgICAgcHJvY2Vzc0RhdGE6IHRydWUsCiAgICAgIGFzeW5jOiB0cnVlLAoKICAgICAgLyoKICAgICAgdGltZW91dDogMCwKICAgICAgZGF0YTogbnVsbCwKICAgICAgZGF0YVR5cGU6IG51bGwsCiAgICAgIHVzZXJuYW1lOiBudWxsLAogICAgICBwYXNzd29yZDogbnVsbCwKICAgICAgY2FjaGU6IG51bGwsCiAgICAgIHRyYWRpdGlvbmFsOiBmYWxzZSwKICAgICAgaGVhZGVyczoge30sCiAgICAgICovCiAgICAgIGFjY2VwdHM6IHsKICAgICAgICB4bWw6ICJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIiwKICAgICAgICBodG1sOiAidGV4dC9odG1sIiwKICAgICAgICB0ZXh0OiAidGV4dC9wbGFpbiIsCiAgICAgICAganNvbjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCIsCiAgICAgICAgIioiOiBhbGxUeXBlcwogICAgICB9LAogICAgICBjb250ZW50czogewogICAgICAgIHhtbDogL3htbC8sCiAgICAgICAgaHRtbDogL2h0bWwvLAogICAgICAgIGpzb246IC9qc29uLwogICAgICB9LAogICAgICByZXNwb25zZUZpZWxkczogewogICAgICAgIHhtbDogInJlc3BvbnNlWE1MIiwKICAgICAgICB0ZXh0OiAicmVzcG9uc2VUZXh0IgogICAgICB9LAogICAgICAvLyBMaXN0IG9mIGRhdGEgY29udmVydGVycwogICAgICAvLyAxKSBrZXkgZm9ybWF0IGlzICJzb3VyY2VfdHlwZSBkZXN0aW5hdGlvbl90eXBlIiAoYSBzaW5nbGUgc3BhY2UgaW4tYmV0d2VlbikKICAgICAgLy8gMikgdGhlIGNhdGNoYWxsIHN5bWJvbCAiKiIgY2FuIGJlIHVzZWQgZm9yIHNvdXJjZV90eXBlCiAgICAgIGNvbnZlcnRlcnM6IHsKICAgICAgICAvLyBDb252ZXJ0IGFueXRoaW5nIHRvIHRleHQKICAgICAgICAiKiB0ZXh0Ijogd2luZG93LlN0cmluZywKICAgICAgICAvLyBUZXh0IHRvIGh0bWwgKHRydWUgPSBubyB0cmFuc2Zvcm1hdGlvbikKICAgICAgICAidGV4dCBodG1sIjogdHJ1ZSwKICAgICAgICAvLyBFdmFsdWF0ZSB0ZXh0IGFzIGEganNvbiBleHByZXNzaW9uCiAgICAgICAgInRleHQganNvbiI6IGpRdWVyeS5wYXJzZUpTT04sCiAgICAgICAgLy8gUGFyc2UgdGV4dCBhcyB4bWwKICAgICAgICAidGV4dCB4bWwiOiBqUXVlcnkucGFyc2VYTUwKICAgICAgfSwKICAgICAgLy8gRm9yIG9wdGlvbnMgdGhhdCBzaG91bGRuJ3QgYmUgZGVlcCBleHRlbmRlZDoKICAgICAgLy8geW91IGNhbiBhZGQgeW91ciBvd24gY3VzdG9tIG9wdGlvbnMgaGVyZSBpZgogICAgICAvLyBhbmQgd2hlbiB5b3UgY3JlYXRlIG9uZSB0aGF0IHNob3VsZG4ndCBiZQogICAgICAvLyBkZWVwIGV4dGVuZGVkIChzZWUgYWpheEV4dGVuZCkKICAgICAgZmxhdE9wdGlvbnM6IHsKICAgICAgICBjb250ZXh0OiB0cnVlLAogICAgICAgIHVybDogdHJ1ZQogICAgICB9CiAgICB9LAogICAgYWpheFByZWZpbHRlcjogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHByZWZpbHRlcnMpLAogICAgYWpheFRyYW5zcG9ydDogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHRyYW5zcG9ydHMpLAogICAgLy8gTWFpbiBtZXRob2QKICAgIGFqYXg6IGZ1bmN0aW9uIGFqYXgodXJsLCBvcHRpb25zKSB7CiAgICAgIC8vIElmIHVybCBpcyBhbiBvYmplY3QsIHNpbXVsYXRlIHByZS0xLjUgc2lnbmF0dXJlCiAgICAgIGlmIChfdHlwZW9mKHVybCkgPT09ICJvYmplY3QiKSB7CiAgICAgICAgb3B0aW9ucyA9IHVybDsKICAgICAgICB1cmwgPSB1bmRlZmluZWQ7CiAgICAgIH0gLy8gRm9yY2Ugb3B0aW9ucyB0byBiZSBhbiBvYmplY3QKCgogICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgdmFyIC8vIENyZWF0ZSB0aGUgZmluYWwgb3B0aW9ucyBvYmplY3QKICAgICAgcyA9IGpRdWVyeS5hamF4U2V0dXAoe30sIG9wdGlvbnMpLAogICAgICAgICAgLy8gQ2FsbGJhY2tzIGNvbnRleHQKICAgICAgY2FsbGJhY2tDb250ZXh0ID0gcy5jb250ZXh0IHx8IHMsCiAgICAgICAgICAvLyBDb250ZXh0IGZvciBnbG9iYWwgZXZlbnRzCiAgICAgIC8vIEl0J3MgdGhlIGNhbGxiYWNrQ29udGV4dCBpZiBvbmUgd2FzIHByb3ZpZGVkIGluIHRoZSBvcHRpb25zCiAgICAgIC8vIGFuZCBpZiBpdCdzIGEgRE9NIG5vZGUgb3IgYSBqUXVlcnkgY29sbGVjdGlvbgogICAgICBnbG9iYWxFdmVudENvbnRleHQgPSBjYWxsYmFja0NvbnRleHQgIT09IHMgJiYgKGNhbGxiYWNrQ29udGV4dC5ub2RlVHlwZSB8fCBjYWxsYmFja0NvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnkpID8galF1ZXJ5KGNhbGxiYWNrQ29udGV4dCkgOiBqUXVlcnkuZXZlbnQsCiAgICAgICAgICAvLyBEZWZlcnJlZHMKICAgICAgZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKSwKICAgICAgICAgIGNvbXBsZXRlRGVmZXJyZWQgPSBqUXVlcnkuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLAogICAgICAgICAgLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKICAgICAgc3RhdHVzQ29kZSA9IHMuc3RhdHVzQ29kZSB8fCB7fSwKICAgICAgICAgIC8vIGlmTW9kaWZpZWQga2V5CiAgICAgIGlmTW9kaWZpZWRLZXksCiAgICAgICAgICAvLyBIZWFkZXJzICh0aGV5IGFyZSBzZW50IGFsbCBhdCBvbmNlKQogICAgICByZXF1ZXN0SGVhZGVycyA9IHt9LAogICAgICAgICAgcmVxdWVzdEhlYWRlcnNOYW1lcyA9IHt9LAogICAgICAgICAgLy8gUmVzcG9uc2UgaGVhZGVycwogICAgICByZXNwb25zZUhlYWRlcnNTdHJpbmcsCiAgICAgICAgICByZXNwb25zZUhlYWRlcnMsCiAgICAgICAgICAvLyB0cmFuc3BvcnQKICAgICAgdHJhbnNwb3J0LAogICAgICAgICAgLy8gdGltZW91dCBoYW5kbGUKICAgICAgdGltZW91dFRpbWVyLAogICAgICAgICAgLy8gQ3Jvc3MtZG9tYWluIGRldGVjdGlvbiB2YXJzCiAgICAgIHBhcnRzLAogICAgICAgICAgLy8gVGhlIGpxWEhSIHN0YXRlCiAgICAgIHN0YXRlID0gMCwKICAgICAgICAgIC8vIFRvIGtub3cgaWYgZ2xvYmFsIGV2ZW50cyBhcmUgdG8gYmUgZGlzcGF0Y2hlZAogICAgICBmaXJlR2xvYmFscywKICAgICAgICAgIC8vIExvb3AgdmFyaWFibGUKICAgICAgaSwKICAgICAgICAgIC8vIEZha2UgeGhyCiAgICAgIGpxWEhSID0gewogICAgICAgIHJlYWR5U3RhdGU6IDAsCiAgICAgICAgLy8gQ2FjaGVzIHRoZSBoZWFkZXIKICAgICAgICBzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiBzZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICBpZiAoIXN0YXRlKSB7CiAgICAgICAgICAgIHZhciBsbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgbmFtZSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbbG5hbWVdID0gcmVxdWVzdEhlYWRlcnNOYW1lc1tsbmFtZV0gfHwgbmFtZTsKICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnNbbmFtZV0gPSB2YWx1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIC8vIFJhdyBzdHJpbmcKICAgICAgICBnZXRBbGxSZXNwb25zZUhlYWRlcnM6IGZ1bmN0aW9uIGdldEFsbFJlc3BvbnNlSGVhZGVycygpIHsKICAgICAgICAgIHJldHVybiBzdGF0ZSA9PT0gMiA/IHJlc3BvbnNlSGVhZGVyc1N0cmluZyA6IG51bGw7CiAgICAgICAgfSwKICAgICAgICAvLyBCdWlsZHMgaGVhZGVycyBoYXNodGFibGUgaWYgbmVlZGVkCiAgICAgICAgZ2V0UmVzcG9uc2VIZWFkZXI6IGZ1bmN0aW9uIGdldFJlc3BvbnNlSGVhZGVyKGtleSkgewogICAgICAgICAgdmFyIG1hdGNoOwoKICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewogICAgICAgICAgICBpZiAoIXJlc3BvbnNlSGVhZGVycykgewogICAgICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyA9IHt9OwoKICAgICAgICAgICAgICB3aGlsZSAobWF0Y2ggPSByaGVhZGVycy5leGVjKHJlc3BvbnNlSGVhZGVyc1N0cmluZykpIHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlSGVhZGVyc1ttYXRjaFsxXS50b0xvd2VyQ2FzZSgpXSA9IG1hdGNoWzJdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbWF0Y2ggPSByZXNwb25zZUhlYWRlcnNba2V5LnRvTG93ZXJDYXNlKCldOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBtYXRjaCA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IG1hdGNoOwogICAgICAgIH0sCiAgICAgICAgLy8gT3ZlcnJpZGVzIHJlc3BvbnNlIGNvbnRlbnQtdHlwZSBoZWFkZXIKICAgICAgICBvdmVycmlkZU1pbWVUeXBlOiBmdW5jdGlvbiBvdmVycmlkZU1pbWVUeXBlKHR5cGUpIHsKICAgICAgICAgIGlmICghc3RhdGUpIHsKICAgICAgICAgICAgcy5taW1lVHlwZSA9IHR5cGU7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSwKICAgICAgICAvLyBDYW5jZWwgdGhlIHJlcXVlc3QKICAgICAgICBhYm9ydDogZnVuY3Rpb24gYWJvcnQoc3RhdHVzVGV4dCkgewogICAgICAgICAgc3RhdHVzVGV4dCA9IHN0YXR1c1RleHQgfHwgImFib3J0IjsKCiAgICAgICAgICBpZiAodHJhbnNwb3J0KSB7CiAgICAgICAgICAgIHRyYW5zcG9ydC5hYm9ydChzdGF0dXNUZXh0KTsKICAgICAgICAgIH0KCiAgICAgICAgICBkb25lKDAsIHN0YXR1c1RleHQpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICB9OyAvLyBDYWxsYmFjayBmb3Igd2hlbiBldmVyeXRoaW5nIGlzIGRvbmUKICAgICAgLy8gSXQgaXMgZGVmaW5lZCBoZXJlIGJlY2F1c2UganNsaW50IGNvbXBsYWlucyBpZiBpdCBpcyBkZWNsYXJlZAogICAgICAvLyBhdCB0aGUgZW5kIG9mIHRoZSBmdW5jdGlvbiAod2hpY2ggd291bGQgYmUgbW9yZSBsb2dpY2FsIGFuZCByZWFkYWJsZSkKCiAgICAgIGZ1bmN0aW9uIGRvbmUoc3RhdHVzLCBuYXRpdmVTdGF0dXNUZXh0LCByZXNwb25zZXMsIGhlYWRlcnMpIHsKICAgICAgICAvLyBDYWxsZWQgb25jZQogICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gU3RhdGUgaXMgImRvbmUiIG5vdwoKCiAgICAgICAgc3RhdGUgPSAyOyAvLyBDbGVhciB0aW1lb3V0IGlmIGl0IGV4aXN0cwoKICAgICAgICBpZiAodGltZW91dFRpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKTsKICAgICAgICB9IC8vIERlcmVmZXJlbmNlIHRyYW5zcG9ydCBmb3IgZWFybHkgZ2FyYmFnZSBjb2xsZWN0aW9uCiAgICAgICAgLy8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZCkKCgogICAgICAgIHRyYW5zcG9ydCA9IHVuZGVmaW5lZDsgLy8gQ2FjaGUgcmVzcG9uc2UgaGVhZGVycwoKICAgICAgICByZXNwb25zZUhlYWRlcnNTdHJpbmcgPSBoZWFkZXJzIHx8ICIiOyAvLyBTZXQgcmVhZHlTdGF0ZQoKICAgICAgICBqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwOwogICAgICAgIHZhciBpc1N1Y2Nlc3MsCiAgICAgICAgICAgIHN1Y2Nlc3MsCiAgICAgICAgICAgIGVycm9yLAogICAgICAgICAgICBzdGF0dXNUZXh0ID0gbmF0aXZlU3RhdHVzVGV4dCwKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXNwb25zZXMgPyBhamF4SGFuZGxlUmVzcG9uc2VzKHMsIGpxWEhSLCByZXNwb25zZXMpIDogdW5kZWZpbmVkLAogICAgICAgICAgICBsYXN0TW9kaWZpZWQsCiAgICAgICAgICAgIGV0YWc7IC8vIElmIHN1Y2Nlc3NmdWwsIGhhbmRsZSB0eXBlIGNoYWluaW5nCgogICAgICAgIGlmIChzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNCkgewogICAgICAgICAgLy8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS4KICAgICAgICAgIGlmIChzLmlmTW9kaWZpZWQpIHsKICAgICAgICAgICAgaWYgKGxhc3RNb2RpZmllZCA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIikpIHsKICAgICAgICAgICAgICBqUXVlcnkubGFzdE1vZGlmaWVkW2lmTW9kaWZpZWRLZXldID0gbGFzdE1vZGlmaWVkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZXRhZyA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJFdGFnIikpIHsKICAgICAgICAgICAgICBqUXVlcnkuZXRhZ1tpZk1vZGlmaWVkS2V5XSA9IGV0YWc7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy8gSWYgbm90IG1vZGlmaWVkCgoKICAgICAgICAgIGlmIChzdGF0dXMgPT09IDMwNCkgewogICAgICAgICAgICBzdGF0dXNUZXh0ID0gIm5vdG1vZGlmaWVkIjsKICAgICAgICAgICAgaXNTdWNjZXNzID0gdHJ1ZTsgLy8gSWYgd2UgaGF2ZSBkYXRhCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHN1Y2Nlc3MgPSBhamF4Q29udmVydChzLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgc3RhdHVzVGV4dCA9ICJzdWNjZXNzIjsKICAgICAgICAgICAgICBpc1N1Y2Nlc3MgPSB0cnVlOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIHBhcnNlcmVycm9yCiAgICAgICAgICAgICAgc3RhdHVzVGV4dCA9ICJwYXJzZXJlcnJvciI7CiAgICAgICAgICAgICAgZXJyb3IgPSBlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIFdlIGV4dHJhY3QgZXJyb3IgZnJvbSBzdGF0dXNUZXh0CiAgICAgICAgICAvLyB0aGVuIG5vcm1hbGl6ZSBzdGF0dXNUZXh0IGFuZCBzdGF0dXMgZm9yIG5vbi1hYm9ydHMKICAgICAgICAgIGVycm9yID0gc3RhdHVzVGV4dDsKCiAgICAgICAgICBpZiAoIXN0YXR1c1RleHQgfHwgc3RhdHVzKSB7CiAgICAgICAgICAgIHN0YXR1c1RleHQgPSAiZXJyb3IiOwoKICAgICAgICAgICAgaWYgKHN0YXR1cyA8IDApIHsKICAgICAgICAgICAgICBzdGF0dXMgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBTZXQgZGF0YSBmb3IgdGhlIGZha2UgeGhyIG9iamVjdAoKCiAgICAgICAganFYSFIuc3RhdHVzID0gc3RhdHVzOwogICAgICAgIGpxWEhSLnN0YXR1c1RleHQgPSAiIiArIChuYXRpdmVTdGF0dXNUZXh0IHx8IHN0YXR1c1RleHQpOyAvLyBTdWNjZXNzL0Vycm9yCgogICAgICAgIGlmIChpc1N1Y2Nlc3MpIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmVXaXRoKGNhbGxiYWNrQ29udGV4dCwgW3N1Y2Nlc3MsIHN0YXR1c1RleHQsIGpxWEhSXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlZmVycmVkLnJlamVjdFdpdGgoY2FsbGJhY2tDb250ZXh0LCBbanFYSFIsIHN0YXR1c1RleHQsIGVycm9yXSk7CiAgICAgICAgfSAvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwoKCiAgICAgICAganFYSFIuc3RhdHVzQ29kZShzdGF0dXNDb2RlKTsKICAgICAgICBzdGF0dXNDb2RlID0gdW5kZWZpbmVkOwoKICAgICAgICBpZiAoZmlyZUdsb2JhbHMpIHsKICAgICAgICAgIGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCJhamF4IiArIChpc1N1Y2Nlc3MgPyAiU3VjY2VzcyIgOiAiRXJyb3IiKSwgW2pxWEhSLCBzLCBpc1N1Y2Nlc3MgPyBzdWNjZXNzIDogZXJyb3JdKTsKICAgICAgICB9IC8vIENvbXBsZXRlCgoKICAgICAgICBjb21wbGV0ZURlZmVycmVkLmZpcmVXaXRoKGNhbGxiYWNrQ29udGV4dCwgW2pxWEhSLCBzdGF0dXNUZXh0XSk7CgogICAgICAgIGlmIChmaXJlR2xvYmFscykgewogICAgICAgICAgZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoImFqYXhDb21wbGV0ZSIsIFtqcVhIUiwgc10pOyAvLyBIYW5kbGUgdGhlIGdsb2JhbCBBSkFYIGNvdW50ZXIKCiAgICAgICAgICBpZiAoISAtLWpRdWVyeS5hY3RpdmUpIHsKICAgICAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIEF0dGFjaCBkZWZlcnJlZHMKCgogICAgICBkZWZlcnJlZC5wcm9taXNlKGpxWEhSKTsKICAgICAganFYSFIuc3VjY2VzcyA9IGpxWEhSLmRvbmU7CiAgICAgIGpxWEhSLmVycm9yID0ganFYSFIuZmFpbDsKICAgICAganFYSFIuY29tcGxldGUgPSBjb21wbGV0ZURlZmVycmVkLmFkZDsgLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKCiAgICAgIGpxWEhSLnN0YXR1c0NvZGUgPSBmdW5jdGlvbiAobWFwKSB7CiAgICAgICAgaWYgKG1hcCkgewogICAgICAgICAgdmFyIHRtcDsKCiAgICAgICAgICBpZiAoc3RhdGUgPCAyKSB7CiAgICAgICAgICAgIGZvciAodG1wIGluIG1hcCkgewogICAgICAgICAgICAgIHN0YXR1c0NvZGVbdG1wXSA9IFtzdGF0dXNDb2RlW3RtcF0sIG1hcFt0bXBdXTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdG1wID0gbWFwW2pxWEhSLnN0YXR1c107CiAgICAgICAgICAgIGpxWEhSLnRoZW4odG1wLCB0bXApOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH07IC8vIFJlbW92ZSBoYXNoIGNoYXJhY3RlciAoIzc1MzE6IGFuZCBzdHJpbmcgcHJvbW90aW9uKQogICAgICAvLyBBZGQgcHJvdG9jb2wgaWYgbm90IHByb3ZpZGVkICgjNTg2NjogSUU3IGlzc3VlIHdpdGggcHJvdG9jb2wtbGVzcyB1cmxzKQogICAgICAvLyBXZSBhbHNvIHVzZSB0aGUgdXJsIHBhcmFtZXRlciBpZiBhdmFpbGFibGUKCgogICAgICBzLnVybCA9ICgodXJsIHx8IHMudXJsKSArICIiKS5yZXBsYWNlKHJoYXNoLCAiIikucmVwbGFjZShycHJvdG9jb2wsIGFqYXhMb2NQYXJ0c1sxXSArICIvLyIpOyAvLyBFeHRyYWN0IGRhdGFUeXBlcyBsaXN0CgogICAgICBzLmRhdGFUeXBlcyA9IGpRdWVyeS50cmltKHMuZGF0YVR5cGUgfHwgIioiKS50b0xvd2VyQ2FzZSgpLnNwbGl0KHJzcGFjZXNBamF4KTsgLy8gRGV0ZXJtaW5lIGlmIGEgY3Jvc3MtZG9tYWluIHJlcXVlc3QgaXMgaW4gb3JkZXIKCiAgICAgIGlmIChzLmNyb3NzRG9tYWluID09IG51bGwpIHsKICAgICAgICBwYXJ0cyA9IHJ1cmwuZXhlYyhzLnVybC50b0xvd2VyQ2FzZSgpKTsKICAgICAgICBzLmNyb3NzRG9tYWluID0gISEocGFydHMgJiYgKHBhcnRzWzFdICE9IGFqYXhMb2NQYXJ0c1sxXSB8fCBwYXJ0c1syXSAhPSBhamF4TG9jUGFydHNbMl0gfHwgKHBhcnRzWzNdIHx8IChwYXJ0c1sxXSA9PT0gImh0dHA6IiA/IDgwIDogNDQzKSkgIT0gKGFqYXhMb2NQYXJ0c1szXSB8fCAoYWpheExvY1BhcnRzWzFdID09PSAiaHR0cDoiID8gODAgOiA0NDMpKSkpOwogICAgICB9IC8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZwoKCiAgICAgIGlmIChzLmRhdGEgJiYgcy5wcm9jZXNzRGF0YSAmJiB0eXBlb2Ygcy5kYXRhICE9PSAic3RyaW5nIikgewogICAgICAgIHMuZGF0YSA9IGpRdWVyeS5wYXJhbShzLmRhdGEsIHMudHJhZGl0aW9uYWwpOwogICAgICB9IC8vIEFwcGx5IHByZWZpbHRlcnMKCgogICAgICBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyhwcmVmaWx0ZXJzLCBzLCBvcHRpb25zLCBqcVhIUik7IC8vIElmIHJlcXVlc3Qgd2FzIGFib3J0ZWQgaW5zaWRlIGEgcHJlZmlsdGVyLCBzdG9wIHRoZXJlCgogICAgICBpZiAoc3RhdGUgPT09IDIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gV2UgY2FuIGZpcmUgZ2xvYmFsIGV2ZW50cyBhcyBvZiBub3cgaWYgYXNrZWQgdG8KCgogICAgICBmaXJlR2xvYmFscyA9IHMuZ2xvYmFsOyAvLyBVcHBlcmNhc2UgdGhlIHR5cGUKCiAgICAgIHMudHlwZSA9IHMudHlwZS50b1VwcGVyQ2FzZSgpOyAvLyBEZXRlcm1pbmUgaWYgcmVxdWVzdCBoYXMgY29udGVudAoKICAgICAgcy5oYXNDb250ZW50ID0gIXJub0NvbnRlbnQudGVzdChzLnR5cGUpOyAvLyBXYXRjaCBmb3IgYSBuZXcgc2V0IG9mIHJlcXVlc3RzCgogICAgICBpZiAoZmlyZUdsb2JhbHMgJiYgalF1ZXJ5LmFjdGl2ZSsrID09PSAwKSB7CiAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpOwogICAgICB9IC8vIE1vcmUgb3B0aW9ucyBoYW5kbGluZyBmb3IgcmVxdWVzdHMgd2l0aCBubyBjb250ZW50CgoKICAgICAgaWYgKCFzLmhhc0NvbnRlbnQpIHsKICAgICAgICAvLyBJZiBkYXRhIGlzIGF2YWlsYWJsZSwgYXBwZW5kIGRhdGEgdG8gdXJsCiAgICAgICAgaWYgKHMuZGF0YSkgewogICAgICAgICAgcy51cmwgKz0gKHJxdWVyeS50ZXN0KHMudXJsKSA/ICImIiA6ICI/IikgKyBzLmRhdGE7IC8vICM5NjgyOiByZW1vdmUgZGF0YSBzbyB0aGF0IGl0J3Mgbm90IHVzZWQgaW4gYW4gZXZlbnR1YWwgcmV0cnkKCiAgICAgICAgICBkZWxldGUgcy5kYXRhOwogICAgICAgIH0gLy8gR2V0IGlmTW9kaWZpZWRLZXkgYmVmb3JlIGFkZGluZyB0aGUgYW50aS1jYWNoZSBwYXJhbWV0ZXIKCgogICAgICAgIGlmTW9kaWZpZWRLZXkgPSBzLnVybDsgLy8gQWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZAoKICAgICAgICBpZiAocy5jYWNoZSA9PT0gZmFsc2UpIHsKICAgICAgICAgIHZhciB0cyA9IGpRdWVyeS5ub3coKSwKICAgICAgICAgICAgICAvLyB0cnkgcmVwbGFjaW5nIF89IGlmIGl0IGlzIHRoZXJlCiAgICAgICAgICByZXQgPSBzLnVybC5yZXBsYWNlKHJ0cywgIiQxXz0iICsgdHMpOyAvLyBpZiBub3RoaW5nIHdhcyByZXBsYWNlZCwgYWRkIHRpbWVzdGFtcCB0byB0aGUgZW5kCgogICAgICAgICAgcy51cmwgPSByZXQgKyAocmV0ID09PSBzLnVybCA/IChycXVlcnkudGVzdChzLnVybCkgPyAiJiIgOiAiPyIpICsgIl89IiArIHRzIDogIiIpOwogICAgICAgIH0KICAgICAgfSAvLyBTZXQgdGhlIGNvcnJlY3QgaGVhZGVyLCBpZiBkYXRhIGlzIGJlaW5nIHNlbnQKCgogICAgICBpZiAocy5kYXRhICYmIHMuaGFzQ29udGVudCAmJiBzLmNvbnRlbnRUeXBlICE9PSBmYWxzZSB8fCBvcHRpb25zLmNvbnRlbnRUeXBlKSB7CiAgICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgcy5jb250ZW50VHlwZSk7CiAgICAgIH0gLy8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS4KCgogICAgICBpZiAocy5pZk1vZGlmaWVkKSB7CiAgICAgICAgaWZNb2RpZmllZEtleSA9IGlmTW9kaWZpZWRLZXkgfHwgcy51cmw7CgogICAgICAgIGlmIChqUXVlcnkubGFzdE1vZGlmaWVkW2lmTW9kaWZpZWRLZXldKSB7CiAgICAgICAgICBqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Nb2RpZmllZC1TaW5jZSIsIGpRdWVyeS5sYXN0TW9kaWZpZWRbaWZNb2RpZmllZEtleV0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGpRdWVyeS5ldGFnW2lmTW9kaWZpZWRLZXldKSB7CiAgICAgICAgICBqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIiwgalF1ZXJ5LmV0YWdbaWZNb2RpZmllZEtleV0pOwogICAgICAgIH0KICAgICAgfSAvLyBTZXQgdGhlIEFjY2VwdHMgaGVhZGVyIGZvciB0aGUgc2VydmVyLCBkZXBlbmRpbmcgb24gdGhlIGRhdGFUeXBlCgoKICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0Iiwgcy5kYXRhVHlwZXNbMF0gJiYgcy5hY2NlcHRzW3MuZGF0YVR5cGVzWzBdXSA/IHMuYWNjZXB0c1tzLmRhdGFUeXBlc1swXV0gKyAocy5kYXRhVHlwZXNbMF0gIT09ICIqIiA/ICIsICIgKyBhbGxUeXBlcyArICI7IHE9MC4wMSIgOiAiIikgOiBzLmFjY2VwdHNbIioiXSk7IC8vIENoZWNrIGZvciBoZWFkZXJzIG9wdGlvbgoKICAgICAgZm9yIChpIGluIHMuaGVhZGVycykgewogICAgICAgIGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoaSwgcy5oZWFkZXJzW2ldKTsKICAgICAgfSAvLyBBbGxvdyBjdXN0b20gaGVhZGVycy9taW1ldHlwZXMgYW5kIGVhcmx5IGFib3J0CgoKICAgICAgaWYgKHMuYmVmb3JlU2VuZCAmJiAocy5iZWZvcmVTZW5kLmNhbGwoY2FsbGJhY2tDb250ZXh0LCBqcVhIUiwgcykgPT09IGZhbHNlIHx8IHN0YXRlID09PSAyKSkgewogICAgICAgIC8vIEFib3J0IGlmIG5vdCBkb25lIGFscmVhZHkKICAgICAgICBqcVhIUi5hYm9ydCgpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBJbnN0YWxsIGNhbGxiYWNrcyBvbiBkZWZlcnJlZHMKCgogICAgICBmb3IgKGkgaW4gewogICAgICAgIHN1Y2Nlc3M6IDEsCiAgICAgICAgZXJyb3I6IDEsCiAgICAgICAgY29tcGxldGU6IDEKICAgICAgfSkgewogICAgICAgIGpxWEhSW2ldKHNbaV0pOwogICAgICB9IC8vIEdldCB0cmFuc3BvcnQKCgogICAgICB0cmFuc3BvcnQgPSBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyh0cmFuc3BvcnRzLCBzLCBvcHRpb25zLCBqcVhIUik7IC8vIElmIG5vIHRyYW5zcG9ydCwgd2UgYXV0by1hYm9ydAoKICAgICAgaWYgKCF0cmFuc3BvcnQpIHsKICAgICAgICBkb25lKC0xLCAiTm8gVHJhbnNwb3J0Iik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAganFYSFIucmVhZHlTdGF0ZSA9IDE7IC8vIFNlbmQgZ2xvYmFsIGV2ZW50CgogICAgICAgIGlmIChmaXJlR2xvYmFscykgewogICAgICAgICAgZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoImFqYXhTZW5kIiwgW2pxWEhSLCBzXSk7CiAgICAgICAgfSAvLyBUaW1lb3V0CgoKICAgICAgICBpZiAocy5hc3luYyAmJiBzLnRpbWVvdXQgPiAwKSB7CiAgICAgICAgICB0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAganFYSFIuYWJvcnQoInRpbWVvdXQiKTsKICAgICAgICAgIH0sIHMudGltZW91dCk7CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgc3RhdGUgPSAxOwogICAgICAgICAgdHJhbnNwb3J0LnNlbmQocmVxdWVzdEhlYWRlcnMsIGRvbmUpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIC8vIFByb3BhZ2F0ZSBleGNlcHRpb24gYXMgZXJyb3IgaWYgbm90IGRvbmUKICAgICAgICAgIGlmIChzdGF0ZSA8IDIpIHsKICAgICAgICAgICAgZG9uZSgtMSwgZSk7IC8vIFNpbXBseSByZXRocm93IG90aGVyd2lzZQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBqcVhIUjsKICAgIH0sCiAgICAvLyBTZXJpYWxpemUgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cyBvciBhIHNldCBvZgogICAgLy8ga2V5L3ZhbHVlcyBpbnRvIGEgcXVlcnkgc3RyaW5nCiAgICBwYXJhbTogZnVuY3Rpb24gcGFyYW0oYSwgdHJhZGl0aW9uYWwpIHsKICAgICAgdmFyIHMgPSBbXSwKICAgICAgICAgIGFkZCA9IGZ1bmN0aW9uIGFkZChrZXksIHZhbHVlKSB7CiAgICAgICAgLy8gSWYgdmFsdWUgaXMgYSBmdW5jdGlvbiwgaW52b2tlIGl0IGFuZCByZXR1cm4gaXRzIHZhbHVlCiAgICAgICAgdmFsdWUgPSBqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZSgpIDogdmFsdWU7CiAgICAgICAgc1tzLmxlbmd0aF0gPSBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7CiAgICAgIH07IC8vIFNldCB0cmFkaXRpb25hbCB0byB0cnVlIGZvciBqUXVlcnkgPD0gMS4zLjIgYmVoYXZpb3IuCgoKICAgICAgaWYgKHRyYWRpdGlvbmFsID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0cmFkaXRpb25hbCA9IGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7CiAgICAgIH0gLy8gSWYgYW4gYXJyYXkgd2FzIHBhc3NlZCBpbiwgYXNzdW1lIHRoYXQgaXQgaXMgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cy4KCgogICAgICBpZiAoalF1ZXJ5LmlzQXJyYXkoYSkgfHwgYS5qcXVlcnkgJiYgIWpRdWVyeS5pc1BsYWluT2JqZWN0KGEpKSB7CiAgICAgICAgLy8gU2VyaWFsaXplIHRoZSBmb3JtIGVsZW1lbnRzCiAgICAgICAgalF1ZXJ5LmVhY2goYSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgYWRkKHRoaXMubmFtZSwgdGhpcy52YWx1ZSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSWYgdHJhZGl0aW9uYWwsIGVuY29kZSB0aGUgIm9sZCIgd2F5ICh0aGUgd2F5IDEuMy4yIG9yIG9sZGVyCiAgICAgICAgLy8gZGlkIGl0KSwgb3RoZXJ3aXNlIGVuY29kZSBwYXJhbXMgcmVjdXJzaXZlbHkuCiAgICAgICAgZm9yICh2YXIgcHJlZml4IGluIGEpIHsKICAgICAgICAgIGJ1aWxkUGFyYW1zKHByZWZpeCwgYVtwcmVmaXhdLCB0cmFkaXRpb25hbCwgYWRkKTsKICAgICAgICB9CiAgICAgIH0gLy8gUmV0dXJuIHRoZSByZXN1bHRpbmcgc2VyaWFsaXphdGlvbgoKCiAgICAgIHJldHVybiBzLmpvaW4oIiYiKS5yZXBsYWNlKHIyMCwgIisiKTsKICAgIH0KICB9KTsKCiAgZnVuY3Rpb24gYnVpbGRQYXJhbXMocHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQpIHsKICAgIGlmIChqUXVlcnkuaXNBcnJheShvYmopKSB7CiAgICAgIC8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLgogICAgICBqUXVlcnkuZWFjaChvYmosIGZ1bmN0aW9uIChpLCB2KSB7CiAgICAgICAgaWYgKHRyYWRpdGlvbmFsIHx8IHJicmFja2V0LnRlc3QocHJlZml4KSkgewogICAgICAgICAgLy8gVHJlYXQgZWFjaCBhcnJheSBpdGVtIGFzIGEgc2NhbGFyLgogICAgICAgICAgYWRkKHByZWZpeCwgdik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIElmIGFycmF5IGl0ZW0gaXMgbm9uLXNjYWxhciAoYXJyYXkgb3Igb2JqZWN0KSwgZW5jb2RlIGl0cwogICAgICAgICAgLy8gbnVtZXJpYyBpbmRleCB0byByZXNvbHZlIGRlc2VyaWFsaXphdGlvbiBhbWJpZ3VpdHkgaXNzdWVzLgogICAgICAgICAgLy8gTm90ZSB0aGF0IHJhY2sgKGFzIG9mIDEuMC4wKSBjYW4ndCBjdXJyZW50bHkgZGVzZXJpYWxpemUKICAgICAgICAgIC8vIG5lc3RlZCBhcnJheXMgcHJvcGVybHksIGFuZCBhdHRlbXB0aW5nIHRvIGRvIHNvIG1heSBjYXVzZQogICAgICAgICAgLy8gYSBzZXJ2ZXIgZXJyb3IuIFBvc3NpYmxlIGZpeGVzIGFyZSB0byBtb2RpZnkgcmFjaydzCiAgICAgICAgICAvLyBkZXNlcmlhbGl6YXRpb24gYWxnb3JpdGhtIG9yIHRvIHByb3ZpZGUgYW4gb3B0aW9uIG9yIGZsYWcKICAgICAgICAgIC8vIHRvIGZvcmNlIGFycmF5IHNlcmlhbGl6YXRpb24gdG8gYmUgc2hhbGxvdy4KICAgICAgICAgIGJ1aWxkUGFyYW1zKHByZWZpeCArICJbIiArIChfdHlwZW9mKHYpID09PSAib2JqZWN0IiA/IGkgOiAiIikgKyAiXSIsIHYsIHRyYWRpdGlvbmFsLCBhZGQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKCF0cmFkaXRpb25hbCAmJiBqUXVlcnkudHlwZShvYmopID09PSAib2JqZWN0IikgewogICAgICAvLyBTZXJpYWxpemUgb2JqZWN0IGl0ZW0uCiAgICAgIGZvciAodmFyIG5hbWUgaW4gb2JqKSB7CiAgICAgICAgYnVpbGRQYXJhbXMocHJlZml4ICsgIlsiICsgbmFtZSArICJdIiwgb2JqW25hbWVdLCB0cmFkaXRpb25hbCwgYWRkKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gU2VyaWFsaXplIHNjYWxhciBpdGVtLgogICAgICBhZGQocHJlZml4LCBvYmopOwogICAgfQogIH0gLy8gVGhpcyBpcyBzdGlsbCBvbiB0aGUgalF1ZXJ5IG9iamVjdC4uLiBmb3Igbm93CiAgLy8gV2FudCB0byBtb3ZlIHRoaXMgdG8galF1ZXJ5LmFqYXggc29tZSBkYXkKCgogIGpRdWVyeS5leHRlbmQoewogICAgLy8gQ291bnRlciBmb3IgaG9sZGluZyB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBxdWVyaWVzCiAgICBhY3RpdmU6IDAsCiAgICAvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4dCByZXF1ZXN0CiAgICBsYXN0TW9kaWZpZWQ6IHt9LAogICAgZXRhZzoge30KICB9KTsKICAvKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6CiAgICogLSBzZXRzIGFsbCByZXNwb25zZVhYWCBmaWVsZHMgYWNjb3JkaW5nbHkKICAgKiAtIGZpbmRzIHRoZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUgYW5kIGV4cGVjdGVkIGRhdGFUeXBlKQogICAqIC0gcmV0dXJucyB0aGUgY29ycmVzcG9uZGluZyByZXNwb25zZQogICAqLwoKICBmdW5jdGlvbiBhamF4SGFuZGxlUmVzcG9uc2VzKHMsIGpxWEhSLCByZXNwb25zZXMpIHsKICAgIHZhciBjb250ZW50cyA9IHMuY29udGVudHMsCiAgICAgICAgZGF0YVR5cGVzID0gcy5kYXRhVHlwZXMsCiAgICAgICAgcmVzcG9uc2VGaWVsZHMgPSBzLnJlc3BvbnNlRmllbGRzLAogICAgICAgIGN0LAogICAgICAgIHR5cGUsCiAgICAgICAgZmluYWxEYXRhVHlwZSwKICAgICAgICBmaXJzdERhdGFUeXBlOyAvLyBGaWxsIHJlc3BvbnNlWFhYIGZpZWxkcwoKICAgIGZvciAodHlwZSBpbiByZXNwb25zZUZpZWxkcykgewogICAgICBpZiAodHlwZSBpbiByZXNwb25zZXMpIHsKICAgICAgICBqcVhIUltyZXNwb25zZUZpZWxkc1t0eXBlXV0gPSByZXNwb25zZXNbdHlwZV07CiAgICAgIH0KICAgIH0gLy8gUmVtb3ZlIGF1dG8gZGF0YVR5cGUgYW5kIGdldCBjb250ZW50LXR5cGUgaW4gdGhlIHByb2Nlc3MKCgogICAgd2hpbGUgKGRhdGFUeXBlc1swXSA9PT0gIioiKSB7CiAgICAgIGRhdGFUeXBlcy5zaGlmdCgpOwoKICAgICAgaWYgKGN0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjdCA9IHMubWltZVR5cGUgfHwganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoImNvbnRlbnQtdHlwZSIpOwogICAgICB9CiAgICB9IC8vIENoZWNrIGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCBhIGtub3duIGNvbnRlbnQtdHlwZQoKCiAgICBpZiAoY3QpIHsKICAgICAgZm9yICh0eXBlIGluIGNvbnRlbnRzKSB7CiAgICAgICAgaWYgKGNvbnRlbnRzW3R5cGVdICYmIGNvbnRlbnRzW3R5cGVdLnRlc3QoY3QpKSB7CiAgICAgICAgICBkYXRhVHlwZXMudW5zaGlmdCh0eXBlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSAvLyBDaGVjayB0byBzZWUgaWYgd2UgaGF2ZSBhIHJlc3BvbnNlIGZvciB0aGUgZXhwZWN0ZWQgZGF0YVR5cGUKCgogICAgaWYgKGRhdGFUeXBlc1swXSBpbiByZXNwb25zZXMpIHsKICAgICAgZmluYWxEYXRhVHlwZSA9IGRhdGFUeXBlc1swXTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFRyeSBjb252ZXJ0aWJsZSBkYXRhVHlwZXMKICAgICAgZm9yICh0eXBlIGluIHJlc3BvbnNlcykgewogICAgICAgIGlmICghZGF0YVR5cGVzWzBdIHx8IHMuY29udmVydGVyc1t0eXBlICsgIiAiICsgZGF0YVR5cGVzWzBdXSkgewogICAgICAgICAgZmluYWxEYXRhVHlwZSA9IHR5cGU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICghZmlyc3REYXRhVHlwZSkgewogICAgICAgICAgZmlyc3REYXRhVHlwZSA9IHR5cGU7CiAgICAgICAgfQogICAgICB9IC8vIE9yIGp1c3QgdXNlIGZpcnN0IG9uZQoKCiAgICAgIGZpbmFsRGF0YVR5cGUgPSBmaW5hbERhdGFUeXBlIHx8IGZpcnN0RGF0YVR5cGU7CiAgICB9IC8vIElmIHdlIGZvdW5kIGEgZGF0YVR5cGUKICAgIC8vIFdlIGFkZCB0aGUgZGF0YVR5cGUgdG8gdGhlIGxpc3QgaWYgbmVlZGVkCiAgICAvLyBhbmQgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlCgoKICAgIGlmIChmaW5hbERhdGFUeXBlKSB7CiAgICAgIGlmIChmaW5hbERhdGFUeXBlICE9PSBkYXRhVHlwZXNbMF0pIHsKICAgICAgICBkYXRhVHlwZXMudW5zaGlmdChmaW5hbERhdGFUeXBlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3BvbnNlc1tmaW5hbERhdGFUeXBlXTsKICAgIH0KICB9IC8vIENoYWluIGNvbnZlcnNpb25zIGdpdmVuIHRoZSByZXF1ZXN0IGFuZCB0aGUgb3JpZ2luYWwgcmVzcG9uc2UKCgogIGZ1bmN0aW9uIGFqYXhDb252ZXJ0KHMsIHJlc3BvbnNlKSB7CiAgICAvLyBBcHBseSB0aGUgZGF0YUZpbHRlciBpZiBwcm92aWRlZAogICAgaWYgKHMuZGF0YUZpbHRlcikgewogICAgICByZXNwb25zZSA9IHMuZGF0YUZpbHRlcihyZXNwb25zZSwgcy5kYXRhVHlwZSk7CiAgICB9CgogICAgdmFyIGRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzLAogICAgICAgIGNvbnZlcnRlcnMgPSB7fSwKICAgICAgICBpLAogICAgICAgIGtleSwKICAgICAgICBsZW5ndGggPSBkYXRhVHlwZXMubGVuZ3RoLAogICAgICAgIHRtcCwKICAgICAgICAvLyBDdXJyZW50IGFuZCBwcmV2aW91cyBkYXRhVHlwZXMKICAgIGN1cnJlbnQgPSBkYXRhVHlwZXNbMF0sCiAgICAgICAgcHJldiwKICAgICAgICAvLyBDb252ZXJzaW9uIGV4cHJlc3Npb24KICAgIGNvbnZlcnNpb24sCiAgICAgICAgLy8gQ29udmVyc2lvbiBmdW5jdGlvbgogICAgY29udiwKICAgICAgICAvLyBDb252ZXJzaW9uIGZ1bmN0aW9ucyAodHJhbnNpdGl2ZSBjb252ZXJzaW9uKQogICAgY29udjEsCiAgICAgICAgY29udjI7IC8vIEZvciBlYWNoIGRhdGFUeXBlIGluIHRoZSBjaGFpbgoKICAgIGZvciAoaSA9IDE7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAvLyBDcmVhdGUgY29udmVydGVycyBtYXAKICAgICAgLy8gd2l0aCBsb3dlcmNhc2VkIGtleXMKICAgICAgaWYgKGkgPT09IDEpIHsKICAgICAgICBmb3IgKGtleSBpbiBzLmNvbnZlcnRlcnMpIHsKICAgICAgICAgIGlmICh0eXBlb2Yga2V5ID09PSAic3RyaW5nIikgewogICAgICAgICAgICBjb252ZXJ0ZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IHMuY29udmVydGVyc1trZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBHZXQgdGhlIGRhdGFUeXBlcwoKCiAgICAgIHByZXYgPSBjdXJyZW50OwogICAgICBjdXJyZW50ID0gZGF0YVR5cGVzW2ldOyAvLyBJZiBjdXJyZW50IGlzIGF1dG8gZGF0YVR5cGUsIHVwZGF0ZSBpdCB0byBwcmV2CgogICAgICBpZiAoY3VycmVudCA9PT0gIioiKSB7CiAgICAgICAgY3VycmVudCA9IHByZXY7IC8vIElmIG5vIGF1dG8gYW5kIGRhdGFUeXBlcyBhcmUgYWN0dWFsbHkgZGlmZmVyZW50CiAgICAgIH0gZWxzZSBpZiAocHJldiAhPT0gIioiICYmIHByZXYgIT09IGN1cnJlbnQpIHsKICAgICAgICAvLyBHZXQgdGhlIGNvbnZlcnRlcgogICAgICAgIGNvbnZlcnNpb24gPSBwcmV2ICsgIiAiICsgY3VycmVudDsKICAgICAgICBjb252ID0gY29udmVydGVyc1tjb252ZXJzaW9uXSB8fCBjb252ZXJ0ZXJzWyIqICIgKyBjdXJyZW50XTsgLy8gSWYgdGhlcmUgaXMgbm8gZGlyZWN0IGNvbnZlcnRlciwgc2VhcmNoIHRyYW5zaXRpdmVseQoKICAgICAgICBpZiAoIWNvbnYpIHsKICAgICAgICAgIGNvbnYyID0gdW5kZWZpbmVkOwoKICAgICAgICAgIGZvciAoY29udjEgaW4gY29udmVydGVycykgewogICAgICAgICAgICB0bXAgPSBjb252MS5zcGxpdCgiICIpOwoKICAgICAgICAgICAgaWYgKHRtcFswXSA9PT0gcHJldiB8fCB0bXBbMF0gPT09ICIqIikgewogICAgICAgICAgICAgIGNvbnYyID0gY29udmVydGVyc1t0bXBbMV0gKyAiICIgKyBjdXJyZW50XTsKCiAgICAgICAgICAgICAgaWYgKGNvbnYyKSB7CiAgICAgICAgICAgICAgICBjb252MSA9IGNvbnZlcnRlcnNbY29udjFdOwoKICAgICAgICAgICAgICAgIGlmIChjb252MSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICBjb252ID0gY29udjI7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnYyID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgIGNvbnYgPSBjb252MTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IC8vIElmIHdlIGZvdW5kIG5vIGNvbnZlcnRlciwgZGlzcGF0Y2ggYW4gZXJyb3IKCgogICAgICAgIGlmICghKGNvbnYgfHwgY29udjIpKSB7CiAgICAgICAgICBqUXVlcnkuZXJyb3IoIk5vIGNvbnZlcnNpb24gZnJvbSAiICsgY29udmVyc2lvbi5yZXBsYWNlKCIgIiwgIiB0byAiKSk7CiAgICAgICAgfSAvLyBJZiBmb3VuZCBjb252ZXJ0ZXIgaXMgbm90IGFuIGVxdWl2YWxlbmNlCgoKICAgICAgICBpZiAoY29udiAhPT0gdHJ1ZSkgewogICAgICAgICAgLy8gQ29udmVydCB3aXRoIDEgb3IgMiBjb252ZXJ0ZXJzIGFjY29yZGluZ2x5CiAgICAgICAgICByZXNwb25zZSA9IGNvbnYgPyBjb252KHJlc3BvbnNlKSA6IGNvbnYyKGNvbnYxKHJlc3BvbnNlKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJlc3BvbnNlOwogIH0KCiAgdmFyIGpzYyA9IGpRdWVyeS5ub3coKSwKICAgICAganNyZSA9IC8oXD0pXD8oJnwkKXxcP1w/L2k7IC8vIERlZmF1bHQganNvbnAgc2V0dGluZ3MKCiAgalF1ZXJ5LmFqYXhTZXR1cCh7CiAgICBqc29ucDogImNhbGxiYWNrIiwKICAgIGpzb25wQ2FsbGJhY2s6IGZ1bmN0aW9uIGpzb25wQ2FsbGJhY2soKSB7CiAgICAgIHJldHVybiBqUXVlcnkuZXhwYW5kbyArICJfIiArIGpzYysrOwogICAgfQogIH0pOyAvLyBEZXRlY3QsIG5vcm1hbGl6ZSBvcHRpb25zIGFuZCBpbnN0YWxsIGNhbGxiYWNrcyBmb3IganNvbnAgcmVxdWVzdHMKCiAgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoImpzb24ganNvbnAiLCBmdW5jdGlvbiAocywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIpIHsKICAgIHZhciBpbnNwZWN0RGF0YSA9IHR5cGVvZiBzLmRhdGEgPT09ICJzdHJpbmciICYmIC9eYXBwbGljYXRpb25cL3hcLXd3d1wtZm9ybVwtdXJsZW5jb2RlZC8udGVzdChzLmNvbnRlbnRUeXBlKTsKCiAgICBpZiAocy5kYXRhVHlwZXNbMF0gPT09ICJqc29ucCIgfHwgcy5qc29ucCAhPT0gZmFsc2UgJiYgKGpzcmUudGVzdChzLnVybCkgfHwgaW5zcGVjdERhdGEgJiYganNyZS50ZXN0KHMuZGF0YSkpKSB7CiAgICAgIHZhciByZXNwb25zZUNvbnRhaW5lciwKICAgICAgICAgIGpzb25wQ2FsbGJhY2sgPSBzLmpzb25wQ2FsbGJhY2sgPSBqUXVlcnkuaXNGdW5jdGlvbihzLmpzb25wQ2FsbGJhY2spID8gcy5qc29ucENhbGxiYWNrKCkgOiBzLmpzb25wQ2FsbGJhY2ssCiAgICAgICAgICBwcmV2aW91cyA9IHdpbmRvd1tqc29ucENhbGxiYWNrXSwKICAgICAgICAgIHVybCA9IHMudXJsLAogICAgICAgICAgZGF0YSA9IHMuZGF0YSwKICAgICAgICAgIHJlcGxhY2UgPSAiJDEiICsganNvbnBDYWxsYmFjayArICIkMiI7CgogICAgICBpZiAocy5qc29ucCAhPT0gZmFsc2UpIHsKICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShqc3JlLCByZXBsYWNlKTsKCiAgICAgICAgaWYgKHMudXJsID09PSB1cmwpIHsKICAgICAgICAgIGlmIChpbnNwZWN0RGF0YSkgewogICAgICAgICAgICBkYXRhID0gZGF0YS5yZXBsYWNlKGpzcmUsIHJlcGxhY2UpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzLmRhdGEgPT09IGRhdGEpIHsKICAgICAgICAgICAgLy8gQWRkIGNhbGxiYWNrIG1hbnVhbGx5CiAgICAgICAgICAgIHVybCArPSAoL1w/Ly50ZXN0KHVybCkgPyAiJiIgOiAiPyIpICsgcy5qc29ucCArICI9IiArIGpzb25wQ2FsbGJhY2s7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBzLnVybCA9IHVybDsKICAgICAgcy5kYXRhID0gZGF0YTsgLy8gSW5zdGFsbCBjYWxsYmFjawoKICAgICAgd2luZG93W2pzb25wQ2FsbGJhY2tdID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgcmVzcG9uc2VDb250YWluZXIgPSBbcmVzcG9uc2VdOwogICAgICB9OyAvLyBDbGVhbi11cCBmdW5jdGlvbgoKCiAgICAgIGpxWEhSLmFsd2F5cyhmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gU2V0IGNhbGxiYWNrIGJhY2sgdG8gcHJldmlvdXMgdmFsdWUKICAgICAgICB3aW5kb3dbanNvbnBDYWxsYmFja10gPSBwcmV2aW91czsgLy8gQ2FsbCBpZiBpdCB3YXMgYSBmdW5jdGlvbiBhbmQgd2UgaGF2ZSBhIHJlc3BvbnNlCgogICAgICAgIGlmIChyZXNwb25zZUNvbnRhaW5lciAmJiBqUXVlcnkuaXNGdW5jdGlvbihwcmV2aW91cykpIHsKICAgICAgICAgIHdpbmRvd1tqc29ucENhbGxiYWNrXShyZXNwb25zZUNvbnRhaW5lclswXSk7CiAgICAgICAgfQogICAgICB9KTsgLy8gVXNlIGRhdGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1dGlvbgoKICAgICAgcy5jb252ZXJ0ZXJzWyJzY3JpcHQganNvbiJdID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghcmVzcG9uc2VDb250YWluZXIpIHsKICAgICAgICAgIGpRdWVyeS5lcnJvcihqc29ucENhbGxiYWNrICsgIiB3YXMgbm90IGNhbGxlZCIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWzBdOwogICAgICB9OyAvLyBmb3JjZSBqc29uIGRhdGFUeXBlCgoKICAgICAgcy5kYXRhVHlwZXNbMF0gPSAianNvbiI7IC8vIERlbGVnYXRlIHRvIHNjcmlwdAoKICAgICAgcmV0dXJuICJzY3JpcHQiOwogICAgfQogIH0pOyAvLyBJbnN0YWxsIHNjcmlwdCBkYXRhVHlwZQoKICBqUXVlcnkuYWpheFNldHVwKHsKICAgIGFjY2VwdHM6IHsKICAgICAgc2NyaXB0OiAidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQiCiAgICB9LAogICAgY29udGVudHM6IHsKICAgICAgc2NyaXB0OiAvamF2YXNjcmlwdHxlY21hc2NyaXB0LwogICAgfSwKICAgIGNvbnZlcnRlcnM6IHsKICAgICAgInRleHQgc2NyaXB0IjogZnVuY3Rpb24gdGV4dFNjcmlwdCh0ZXh0KSB7CiAgICAgICAgalF1ZXJ5Lmdsb2JhbEV2YWwodGV4dCk7CiAgICAgICAgcmV0dXJuIHRleHQ7CiAgICAgIH0KICAgIH0KICB9KTsgLy8gSGFuZGxlIGNhY2hlJ3Mgc3BlY2lhbCBjYXNlIGFuZCBnbG9iYWwKCiAgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsIGZ1bmN0aW9uIChzKSB7CiAgICBpZiAocy5jYWNoZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHMuY2FjaGUgPSBmYWxzZTsKICAgIH0KCiAgICBpZiAocy5jcm9zc0RvbWFpbikgewogICAgICBzLnR5cGUgPSAiR0VUIjsKICAgICAgcy5nbG9iYWwgPSBmYWxzZTsKICAgIH0KICB9KTsgLy8gQmluZCBzY3JpcHQgdGFnIGhhY2sgdHJhbnNwb3J0CgogIGpRdWVyeS5hamF4VHJhbnNwb3J0KCJzY3JpcHQiLCBmdW5jdGlvbiAocykgewogICAgLy8gVGhpcyB0cmFuc3BvcnQgb25seSBkZWFscyB3aXRoIGNyb3NzIGRvbWFpbiByZXF1ZXN0cwogICAgaWYgKHMuY3Jvc3NEb21haW4pIHsKICAgICAgdmFyIHNjcmlwdCwKICAgICAgICAgIGhlYWQgPSBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0gfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogICAgICByZXR1cm4gewogICAgICAgIHNlbmQ6IGZ1bmN0aW9uIHNlbmQoXywgY2FsbGJhY2spIHsKICAgICAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwogICAgICAgICAgc2NyaXB0LmFzeW5jID0gImFzeW5jIjsKCiAgICAgICAgICBpZiAocy5zY3JpcHRDaGFyc2V0KSB7CiAgICAgICAgICAgIHNjcmlwdC5jaGFyc2V0ID0gcy5zY3JpcHRDaGFyc2V0OwogICAgICAgICAgfQoKICAgICAgICAgIHNjcmlwdC5zcmMgPSBzLnVybDsgLy8gQXR0YWNoIGhhbmRsZXJzIGZvciBhbGwgYnJvd3NlcnMKCiAgICAgICAgICBzY3JpcHQub25sb2FkID0gc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uIChfLCBpc0Fib3J0KSB7CiAgICAgICAgICAgIGlmIChpc0Fib3J0IHx8ICFzY3JpcHQucmVhZHlTdGF0ZSB8fCAvbG9hZGVkfGNvbXBsZXRlLy50ZXN0KHNjcmlwdC5yZWFkeVN0YXRlKSkgewogICAgICAgICAgICAgIC8vIEhhbmRsZSBtZW1vcnkgbGVhayBpbiBJRQogICAgICAgICAgICAgIHNjcmlwdC5vbmxvYWQgPSBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsgLy8gUmVtb3ZlIHRoZSBzY3JpcHQKCiAgICAgICAgICAgICAgaWYgKGhlYWQgJiYgc2NyaXB0LnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgICAgIGhlYWQucmVtb3ZlQ2hpbGQoc2NyaXB0KTsKICAgICAgICAgICAgICB9IC8vIERlcmVmZXJlbmNlIHRoZSBzY3JpcHQKCgogICAgICAgICAgICAgIHNjcmlwdCA9IHVuZGVmaW5lZDsgLy8gQ2FsbGJhY2sgaWYgbm90IGFib3J0CgogICAgICAgICAgICAgIGlmICghaXNBYm9ydCkgewogICAgICAgICAgICAgICAgY2FsbGJhY2soMjAwLCAic3VjY2VzcyIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfTsgLy8gVXNlIGluc2VydEJlZm9yZSBpbnN0ZWFkIG9mIGFwcGVuZENoaWxkICB0byBjaXJjdW12ZW50IGFuIElFNiBidWcuCiAgICAgICAgICAvLyBUaGlzIGFyaXNlcyB3aGVuIGEgYmFzZSBub2RlIGlzIHVzZWQgKCMyNzA5IGFuZCAjNDM3OCkuCgoKICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHNjcmlwdCwgaGVhZC5maXJzdENoaWxkKTsKICAgICAgICB9LAogICAgICAgIGFib3J0OiBmdW5jdGlvbiBhYm9ydCgpIHsKICAgICAgICAgIGlmIChzY3JpcHQpIHsKICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCgwLCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CiAgdmFyIC8vICM1MjgwOiBJbnRlcm5ldCBFeHBsb3JlciB3aWxsIGtlZXAgY29ubmVjdGlvbnMgYWxpdmUgaWYgd2UgZG9uJ3QgYWJvcnQgb24gdW5sb2FkCiAgeGhyT25VbmxvYWRBYm9ydCA9IHdpbmRvdy5BY3RpdmVYT2JqZWN0ID8gZnVuY3Rpb24gKCkgewogICAgLy8gQWJvcnQgYWxsIHBlbmRpbmcgcmVxdWVzdHMKICAgIGZvciAodmFyIGtleSBpbiB4aHJDYWxsYmFja3MpIHsKICAgICAgeGhyQ2FsbGJhY2tzW2tleV0oMCwgMSk7CiAgICB9CiAgfSA6IGZhbHNlLAogICAgICB4aHJJZCA9IDAsCiAgICAgIHhockNhbGxiYWNrczsgLy8gRnVuY3Rpb25zIHRvIGNyZWF0ZSB4aHJzCgogIGZ1bmN0aW9uIGNyZWF0ZVN0YW5kYXJkWEhSKCkgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKICAgIH0gY2F0Y2ggKGUpIHt9CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVBY3RpdmVYSFIoKSB7CiAgICB0cnkgewogICAgICByZXR1cm4gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpOwogICAgfSBjYXRjaCAoZSkge30KICB9IC8vIENyZWF0ZSB0aGUgcmVxdWVzdCBvYmplY3QKICAvLyAoVGhpcyBpcyBzdGlsbCBhdHRhY2hlZCB0byBhamF4U2V0dGluZ3MgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpCgoKICBqUXVlcnkuYWpheFNldHRpbmdzLnhociA9IHdpbmRvdy5BY3RpdmVYT2JqZWN0ID8KICAvKiBNaWNyb3NvZnQgZmFpbGVkIHRvIHByb3Blcmx5CiAgICogaW1wbGVtZW50IHRoZSBYTUxIdHRwUmVxdWVzdCBpbiBJRTcgKGNhbid0IHJlcXVlc3QgbG9jYWwgZmlsZXMpLAogICAqIHNvIHdlIHVzZSB0aGUgQWN0aXZlWE9iamVjdCB3aGVuIGl0IGlzIGF2YWlsYWJsZQogICAqIEFkZGl0aW9uYWxseSBYTUxIdHRwUmVxdWVzdCBjYW4gYmUgZGlzYWJsZWQgaW4gSUU3L0lFOCBzbwogICAqIHdlIG5lZWQgYSBmYWxsYmFjay4KICAgKi8KICBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gIXRoaXMuaXNMb2NhbCAmJiBjcmVhdGVTdGFuZGFyZFhIUigpIHx8IGNyZWF0ZUFjdGl2ZVhIUigpOwogIH0gOiAvLyBGb3IgYWxsIG90aGVyIGJyb3dzZXJzLCB1c2UgdGhlIHN0YW5kYXJkIFhNTEh0dHBSZXF1ZXN0IG9iamVjdAogIGNyZWF0ZVN0YW5kYXJkWEhSOyAvLyBEZXRlcm1pbmUgc3VwcG9ydCBwcm9wZXJ0aWVzCgogIChmdW5jdGlvbiAoeGhyKSB7CiAgICBqUXVlcnkuZXh0ZW5kKGpRdWVyeS5zdXBwb3J0LCB7CiAgICAgIGFqYXg6ICEheGhyLAogICAgICBjb3JzOiAhIXhociAmJiAid2l0aENyZWRlbnRpYWxzIiBpbiB4aHIKICAgIH0pOwogIH0pKGpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCkpOyAvLyBDcmVhdGUgdHJhbnNwb3J0IGlmIHRoZSBicm93c2VyIGNhbiBwcm92aWRlIGFuIHhocgoKCiAgaWYgKGpRdWVyeS5zdXBwb3J0LmFqYXgpIHsKICAgIGpRdWVyeS5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uIChzKSB7CiAgICAgIC8vIENyb3NzIGRvbWFpbiBvbmx5IGFsbG93ZWQgaWYgc3VwcG9ydGVkIHRocm91Z2ggWE1MSHR0cFJlcXVlc3QKICAgICAgaWYgKCFzLmNyb3NzRG9tYWluIHx8IGpRdWVyeS5zdXBwb3J0LmNvcnMpIHsKICAgICAgICB2YXIgX2NhbGxiYWNrOwoKICAgICAgICByZXR1cm4gewogICAgICAgICAgc2VuZDogZnVuY3Rpb24gc2VuZChoZWFkZXJzLCBjb21wbGV0ZSkgewogICAgICAgICAgICAvLyBHZXQgYSBuZXcgeGhyCiAgICAgICAgICAgIHZhciB4aHIgPSBzLnhocigpLAogICAgICAgICAgICAgICAgaGFuZGxlLAogICAgICAgICAgICAgICAgaTsgLy8gT3BlbiB0aGUgc29ja2V0CiAgICAgICAgICAgIC8vIFBhc3NpbmcgbnVsbCB1c2VybmFtZSwgZ2VuZXJhdGVzIGEgbG9naW4gcG9wdXAgb24gT3BlcmEgKCMyODY1KQoKICAgICAgICAgICAgaWYgKHMudXNlcm5hbWUpIHsKICAgICAgICAgICAgICB4aHIub3BlbihzLnR5cGUsIHMudXJsLCBzLmFzeW5jLCBzLnVzZXJuYW1lLCBzLnBhc3N3b3JkKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB4aHIub3BlbihzLnR5cGUsIHMudXJsLCBzLmFzeW5jKTsKICAgICAgICAgICAgfSAvLyBBcHBseSBjdXN0b20gZmllbGRzIGlmIHByb3ZpZGVkCgoKICAgICAgICAgICAgaWYgKHMueGhyRmllbGRzKSB7CiAgICAgICAgICAgICAgZm9yIChpIGluIHMueGhyRmllbGRzKSB7CiAgICAgICAgICAgICAgICB4aHJbaV0gPSBzLnhockZpZWxkc1tpXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gLy8gT3ZlcnJpZGUgbWltZSB0eXBlIGlmIG5lZWRlZAoKCiAgICAgICAgICAgIGlmIChzLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlKSB7CiAgICAgICAgICAgICAgeGhyLm92ZXJyaWRlTWltZVR5cGUocy5taW1lVHlwZSk7CiAgICAgICAgICAgIH0gLy8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXIKICAgICAgICAgICAgLy8gRm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cywgc2VlaW5nIGFzIGNvbmRpdGlvbnMgZm9yIGEgcHJlZmxpZ2h0IGFyZQogICAgICAgICAgICAvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLgogICAgICAgICAgICAvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cCkKICAgICAgICAgICAgLy8gRm9yIHNhbWUtZG9tYWluIHJlcXVlc3RzLCB3b24ndCBjaGFuZ2UgaGVhZGVyIGlmIGFscmVhZHkgcHJvdmlkZWQuCgoKICAgICAgICAgICAgaWYgKCFzLmNyb3NzRG9tYWluICYmICFoZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl0pIHsKICAgICAgICAgICAgICBoZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl0gPSAiWE1MSHR0cFJlcXVlc3QiOwogICAgICAgICAgICB9IC8vIE5lZWQgYW4gZXh0cmEgdHJ5L2NhdGNoIGZvciBjcm9zcyBkb21haW4gcmVxdWVzdHMgaW4gRmlyZWZveCAzCgoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmb3IgKGkgaW4gaGVhZGVycykgewogICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoaSwgaGVhZGVyc1tpXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChfKSB7fSAvLyBEbyBzZW5kIHRoZSByZXF1ZXN0CiAgICAgICAgICAgIC8vIFRoaXMgbWF5IHJhaXNlIGFuIGV4Y2VwdGlvbiB3aGljaCBpcyBhY3R1YWxseQogICAgICAgICAgICAvLyBoYW5kbGVkIGluIGpRdWVyeS5hamF4IChzbyBubyB0cnkvY2F0Y2ggaGVyZSkKCgogICAgICAgICAgICB4aHIuc2VuZChzLmhhc0NvbnRlbnQgJiYgcy5kYXRhIHx8IG51bGwpOyAvLyBMaXN0ZW5lcgoKICAgICAgICAgICAgX2NhbGxiYWNrID0gZnVuY3Rpb24gY2FsbGJhY2soXywgaXNBYm9ydCkgewogICAgICAgICAgICAgIHZhciBzdGF0dXMsIHN0YXR1c1RleHQsIHJlc3BvbnNlSGVhZGVycywgcmVzcG9uc2VzLCB4bWw7IC8vIEZpcmVmb3ggdGhyb3dzIGV4Y2VwdGlvbnMgd2hlbiBhY2Nlc3NpbmcgcHJvcGVydGllcwogICAgICAgICAgICAgIC8vIG9mIGFuIHhociB3aGVuIGEgbmV0d29yayBlcnJvciBvY2N1cmVkCiAgICAgICAgICAgICAgLy8gaHR0cDovL2hlbHBmdWwua25vYnMtZGlhbHMuY29tL2luZGV4LnBocC9Db21wb25lbnRfcmV0dXJuZWRfZmFpbHVyZV9jb2RlOl8weDgwMDQwMTExXyhOU19FUlJPUl9OT1RfQVZBSUxBQkxFKQoKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gV2FzIG5ldmVyIGNhbGxlZCBhbmQgaXMgYWJvcnRlZCBvciBjb21wbGV0ZQogICAgICAgICAgICAgICAgaWYgKF9jYWxsYmFjayAmJiAoaXNBYm9ydCB8fCB4aHIucmVhZHlTdGF0ZSA9PT0gNCkpIHsKICAgICAgICAgICAgICAgICAgLy8gT25seSBjYWxsZWQgb25jZQogICAgICAgICAgICAgICAgICBfY2FsbGJhY2sgPSB1bmRlZmluZWQ7IC8vIERvIG5vdCBrZWVwIGFzIGFjdGl2ZSBhbnltb3JlCgogICAgICAgICAgICAgICAgICBpZiAoaGFuZGxlKSB7CiAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGpRdWVyeS5ub29wOwoKICAgICAgICAgICAgICAgICAgICBpZiAoeGhyT25VbmxvYWRBYm9ydCkgewogICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHhockNhbGxiYWNrc1toYW5kbGVdOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSAvLyBJZiBpdCdzIGFuIGFib3J0CgoKICAgICAgICAgICAgICAgICAgaWYgKGlzQWJvcnQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBBYm9ydCBpdCBtYW51YWxseSBpZiBuZWVkZWQKICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgIT09IDQpIHsKICAgICAgICAgICAgICAgICAgICAgIHhoci5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSB4aHIuc3RhdHVzOwogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyA9IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTsKICAgICAgICAgICAgICAgICAgICByZXNwb25zZXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICB4bWwgPSB4aHIucmVzcG9uc2VYTUw7IC8vIENvbnN0cnVjdCByZXNwb25zZSBsaXN0CgogICAgICAgICAgICAgICAgICAgIGlmICh4bWwgJiYgeG1sLmRvY3VtZW50RWxlbWVudAogICAgICAgICAgICAgICAgICAgIC8qICM0OTU4ICovCiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlcy54bWwgPSB4bWw7CiAgICAgICAgICAgICAgICAgICAgICB9IC8vIFdoZW4gcmVxdWVzdGluZyBiaW5hcnkgZGF0YSwgSUU2LTkgd2lsbCB0aHJvdyBhbiBleGNlcHRpb24KICAgICAgICAgICAgICAgICAgICAvLyBvbiBhbnkgYXR0ZW1wdCB0byBhY2Nlc3MgcmVzcG9uc2VUZXh0ICgjMTE0MjYpCgoKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VzLnRleHQgPSB4aHIucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKF8pIHt9IC8vIEZpcmVmb3ggdGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZwogICAgICAgICAgICAgICAgICAgIC8vIHN0YXR1c1RleHQgZm9yIGZhdWx0eSBjcm9zcy1kb21haW4gcmVxdWVzdHMKCgogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0ID0geGhyLnN0YXR1c1RleHQ7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgICAgLy8gV2Ugbm9ybWFsaXplIHdpdGggV2Via2l0IGdpdmluZyBhbiBlbXB0eSBzdGF0dXNUZXh0CiAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgfSAvLyBGaWx0ZXIgc3RhdHVzIGZvciBub24gc3RhbmRhcmQgYmVoYXZpb3JzCiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3QgaXMgbG9jYWwgYW5kIHdlIGhhdmUgZGF0YTogYXNzdW1lIGEgc3VjY2VzcwogICAgICAgICAgICAgICAgICAgIC8vIChzdWNjZXNzIHdpdGggbm8gZGF0YSB3b24ndCBnZXQgbm90aWZpZWQsIHRoYXQncyB0aGUgYmVzdCB3ZQogICAgICAgICAgICAgICAgICAgIC8vIGNhbiBkbyBnaXZlbiBjdXJyZW50IGltcGxlbWVudGF0aW9ucykKCgogICAgICAgICAgICAgICAgICAgIGlmICghc3RhdHVzICYmIHMuaXNMb2NhbCAmJiAhcy5jcm9zc0RvbWFpbikgewogICAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gcmVzcG9uc2VzLnRleHQgPyAyMDAgOiA0MDQ7IC8vIElFIC0gIzE0NTA6IHNvbWV0aW1lcyByZXR1cm5zIDEyMjMgd2hlbiBpdCBzaG91bGQgYmUgMjA0CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09IDEyMjMpIHsKICAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IDIwNDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChmaXJlZm94QWNjZXNzRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICBpZiAoIWlzQWJvcnQpIHsKICAgICAgICAgICAgICAgICAgY29tcGxldGUoLTEsIGZpcmVmb3hBY2Nlc3NFeGNlcHRpb24pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gLy8gQ2FsbCBjb21wbGV0ZSBpZiBuZWVkZWQKCgogICAgICAgICAgICAgIGlmIChyZXNwb25zZXMpIHsKICAgICAgICAgICAgICAgIGNvbXBsZXRlKHN0YXR1cywgc3RhdHVzVGV4dCwgcmVzcG9uc2VzLCByZXNwb25zZUhlYWRlcnMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsgLy8gaWYgd2UncmUgaW4gc3luYyBtb2RlIG9yIGl0J3MgaW4gY2FjaGUKICAgICAgICAgICAgLy8gYW5kIGhhcyBiZWVuIHJldHJpZXZlZCBkaXJlY3RseSAoSUU2ICYgSUU3KQogICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIG1hbnVhbGx5IGZpcmUgdGhlIGNhbGxiYWNrCgoKICAgICAgICAgICAgaWYgKCFzLmFzeW5jIHx8IHhoci5yZWFkeVN0YXRlID09PSA0KSB7CiAgICAgICAgICAgICAgX2NhbGxiYWNrKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaGFuZGxlID0gKyt4aHJJZDsKCiAgICAgICAgICAgICAgaWYgKHhock9uVW5sb2FkQWJvcnQpIHsKICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgYWN0aXZlIHhocnMgY2FsbGJhY2tzIGxpc3QgaWYgbmVlZGVkCiAgICAgICAgICAgICAgICAvLyBhbmQgYXR0YWNoIHRoZSB1bmxvYWQgaGFuZGxlcgogICAgICAgICAgICAgICAgaWYgKCF4aHJDYWxsYmFja3MpIHsKICAgICAgICAgICAgICAgICAgeGhyQ2FsbGJhY2tzID0ge307CiAgICAgICAgICAgICAgICAgIGpRdWVyeSh3aW5kb3cpLnVubG9hZCh4aHJPblVubG9hZEFib3J0KTsKICAgICAgICAgICAgICAgIH0gLy8gQWRkIHRvIGxpc3Qgb2YgYWN0aXZlIHhocnMgY2FsbGJhY2tzCgoKICAgICAgICAgICAgICAgIHhockNhbGxiYWNrc1toYW5kbGVdID0gX2NhbGxiYWNrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IF9jYWxsYmFjazsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGFib3J0OiBmdW5jdGlvbiBhYm9ydCgpIHsKICAgICAgICAgICAgaWYgKF9jYWxsYmFjaykgewogICAgICAgICAgICAgIF9jYWxsYmFjaygwLCAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgIH0pOwogIH0KCiAgdmFyIGVsZW1kaXNwbGF5ID0ge30sCiAgICAgIGlmcmFtZSwKICAgICAgaWZyYW1lRG9jLAogICAgICByZnh0eXBlcyA9IC9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLywKICAgICAgcmZ4bnVtID0gL14oWytcLV09KT8oW1xkKy5cLV0rKShbYS16JV0qKSQvaSwKICAgICAgdGltZXJJZCwKICAgICAgZnhBdHRycyA9IFsvLyBoZWlnaHQgYW5pbWF0aW9ucwogIFsiaGVpZ2h0IiwgIm1hcmdpblRvcCIsICJtYXJnaW5Cb3R0b20iLCAicGFkZGluZ1RvcCIsICJwYWRkaW5nQm90dG9tIl0sIC8vIHdpZHRoIGFuaW1hdGlvbnMKICBbIndpZHRoIiwgIm1hcmdpbkxlZnQiLCAibWFyZ2luUmlnaHQiLCAicGFkZGluZ0xlZnQiLCAicGFkZGluZ1JpZ2h0Il0sIC8vIG9wYWNpdHkgYW5pbWF0aW9ucwogIFsib3BhY2l0eSJdXSwKICAgICAgZnhOb3c7CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBzaG93OiBmdW5jdGlvbiBzaG93KHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBlbGVtLCBkaXNwbGF5OwoKICAgICAgaWYgKHNwZWVkIHx8IHNwZWVkID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0ZShnZW5GeCgic2hvdyIsIDMpLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSB0aGlzLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgICAgZWxlbSA9IHRoaXNbaV07CgogICAgICAgICAgaWYgKGVsZW0uc3R5bGUpIHsKICAgICAgICAgICAgZGlzcGxheSA9IGVsZW0uc3R5bGUuZGlzcGxheTsgLy8gUmVzZXQgdGhlIGlubGluZSBkaXNwbGF5IG9mIHRoaXMgZWxlbWVudCB0byBsZWFybiBpZiBpdCBpcwogICAgICAgICAgICAvLyBiZWluZyBoaWRkZW4gYnkgY2FzY2FkZWQgcnVsZXMgb3Igbm90CgogICAgICAgICAgICBpZiAoIWpRdWVyeS5fZGF0YShlbGVtLCAib2xkZGlzcGxheSIpICYmIGRpc3BsYXkgPT09ICJub25lIikgewogICAgICAgICAgICAgIGRpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXkgPSAiIjsKICAgICAgICAgICAgfSAvLyBTZXQgZWxlbWVudHMgd2hpY2ggaGF2ZSBiZWVuIG92ZXJyaWRkZW4gd2l0aCBkaXNwbGF5OiBub25lCiAgICAgICAgICAgIC8vIGluIGEgc3R5bGVzaGVldCB0byB3aGF0ZXZlciB0aGUgZGVmYXVsdCBicm93c2VyIHN0eWxlIGlzCiAgICAgICAgICAgIC8vIGZvciBzdWNoIGFuIGVsZW1lbnQKCgogICAgICAgICAgICBpZiAoZGlzcGxheSA9PT0gIiIgJiYgalF1ZXJ5LmNzcyhlbGVtLCAiZGlzcGxheSIpID09PSAibm9uZSIgfHwgIWpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBlbGVtKSkgewogICAgICAgICAgICAgIGpRdWVyeS5fZGF0YShlbGVtLCAib2xkZGlzcGxheSIsIGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gLy8gU2V0IHRoZSBkaXNwbGF5IG9mIG1vc3Qgb2YgdGhlIGVsZW1lbnRzIGluIGEgc2Vjb25kIGxvb3AKICAgICAgICAvLyB0byBhdm9pZCB0aGUgY29uc3RhbnQgcmVmbG93CgoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgajsgaSsrKSB7CiAgICAgICAgICBlbGVtID0gdGhpc1tpXTsKCiAgICAgICAgICBpZiAoZWxlbS5zdHlsZSkgewogICAgICAgICAgICBkaXNwbGF5ID0gZWxlbS5zdHlsZS5kaXNwbGF5OwoKICAgICAgICAgICAgaWYgKGRpc3BsYXkgPT09ICIiIHx8IGRpc3BsYXkgPT09ICJub25lIikgewogICAgICAgICAgICAgIGVsZW0uc3R5bGUuZGlzcGxheSA9IGpRdWVyeS5fZGF0YShlbGVtLCAib2xkZGlzcGxheSIpIHx8ICIiOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfSwKICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoc3BlZWQsIGVhc2luZywgY2FsbGJhY2spIHsKICAgICAgaWYgKHNwZWVkIHx8IHNwZWVkID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0ZShnZW5GeCgiaGlkZSIsIDMpLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGVsZW0sCiAgICAgICAgICAgIGRpc3BsYXksCiAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICBqID0gdGhpcy5sZW5ndGg7CgogICAgICAgIGZvciAoOyBpIDwgajsgaSsrKSB7CiAgICAgICAgICBlbGVtID0gdGhpc1tpXTsKCiAgICAgICAgICBpZiAoZWxlbS5zdHlsZSkgewogICAgICAgICAgICBkaXNwbGF5ID0galF1ZXJ5LmNzcyhlbGVtLCAiZGlzcGxheSIpOwoKICAgICAgICAgICAgaWYgKGRpc3BsYXkgIT09ICJub25lIiAmJiAhalF1ZXJ5Ll9kYXRhKGVsZW0sICJvbGRkaXNwbGF5IikpIHsKICAgICAgICAgICAgICBqUXVlcnkuX2RhdGEoZWxlbSwgIm9sZGRpc3BsYXkiLCBkaXNwbGF5KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gLy8gU2V0IHRoZSBkaXNwbGF5IG9mIHRoZSBlbGVtZW50cyBpbiBhIHNlY29uZCBsb29wCiAgICAgICAgLy8gdG8gYXZvaWQgdGhlIGNvbnN0YW50IHJlZmxvdwoKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGo7IGkrKykgewogICAgICAgICAgaWYgKHRoaXNbaV0uc3R5bGUpIHsKICAgICAgICAgICAgdGhpc1tpXS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgIH0sCiAgICAvLyBTYXZlIHRoZSBvbGQgdG9nZ2xlIGZ1bmN0aW9uCiAgICBfdG9nZ2xlOiBqUXVlcnkuZm4udG9nZ2xlLAogICAgdG9nZ2xlOiBmdW5jdGlvbiB0b2dnbGUoZm4sIGZuMiwgY2FsbGJhY2spIHsKICAgICAgdmFyIGJvb2wgPSB0eXBlb2YgZm4gPT09ICJib29sZWFuIjsKCiAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihmbikgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oZm4yKSkgewogICAgICAgIHRoaXMuX3RvZ2dsZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9IGVsc2UgaWYgKGZuID09IG51bGwgfHwgYm9vbCkgewogICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgc3RhdGUgPSBib29sID8gZm4gOiBqUXVlcnkodGhpcykuaXMoIjpoaWRkZW4iKTsKICAgICAgICAgIGpRdWVyeSh0aGlzKVtzdGF0ZSA/ICJzaG93IiA6ICJoaWRlIl0oKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFuaW1hdGUoZ2VuRngoInRvZ2dsZSIsIDMpLCBmbiwgZm4yLCBjYWxsYmFjayk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGZhZGVUbzogZnVuY3Rpb24gZmFkZVRvKHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjaykgewogICAgICByZXR1cm4gdGhpcy5maWx0ZXIoIjpoaWRkZW4iKS5jc3MoIm9wYWNpdHkiLCAwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7CiAgICAgICAgb3BhY2l0eTogdG8KICAgICAgfSwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2spOwogICAgfSwKICAgIGFuaW1hdGU6IGZ1bmN0aW9uIGFuaW1hdGUocHJvcCwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2spIHsKICAgICAgdmFyIG9wdGFsbCA9IGpRdWVyeS5zcGVlZChzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayk7CgogICAgICBpZiAoalF1ZXJ5LmlzRW1wdHlPYmplY3QocHJvcCkpIHsKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKG9wdGFsbC5jb21wbGV0ZSwgW2ZhbHNlXSk7CiAgICAgIH0gLy8gRG8gbm90IGNoYW5nZSByZWZlcmVuY2VkIHByb3BlcnRpZXMgYXMgcGVyLXByb3BlcnR5IGVhc2luZyB3aWxsIGJlIGxvc3QKCgogICAgICBwcm9wID0galF1ZXJ5LmV4dGVuZCh7fSwgcHJvcCk7CgogICAgICBmdW5jdGlvbiBkb0FuaW1hdGlvbigpIHsKICAgICAgICAvLyBYWFggJ3RoaXMnIGRvZXMgbm90IGFsd2F5cyBoYXZlIGEgbm9kZU5hbWUgd2hlbiBydW5uaW5nIHRoZQogICAgICAgIC8vIHRlc3Qgc3VpdGUKICAgICAgICBpZiAob3B0YWxsLnF1ZXVlID09PSBmYWxzZSkgewogICAgICAgICAgalF1ZXJ5Ll9tYXJrKHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgdmFyIG9wdCA9IGpRdWVyeS5leHRlbmQoe30sIG9wdGFsbCksCiAgICAgICAgICAgIGlzRWxlbWVudCA9IHRoaXMubm9kZVR5cGUgPT09IDEsCiAgICAgICAgICAgIGhpZGRlbiA9IGlzRWxlbWVudCAmJiBqUXVlcnkodGhpcykuaXMoIjpoaWRkZW4iKSwKICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgdmFsLAogICAgICAgICAgICBwLAogICAgICAgICAgICBlLAogICAgICAgICAgICBob29rcywKICAgICAgICAgICAgcmVwbGFjZSwKICAgICAgICAgICAgcGFydHMsCiAgICAgICAgICAgIHN0YXJ0LAogICAgICAgICAgICBlbmQsCiAgICAgICAgICAgIHVuaXQsCiAgICAgICAgICAgIG1ldGhvZDsgLy8gd2lsbCBzdG9yZSBwZXIgcHJvcGVydHkgZWFzaW5nIGFuZCBiZSB1c2VkIHRvIGRldGVybWluZSB3aGVuIGFuIGFuaW1hdGlvbiBpcyBjb21wbGV0ZQoKICAgICAgICBvcHQuYW5pbWF0ZWRQcm9wZXJ0aWVzID0ge307IC8vIGZpcnN0IHBhc3Mgb3ZlciBwcm9wZXJ0eXMgdG8gZXhwYW5kIC8gbm9ybWFsaXplCgogICAgICAgIGZvciAocCBpbiBwcm9wKSB7CiAgICAgICAgICBuYW1lID0galF1ZXJ5LmNhbWVsQ2FzZShwKTsKCiAgICAgICAgICBpZiAocCAhPT0gbmFtZSkgewogICAgICAgICAgICBwcm9wW25hbWVdID0gcHJvcFtwXTsKICAgICAgICAgICAgZGVsZXRlIHByb3BbcF07CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKChob29rcyA9IGpRdWVyeS5jc3NIb29rc1tuYW1lXSkgJiYgImV4cGFuZCIgaW4gaG9va3MpIHsKICAgICAgICAgICAgcmVwbGFjZSA9IGhvb2tzLmV4cGFuZChwcm9wW25hbWVdKTsKICAgICAgICAgICAgZGVsZXRlIHByb3BbbmFtZV07IC8vIG5vdCBxdWl0ZSAkLmV4dGVuZCwgdGhpcyB3b250IG92ZXJ3cml0ZSBrZXlzIGFscmVhZHkgcHJlc2VudC4KICAgICAgICAgICAgLy8gYWxzbyAtIHJldXNpbmcgJ3AnIGZyb20gYWJvdmUgYmVjYXVzZSB3ZSBoYXZlIHRoZSBjb3JyZWN0ICJuYW1lIgoKICAgICAgICAgICAgZm9yIChwIGluIHJlcGxhY2UpIHsKICAgICAgICAgICAgICBpZiAoIShwIGluIHByb3ApKSB7CiAgICAgICAgICAgICAgICBwcm9wW3BdID0gcmVwbGFjZVtwXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZvciAobmFtZSBpbiBwcm9wKSB7CiAgICAgICAgICB2YWwgPSBwcm9wW25hbWVdOyAvLyBlYXNpbmcgcmVzb2x1dGlvbjogcGVyIHByb3BlcnR5ID4gb3B0LnNwZWNpYWxFYXNpbmcgPiBvcHQuZWFzaW5nID4gJ3N3aW5nJyAoZGVmYXVsdCkKCiAgICAgICAgICBpZiAoalF1ZXJ5LmlzQXJyYXkodmFsKSkgewogICAgICAgICAgICBvcHQuYW5pbWF0ZWRQcm9wZXJ0aWVzW25hbWVdID0gdmFsWzFdOwogICAgICAgICAgICB2YWwgPSBwcm9wW25hbWVdID0gdmFsWzBdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb3B0LmFuaW1hdGVkUHJvcGVydGllc1tuYW1lXSA9IG9wdC5zcGVjaWFsRWFzaW5nICYmIG9wdC5zcGVjaWFsRWFzaW5nW25hbWVdIHx8IG9wdC5lYXNpbmcgfHwgJ3N3aW5nJzsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodmFsID09PSAiaGlkZSIgJiYgaGlkZGVuIHx8IHZhbCA9PT0gInNob3ciICYmICFoaWRkZW4pIHsKICAgICAgICAgICAgcmV0dXJuIG9wdC5jb21wbGV0ZS5jYWxsKHRoaXMpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChpc0VsZW1lbnQgJiYgKG5hbWUgPT09ICJoZWlnaHQiIHx8IG5hbWUgPT09ICJ3aWR0aCIpKSB7CiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IG5vdGhpbmcgc25lYWtzIG91dAogICAgICAgICAgICAvLyBSZWNvcmQgYWxsIDMgb3ZlcmZsb3cgYXR0cmlidXRlcyBiZWNhdXNlIElFIGRvZXMgbm90CiAgICAgICAgICAgIC8vIGNoYW5nZSB0aGUgb3ZlcmZsb3cgYXR0cmlidXRlIHdoZW4gb3ZlcmZsb3dYIGFuZAogICAgICAgICAgICAvLyBvdmVyZmxvd1kgYXJlIHNldCB0byB0aGUgc2FtZSB2YWx1ZQogICAgICAgICAgICBvcHQub3ZlcmZsb3cgPSBbdGhpcy5zdHlsZS5vdmVyZmxvdywgdGhpcy5zdHlsZS5vdmVyZmxvd1gsIHRoaXMuc3R5bGUub3ZlcmZsb3dZXTsgLy8gU2V0IGRpc3BsYXkgcHJvcGVydHkgdG8gaW5saW5lLWJsb2NrIGZvciBoZWlnaHQvd2lkdGgKICAgICAgICAgICAgLy8gYW5pbWF0aW9ucyBvbiBpbmxpbmUgZWxlbWVudHMgdGhhdCBhcmUgaGF2aW5nIHdpZHRoL2hlaWdodCBhbmltYXRlZAoKICAgICAgICAgICAgaWYgKGpRdWVyeS5jc3ModGhpcywgImRpc3BsYXkiKSA9PT0gImlubGluZSIgJiYgalF1ZXJ5LmNzcyh0aGlzLCAiZmxvYXQiKSA9PT0gIm5vbmUiKSB7CiAgICAgICAgICAgICAgLy8gaW5saW5lLWxldmVsIGVsZW1lbnRzIGFjY2VwdCBpbmxpbmUtYmxvY2s7CiAgICAgICAgICAgICAgLy8gYmxvY2stbGV2ZWwgZWxlbWVudHMgbmVlZCB0byBiZSBpbmxpbmUgd2l0aCBsYXlvdXQKICAgICAgICAgICAgICBpZiAoIWpRdWVyeS5zdXBwb3J0LmlubGluZUJsb2NrTmVlZHNMYXlvdXQgfHwgZGVmYXVsdERpc3BsYXkodGhpcy5ub2RlTmFtZSkgPT09ICJpbmxpbmUiKSB7CiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5zdHlsZS56b29tID0gMTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChvcHQub3ZlcmZsb3cgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIH0KCiAgICAgICAgZm9yIChwIGluIHByb3ApIHsKICAgICAgICAgIGUgPSBuZXcgalF1ZXJ5LmZ4KHRoaXMsIG9wdCwgcCk7CiAgICAgICAgICB2YWwgPSBwcm9wW3BdOwoKICAgICAgICAgIGlmIChyZnh0eXBlcy50ZXN0KHZhbCkpIHsKICAgICAgICAgICAgLy8gVHJhY2tzIHdoZXRoZXIgdG8gc2hvdyBvciBoaWRlIGJhc2VkIG9uIHByaXZhdGUKICAgICAgICAgICAgLy8gZGF0YSBhdHRhY2hlZCB0byB0aGUgZWxlbWVudAogICAgICAgICAgICBtZXRob2QgPSBqUXVlcnkuX2RhdGEodGhpcywgInRvZ2dsZSIgKyBwKSB8fCAodmFsID09PSAidG9nZ2xlIiA/IGhpZGRlbiA/ICJzaG93IiA6ICJoaWRlIiA6IDApOwoKICAgICAgICAgICAgaWYgKG1ldGhvZCkgewogICAgICAgICAgICAgIGpRdWVyeS5fZGF0YSh0aGlzLCAidG9nZ2xlIiArIHAsIG1ldGhvZCA9PT0gInNob3ciID8gImhpZGUiIDogInNob3ciKTsKCiAgICAgICAgICAgICAgZVttZXRob2RdKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZVt2YWxdKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBhcnRzID0gcmZ4bnVtLmV4ZWModmFsKTsKICAgICAgICAgICAgc3RhcnQgPSBlLmN1cigpOwoKICAgICAgICAgICAgaWYgKHBhcnRzKSB7CiAgICAgICAgICAgICAgZW5kID0gcGFyc2VGbG9hdChwYXJ0c1syXSk7CiAgICAgICAgICAgICAgdW5pdCA9IHBhcnRzWzNdIHx8IChqUXVlcnkuY3NzTnVtYmVyW3BdID8gIiIgOiAicHgiKTsgLy8gV2UgbmVlZCB0byBjb21wdXRlIHN0YXJ0aW5nIHZhbHVlCgogICAgICAgICAgICAgIGlmICh1bml0ICE9PSAicHgiKSB7CiAgICAgICAgICAgICAgICBqUXVlcnkuc3R5bGUodGhpcywgcCwgKGVuZCB8fCAxKSArIHVuaXQpOwogICAgICAgICAgICAgICAgc3RhcnQgPSAoZW5kIHx8IDEpIC8gZS5jdXIoKSAqIHN0YXJ0OwogICAgICAgICAgICAgICAgalF1ZXJ5LnN0eWxlKHRoaXMsIHAsIHN0YXJ0ICsgdW5pdCk7CiAgICAgICAgICAgICAgfSAvLyBJZiBhICs9Ly09IHRva2VuIHdhcyBwcm92aWRlZCwgd2UncmUgZG9pbmcgYSByZWxhdGl2ZSBhbmltYXRpb24KCgogICAgICAgICAgICAgIGlmIChwYXJ0c1sxXSkgewogICAgICAgICAgICAgICAgZW5kID0gKHBhcnRzWzFdID09PSAiLT0iID8gLTEgOiAxKSAqIGVuZCArIHN0YXJ0OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZS5jdXN0b20oc3RhcnQsIGVuZCwgdW5pdCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZS5jdXN0b20oc3RhcnQsIHZhbCwgIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBGb3IgSlMgc3RyaWN0IGNvbXBsaWFuY2UKCgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gb3B0YWxsLnF1ZXVlID09PSBmYWxzZSA/IHRoaXMuZWFjaChkb0FuaW1hdGlvbikgOiB0aGlzLnF1ZXVlKG9wdGFsbC5xdWV1ZSwgZG9BbmltYXRpb24pOwogICAgfSwKICAgIHN0b3A6IGZ1bmN0aW9uIHN0b3AodHlwZSwgY2xlYXJRdWV1ZSwgZ290b0VuZCkgewogICAgICBpZiAodHlwZW9mIHR5cGUgIT09ICJzdHJpbmciKSB7CiAgICAgICAgZ290b0VuZCA9IGNsZWFyUXVldWU7CiAgICAgICAgY2xlYXJRdWV1ZSA9IHR5cGU7CiAgICAgICAgdHlwZSA9IHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgaWYgKGNsZWFyUXVldWUgJiYgdHlwZSAhPT0gZmFsc2UpIHsKICAgICAgICB0aGlzLnF1ZXVlKHR5cGUgfHwgImZ4IiwgW10pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgaW5kZXgsCiAgICAgICAgICAgIGhhZFRpbWVycyA9IGZhbHNlLAogICAgICAgICAgICB0aW1lcnMgPSBqUXVlcnkudGltZXJzLAogICAgICAgICAgICBkYXRhID0galF1ZXJ5Ll9kYXRhKHRoaXMpOyAvLyBjbGVhciBtYXJrZXIgY291bnRlcnMgaWYgd2Uga25vdyB0aGV5IHdvbid0IGJlCgoKICAgICAgICBpZiAoIWdvdG9FbmQpIHsKICAgICAgICAgIGpRdWVyeS5fdW5tYXJrKHRydWUsIHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gc3RvcFF1ZXVlKGVsZW0sIGRhdGEsIGluZGV4KSB7CiAgICAgICAgICB2YXIgaG9va3MgPSBkYXRhW2luZGV4XTsKICAgICAgICAgIGpRdWVyeS5yZW1vdmVEYXRhKGVsZW0sIGluZGV4LCB0cnVlKTsKICAgICAgICAgIGhvb2tzLnN0b3AoZ290b0VuZCk7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZSA9PSBudWxsKSB7CiAgICAgICAgICBmb3IgKGluZGV4IGluIGRhdGEpIHsKICAgICAgICAgICAgaWYgKGRhdGFbaW5kZXhdICYmIGRhdGFbaW5kZXhdLnN0b3AgJiYgaW5kZXguaW5kZXhPZigiLnJ1biIpID09PSBpbmRleC5sZW5ndGggLSA0KSB7CiAgICAgICAgICAgICAgc3RvcFF1ZXVlKHRoaXMsIGRhdGEsIGluZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZGF0YVtpbmRleCA9IHR5cGUgKyAiLnJ1biJdICYmIGRhdGFbaW5kZXhdLnN0b3ApIHsKICAgICAgICAgIHN0b3BRdWV1ZSh0aGlzLCBkYXRhLCBpbmRleCk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGluZGV4ID0gdGltZXJzLmxlbmd0aDsgaW5kZXgtLTspIHsKICAgICAgICAgIGlmICh0aW1lcnNbaW5kZXhdLmVsZW0gPT09IHRoaXMgJiYgKHR5cGUgPT0gbnVsbCB8fCB0aW1lcnNbaW5kZXhdLnF1ZXVlID09PSB0eXBlKSkgewogICAgICAgICAgICBpZiAoZ290b0VuZCkgewogICAgICAgICAgICAgIC8vIGZvcmNlIHRoZSBuZXh0IHN0ZXAgdG8gYmUgdGhlIGxhc3QKICAgICAgICAgICAgICB0aW1lcnNbaW5kZXhdKHRydWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRpbWVyc1tpbmRleF0uc2F2ZVN0YXRlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhZFRpbWVycyA9IHRydWU7CiAgICAgICAgICAgIHRpbWVycy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgfQogICAgICAgIH0gLy8gc3RhcnQgdGhlIG5leHQgaW4gdGhlIHF1ZXVlIGlmIHRoZSBsYXN0IHN0ZXAgd2Fzbid0IGZvcmNlZAogICAgICAgIC8vIHRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2ggd2lsbCBkZXF1ZXVlCiAgICAgICAgLy8gYnV0IG9ubHkgaWYgdGhleSB3ZXJlIGdvdG9FbmQKCgogICAgICAgIGlmICghKGdvdG9FbmQgJiYgaGFkVGltZXJzKSkgewogICAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9KTsgLy8gQW5pbWF0aW9ucyBjcmVhdGVkIHN5bmNocm9ub3VzbHkgd2lsbCBydW4gc3luY2hyb25vdXNseQoKICBmdW5jdGlvbiBjcmVhdGVGeE5vdygpIHsKICAgIHNldFRpbWVvdXQoY2xlYXJGeE5vdywgMCk7CiAgICByZXR1cm4gZnhOb3cgPSBqUXVlcnkubm93KCk7CiAgfQoKICBmdW5jdGlvbiBjbGVhckZ4Tm93KCkgewogICAgZnhOb3cgPSB1bmRlZmluZWQ7CiAgfSAvLyBHZW5lcmF0ZSBwYXJhbWV0ZXJzIHRvIGNyZWF0ZSBhIHN0YW5kYXJkIGFuaW1hdGlvbgoKCiAgZnVuY3Rpb24gZ2VuRngodHlwZSwgbnVtKSB7CiAgICB2YXIgb2JqID0ge307CiAgICBqUXVlcnkuZWFjaChmeEF0dHJzLmNvbmNhdC5hcHBseShbXSwgZnhBdHRycy5zbGljZSgwLCBudW0pKSwgZnVuY3Rpb24gKCkgewogICAgICBvYmpbdGhpc10gPSB0eXBlOwogICAgfSk7CiAgICByZXR1cm4gb2JqOwogIH0gLy8gR2VuZXJhdGUgc2hvcnRjdXRzIGZvciBjdXN0b20gYW5pbWF0aW9ucwoKCiAgalF1ZXJ5LmVhY2goewogICAgc2xpZGVEb3duOiBnZW5GeCgic2hvdyIsIDEpLAogICAgc2xpZGVVcDogZ2VuRngoImhpZGUiLCAxKSwKICAgIHNsaWRlVG9nZ2xlOiBnZW5GeCgidG9nZ2xlIiwgMSksCiAgICBmYWRlSW46IHsKICAgICAgb3BhY2l0eTogInNob3ciCiAgICB9LAogICAgZmFkZU91dDogewogICAgICBvcGFjaXR5OiAiaGlkZSIKICAgIH0sCiAgICBmYWRlVG9nZ2xlOiB7CiAgICAgIG9wYWNpdHk6ICJ0b2dnbGUiCiAgICB9CiAgfSwgZnVuY3Rpb24gKG5hbWUsIHByb3BzKSB7CiAgICBqUXVlcnkuZm5bbmFtZV0gPSBmdW5jdGlvbiAoc3BlZWQsIGVhc2luZywgY2FsbGJhY2spIHsKICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0ZShwcm9wcywgc3BlZWQsIGVhc2luZywgY2FsbGJhY2spOwogICAgfTsKICB9KTsKICBqUXVlcnkuZXh0ZW5kKHsKICAgIHNwZWVkOiBmdW5jdGlvbiBzcGVlZChfc3BlZWQsIGVhc2luZywgZm4pIHsKICAgICAgdmFyIG9wdCA9IF9zcGVlZCAmJiBfdHlwZW9mKF9zcGVlZCkgPT09ICJvYmplY3QiID8galF1ZXJ5LmV4dGVuZCh7fSwgX3NwZWVkKSA6IHsKICAgICAgICBjb21wbGV0ZTogZm4gfHwgIWZuICYmIGVhc2luZyB8fCBqUXVlcnkuaXNGdW5jdGlvbihfc3BlZWQpICYmIF9zcGVlZCwKICAgICAgICBkdXJhdGlvbjogX3NwZWVkLAogICAgICAgIGVhc2luZzogZm4gJiYgZWFzaW5nIHx8IGVhc2luZyAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24oZWFzaW5nKSAmJiBlYXNpbmcKICAgICAgfTsKICAgICAgb3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4Lm9mZiA/IDAgOiB0eXBlb2Ygb3B0LmR1cmF0aW9uID09PSAibnVtYmVyIiA/IG9wdC5kdXJhdGlvbiA6IG9wdC5kdXJhdGlvbiBpbiBqUXVlcnkuZnguc3BlZWRzID8galF1ZXJ5LmZ4LnNwZWVkc1tvcHQuZHVyYXRpb25dIDogalF1ZXJ5LmZ4LnNwZWVkcy5fZGVmYXVsdDsgLy8gbm9ybWFsaXplIG9wdC5xdWV1ZSAtIHRydWUvdW5kZWZpbmVkL251bGwgLT4gImZ4IgoKICAgICAgaWYgKG9wdC5xdWV1ZSA9PSBudWxsIHx8IG9wdC5xdWV1ZSA9PT0gdHJ1ZSkgewogICAgICAgIG9wdC5xdWV1ZSA9ICJmeCI7CiAgICAgIH0gLy8gUXVldWVpbmcKCgogICAgICBvcHQub2xkID0gb3B0LmNvbXBsZXRlOwoKICAgICAgb3B0LmNvbXBsZXRlID0gZnVuY3Rpb24gKG5vVW5tYXJrKSB7CiAgICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKG9wdC5vbGQpKSB7CiAgICAgICAgICBvcHQub2xkLmNhbGwodGhpcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAob3B0LnF1ZXVlKSB7CiAgICAgICAgICBqUXVlcnkuZGVxdWV1ZSh0aGlzLCBvcHQucXVldWUpOwogICAgICAgIH0gZWxzZSBpZiAobm9Vbm1hcmsgIT09IGZhbHNlKSB7CiAgICAgICAgICBqUXVlcnkuX3VubWFyayh0aGlzKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICByZXR1cm4gb3B0OwogICAgfSwKICAgIGVhc2luZzogewogICAgICBsaW5lYXI6IGZ1bmN0aW9uIGxpbmVhcihwKSB7CiAgICAgICAgcmV0dXJuIHA7CiAgICAgIH0sCiAgICAgIHN3aW5nOiBmdW5jdGlvbiBzd2luZyhwKSB7CiAgICAgICAgcmV0dXJuIC1NYXRoLmNvcyhwICogTWF0aC5QSSkgLyAyICsgMC41OwogICAgICB9CiAgICB9LAogICAgdGltZXJzOiBbXSwKICAgIGZ4OiBmdW5jdGlvbiBmeChlbGVtLCBvcHRpb25zLCBwcm9wKSB7CiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgICAgIHRoaXMuZWxlbSA9IGVsZW07CiAgICAgIHRoaXMucHJvcCA9IHByb3A7CiAgICAgIG9wdGlvbnMub3JpZyA9IG9wdGlvbnMub3JpZyB8fCB7fTsKICAgIH0KICB9KTsKICBqUXVlcnkuZngucHJvdG90eXBlID0gewogICAgLy8gU2ltcGxlIGZ1bmN0aW9uIGZvciBzZXR0aW5nIGEgc3R5bGUgdmFsdWUKICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKCkgewogICAgICBpZiAodGhpcy5vcHRpb25zLnN0ZXApIHsKICAgICAgICB0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMpOwogICAgICB9CgogICAgICAoalF1ZXJ5LmZ4LnN0ZXBbdGhpcy5wcm9wXSB8fCBqUXVlcnkuZnguc3RlcC5fZGVmYXVsdCkodGhpcyk7CiAgICB9LAogICAgLy8gR2V0IHRoZSBjdXJyZW50IHNpemUKICAgIGN1cjogZnVuY3Rpb24gY3VyKCkgewogICAgICBpZiAodGhpcy5lbGVtW3RoaXMucHJvcF0gIT0gbnVsbCAmJiAoIXRoaXMuZWxlbS5zdHlsZSB8fCB0aGlzLmVsZW0uc3R5bGVbdGhpcy5wcm9wXSA9PSBudWxsKSkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1bdGhpcy5wcm9wXTsKICAgICAgfQoKICAgICAgdmFyIHBhcnNlZCwKICAgICAgICAgIHIgPSBqUXVlcnkuY3NzKHRoaXMuZWxlbSwgdGhpcy5wcm9wKTsgLy8gRW1wdHkgc3RyaW5ncywgbnVsbCwgdW5kZWZpbmVkIGFuZCAiYXV0byIgYXJlIGNvbnZlcnRlZCB0byAwLAogICAgICAvLyBjb21wbGV4IHZhbHVlcyBzdWNoIGFzICJyb3RhdGUoMXJhZCkiIGFyZSByZXR1cm5lZCBhcyBpcywKICAgICAgLy8gc2ltcGxlIHZhbHVlcyBzdWNoIGFzICIxMHB4IiBhcmUgcGFyc2VkIHRvIEZsb2F0LgoKICAgICAgcmV0dXJuIGlzTmFOKHBhcnNlZCA9IHBhcnNlRmxvYXQocikpID8gIXIgfHwgciA9PT0gImF1dG8iID8gMCA6IHIgOiBwYXJzZWQ7CiAgICB9LAogICAgLy8gU3RhcnQgYW4gYW5pbWF0aW9uIGZyb20gb25lIG51bWJlciB0byBhbm90aGVyCiAgICBjdXN0b206IGZ1bmN0aW9uIGN1c3RvbShmcm9tLCB0bywgdW5pdCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgICBmeCA9IGpRdWVyeS5meDsKICAgICAgdGhpcy5zdGFydFRpbWUgPSBmeE5vdyB8fCBjcmVhdGVGeE5vdygpOwogICAgICB0aGlzLmVuZCA9IHRvOwogICAgICB0aGlzLm5vdyA9IHRoaXMuc3RhcnQgPSBmcm9tOwogICAgICB0aGlzLnBvcyA9IHRoaXMuc3RhdGUgPSAwOwogICAgICB0aGlzLnVuaXQgPSB1bml0IHx8IHRoaXMudW5pdCB8fCAoalF1ZXJ5LmNzc051bWJlclt0aGlzLnByb3BdID8gIiIgOiAicHgiKTsKCiAgICAgIGZ1bmN0aW9uIHQoZ290b0VuZCkgewogICAgICAgIHJldHVybiBzZWxmLnN0ZXAoZ290b0VuZCk7CiAgICAgIH0KCiAgICAgIHQucXVldWUgPSB0aGlzLm9wdGlvbnMucXVldWU7CiAgICAgIHQuZWxlbSA9IHRoaXMuZWxlbTsKCiAgICAgIHQuc2F2ZVN0YXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChqUXVlcnkuX2RhdGEoc2VsZi5lbGVtLCAiZnhzaG93IiArIHNlbGYucHJvcCkgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5oaWRlKSB7CiAgICAgICAgICAgIGpRdWVyeS5fZGF0YShzZWxmLmVsZW0sICJmeHNob3ciICsgc2VsZi5wcm9wLCBzZWxmLnN0YXJ0KTsKICAgICAgICAgIH0gZWxzZSBpZiAoc2VsZi5vcHRpb25zLnNob3cpIHsKICAgICAgICAgICAgalF1ZXJ5Ll9kYXRhKHNlbGYuZWxlbSwgImZ4c2hvdyIgKyBzZWxmLnByb3AsIHNlbGYuZW5kKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAodCgpICYmIGpRdWVyeS50aW1lcnMucHVzaCh0KSAmJiAhdGltZXJJZCkgewogICAgICAgIHRpbWVySWQgPSBzZXRJbnRlcnZhbChmeC50aWNrLCBmeC5pbnRlcnZhbCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBTaW1wbGUgJ3Nob3cnIGZ1bmN0aW9uCiAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkgewogICAgICB2YXIgZGF0YVNob3cgPSBqUXVlcnkuX2RhdGEodGhpcy5lbGVtLCAiZnhzaG93IiArIHRoaXMucHJvcCk7IC8vIFJlbWVtYmVyIHdoZXJlIHdlIHN0YXJ0ZWQsIHNvIHRoYXQgd2UgY2FuIGdvIGJhY2sgdG8gaXQgbGF0ZXIKCgogICAgICB0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdID0gZGF0YVNob3cgfHwgalF1ZXJ5LnN0eWxlKHRoaXMuZWxlbSwgdGhpcy5wcm9wKTsKICAgICAgdGhpcy5vcHRpb25zLnNob3cgPSB0cnVlOyAvLyBCZWdpbiB0aGUgYW5pbWF0aW9uCiAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHdlIHN0YXJ0IGF0IGEgc21hbGwgd2lkdGgvaGVpZ2h0IHRvIGF2b2lkIGFueSBmbGFzaCBvZiBjb250ZW50CgogICAgICBpZiAoZGF0YVNob3cgIT09IHVuZGVmaW5lZCkgewogICAgICAgIC8vIFRoaXMgc2hvdyBpcyBwaWNraW5nIHVwIHdoZXJlIGEgcHJldmlvdXMgaGlkZSBvciBzaG93IGxlZnQgb2ZmCiAgICAgICAgdGhpcy5jdXN0b20odGhpcy5jdXIoKSwgZGF0YVNob3cpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY3VzdG9tKHRoaXMucHJvcCA9PT0gIndpZHRoIiB8fCB0aGlzLnByb3AgPT09ICJoZWlnaHQiID8gMSA6IDAsIHRoaXMuY3VyKCkpOwogICAgICB9IC8vIFN0YXJ0IGJ5IHNob3dpbmcgdGhlIGVsZW1lbnQKCgogICAgICBqUXVlcnkodGhpcy5lbGVtKS5zaG93KCk7CiAgICB9LAogICAgLy8gU2ltcGxlICdoaWRlJyBmdW5jdGlvbgogICAgaGlkZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgLy8gUmVtZW1iZXIgd2hlcmUgd2Ugc3RhcnRlZCwgc28gdGhhdCB3ZSBjYW4gZ28gYmFjayB0byBpdCBsYXRlcgogICAgICB0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdID0galF1ZXJ5Ll9kYXRhKHRoaXMuZWxlbSwgImZ4c2hvdyIgKyB0aGlzLnByb3ApIHx8IGpRdWVyeS5zdHlsZSh0aGlzLmVsZW0sIHRoaXMucHJvcCk7CiAgICAgIHRoaXMub3B0aW9ucy5oaWRlID0gdHJ1ZTsgLy8gQmVnaW4gdGhlIGFuaW1hdGlvbgoKICAgICAgdGhpcy5jdXN0b20odGhpcy5jdXIoKSwgMCk7CiAgICB9LAogICAgLy8gRWFjaCBzdGVwIG9mIGFuIGFuaW1hdGlvbgogICAgc3RlcDogZnVuY3Rpb24gc3RlcChnb3RvRW5kKSB7CiAgICAgIHZhciBwLAogICAgICAgICAgbiwKICAgICAgICAgIGNvbXBsZXRlLAogICAgICAgICAgdCA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksCiAgICAgICAgICBkb25lID0gdHJ1ZSwKICAgICAgICAgIGVsZW0gPSB0aGlzLmVsZW0sCiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zOwoKICAgICAgaWYgKGdvdG9FbmQgfHwgdCA+PSBvcHRpb25zLmR1cmF0aW9uICsgdGhpcy5zdGFydFRpbWUpIHsKICAgICAgICB0aGlzLm5vdyA9IHRoaXMuZW5kOwogICAgICAgIHRoaXMucG9zID0gdGhpcy5zdGF0ZSA9IDE7CiAgICAgICAgdGhpcy51cGRhdGUoKTsKICAgICAgICBvcHRpb25zLmFuaW1hdGVkUHJvcGVydGllc1t0aGlzLnByb3BdID0gdHJ1ZTsKCiAgICAgICAgZm9yIChwIGluIG9wdGlvbnMuYW5pbWF0ZWRQcm9wZXJ0aWVzKSB7CiAgICAgICAgICBpZiAob3B0aW9ucy5hbmltYXRlZFByb3BlcnRpZXNbcF0gIT09IHRydWUpIHsKICAgICAgICAgICAgZG9uZSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGRvbmUpIHsKICAgICAgICAgIC8vIFJlc2V0IHRoZSBvdmVyZmxvdwogICAgICAgICAgaWYgKG9wdGlvbnMub3ZlcmZsb3cgIT0gbnVsbCAmJiAhalF1ZXJ5LnN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcykgewogICAgICAgICAgICBqUXVlcnkuZWFjaChbIiIsICJYIiwgIlkiXSwgZnVuY3Rpb24gKGluZGV4LCB2YWx1ZSkgewogICAgICAgICAgICAgIGVsZW0uc3R5bGVbIm92ZXJmbG93IiArIHZhbHVlXSA9IG9wdGlvbnMub3ZlcmZsb3dbaW5kZXhdOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gLy8gSGlkZSB0aGUgZWxlbWVudCBpZiB0aGUgImhpZGUiIG9wZXJhdGlvbiB3YXMgZG9uZQoKCiAgICAgICAgICBpZiAob3B0aW9ucy5oaWRlKSB7CiAgICAgICAgICAgIGpRdWVyeShlbGVtKS5oaWRlKCk7CiAgICAgICAgICB9IC8vIFJlc2V0IHRoZSBwcm9wZXJ0aWVzLCBpZiB0aGUgaXRlbSBoYXMgYmVlbiBoaWRkZW4gb3Igc2hvd24KCgogICAgICAgICAgaWYgKG9wdGlvbnMuaGlkZSB8fCBvcHRpb25zLnNob3cpIHsKICAgICAgICAgICAgZm9yIChwIGluIG9wdGlvbnMuYW5pbWF0ZWRQcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgICAgalF1ZXJ5LnN0eWxlKGVsZW0sIHAsIG9wdGlvbnMub3JpZ1twXSk7CiAgICAgICAgICAgICAgalF1ZXJ5LnJlbW92ZURhdGEoZWxlbSwgImZ4c2hvdyIgKyBwLCB0cnVlKTsgLy8gVG9nZ2xlIGRhdGEgaXMgbm8gbG9uZ2VyIG5lZWRlZAoKICAgICAgICAgICAgICBqUXVlcnkucmVtb3ZlRGF0YShlbGVtLCAidG9nZ2xlIiArIHAsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIEV4ZWN1dGUgdGhlIGNvbXBsZXRlIGZ1bmN0aW9uCiAgICAgICAgICAvLyBpbiB0aGUgZXZlbnQgdGhhdCB0aGUgY29tcGxldGUgZnVuY3Rpb24gdGhyb3dzIGFuIGV4Y2VwdGlvbgogICAgICAgICAgLy8gd2UgbXVzdCBlbnN1cmUgaXQgd29uJ3QgYmUgY2FsbGVkIHR3aWNlLiAjNTY4NAoKCiAgICAgICAgICBjb21wbGV0ZSA9IG9wdGlvbnMuY29tcGxldGU7CgogICAgICAgICAgaWYgKGNvbXBsZXRlKSB7CiAgICAgICAgICAgIG9wdGlvbnMuY29tcGxldGUgPSBmYWxzZTsKICAgICAgICAgICAgY29tcGxldGUuY2FsbChlbGVtKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBjbGFzc2ljYWwgZWFzaW5nIGNhbm5vdCBiZSB1c2VkIHdpdGggYW4gSW5maW5pdHkgZHVyYXRpb24KICAgICAgICBpZiAob3B0aW9ucy5kdXJhdGlvbiA9PSBJbmZpbml0eSkgewogICAgICAgICAgdGhpcy5ub3cgPSB0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuID0gdCAtIHRoaXMuc3RhcnRUaW1lOwogICAgICAgICAgdGhpcy5zdGF0ZSA9IG4gLyBvcHRpb25zLmR1cmF0aW9uOyAvLyBQZXJmb3JtIHRoZSBlYXNpbmcgZnVuY3Rpb24sIGRlZmF1bHRzIHRvIHN3aW5nCgogICAgICAgICAgdGhpcy5wb3MgPSBqUXVlcnkuZWFzaW5nW29wdGlvbnMuYW5pbWF0ZWRQcm9wZXJ0aWVzW3RoaXMucHJvcF1dKHRoaXMuc3RhdGUsIG4sIDAsIDEsIG9wdGlvbnMuZHVyYXRpb24pOwogICAgICAgICAgdGhpcy5ub3cgPSB0aGlzLnN0YXJ0ICsgKHRoaXMuZW5kIC0gdGhpcy5zdGFydCkgKiB0aGlzLnBvczsKICAgICAgICB9IC8vIFBlcmZvcm0gdGhlIG5leHQgc3RlcCBvZiB0aGUgYW5pbWF0aW9uCgoKICAgICAgICB0aGlzLnVwZGF0ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9OwogIGpRdWVyeS5leHRlbmQoalF1ZXJ5LmZ4LCB7CiAgICB0aWNrOiBmdW5jdGlvbiB0aWNrKCkgewogICAgICB2YXIgdGltZXIsCiAgICAgICAgICB0aW1lcnMgPSBqUXVlcnkudGltZXJzLAogICAgICAgICAgaSA9IDA7CgogICAgICBmb3IgKDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKykgewogICAgICAgIHRpbWVyID0gdGltZXJzW2ldOyAvLyBDaGVja3MgdGhlIHRpbWVyIGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlbW92ZWQKCiAgICAgICAgaWYgKCF0aW1lcigpICYmIHRpbWVyc1tpXSA9PT0gdGltZXIpIHsKICAgICAgICAgIHRpbWVycy5zcGxpY2UoaS0tLCAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghdGltZXJzLmxlbmd0aCkgewogICAgICAgIGpRdWVyeS5meC5zdG9wKCk7CiAgICAgIH0KICAgIH0sCiAgICBpbnRlcnZhbDogMTMsCiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICBjbGVhckludGVydmFsKHRpbWVySWQpOwogICAgICB0aW1lcklkID0gbnVsbDsKICAgIH0sCiAgICBzcGVlZHM6IHsKICAgICAgc2xvdzogNjAwLAogICAgICBmYXN0OiAyMDAsCiAgICAgIC8vIERlZmF1bHQgc3BlZWQKICAgICAgX2RlZmF1bHQ6IDQwMAogICAgfSwKICAgIHN0ZXA6IHsKICAgICAgb3BhY2l0eTogZnVuY3Rpb24gb3BhY2l0eShmeCkgewogICAgICAgIGpRdWVyeS5zdHlsZShmeC5lbGVtLCAib3BhY2l0eSIsIGZ4Lm5vdyk7CiAgICAgIH0sCiAgICAgIF9kZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdChmeCkgewogICAgICAgIGlmIChmeC5lbGVtLnN0eWxlICYmIGZ4LmVsZW0uc3R5bGVbZngucHJvcF0gIT0gbnVsbCkgewogICAgICAgICAgZnguZWxlbS5zdHlsZVtmeC5wcm9wXSA9IGZ4Lm5vdyArIGZ4LnVuaXQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZ4LmVsZW1bZngucHJvcF0gPSBmeC5ub3c7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7IC8vIEVuc3VyZSBwcm9wcyB0aGF0IGNhbid0IGJlIG5lZ2F0aXZlIGRvbid0IGdvIHRoZXJlIG9uIHVuZGVyc2hvb3QgZWFzaW5nCgogIGpRdWVyeS5lYWNoKGZ4QXR0cnMuY29uY2F0LmFwcGx5KFtdLCBmeEF0dHJzKSwgZnVuY3Rpb24gKGksIHByb3ApIHsKICAgIC8vIGV4Y2x1ZGUgbWFyZ2luVG9wLCBtYXJnaW5MZWZ0LCBtYXJnaW5Cb3R0b20gYW5kIG1hcmdpblJpZ2h0IGZyb20gdGhpcyBsaXN0CiAgICBpZiAocHJvcC5pbmRleE9mKCJtYXJnaW4iKSkgewogICAgICBqUXVlcnkuZnguc3RlcFtwcm9wXSA9IGZ1bmN0aW9uIChmeCkgewogICAgICAgIGpRdWVyeS5zdHlsZShmeC5lbGVtLCBwcm9wLCBNYXRoLm1heCgwLCBmeC5ub3cpICsgZngudW5pdCk7CiAgICAgIH07CiAgICB9CiAgfSk7CgogIGlmIChqUXVlcnkuZXhwciAmJiBqUXVlcnkuZXhwci5maWx0ZXJzKSB7CiAgICBqUXVlcnkuZXhwci5maWx0ZXJzLmFuaW1hdGVkID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgcmV0dXJuIGpRdWVyeS5ncmVwKGpRdWVyeS50aW1lcnMsIGZ1bmN0aW9uIChmbikgewogICAgICAgIHJldHVybiBlbGVtID09PSBmbi5lbGVtOwogICAgICB9KS5sZW5ndGg7CiAgICB9OwogIH0gLy8gVHJ5IHRvIHJlc3RvcmUgdGhlIGRlZmF1bHQgZGlzcGxheSB2YWx1ZSBvZiBhbiBlbGVtZW50CgoKICBmdW5jdGlvbiBkZWZhdWx0RGlzcGxheShub2RlTmFtZSkgewogICAgaWYgKCFlbGVtZGlzcGxheVtub2RlTmFtZV0pIHsKICAgICAgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5LAogICAgICAgICAgZWxlbSA9IGpRdWVyeSgiPCIgKyBub2RlTmFtZSArICI+IikuYXBwZW5kVG8oYm9keSksCiAgICAgICAgICBkaXNwbGF5ID0gZWxlbS5jc3MoImRpc3BsYXkiKTsKICAgICAgZWxlbS5yZW1vdmUoKTsgLy8gSWYgdGhlIHNpbXBsZSB3YXkgZmFpbHMsCiAgICAgIC8vIGdldCBlbGVtZW50J3MgcmVhbCBkZWZhdWx0IGRpc3BsYXkgYnkgYXR0YWNoaW5nIGl0IHRvIGEgdGVtcCBpZnJhbWUKCiAgICAgIGlmIChkaXNwbGF5ID09PSAibm9uZSIgfHwgZGlzcGxheSA9PT0gIiIpIHsKICAgICAgICAvLyBObyBpZnJhbWUgdG8gdXNlIHlldCwgc28gY3JlYXRlIGl0CiAgICAgICAgaWYgKCFpZnJhbWUpIHsKICAgICAgICAgIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpOwogICAgICAgICAgaWZyYW1lLmZyYW1lQm9yZGVyID0gaWZyYW1lLndpZHRoID0gaWZyYW1lLmhlaWdodCA9IDA7CiAgICAgICAgfQoKICAgICAgICBib2R5LmFwcGVuZENoaWxkKGlmcmFtZSk7IC8vIENyZWF0ZSBhIGNhY2hlYWJsZSBjb3B5IG9mIHRoZSBpZnJhbWUgZG9jdW1lbnQgb24gZmlyc3QgY2FsbC4KICAgICAgICAvLyBJRSBhbmQgT3BlcmEgd2lsbCBhbGxvdyB1cyB0byByZXVzZSB0aGUgaWZyYW1lRG9jIHdpdGhvdXQgcmUtd3JpdGluZyB0aGUgZmFrZSBIVE1MCiAgICAgICAgLy8gZG9jdW1lbnQgdG8gaXQ7IFdlYktpdCAmIEZpcmVmb3ggd29uJ3QgYWxsb3cgcmV1c2luZyB0aGUgaWZyYW1lIGRvY3VtZW50LgoKICAgICAgICBpZiAoIWlmcmFtZURvYyB8fCAhaWZyYW1lLmNyZWF0ZUVsZW1lbnQpIHsKICAgICAgICAgIGlmcmFtZURvYyA9IChpZnJhbWUuY29udGVudFdpbmRvdyB8fCBpZnJhbWUuY29udGVudERvY3VtZW50KS5kb2N1bWVudDsKICAgICAgICAgIGlmcmFtZURvYy53cml0ZSgoalF1ZXJ5LnN1cHBvcnQuYm94TW9kZWwgPyAiPCFkb2N0eXBlIGh0bWw+IiA6ICIiKSArICI8aHRtbD48Ym9keT4iKTsKICAgICAgICAgIGlmcmFtZURvYy5jbG9zZSgpOwogICAgICAgIH0KCiAgICAgICAgZWxlbSA9IGlmcmFtZURvYy5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTsKICAgICAgICBpZnJhbWVEb2MuYm9keS5hcHBlbmRDaGlsZChlbGVtKTsKICAgICAgICBkaXNwbGF5ID0galF1ZXJ5LmNzcyhlbGVtLCAiZGlzcGxheSIpOwogICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQoaWZyYW1lKTsKICAgICAgfSAvLyBTdG9yZSB0aGUgY29ycmVjdCBkZWZhdWx0IGRpc3BsYXkKCgogICAgICBlbGVtZGlzcGxheVtub2RlTmFtZV0gPSBkaXNwbGF5OwogICAgfQoKICAgIHJldHVybiBlbGVtZGlzcGxheVtub2RlTmFtZV07CiAgfQoKICB2YXIgZ2V0T2Zmc2V0LAogICAgICBydGFibGUgPSAvXnQoPzphYmxlfGR8aCkkL2ksCiAgICAgIHJyb290ID0gL14oPzpib2R5fGh0bWwpJC9pOwoKICBpZiAoImdldEJvdW5kaW5nQ2xpZW50UmVjdCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7CiAgICBnZXRPZmZzZXQgPSBmdW5jdGlvbiBnZXRPZmZzZXQoZWxlbSwgZG9jLCBkb2NFbGVtLCBib3gpIHsKICAgICAgdHJ5IHsKICAgICAgICBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICB9IGNhdGNoIChlKSB7fSAvLyBNYWtlIHN1cmUgd2UncmUgbm90IGRlYWxpbmcgd2l0aCBhIGRpc2Nvbm5lY3RlZCBET00gbm9kZQoKCiAgICAgIGlmICghYm94IHx8ICFqUXVlcnkuY29udGFpbnMoZG9jRWxlbSwgZWxlbSkpIHsKICAgICAgICByZXR1cm4gYm94ID8gewogICAgICAgICAgdG9wOiBib3gudG9wLAogICAgICAgICAgbGVmdDogYm94LmxlZnQKICAgICAgICB9IDogewogICAgICAgICAgdG9wOiAwLAogICAgICAgICAgbGVmdDogMAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBib2R5ID0gZG9jLmJvZHksCiAgICAgICAgICB3aW4gPSBnZXRXaW5kb3coZG9jKSwKICAgICAgICAgIGNsaWVudFRvcCA9IGRvY0VsZW0uY2xpZW50VG9wIHx8IGJvZHkuY2xpZW50VG9wIHx8IDAsCiAgICAgICAgICBjbGllbnRMZWZ0ID0gZG9jRWxlbS5jbGllbnRMZWZ0IHx8IGJvZHkuY2xpZW50TGVmdCB8fCAwLAogICAgICAgICAgc2Nyb2xsVG9wID0gd2luLnBhZ2VZT2Zmc2V0IHx8IGpRdWVyeS5zdXBwb3J0LmJveE1vZGVsICYmIGRvY0VsZW0uc2Nyb2xsVG9wIHx8IGJvZHkuc2Nyb2xsVG9wLAogICAgICAgICAgc2Nyb2xsTGVmdCA9IHdpbi5wYWdlWE9mZnNldCB8fCBqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbCAmJiBkb2NFbGVtLnNjcm9sbExlZnQgfHwgYm9keS5zY3JvbGxMZWZ0LAogICAgICAgICAgdG9wID0gYm94LnRvcCArIHNjcm9sbFRvcCAtIGNsaWVudFRvcCwKICAgICAgICAgIGxlZnQgPSBib3gubGVmdCArIHNjcm9sbExlZnQgLSBjbGllbnRMZWZ0OwogICAgICByZXR1cm4gewogICAgICAgIHRvcDogdG9wLAogICAgICAgIGxlZnQ6IGxlZnQKICAgICAgfTsKICAgIH07CiAgfSBlbHNlIHsKICAgIGdldE9mZnNldCA9IGZ1bmN0aW9uIGdldE9mZnNldChlbGVtLCBkb2MsIGRvY0VsZW0pIHsKICAgICAgdmFyIGNvbXB1dGVkU3R5bGUsCiAgICAgICAgICBvZmZzZXRQYXJlbnQgPSBlbGVtLm9mZnNldFBhcmVudCwKICAgICAgICAgIHByZXZPZmZzZXRQYXJlbnQgPSBlbGVtLAogICAgICAgICAgYm9keSA9IGRvYy5ib2R5LAogICAgICAgICAgZGVmYXVsdFZpZXcgPSBkb2MuZGVmYXVsdFZpZXcsCiAgICAgICAgICBwcmV2Q29tcHV0ZWRTdHlsZSA9IGRlZmF1bHRWaWV3ID8gZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtLCBudWxsKSA6IGVsZW0uY3VycmVudFN0eWxlLAogICAgICAgICAgdG9wID0gZWxlbS5vZmZzZXRUb3AsCiAgICAgICAgICBsZWZ0ID0gZWxlbS5vZmZzZXRMZWZ0OwoKICAgICAgd2hpbGUgKChlbGVtID0gZWxlbS5wYXJlbnROb2RlKSAmJiBlbGVtICE9PSBib2R5ICYmIGVsZW0gIT09IGRvY0VsZW0pIHsKICAgICAgICBpZiAoalF1ZXJ5LnN1cHBvcnQuZml4ZWRQb3NpdGlvbiAmJiBwcmV2Q29tcHV0ZWRTdHlsZS5wb3NpdGlvbiA9PT0gImZpeGVkIikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjb21wdXRlZFN0eWxlID0gZGVmYXVsdFZpZXcgPyBkZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW0sIG51bGwpIDogZWxlbS5jdXJyZW50U3R5bGU7CiAgICAgICAgdG9wIC09IGVsZW0uc2Nyb2xsVG9wOwogICAgICAgIGxlZnQgLT0gZWxlbS5zY3JvbGxMZWZ0OwoKICAgICAgICBpZiAoZWxlbSA9PT0gb2Zmc2V0UGFyZW50KSB7CiAgICAgICAgICB0b3AgKz0gZWxlbS5vZmZzZXRUb3A7CiAgICAgICAgICBsZWZ0ICs9IGVsZW0ub2Zmc2V0TGVmdDsKCiAgICAgICAgICBpZiAoalF1ZXJ5LnN1cHBvcnQuZG9lc05vdEFkZEJvcmRlciAmJiAhKGpRdWVyeS5zdXBwb3J0LmRvZXNBZGRCb3JkZXJGb3JUYWJsZUFuZENlbGxzICYmIHJ0YWJsZS50ZXN0KGVsZW0ubm9kZU5hbWUpKSkgewogICAgICAgICAgICB0b3AgKz0gcGFyc2VGbG9hdChjb21wdXRlZFN0eWxlLmJvcmRlclRvcFdpZHRoKSB8fCAwOwogICAgICAgICAgICBsZWZ0ICs9IHBhcnNlRmxvYXQoY29tcHV0ZWRTdHlsZS5ib3JkZXJMZWZ0V2lkdGgpIHx8IDA7CiAgICAgICAgICB9CgogICAgICAgICAgcHJldk9mZnNldFBhcmVudCA9IG9mZnNldFBhcmVudDsKICAgICAgICAgIG9mZnNldFBhcmVudCA9IGVsZW0ub2Zmc2V0UGFyZW50OwogICAgICAgIH0KCiAgICAgICAgaWYgKGpRdWVyeS5zdXBwb3J0LnN1YnRyYWN0c0JvcmRlckZvck92ZXJmbG93Tm90VmlzaWJsZSAmJiBjb21wdXRlZFN0eWxlLm92ZXJmbG93ICE9PSAidmlzaWJsZSIpIHsKICAgICAgICAgIHRvcCArPSBwYXJzZUZsb2F0KGNvbXB1dGVkU3R5bGUuYm9yZGVyVG9wV2lkdGgpIHx8IDA7CiAgICAgICAgICBsZWZ0ICs9IHBhcnNlRmxvYXQoY29tcHV0ZWRTdHlsZS5ib3JkZXJMZWZ0V2lkdGgpIHx8IDA7CiAgICAgICAgfQoKICAgICAgICBwcmV2Q29tcHV0ZWRTdHlsZSA9IGNvbXB1dGVkU3R5bGU7CiAgICAgIH0KCiAgICAgIGlmIChwcmV2Q29tcHV0ZWRTdHlsZS5wb3NpdGlvbiA9PT0gInJlbGF0aXZlIiB8fCBwcmV2Q29tcHV0ZWRTdHlsZS5wb3NpdGlvbiA9PT0gInN0YXRpYyIpIHsKICAgICAgICB0b3AgKz0gYm9keS5vZmZzZXRUb3A7CiAgICAgICAgbGVmdCArPSBib2R5Lm9mZnNldExlZnQ7CiAgICAgIH0KCiAgICAgIGlmIChqUXVlcnkuc3VwcG9ydC5maXhlZFBvc2l0aW9uICYmIHByZXZDb21wdXRlZFN0eWxlLnBvc2l0aW9uID09PSAiZml4ZWQiKSB7CiAgICAgICAgdG9wICs9IE1hdGgubWF4KGRvY0VsZW0uc2Nyb2xsVG9wLCBib2R5LnNjcm9sbFRvcCk7CiAgICAgICAgbGVmdCArPSBNYXRoLm1heChkb2NFbGVtLnNjcm9sbExlZnQsIGJvZHkuc2Nyb2xsTGVmdCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgdG9wOiB0b3AsCiAgICAgICAgbGVmdDogbGVmdAogICAgICB9OwogICAgfTsKICB9CgogIGpRdWVyeS5mbi5vZmZzZXQgPSBmdW5jdGlvbiAob3B0aW9ucykgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIG9wdGlvbnMgPT09IHVuZGVmaW5lZCA/IHRoaXMgOiB0aGlzLmVhY2goZnVuY3Rpb24gKGkpIHsKICAgICAgICBqUXVlcnkub2Zmc2V0LnNldE9mZnNldCh0aGlzLCBvcHRpb25zLCBpKTsKICAgICAgfSk7CiAgICB9CgogICAgdmFyIGVsZW0gPSB0aGlzWzBdLAogICAgICAgIGRvYyA9IGVsZW0gJiYgZWxlbS5vd25lckRvY3VtZW50OwoKICAgIGlmICghZG9jKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChlbGVtID09PSBkb2MuYm9keSkgewogICAgICByZXR1cm4galF1ZXJ5Lm9mZnNldC5ib2R5T2Zmc2V0KGVsZW0pOwogICAgfQoKICAgIHJldHVybiBnZXRPZmZzZXQoZWxlbSwgZG9jLCBkb2MuZG9jdW1lbnRFbGVtZW50KTsKICB9OwoKICBqUXVlcnkub2Zmc2V0ID0gewogICAgYm9keU9mZnNldDogZnVuY3Rpb24gYm9keU9mZnNldChib2R5KSB7CiAgICAgIHZhciB0b3AgPSBib2R5Lm9mZnNldFRvcCwKICAgICAgICAgIGxlZnQgPSBib2R5Lm9mZnNldExlZnQ7CgogICAgICBpZiAoalF1ZXJ5LnN1cHBvcnQuZG9lc05vdEluY2x1ZGVNYXJnaW5JbkJvZHlPZmZzZXQpIHsKICAgICAgICB0b3AgKz0gcGFyc2VGbG9hdChqUXVlcnkuY3NzKGJvZHksICJtYXJnaW5Ub3AiKSkgfHwgMDsKICAgICAgICBsZWZ0ICs9IHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhib2R5LCAibWFyZ2luTGVmdCIpKSB8fCAwOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIHRvcDogdG9wLAogICAgICAgIGxlZnQ6IGxlZnQKICAgICAgfTsKICAgIH0sCiAgICBzZXRPZmZzZXQ6IGZ1bmN0aW9uIHNldE9mZnNldChlbGVtLCBvcHRpb25zLCBpKSB7CiAgICAgIHZhciBwb3NpdGlvbiA9IGpRdWVyeS5jc3MoZWxlbSwgInBvc2l0aW9uIik7IC8vIHNldCBwb3NpdGlvbiBmaXJzdCwgaW4tY2FzZSB0b3AvbGVmdCBhcmUgc2V0IGV2ZW4gb24gc3RhdGljIGVsZW0KCiAgICAgIGlmIChwb3NpdGlvbiA9PT0gInN0YXRpYyIpIHsKICAgICAgICBlbGVtLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKICAgICAgfQoKICAgICAgdmFyIGN1ckVsZW0gPSBqUXVlcnkoZWxlbSksCiAgICAgICAgICBjdXJPZmZzZXQgPSBjdXJFbGVtLm9mZnNldCgpLAogICAgICAgICAgY3VyQ1NTVG9wID0galF1ZXJ5LmNzcyhlbGVtLCAidG9wIiksCiAgICAgICAgICBjdXJDU1NMZWZ0ID0galF1ZXJ5LmNzcyhlbGVtLCAibGVmdCIpLAogICAgICAgICAgY2FsY3VsYXRlUG9zaXRpb24gPSAocG9zaXRpb24gPT09ICJhYnNvbHV0ZSIgfHwgcG9zaXRpb24gPT09ICJmaXhlZCIpICYmIGpRdWVyeS5pbkFycmF5KCJhdXRvIiwgW2N1ckNTU1RvcCwgY3VyQ1NTTGVmdF0pID4gLTEsCiAgICAgICAgICBwcm9wcyA9IHt9LAogICAgICAgICAgY3VyUG9zaXRpb24gPSB7fSwKICAgICAgICAgIGN1clRvcCwKICAgICAgICAgIGN1ckxlZnQ7IC8vIG5lZWQgdG8gYmUgYWJsZSB0byBjYWxjdWxhdGUgcG9zaXRpb24gaWYgZWl0aGVyIHRvcCBvciBsZWZ0IGlzIGF1dG8gYW5kIHBvc2l0aW9uIGlzIGVpdGhlciBhYnNvbHV0ZSBvciBmaXhlZAoKICAgICAgaWYgKGNhbGN1bGF0ZVBvc2l0aW9uKSB7CiAgICAgICAgY3VyUG9zaXRpb24gPSBjdXJFbGVtLnBvc2l0aW9uKCk7CiAgICAgICAgY3VyVG9wID0gY3VyUG9zaXRpb24udG9wOwogICAgICAgIGN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0OwogICAgICB9IGVsc2UgewogICAgICAgIGN1clRvcCA9IHBhcnNlRmxvYXQoY3VyQ1NTVG9wKSB8fCAwOwogICAgICAgIGN1ckxlZnQgPSBwYXJzZUZsb2F0KGN1ckNTU0xlZnQpIHx8IDA7CiAgICAgIH0KCiAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihvcHRpb25zKSkgewogICAgICAgIG9wdGlvbnMgPSBvcHRpb25zLmNhbGwoZWxlbSwgaSwgY3VyT2Zmc2V0KTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMudG9wICE9IG51bGwpIHsKICAgICAgICBwcm9wcy50b3AgPSBvcHRpb25zLnRvcCAtIGN1ck9mZnNldC50b3AgKyBjdXJUb3A7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmxlZnQgIT0gbnVsbCkgewogICAgICAgIHByb3BzLmxlZnQgPSBvcHRpb25zLmxlZnQgLSBjdXJPZmZzZXQubGVmdCArIGN1ckxlZnQ7CiAgICAgIH0KCiAgICAgIGlmICgidXNpbmciIGluIG9wdGlvbnMpIHsKICAgICAgICBvcHRpb25zLnVzaW5nLmNhbGwoZWxlbSwgcHJvcHMpOwogICAgICB9IGVsc2UgewogICAgICAgIGN1ckVsZW0uY3NzKHByb3BzKTsKICAgICAgfQogICAgfQogIH07CiAgalF1ZXJ5LmZuLmV4dGVuZCh7CiAgICBwb3NpdGlvbjogZnVuY3Rpb24gcG9zaXRpb24oKSB7CiAgICAgIGlmICghdGhpc1swXSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgZWxlbSA9IHRoaXNbMF0sCiAgICAgICAgICAvLyBHZXQgKnJlYWwqIG9mZnNldFBhcmVudAogICAgICBvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCgpLAogICAgICAgICAgLy8gR2V0IGNvcnJlY3Qgb2Zmc2V0cwogICAgICBvZmZzZXQgPSB0aGlzLm9mZnNldCgpLAogICAgICAgICAgcGFyZW50T2Zmc2V0ID0gcnJvb3QudGVzdChvZmZzZXRQYXJlbnRbMF0ubm9kZU5hbWUpID8gewogICAgICAgIHRvcDogMCwKICAgICAgICBsZWZ0OiAwCiAgICAgIH0gOiBvZmZzZXRQYXJlbnQub2Zmc2V0KCk7IC8vIFN1YnRyYWN0IGVsZW1lbnQgbWFyZ2lucwogICAgICAvLyBub3RlOiB3aGVuIGFuIGVsZW1lbnQgaGFzIG1hcmdpbjogYXV0byB0aGUgb2Zmc2V0TGVmdCBhbmQgbWFyZ2luTGVmdAogICAgICAvLyBhcmUgdGhlIHNhbWUgaW4gU2FmYXJpIGNhdXNpbmcgb2Zmc2V0LmxlZnQgdG8gaW5jb3JyZWN0bHkgYmUgMAoKICAgICAgb2Zmc2V0LnRvcCAtPSBwYXJzZUZsb2F0KGpRdWVyeS5jc3MoZWxlbSwgIm1hcmdpblRvcCIpKSB8fCAwOwogICAgICBvZmZzZXQubGVmdCAtPSBwYXJzZUZsb2F0KGpRdWVyeS5jc3MoZWxlbSwgIm1hcmdpbkxlZnQiKSkgfHwgMDsgLy8gQWRkIG9mZnNldFBhcmVudCBib3JkZXJzCgogICAgICBwYXJlbnRPZmZzZXQudG9wICs9IHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhvZmZzZXRQYXJlbnRbMF0sICJib3JkZXJUb3BXaWR0aCIpKSB8fCAwOwogICAgICBwYXJlbnRPZmZzZXQubGVmdCArPSBwYXJzZUZsb2F0KGpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50WzBdLCAiYm9yZGVyTGVmdFdpZHRoIikpIHx8IDA7IC8vIFN1YnRyYWN0IHRoZSB0d28gb2Zmc2V0cwoKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3A6IG9mZnNldC50b3AgLSBwYXJlbnRPZmZzZXQudG9wLAogICAgICAgIGxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQKICAgICAgfTsKICAgIH0sCiAgICBvZmZzZXRQYXJlbnQ6IGZ1bmN0aW9uIG9mZnNldFBhcmVudCgpIHsKICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQgfHwgZG9jdW1lbnQuYm9keTsKCiAgICAgICAgd2hpbGUgKG9mZnNldFBhcmVudCAmJiAhcnJvb3QudGVzdChvZmZzZXRQYXJlbnQubm9kZU5hbWUpICYmIGpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50LCAicG9zaXRpb24iKSA9PT0gInN0YXRpYyIpIHsKICAgICAgICAgIG9mZnNldFBhcmVudCA9IG9mZnNldFBhcmVudC5vZmZzZXRQYXJlbnQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gb2Zmc2V0UGFyZW50OwogICAgICB9KTsKICAgIH0KICB9KTsgLy8gQ3JlYXRlIHNjcm9sbExlZnQgYW5kIHNjcm9sbFRvcCBtZXRob2RzCgogIGpRdWVyeS5lYWNoKHsKICAgIHNjcm9sbExlZnQ6ICJwYWdlWE9mZnNldCIsCiAgICBzY3JvbGxUb3A6ICJwYWdlWU9mZnNldCIKICB9LCBmdW5jdGlvbiAobWV0aG9kLCBwcm9wKSB7CiAgICB2YXIgdG9wID0gL1kvLnRlc3QocHJvcCk7CgogICAgalF1ZXJ5LmZuW21ldGhvZF0gPSBmdW5jdGlvbiAodmFsKSB7CiAgICAgIHJldHVybiBqUXVlcnkuYWNjZXNzKHRoaXMsIGZ1bmN0aW9uIChlbGVtLCBtZXRob2QsIHZhbCkgewogICAgICAgIHZhciB3aW4gPSBnZXRXaW5kb3coZWxlbSk7CgogICAgICAgIGlmICh2YWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuIHdpbiA/IHByb3AgaW4gd2luID8gd2luW3Byb3BdIDogalF1ZXJ5LnN1cHBvcnQuYm94TW9kZWwgJiYgd2luLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFttZXRob2RdIHx8IHdpbi5kb2N1bWVudC5ib2R5W21ldGhvZF0gOiBlbGVtW21ldGhvZF07CiAgICAgICAgfQoKICAgICAgICBpZiAod2luKSB7CiAgICAgICAgICB3aW4uc2Nyb2xsVG8oIXRvcCA/IHZhbCA6IGpRdWVyeSh3aW4pLnNjcm9sbExlZnQoKSwgdG9wID8gdmFsIDogalF1ZXJ5KHdpbikuc2Nyb2xsVG9wKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlbGVtW21ldGhvZF0gPSB2YWw7CiAgICAgICAgfQogICAgICB9LCBtZXRob2QsIHZhbCwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCk7CiAgICB9OwogIH0pOwoKICBmdW5jdGlvbiBnZXRXaW5kb3coZWxlbSkgewogICAgcmV0dXJuIGpRdWVyeS5pc1dpbmRvdyhlbGVtKSA/IGVsZW0gOiBlbGVtLm5vZGVUeXBlID09PSA5ID8gZWxlbS5kZWZhdWx0VmlldyB8fCBlbGVtLnBhcmVudFdpbmRvdyA6IGZhbHNlOwogIH0gLy8gQ3JlYXRlIHdpZHRoLCBoZWlnaHQsIGlubmVySGVpZ2h0LCBpbm5lcldpZHRoLCBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aCBtZXRob2RzCgoKICBqUXVlcnkuZWFjaCh7CiAgICBIZWlnaHQ6ICJoZWlnaHQiLAogICAgV2lkdGg6ICJ3aWR0aCIKICB9LCBmdW5jdGlvbiAobmFtZSwgdHlwZSkgewogICAgdmFyIGNsaWVudFByb3AgPSAiY2xpZW50IiArIG5hbWUsCiAgICAgICAgc2Nyb2xsUHJvcCA9ICJzY3JvbGwiICsgbmFtZSwKICAgICAgICBvZmZzZXRQcm9wID0gIm9mZnNldCIgKyBuYW1lOyAvLyBpbm5lckhlaWdodCBhbmQgaW5uZXJXaWR0aAoKICAgIGpRdWVyeS5mblsiaW5uZXIiICsgbmFtZV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBlbGVtID0gdGhpc1swXTsKICAgICAgcmV0dXJuIGVsZW0gPyBlbGVtLnN0eWxlID8gcGFyc2VGbG9hdChqUXVlcnkuY3NzKGVsZW0sIHR5cGUsICJwYWRkaW5nIikpIDogdGhpc1t0eXBlXSgpIDogbnVsbDsKICAgIH07IC8vIG91dGVySGVpZ2h0IGFuZCBvdXRlcldpZHRoCgoKICAgIGpRdWVyeS5mblsib3V0ZXIiICsgbmFtZV0gPSBmdW5jdGlvbiAobWFyZ2luKSB7CiAgICAgIHZhciBlbGVtID0gdGhpc1swXTsKICAgICAgcmV0dXJuIGVsZW0gPyBlbGVtLnN0eWxlID8gcGFyc2VGbG9hdChqUXVlcnkuY3NzKGVsZW0sIHR5cGUsIG1hcmdpbiA/ICJtYXJnaW4iIDogImJvcmRlciIpKSA6IHRoaXNbdHlwZV0oKSA6IG51bGw7CiAgICB9OwoKICAgIGpRdWVyeS5mblt0eXBlXSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICByZXR1cm4galF1ZXJ5LmFjY2Vzcyh0aGlzLCBmdW5jdGlvbiAoZWxlbSwgdHlwZSwgdmFsdWUpIHsKICAgICAgICB2YXIgZG9jLCBkb2NFbGVtUHJvcCwgb3JpZywgcmV0OwoKICAgICAgICBpZiAoalF1ZXJ5LmlzV2luZG93KGVsZW0pKSB7CiAgICAgICAgICAvLyAzcmQgY29uZGl0aW9uIGFsbG93cyBOb2tpYSBzdXBwb3J0LCBhcyBpdCBzdXBwb3J0cyB0aGUgZG9jRWxlbSBwcm9wIGJ1dCBub3QgQ1NTMUNvbXBhdAogICAgICAgICAgZG9jID0gZWxlbS5kb2N1bWVudDsKICAgICAgICAgIGRvY0VsZW1Qcm9wID0gZG9jLmRvY3VtZW50RWxlbWVudFtjbGllbnRQcm9wXTsKICAgICAgICAgIHJldHVybiBqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbCAmJiBkb2NFbGVtUHJvcCB8fCBkb2MuYm9keSAmJiBkb2MuYm9keVtjbGllbnRQcm9wXSB8fCBkb2NFbGVtUHJvcDsKICAgICAgICB9IC8vIEdldCBkb2N1bWVudCB3aWR0aCBvciBoZWlnaHQKCgogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSA5KSB7CiAgICAgICAgICAvLyBFaXRoZXIgc2Nyb2xsW1dpZHRoL0hlaWdodF0gb3Igb2Zmc2V0W1dpZHRoL0hlaWdodF0sIHdoaWNoZXZlciBpcyBncmVhdGVyCiAgICAgICAgICBkb2MgPSBlbGVtLmRvY3VtZW50RWxlbWVudDsgLy8gd2hlbiBhIHdpbmRvdyA+IGRvY3VtZW50LCBJRTYgcmVwb3J0cyBhIG9mZnNldFtXaWR0aC9IZWlnaHRdID4gY2xpZW50W1dpZHRoL0hlaWdodF0KICAgICAgICAgIC8vIHNvIHdlIGNhbid0IHVzZSBtYXgsIGFzIGl0J2xsIGNob29zZSB0aGUgaW5jb3JyZWN0IG9mZnNldFtXaWR0aC9IZWlnaHRdCiAgICAgICAgICAvLyBpbnN0ZWFkIHdlIHVzZSB0aGUgY29ycmVjdCBjbGllbnRbV2lkdGgvSGVpZ2h0XQogICAgICAgICAgLy8gc3VwcG9ydDpJRTYKCiAgICAgICAgICBpZiAoZG9jW2NsaWVudFByb3BdID49IGRvY1tzY3JvbGxQcm9wXSkgewogICAgICAgICAgICByZXR1cm4gZG9jW2NsaWVudFByb3BdOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBNYXRoLm1heChlbGVtLmJvZHlbc2Nyb2xsUHJvcF0sIGRvY1tzY3JvbGxQcm9wXSwgZWxlbS5ib2R5W29mZnNldFByb3BdLCBkb2Nbb2Zmc2V0UHJvcF0pOwogICAgICAgIH0gLy8gR2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudAoKCiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG9yaWcgPSBqUXVlcnkuY3NzKGVsZW0sIHR5cGUpOwogICAgICAgICAgcmV0ID0gcGFyc2VGbG9hdChvcmlnKTsKICAgICAgICAgIHJldHVybiBqUXVlcnkuaXNOdW1lcmljKHJldCkgPyByZXQgOiBvcmlnOwogICAgICAgIH0gLy8gU2V0IHRoZSB3aWR0aCBvciBoZWlnaHQgb24gdGhlIGVsZW1lbnQKCgogICAgICAgIGpRdWVyeShlbGVtKS5jc3ModHlwZSwgdmFsdWUpOwogICAgICB9LCB0eXBlLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCk7CiAgICB9OwogIH0pOyAvLyBFeHBvc2UgalF1ZXJ5IHRvIHRoZSBnbG9iYWwgb2JqZWN0CgogIHdpbmRvdy5qUXVlcnkgPSB3aW5kb3cuJCA9IGpRdWVyeTsgLy8gRXhwb3NlIGpRdWVyeSBhcyBhbiBBTUQgbW9kdWxlLCBidXQgb25seSBmb3IgQU1EIGxvYWRlcnMgdGhhdAogIC8vIHVuZGVyc3RhbmQgdGhlIGlzc3VlcyB3aXRoIGxvYWRpbmcgbXVsdGlwbGUgdmVyc2lvbnMgb2YgalF1ZXJ5CiAgLy8gaW4gYSBwYWdlIHRoYXQgYWxsIG1pZ2h0IGNhbGwgZGVmaW5lKCkuIFRoZSBsb2FkZXIgd2lsbCBpbmRpY2F0ZQogIC8vIHRoZXkgaGF2ZSBzcGVjaWFsIGFsbG93YW5jZXMgZm9yIG11bHRpcGxlIGpRdWVyeSB2ZXJzaW9ucyBieQogIC8vIHNwZWNpZnlpbmcgZGVmaW5lLmFtZC5qUXVlcnkgPSB0cnVlLiBSZWdpc3RlciBhcyBhIG5hbWVkIG1vZHVsZSwKICAvLyBzaW5jZSBqUXVlcnkgY2FuIGJlIGNvbmNhdGVuYXRlZCB3aXRoIG90aGVyIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsCiAgLy8gYnV0IG5vdCB1c2UgYSBwcm9wZXIgY29uY2F0ZW5hdGlvbiBzY3JpcHQgdGhhdCB1bmRlcnN0YW5kcyBhbm9ueW1vdXMKICAvLyBBTUQgbW9kdWxlcy4gQSBuYW1lZCBBTUQgaXMgc2FmZXN0IGFuZCBtb3N0IHJvYnVzdCB3YXkgdG8gcmVnaXN0ZXIuCiAgLy8gTG93ZXJjYXNlIGpxdWVyeSBpcyB1c2VkIGJlY2F1c2UgQU1EIG1vZHVsZSBuYW1lcyBhcmUgZGVyaXZlZCBmcm9tCiAgLy8gZmlsZSBuYW1lcywgYW5kIGpRdWVyeSBpcyBub3JtYWxseSBkZWxpdmVyZWQgaW4gYSBsb3dlcmNhc2UgZmlsZSBuYW1lLgogIC8vIERvIHRoaXMgYWZ0ZXIgY3JlYXRpbmcgdGhlIGdsb2JhbCBzbyB0aGF0IGlmIGFuIEFNRCBtb2R1bGUgd2FudHMgdG8gY2FsbAogIC8vIG5vQ29uZmxpY3QgdG8gaGlkZSB0aGlzIHZlcnNpb24gb2YgalF1ZXJ5LCBpdCB3aWxsIHdvcmsuCgogIGlmICh0eXBlb2YgZGVmaW5lID09PSAiZnVuY3Rpb24iICYmIGRlZmluZS5hbWQgJiYgZGVmaW5lLmFtZC5qUXVlcnkpIHsKICAgIGRlZmluZSgianF1ZXJ5IiwgW10sIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGpRdWVyeTsKICAgIH0pOwogIH0KfSkod2luZG93KTs="},{"version":3,"sources":["/Users/w/Documents/三阶段/2020-9-16/src/components/my-banner/js/jquery-1.7.2.js"],"names":["window","undefined","document","navigator","location","jQuery","selector","context","fn","init","rootjQuery","_jQuery","_$","$","quickExpr","rnotwhite","trimLeft","trimRight","rsingleTag","rvalidchars","rvalidescape","rvalidtokens","rvalidbraces","rwebkit","ropera","rmsie","rmozilla","rdashAlpha","rmsPrefix","fcamelCase","all","letter","toUpperCase","userAgent","browserMatch","readyList","DOMContentLoaded","toString","Object","prototype","hasOwn","hasOwnProperty","push","Array","slice","trim","String","indexOf","class2type","constructor","match","elem","ret","doc","nodeType","length","body","charAt","exec","ownerDocument","isPlainObject","createElement","attr","call","buildFragment","cacheable","clone","fragment","childNodes","merge","getElementById","parentNode","id","find","jquery","isFunction","ready","makeArray","size","toArray","get","num","pushStack","elems","name","isArray","apply","prevObject","each","callback","args","bindReady","add","eq","i","first","last","arguments","join","map","end","sort","splice","extend","options","src","copy","copyIsArray","target","deep","noConflict","isReady","readyWait","holdReady","hold","wait","setTimeout","fireWith","trigger","off","Callbacks","readyState","addEventListener","attachEvent","toplevel","frameElement","e","documentElement","doScroll","doScrollCheck","obj","type","isWindow","isNumeric","isNaN","parseFloat","isFinite","key","isEmptyObject","error","msg","Error","parseJSON","data","JSON","parse","test","replace","Function","parseXML","xml","tmp","DOMParser","parseFromString","ActiveXObject","async","loadXML","getElementsByTagName","noop","globalEval","execScript","camelCase","string","nodeName","object","isObj","text","array","results","inArray","len","Math","max","second","j","l","grep","inv","retVal","arg","value","concat","guid","proxy","access","chainable","emptyGet","pass","bulk","now","Date","getTime","uaMatch","ua","toLowerCase","browser","version","sub","jQuerySub","superclass","rootjQuerySub","split","webkit","safari","removeEventListener","detachEvent","flagsCache","createFlags","flags","list","stack","memory","fired","firing","firingStart","firingLength","firingIndex","actual","unique","self","has","fire","stopOnFalse","once","shift","disable","remove","argIndex","argLength","empty","disabled","lock","locked","sliceDeferred","Deferred","func","doneList","failList","progressList","state","lists","resolve","reject","notify","promise","done","fail","progress","isResolved","isRejected","then","doneCallbacks","failCallbacks","progressCallbacks","deferred","always","pipe","fnDone","fnFail","fnProgress","newDefer","handler","action","returned","when","firstParam","pValues","count","pCount","resolveFunc","resolveWith","progressFunc","notifyWith","support","a","select","opt","input","tds","events","eventName","isSupported","div","setAttribute","innerHTML","appendChild","leadingWhitespace","firstChild","tbody","htmlSerialize","style","getAttribute","hrefNormalized","opacity","cssFloat","checkOn","optSelected","selected","getSetAttribute","className","enctype","html5Clone","cloneNode","outerHTML","submitBubbles","changeBubbles","focusinBubbles","deleteExpando","noCloneEvent","inlineBlockNeedsLayout","shrinkWrapBlocks","reliableMarginRight","pixelMargin","boxModel","compatMode","checked","noCloneChecked","optDisabled","fireEvent","radioValue","createDocumentFragment","lastChild","checkClone","appendChecked","removeChild","submit","change","focusin","container","outer","inner","table","td","offsetSupport","marginDiv","conMarginTop","html","positionTopLeftWidthHeight","paddingMarginBorderVisibility","paddingMarginBorder","cssText","insertBefore","offsetHeight","display","reliableHiddenOffsets","getComputedStyle","width","marginRight","parseInt","zoom","padding","border","overflow","offsetWidth","nextSibling","doesNotAddBorder","offsetTop","doesAddBorderForTableAndCells","position","top","fixedPosition","subtractsBorderForOverflowNotVisible","doesNotIncludeMarginInBodyOffset","marginTop","rbrace","rmultiDash","cache","uuid","expando","random","noData","hasData","isEmptyDataObject","pvt","acceptData","privateCache","thisCache","internalKey","getByName","isNode","isEvents","toJSON","removeData","setInterval","removeAttribute","_data","parts","part","attributes","substring","dataAttr","triggerHandler","handleQueueMarkDefer","deferDataKey","queueDataKey","markDataKey","defer","_mark","_unmark","force","queue","q","dequeue","hooks","unshift","setter","delay","time","fx","speeds","next","timeout","stop","clearTimeout","clearQueue","elements","rclass","rspace","rreturn","rtype","rfocusable","rclickable","rboolean","nodeHook","boolHook","fixSpecified","removeAttr","prop","removeProp","propFix","addClass","classNames","setClass","c","cl","removeClass","toggleClass","stateVal","isBool","hasClass","val","valHooks","set","option","specified","index","selectedIndex","values","one","attrFn","css","height","offset","notxml","nType","isXMLDoc","attrHooks","propName","attrNames","tabindex","readonly","maxlength","cellspacing","cellpadding","rowspan","colspan","usemap","frameborder","contenteditable","propHooks","tabIndex","attributeNode","getAttributeNode","href","attrNode","property","nodeValue","coords","button","createAttribute","setAttributeNode","parent","rformElems","rtypenamespace","rhoverHack","rkeyEvent","rmouseEvent","rfocusMorph","rquickIs","quickParse","quick","RegExp","quickIs","m","attrs","hoverHack","event","special","hover","types","elemData","eventHandle","t","tns","namespaces","handleObj","handleObjIn","handlers","handle","triggered","dispatch","delegateType","bindType","origType","namespace","delegateCount","setup","global","mappedTypes","origCount","eventType","teardown","removeEvent","customEvent","onlyHandlers","exclusive","cur","old","ontype","eventPath","bubbleType","Event","isTrigger","namespace_re","result","noBubble","defaultView","parentWindow","isPropagationStopped","preventDefault","isDefaultPrevented","_default","fix","run_all","handlerQueue","jqcur","selMatch","matched","matches","sel","related","delegateTarget","preDispatch","is","currentTarget","isImmediatePropagationStopped","stopPropagation","postDispatch","props","fixHooks","keyHooks","filter","original","which","charCode","keyCode","mouseHooks","eventDoc","fromElement","pageX","clientX","scrollLeft","clientLeft","pageY","clientY","scrollTop","clientTop","relatedTarget","toElement","originalEvent","fixHook","srcElement","metaKey","ctrlKey","load","focus","blur","beforeunload","onbeforeunload","simulate","bubble","isSimulated","defaultPrevented","returnValue","getPreventDefault","returnTrue","returnFalse","timeStamp","cancelBubble","stopImmediatePropagation","mouseenter","mouseleave","orig","contains","form","_submit_attached","_submit_bubble","propertyName","_just_changed","_change_attached","attaches","on","origFn","bind","unbind","live","die","delegate","undelegate","toggle","toggler","lastToggle","click","fnOver","fnOut","chunker","hasDuplicate","baseHasDuplicate","rBackslash","rReturn","rNonWord","Sizzle","seed","origContext","checkSet","extra","pop","prune","contextXML","isXML","soFar","origPOS","Expr","relative","posProcess","ID","expr","uniqueSort","sortOrder","matchesSelector","node","left","order","leftMatch","substr","inplace","not","anyFound","found","item","curLoop","isXMLFilter","preFilter","getText","textContent","innerText","selectors","CLASS","NAME","ATTR","TAG","CHILD","POS","PSEUDO","attrMap","attrHandle","isPartStr","isTag","isPartStrNotTag","previousSibling","nodeCheck","doneName","checkFn","dirCheck","dirNodeCheck","getElementsByName","filters","enabled","header","radio","checkbox","file","password","image","reset","activeElement","setFilters","even","odd","lt","gt","nth","diff","nodeIndex","check","fescape","source","globalPOS","siblingCheck","compareDocumentPosition","b","sourceIndex","al","bl","ap","bp","aup","bup","root","createComment","querySelectorAll","oldSizzle","query","getElementsByClassName","qsaError","oldContext","nid","hasParent","relativeHierarchySelector","pseudoError","mozMatchesSelector","webkitMatchesSelector","msMatchesSelector","disconnectedMatch","pseudoWorks","dir","sizset","tmpSet","later","runtil","rparentsprev","rmultiselector","isSimple","guaranteedUnique","children","contents","prev","n","r","targets","winnow","closest","level","pos","prevAll","isDisconnected","andSelf","parents","parentsUntil","until","nextAll","nextUntil","prevUntil","siblings","sibling","contentDocument","contentWindow","reverse","qualifier","keep","filtered","createSafeFragment","nodeNames","safeFrag","rinlinejQuery","rleadingWhitespace","rxhtmlTag","rtagName","rtbody","rhtml","rnoInnerhtml","rnocache","rnoshimcache","rchecked","rscriptType","rcleanScript","wrapMap","legend","thead","tr","col","area","safeFragment","optgroup","tfoot","colgroup","caption","th","append","createTextNode","wrapAll","wrap","wrapInner","unwrap","replaceWith","domManip","prepend","before","clean","after","keepData","cleanData","dataAndEvents","deepDataAndEvents","detach","scripts","lastIndex","ajax","url","dataType","cloneCopyEvent","dest","oldData","curData","cloneFixAttributes","clearAttributes","mergeAttributes","defaultChecked","defaultSelected","defaultValue","nodes","cacheresults","fragments","appendTo","prependTo","insertAfter","replaceAll","insert","getAll","fixDefaultChecked","findInputs","shimCloneNode","srcElements","destElements","checkScriptType","script","tag","depth","safeChildNodes","hasBody","jsTags","ralpha","ropacity","rupper","rnum","rnumnonpx","rrelNum","rmargin","cssShow","visibility","cssExpand","curCSS","currentStyle","cssHooks","computed","cssNumber","cssProps","origName","swap","computedStyle","getPropertyValue","rsLeft","uncomputed","runtimeStyle","pixelLeft","getWidthOrHeight","$1","hidden","visible","margin","prefix","suffix","expand","expanded","r20","rbracket","rCRLF","rhash","rheaders","rinput","rlocalProtocol","rnoContent","rprotocol","rquery","rscript","rselectTextarea","rspacesAjax","rts","rurl","_load","prefilters","transports","ajaxLocation","ajaxLocParts","allTypes","addToPrefiltersOrTransports","structure","dataTypeExpression","dataTypes","placeBefore","inspectPrefiltersOrTransports","originalOptions","jqXHR","inspected","executeOnly","selection","ajaxExtend","flatOptions","ajaxSettings","params","param","traditional","complete","status","responseText","serialize","serializeArray","o","f","method","success","getScript","getJSON","ajaxSetup","settings","isLocal","contentType","processData","accepts","json","responseFields","converters","ajaxPrefilter","ajaxTransport","s","callbackContext","globalEventContext","completeDeferred","statusCode","ifModifiedKey","requestHeaders","requestHeadersNames","responseHeadersString","responseHeaders","transport","timeoutTimer","fireGlobals","setRequestHeader","lname","getAllResponseHeaders","getResponseHeader","overrideMimeType","mimeType","abort","statusText","nativeStatusText","responses","headers","isSuccess","response","ajaxHandleResponses","lastModified","etag","ifModified","ajaxConvert","rejectWith","active","crossDomain","hasContent","ts","beforeSend","send","encodeURIComponent","buildParams","v","ct","finalDataType","firstDataType","dataFilter","current","conversion","conv","conv1","conv2","jsc","jsre","jsonp","jsonpCallback","originalSettings","inspectData","responseContainer","previous","head","_","scriptCharset","charset","onload","onreadystatechange","isAbort","xhrOnUnloadAbort","xhrCallbacks","xhrId","createStandardXHR","XMLHttpRequest","createActiveXHR","xhr","cors","username","open","xhrFields","responseXML","firefoxAccessException","unload","elemdisplay","iframe","iframeDoc","rfxtypes","rfxnum","timerId","fxAttrs","fxNow","show","speed","easing","animate","genFx","defaultDisplay","hide","_toggle","fn2","bool","fadeTo","to","optall","doAnimation","isElement","p","start","unit","animatedProperties","specialEasing","overflowX","overflowY","custom","gotoEnd","hadTimers","timers","stopQueue","saveState","createFxNow","clearFxNow","slideDown","slideUp","slideToggle","fadeIn","fadeOut","fadeToggle","duration","noUnmark","linear","swing","cos","PI","update","step","parsed","from","startTime","tick","interval","dataShow","Infinity","timer","clearInterval","slow","fast","animated","frameBorder","write","close","getOffset","rtable","rroot","docElem","box","getBoundingClientRect","win","getWindow","pageYOffset","pageXOffset","offsetParent","prevOffsetParent","prevComputedStyle","offsetLeft","borderTopWidth","borderLeftWidth","setOffset","bodyOffset","curElem","curOffset","curCSSTop","curCSSLeft","calculatePosition","curPosition","curTop","curLeft","using","parentOffset","scrollTo","Height","Width","clientProp","scrollProp","offsetProp","docElemProp","define","amd"],"mappings":"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","sourcesContent":["/*!\n * jQuery JavaScript Library v1.7.2\n * http://jquery.com/\n *\n * Copyright 2011, John Resig\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * Includes Sizzle.js\n * http://sizzlejs.com/\n * Copyright 2011, The Dojo Foundation\n * Released under the MIT, BSD, and GPL Licenses.\n *\n * Date: Wed Mar 21 12:46:34 2012 -0700\n */\n(function( window, undefined ) {\n\n// Use the correct document accordingly with window argument (sandbox)\nvar document = window.document,\n\tnavigator = window.navigator,\n\tlocation = window.location;\nvar jQuery = (function() {\n\n// Define a local copy of jQuery\nvar jQuery = function( selector, context ) {\n\t\t// The jQuery object is actually just the init constructor 'enhanced'\n\t\treturn new jQuery.fn.init( selector, context, rootjQuery );\n\t},\n\n\t// Map over jQuery in case of overwrite\n\t_jQuery = window.jQuery,\n\n\t// Map over the $ in case of overwrite\n\t_$ = window.$,\n\n\t// A central reference to the root jQuery(document)\n\trootjQuery,\n\n\t// A simple way to check for HTML strings or ID strings\n\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n\tquickExpr = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/,\n\n\t// Check if a string has a non-whitespace character in it\n\trnotwhite = /\\S/,\n\n\t// Used for trimming whitespace\n\ttrimLeft = /^\\s+/,\n\ttrimRight = /\\s+$/,\n\n\t// Match a standalone tag\n\trsingleTag = /^<(\\w+)\\s*\\/?>(?:<\\/\\1>)?$/,\n\n\t// JSON RegExp\n\trvalidchars = /^[\\],:{}\\s]*$/,\n\trvalidescape = /\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,\n\trvalidtokens = /\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,\n\trvalidbraces = /(?:^|:|,)(?:\\s*\\[)+/g,\n\n\t// Useragent RegExp\n\trwebkit = /(webkit)[ \\/]([\\w.]+)/,\n\tropera = /(opera)(?:.*version)?[ \\/]([\\w.]+)/,\n\trmsie = /(msie) ([\\w.]+)/,\n\trmozilla = /(mozilla)(?:.*? rv:([\\w.]+))?/,\n\n\t// Matches dashed string for camelizing\n\trdashAlpha = /-([a-z]|[0-9])/ig,\n\trmsPrefix = /^-ms-/,\n\n\t// Used by jQuery.camelCase as callback to replace()\n\tfcamelCase = function( all, letter ) {\n\t\treturn ( letter + \"\" ).toUpperCase();\n\t},\n\n\t// Keep a UserAgent string for use with jQuery.browser\n\tuserAgent = navigator.userAgent,\n\n\t// For matching the engine and version of the browser\n\tbrowserMatch,\n\n\t// The deferred used on DOM ready\n\treadyList,\n\n\t// The ready event handler\n\tDOMContentLoaded,\n\n\t// Save a reference to some core methods\n\ttoString = Object.prototype.toString,\n\thasOwn = Object.prototype.hasOwnProperty,\n\tpush = Array.prototype.push,\n\tslice = Array.prototype.slice,\n\ttrim = String.prototype.trim,\n\tindexOf = Array.prototype.indexOf,\n\n\t// [[Class]] -> type pairs\n\tclass2type = {};\n\njQuery.fn = jQuery.prototype = {\n\tconstructor: jQuery,\n\tinit: function( selector, context, rootjQuery ) {\n\t\tvar match, elem, ret, doc;\n\n\t\t// Handle $(\"\"), $(null), or $(undefined)\n\t\tif ( !selector ) {\n\t\t\treturn this;\n\t\t}\n\n\t\t// Handle $(DOMElement)\n\t\tif ( selector.nodeType ) {\n\t\t\tthis.context = this[0] = selector;\n\t\t\tthis.length = 1;\n\t\t\treturn this;\n\t\t}\n\n\t\t// The body element only exists once, optimize finding it\n\t\tif ( selector === \"body\" && !context && document.body ) {\n\t\t\tthis.context = document;\n\t\t\tthis[0] = document.body;\n\t\t\tthis.selector = selector;\n\t\t\tthis.length = 1;\n\t\t\treturn this;\n\t\t}\n\n\t\t// Handle HTML strings\n\t\tif ( typeof selector === \"string\" ) {\n\t\t\t// Are we dealing with HTML string or an ID?\n\t\t\tif ( selector.charAt(0) === \"<\" && selector.charAt( selector.length - 1 ) === \">\" && selector.length >= 3 ) {\n\t\t\t\t// Assume that strings that start and end with <> are HTML and skip the regex check\n\t\t\t\tmatch = [ null, selector, null ];\n\n\t\t\t} else {\n\t\t\t\tmatch = quickExpr.exec( selector );\n\t\t\t}\n\n\t\t\t// Verify a match, and that no context was specified for #id\n\t\t\tif ( match && (match[1] || !context) ) {\n\n\t\t\t\t// HANDLE: $(html) -> $(array)\n\t\t\t\tif ( match[1] ) {\n\t\t\t\t\tcontext = context instanceof jQuery ? context[0] : context;\n\t\t\t\t\tdoc = ( context ? context.ownerDocument || context : document );\n\n\t\t\t\t\t// If a single string is passed in and it's a single tag\n\t\t\t\t\t// just do a createElement and skip the rest\n\t\t\t\t\tret = rsingleTag.exec( selector );\n\n\t\t\t\t\tif ( ret ) {\n\t\t\t\t\t\tif ( jQuery.isPlainObject( context ) ) {\n\t\t\t\t\t\t\tselector = [ document.createElement( ret[1] ) ];\n\t\t\t\t\t\t\tjQuery.fn.attr.call( selector, context, true );\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tselector = [ doc.createElement( ret[1] ) ];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tret = jQuery.buildFragment( [ match[1] ], [ doc ] );\n\t\t\t\t\t\tselector = ( ret.cacheable ? jQuery.clone(ret.fragment) : ret.fragment ).childNodes;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn jQuery.merge( this, selector );\n\n\t\t\t\t// HANDLE: $(\"#id\")\n\t\t\t\t} else {\n\t\t\t\t\telem = document.getElementById( match[2] );\n\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\t\tif ( elem && elem.parentNode ) {\n\t\t\t\t\t\t// Handle the case where IE and Opera return items\n\t\t\t\t\t\t// by name instead of ID\n\t\t\t\t\t\tif ( elem.id !== match[2] ) {\n\t\t\t\t\t\t\treturn rootjQuery.find( selector );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Otherwise, we inject the element directly into the jQuery object\n\t\t\t\t\t\tthis.length = 1;\n\t\t\t\t\t\tthis[0] = elem;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.context = document;\n\t\t\t\t\tthis.selector = selector;\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t// HANDLE: $(expr, $(...))\n\t\t\t} else if ( !context || context.jquery ) {\n\t\t\t\treturn ( context || rootjQuery ).find( selector );\n\n\t\t\t// HANDLE: $(expr, context)\n\t\t\t// (which is just equivalent to: $(context).find(expr)\n\t\t\t} else {\n\t\t\t\treturn this.constructor( context ).find( selector );\n\t\t\t}\n\n\t\t// HANDLE: $(function)\n\t\t// Shortcut for document ready\n\t\t} else if ( jQuery.isFunction( selector ) ) {\n\t\t\treturn rootjQuery.ready( selector );\n\t\t}\n\n\t\tif ( selector.selector !== undefined ) {\n\t\t\tthis.selector = selector.selector;\n\t\t\tthis.context = selector.context;\n\t\t}\n\n\t\treturn jQuery.makeArray( selector, this );\n\t},\n\n\t// Start with an empty selector\n\tselector: \"\",\n\n\t// The current version of jQuery being used\n\tjquery: \"1.7.2\",\n\n\t// The default length of a jQuery object is 0\n\tlength: 0,\n\n\t// The number of elements contained in the matched element set\n\tsize: function() {\n\t\treturn this.length;\n\t},\n\n\ttoArray: function() {\n\t\treturn slice.call( this, 0 );\n\t},\n\n\t// Get the Nth element in the matched element set OR\n\t// Get the whole matched element set as a clean array\n\tget: function( num ) {\n\t\treturn num == null ?\n\n\t\t\t// Return a 'clean' array\n\t\t\tthis.toArray() :\n\n\t\t\t// Return just the object\n\t\t\t( num < 0 ? this[ this.length + num ] : this[ num ] );\n\t},\n\n\t// Take an array of elements and push it onto the stack\n\t// (returning the new matched element set)\n\tpushStack: function( elems, name, selector ) {\n\t\t// Build a new jQuery matched element set\n\t\tvar ret = this.constructor();\n\n\t\tif ( jQuery.isArray( elems ) ) {\n\t\t\tpush.apply( ret, elems );\n\n\t\t} else {\n\t\t\tjQuery.merge( ret, elems );\n\t\t}\n\n\t\t// Add the old object onto the stack (as a reference)\n\t\tret.prevObject = this;\n\n\t\tret.context = this.context;\n\n\t\tif ( name === \"find\" ) {\n\t\t\tret.selector = this.selector + ( this.selector ? \" \" : \"\" ) + selector;\n\t\t} else if ( name ) {\n\t\t\tret.selector = this.selector + \".\" + name + \"(\" + selector + \")\";\n\t\t}\n\n\t\t// Return the newly-formed element set\n\t\treturn ret;\n\t},\n\n\t// Execute a callback for every element in the matched set.\n\t// (You can seed the arguments with an array of args, but this is\n\t// only used internally.)\n\teach: function( callback, args ) {\n\t\treturn jQuery.each( this, callback, args );\n\t},\n\n\tready: function( fn ) {\n\t\t// Attach the listeners\n\t\tjQuery.bindReady();\n\n\t\t// Add the callback\n\t\treadyList.add( fn );\n\n\t\treturn this;\n\t},\n\n\teq: function( i ) {\n\t\ti = +i;\n\t\treturn i === -1 ?\n\t\t\tthis.slice( i ) :\n\t\t\tthis.slice( i, i + 1 );\n\t},\n\n\tfirst: function() {\n\t\treturn this.eq( 0 );\n\t},\n\n\tlast: function() {\n\t\treturn this.eq( -1 );\n\t},\n\n\tslice: function() {\n\t\treturn this.pushStack( slice.apply( this, arguments ),\n\t\t\t\"slice\", slice.call(arguments).join(\",\") );\n\t},\n\n\tmap: function( callback ) {\n\t\treturn this.pushStack( jQuery.map(this, function( elem, i ) {\n\t\t\treturn callback.call( elem, i, elem );\n\t\t}));\n\t},\n\n\tend: function() {\n\t\treturn this.prevObject || this.constructor(null);\n\t},\n\n\t// For internal use only.\n\t// Behaves like an Array's method, not like a jQuery method.\n\tpush: push,\n\tsort: [].sort,\n\tsplice: [].splice\n};\n\n// Give the init function the jQuery prototype for later instantiation\njQuery.fn.init.prototype = jQuery.fn;\n\njQuery.extend = jQuery.fn.extend = function() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0] || {},\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === \"boolean\" ) {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== \"object\" && !jQuery.isFunction(target) ) {\n\t\ttarget = {};\n\t}\n\n\t// extend jQuery itself if only one argument is passed\n\tif ( length === i ) {\n\t\ttarget = this;\n\t\t--i;\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\t\t// Only deal with non-null/undefined values\n\t\tif ( (options = arguments[ i ]) != null ) {\n\t\t\t// Extend the base object\n\t\t\tfor ( name in options ) {\n\t\t\t\tsrc = target[ name ];\n\t\t\t\tcopy = options[ name ];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif ( target === copy ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {\n\t\t\t\t\tif ( copyIsArray ) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && jQuery.isArray(src) ? src : [];\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && jQuery.isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\n\n\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if ( copy !== undefined ) {\n\t\t\t\t\ttarget[ name ] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\njQuery.extend({\n\tnoConflict: function( deep ) {\n\t\tif ( window.$ === jQuery ) {\n\t\t\twindow.$ = _$;\n\t\t}\n\n\t\tif ( deep && window.jQuery === jQuery ) {\n\t\t\twindow.jQuery = _jQuery;\n\t\t}\n\n\t\treturn jQuery;\n\t},\n\n\t// Is the DOM ready to be used? Set to true once it occurs.\n\tisReady: false,\n\n\t// A counter to track how many items to wait for before\n\t// the ready event fires. See #6781\n\treadyWait: 1,\n\n\t// Hold (or release) the ready event\n\tholdReady: function( hold ) {\n\t\tif ( hold ) {\n\t\t\tjQuery.readyWait++;\n\t\t} else {\n\t\t\tjQuery.ready( true );\n\t\t}\n\t},\n\n\t// Handle when the DOM is ready\n\tready: function( wait ) {\n\t\t// Either a released hold or an DOMready/load event and not yet ready\n\t\tif ( (wait === true && !--jQuery.readyWait) || (wait !== true && !jQuery.isReady) ) {\n\t\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n\t\t\tif ( !document.body ) {\n\t\t\t\treturn setTimeout( jQuery.ready, 1 );\n\t\t\t}\n\n\t\t\t// Remember that the DOM is ready\n\t\t\tjQuery.isReady = true;\n\n\t\t\t// If a normal DOM Ready event fired, decrement, and wait if need be\n\t\t\tif ( wait !== true && --jQuery.readyWait > 0 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If there are functions bound, to execute\n\t\t\treadyList.fireWith( document, [ jQuery ] );\n\n\t\t\t// Trigger any bound ready events\n\t\t\tif ( jQuery.fn.trigger ) {\n\t\t\t\tjQuery( document ).trigger( \"ready\" ).off( \"ready\" );\n\t\t\t}\n\t\t}\n\t},\n\n\tbindReady: function() {\n\t\tif ( readyList ) {\n\t\t\treturn;\n\t\t}\n\n\t\treadyList = jQuery.Callbacks( \"once memory\" );\n\n\t\t// Catch cases where $(document).ready() is called after the\n\t\t// browser event has already occurred.\n\t\tif ( document.readyState === \"complete\" ) {\n\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\t\t\treturn setTimeout( jQuery.ready, 1 );\n\t\t}\n\n\t\t// Mozilla, Opera and webkit nightlies currently support this event\n\t\tif ( document.addEventListener ) {\n\t\t\t// Use the handy event callback\n\t\t\tdocument.addEventListener( \"DOMContentLoaded\", DOMContentLoaded, false );\n\n\t\t\t// A fallback to window.onload, that will always work\n\t\t\twindow.addEventListener( \"load\", jQuery.ready, false );\n\n\t\t// If IE event model is used\n\t\t} else if ( document.attachEvent ) {\n\t\t\t// ensure firing before onload,\n\t\t\t// maybe late but safe also for iframes\n\t\t\tdocument.attachEvent( \"onreadystatechange\", DOMContentLoaded );\n\n\t\t\t// A fallback to window.onload, that will always work\n\t\t\twindow.attachEvent( \"onload\", jQuery.ready );\n\n\t\t\t// If IE and not a frame\n\t\t\t// continually check to see if the document is ready\n\t\t\tvar toplevel = false;\n\n\t\t\ttry {\n\t\t\t\ttoplevel = window.frameElement == null;\n\t\t\t} catch(e) {}\n\n\t\t\tif ( document.documentElement.doScroll && toplevel ) {\n\t\t\t\tdoScrollCheck();\n\t\t\t}\n\t\t}\n\t},\n\n\t// See test/unit/core.js for details concerning isFunction.\n\t// Since version 1.3, DOM methods and functions like alert\n\t// aren't supported. They return false on IE (#2968).\n\tisFunction: function( obj ) {\n\t\treturn jQuery.type(obj) === \"function\";\n\t},\n\n\tisArray: Array.isArray || function( obj ) {\n\t\treturn jQuery.type(obj) === \"array\";\n\t},\n\n\tisWindow: function( obj ) {\n\t\treturn obj != null && obj == obj.window;\n\t},\n\n\tisNumeric: function( obj ) {\n\t\treturn !isNaN( parseFloat(obj) ) && isFinite( obj );\n\t},\n\n\ttype: function( obj ) {\n\t\treturn obj == null ?\n\t\t\tString( obj ) :\n\t\t\tclass2type[ toString.call(obj) ] || \"object\";\n\t},\n\n\tisPlainObject: function( obj ) {\n\t\t// Must be an Object.\n\t\t// Because of IE, we also have to check the presence of the constructor property.\n\t\t// Make sure that DOM nodes and window objects don't pass through, as well\n\t\tif ( !obj || jQuery.type(obj) !== \"object\" || obj.nodeType || jQuery.isWindow( obj ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\ttry {\n\t\t\t// Not own constructor property must be Object\n\t\t\tif ( obj.constructor &&\n\t\t\t\t!hasOwn.call(obj, \"constructor\") &&\n\t\t\t\t!hasOwn.call(obj.constructor.prototype, \"isPrototypeOf\") ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\t// IE8,9 Will throw exceptions on certain host objects #9897\n\t\t\treturn false;\n\t\t}\n\n\t\t// Own properties are enumerated firstly, so to speed up,\n\t\t// if last one is own, then all properties are own.\n\n\t\tvar key;\n\t\tfor ( key in obj ) {}\n\n\t\treturn key === undefined || hasOwn.call( obj, key );\n\t},\n\n\tisEmptyObject: function( obj ) {\n\t\tfor ( var name in obj ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\terror: function( msg ) {\n\t\tthrow new Error( msg );\n\t},\n\n\tparseJSON: function( data ) {\n\t\tif ( typeof data !== \"string\" || !data ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Make sure leading/trailing whitespace is removed (IE can't handle it)\n\t\tdata = jQuery.trim( data );\n\n\t\t// Attempt to parse using the native JSON parser first\n\t\tif ( window.JSON && window.JSON.parse ) {\n\t\t\treturn window.JSON.parse( data );\n\t\t}\n\n\t\t// Make sure the incoming data is actual JSON\n\t\t// Logic borrowed from http://json.org/json2.js\n\t\tif ( rvalidchars.test( data.replace( rvalidescape, \"@\" )\n\t\t\t.replace( rvalidtokens, \"]\" )\n\t\t\t.replace( rvalidbraces, \"\")) ) {\n\n\t\t\treturn ( new Function( \"return \" + data ) )();\n\n\t\t}\n\t\tjQuery.error( \"Invalid JSON: \" + data );\n\t},\n\n\t// Cross-browser xml parsing\n\tparseXML: function( data ) {\n\t\tif ( typeof data !== \"string\" || !data ) {\n\t\t\treturn null;\n\t\t}\n\t\tvar xml, tmp;\n\t\ttry {\n\t\t\tif ( window.DOMParser ) { // Standard\n\t\t\t\ttmp = new DOMParser();\n\t\t\t\txml = tmp.parseFromString( data , \"text/xml\" );\n\t\t\t} else { // IE\n\t\t\t\txml = new ActiveXObject( \"Microsoft.XMLDOM\" );\n\t\t\t\txml.async = \"false\";\n\t\t\t\txml.loadXML( data );\n\t\t\t}\n\t\t} catch( e ) {\n\t\t\txml = undefined;\n\t\t}\n\t\tif ( !xml || !xml.documentElement || xml.getElementsByTagName( \"parsererror\" ).length ) {\n\t\t\tjQuery.error( \"Invalid XML: \" + data );\n\t\t}\n\t\treturn xml;\n\t},\n\n\tnoop: function() {},\n\n\t// Evaluates a script in a global context\n\t// Workarounds based on findings by Jim Driscoll\n\t// http://weblogs.java.net/blog/driscoll/archive/2009/09/08/eval-javascript-global-context\n\tglobalEval: function( data ) {\n\t\tif ( data && rnotwhite.test( data ) ) {\n\t\t\t// We use execScript on Internet Explorer\n\t\t\t// We use an anonymous function so that context is window\n\t\t\t// rather than jQuery in Firefox\n\t\t\t( window.execScript || function( data ) {\n\t\t\t\twindow[ \"eval\" ].call( window, data );\n\t\t\t} )( data );\n\t\t}\n\t},\n\n\t// Convert dashed to camelCase; used by the css and data modules\n\t// Microsoft forgot to hump their vendor prefix (#9572)\n\tcamelCase: function( string ) {\n\t\treturn string.replace( rmsPrefix, \"ms-\" ).replace( rdashAlpha, fcamelCase );\n\t},\n\n\tnodeName: function( elem, name ) {\n\t\treturn elem.nodeName && elem.nodeName.toUpperCase() === name.toUpperCase();\n\t},\n\n\t// args is for internal usage only\n\teach: function( object, callback, args ) {\n\t\tvar name, i = 0,\n\t\t\tlength = object.length,\n\t\t\tisObj = length === undefined || jQuery.isFunction( object );\n\n\t\tif ( args ) {\n\t\t\tif ( isObj ) {\n\t\t\t\tfor ( name in object ) {\n\t\t\t\t\tif ( callback.apply( object[ name ], args ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( ; i < length; ) {\n\t\t\t\t\tif ( callback.apply( object[ i++ ], args ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// A special, fast, case for the most common use of each\n\t\t} else {\n\t\t\tif ( isObj ) {\n\t\t\t\tfor ( name in object ) {\n\t\t\t\t\tif ( callback.call( object[ name ], name, object[ name ] ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( ; i < length; ) {\n\t\t\t\t\tif ( callback.call( object[ i ], i, object[ i++ ] ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn object;\n\t},\n\n\t// Use native String.trim function wherever possible\n\ttrim: trim ?\n\t\tfunction( text ) {\n\t\t\treturn text == null ?\n\t\t\t\t\"\" :\n\t\t\t\ttrim.call( text );\n\t\t} :\n\n\t\t// Otherwise use our own trimming functionality\n\t\tfunction( text ) {\n\t\t\treturn text == null ?\n\t\t\t\t\"\" :\n\t\t\t\ttext.toString().replace( trimLeft, \"\" ).replace( trimRight, \"\" );\n\t\t},\n\n\t// results is for internal usage only\n\tmakeArray: function( array, results ) {\n\t\tvar ret = results || [];\n\n\t\tif ( array != null ) {\n\t\t\t// The window, strings (and functions) also have 'length'\n\t\t\t// Tweaked logic slightly to handle Blackberry 4.7 RegExp issues #6930\n\t\t\tvar type = jQuery.type( array );\n\n\t\t\tif ( array.length == null || type === \"string\" || type === \"function\" || type === \"regexp\" || jQuery.isWindow( array ) ) {\n\t\t\t\tpush.call( ret, array );\n\t\t\t} else {\n\t\t\t\tjQuery.merge( ret, array );\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tinArray: function( elem, array, i ) {\n\t\tvar len;\n\n\t\tif ( array ) {\n\t\t\tif ( indexOf ) {\n\t\t\t\treturn indexOf.call( array, elem, i );\n\t\t\t}\n\n\t\t\tlen = array.length;\n\t\t\ti = i ? i < 0 ? Math.max( 0, len + i ) : i : 0;\n\n\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\t// Skip accessing in sparse arrays\n\t\t\t\tif ( i in array && array[ i ] === elem ) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t},\n\n\tmerge: function( first, second ) {\n\t\tvar i = first.length,\n\t\t\tj = 0;\n\n\t\tif ( typeof second.length === \"number\" ) {\n\t\t\tfor ( var l = second.length; j < l; j++ ) {\n\t\t\t\tfirst[ i++ ] = second[ j ];\n\t\t\t}\n\n\t\t} else {\n\t\t\twhile ( second[j] !== undefined ) {\n\t\t\t\tfirst[ i++ ] = second[ j++ ];\n\t\t\t}\n\t\t}\n\n\t\tfirst.length = i;\n\n\t\treturn first;\n\t},\n\n\tgrep: function( elems, callback, inv ) {\n\t\tvar ret = [], retVal;\n\t\tinv = !!inv;\n\n\t\t// Go through the array, only saving the items\n\t\t// that pass the validator function\n\t\tfor ( var i = 0, length = elems.length; i < length; i++ ) {\n\t\t\tretVal = !!callback( elems[ i ], i );\n\t\t\tif ( inv !== retVal ) {\n\t\t\t\tret.push( elems[ i ] );\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\t// arg is for internal usage only\n\tmap: function( elems, callback, arg ) {\n\t\tvar value, key, ret = [],\n\t\t\ti = 0,\n\t\t\tlength = elems.length,\n\t\t\t// jquery objects are treated as arrays\n\t\t\tisArray = elems instanceof jQuery || length !== undefined && typeof length === \"number\" && ( ( length > 0 && elems[ 0 ] && elems[ length -1 ] ) || length === 0 || jQuery.isArray( elems ) ) ;\n\n\t\t// Go through the array, translating each of the items to their\n\t\tif ( isArray ) {\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret[ ret.length ] = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Go through every key on the object,\n\t\t} else {\n\t\t\tfor ( key in elems ) {\n\t\t\t\tvalue = callback( elems[ key ], key, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret[ ret.length ] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Flatten any nested arrays\n\t\treturn ret.concat.apply( [], ret );\n\t},\n\n\t// A global GUID counter for objects\n\tguid: 1,\n\n\t// Bind a function to a context, optionally partially applying any\n\t// arguments.\n\tproxy: function( fn, context ) {\n\t\tif ( typeof context === \"string\" ) {\n\t\t\tvar tmp = fn[ context ];\n\t\t\tcontext = fn;\n\t\t\tfn = tmp;\n\t\t}\n\n\t\t// Quick check to determine if target is callable, in the spec\n\t\t// this throws a TypeError, but we will just return undefined.\n\t\tif ( !jQuery.isFunction( fn ) ) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Simulated bind\n\t\tvar args = slice.call( arguments, 2 ),\n\t\t\tproxy = function() {\n\t\t\t\treturn fn.apply( context, args.concat( slice.call( arguments ) ) );\n\t\t\t};\n\n\t\t// Set the guid of unique handler to the same of original handler, so it can be removed\n\t\tproxy.guid = fn.guid = fn.guid || proxy.guid || jQuery.guid++;\n\n\t\treturn proxy;\n\t},\n\n\t// Mutifunctional method to get and set values to a collection\n\t// The value/s can optionally be executed if it's a function\n\taccess: function( elems, fn, key, value, chainable, emptyGet, pass ) {\n\t\tvar exec,\n\t\t\tbulk = key == null,\n\t\t\ti = 0,\n\t\t\tlength = elems.length;\n\n\t\t// Sets many values\n\t\tif ( key && typeof key === \"object\" ) {\n\t\t\tfor ( i in key ) {\n\t\t\t\tjQuery.access( elems, fn, i, key[i], 1, emptyGet, value );\n\t\t\t}\n\t\t\tchainable = 1;\n\n\t\t// Sets one value\n\t\t} else if ( value !== undefined ) {\n\t\t\t// Optionally, function values get executed if exec is true\n\t\t\texec = pass === undefined && jQuery.isFunction( value );\n\n\t\t\tif ( bulk ) {\n\t\t\t\t// Bulk operations only iterate when executing function values\n\t\t\t\tif ( exec ) {\n\t\t\t\t\texec = fn;\n\t\t\t\t\tfn = function( elem, key, value ) {\n\t\t\t\t\t\treturn exec.call( jQuery( elem ), value );\n\t\t\t\t\t};\n\n\t\t\t\t// Otherwise they run against the entire set\n\t\t\t\t} else {\n\t\t\t\t\tfn.call( elems, value );\n\t\t\t\t\tfn = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( fn ) {\n\t\t\t\tfor (; i < length; i++ ) {\n\t\t\t\t\tfn( elems[i], key, exec ? value.call( elems[i], i, fn( elems[i], key ) ) : value, pass );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tchainable = 1;\n\t\t}\n\n\t\treturn chainable ?\n\t\t\telems :\n\n\t\t\t// Gets\n\t\t\tbulk ?\n\t\t\t\tfn.call( elems ) :\n\t\t\t\tlength ? fn( elems[0], key ) : emptyGet;\n\t},\n\n\tnow: function() {\n\t\treturn ( new Date() ).getTime();\n\t},\n\n\t// Use of jQuery.browser is frowned upon.\n\t// More details: http://docs.jquery.com/Utilities/jQuery.browser\n\tuaMatch: function( ua ) {\n\t\tua = ua.toLowerCase();\n\n\t\tvar match = rwebkit.exec( ua ) ||\n\t\t\tropera.exec( ua ) ||\n\t\t\trmsie.exec( ua ) ||\n\t\t\tua.indexOf(\"compatible\") < 0 && rmozilla.exec( ua ) ||\n\t\t\t[];\n\n\t\treturn { browser: match[1] || \"\", version: match[2] || \"0\" };\n\t},\n\n\tsub: function() {\n\t\tfunction jQuerySub( selector, context ) {\n\t\t\treturn new jQuerySub.fn.init( selector, context );\n\t\t}\n\t\tjQuery.extend( true, jQuerySub, this );\n\t\tjQuerySub.superclass = this;\n\t\tjQuerySub.fn = jQuerySub.prototype = this();\n\t\tjQuerySub.fn.constructor = jQuerySub;\n\t\tjQuerySub.sub = this.sub;\n\t\tjQuerySub.fn.init = function init( selector, context ) {\n\t\t\tif ( context && context instanceof jQuery && !(context instanceof jQuerySub) ) {\n\t\t\t\tcontext = jQuerySub( context );\n\t\t\t}\n\n\t\t\treturn jQuery.fn.init.call( this, selector, context, rootjQuerySub );\n\t\t};\n\t\tjQuerySub.fn.init.prototype = jQuerySub.fn;\n\t\tvar rootjQuerySub = jQuerySub(document);\n\t\treturn jQuerySub;\n\t},\n\n\tbrowser: {}\n});\n\n// Populate the class2type map\njQuery.each(\"Boolean Number String Function Array Date RegExp Object\".split(\" \"), function(i, name) {\n\tclass2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\n});\n\nbrowserMatch = jQuery.uaMatch( userAgent );\nif ( browserMatch.browser ) {\n\tjQuery.browser[ browserMatch.browser ] = true;\n\tjQuery.browser.version = browserMatch.version;\n}\n\n// Deprecated, use jQuery.browser.webkit instead\nif ( jQuery.browser.webkit ) {\n\tjQuery.browser.safari = true;\n}\n\n// IE doesn't match non-breaking spaces with \\s\nif ( rnotwhite.test( \"\\xA0\" ) ) {\n\ttrimLeft = /^[\\s\\xA0]+/;\n\ttrimRight = /[\\s\\xA0]+$/;\n}\n\n// All jQuery objects should point back to these\nrootjQuery = jQuery(document);\n\n// Cleanup functions for the document ready method\nif ( document.addEventListener ) {\n\tDOMContentLoaded = function() {\n\t\tdocument.removeEventListener( \"DOMContentLoaded\", DOMContentLoaded, false );\n\t\tjQuery.ready();\n\t};\n\n} else if ( document.attachEvent ) {\n\tDOMContentLoaded = function() {\n\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n\t\tif ( document.readyState === \"complete\" ) {\n\t\t\tdocument.detachEvent( \"onreadystatechange\", DOMContentLoaded );\n\t\t\tjQuery.ready();\n\t\t}\n\t};\n}\n\n// The DOM ready check for Internet Explorer\nfunction doScrollCheck() {\n\tif ( jQuery.isReady ) {\n\t\treturn;\n\t}\n\n\ttry {\n\t\t// If IE is used, use the trick by Diego Perini\n\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\tdocument.documentElement.doScroll(\"left\");\n\t} catch(e) {\n\t\tsetTimeout( doScrollCheck, 1 );\n\t\treturn;\n\t}\n\n\t// and execute any waiting functions\n\tjQuery.ready();\n}\n\nreturn jQuery;\n\n})();\n\n\n// String to Object flags format cache\nvar flagsCache = {};\n\n// Convert String-formatted flags into Object-formatted ones and store in cache\nfunction createFlags( flags ) {\n\tvar object = flagsCache[ flags ] = {},\n\t\ti, length;\n\tflags = flags.split( /\\s+/ );\n\tfor ( i = 0, length = flags.length; i < length; i++ ) {\n\t\tobject[ flags[i] ] = true;\n\t}\n\treturn object;\n}\n\n/*\n * Create a callback list using the following parameters:\n *\n *\tflags:\tan optional list of space-separated flags that will change how\n *\t\t\tthe callback list behaves\n *\n * By default a callback list will act like an event callback list and can be\n * \"fired\" multiple times.\n *\n * Possible flags:\n *\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n *\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n *\t\t\t\t\tafter the list has been fired right away with the latest \"memorized\"\n *\t\t\t\t\tvalues (like a Deferred)\n *\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n *\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\n *\n */\njQuery.Callbacks = function( flags ) {\n\n\t// Convert flags from String-formatted to Object-formatted\n\t// (we check in cache first)\n\tflags = flags ? ( flagsCache[ flags ] || createFlags( flags ) ) : {};\n\n\tvar // Actual callback list\n\t\tlist = [],\n\t\t// Stack of fire calls for repeatable lists\n\t\tstack = [],\n\t\t// Last fire value (for non-forgettable lists)\n\t\tmemory,\n\t\t// Flag to know if list was already fired\n\t\tfired,\n\t\t// Flag to know if list is currently firing\n\t\tfiring,\n\t\t// First callback to fire (used internally by add and fireWith)\n\t\tfiringStart,\n\t\t// End of the loop when firing\n\t\tfiringLength,\n\t\t// Index of currently firing callback (modified by remove if needed)\n\t\tfiringIndex,\n\t\t// Add one or several callbacks to the list\n\t\tadd = function( args ) {\n\t\t\tvar i,\n\t\t\t\tlength,\n\t\t\t\telem,\n\t\t\t\ttype,\n\t\t\t\tactual;\n\t\t\tfor ( i = 0, length = args.length; i < length; i++ ) {\n\t\t\t\telem = args[ i ];\n\t\t\t\ttype = jQuery.type( elem );\n\t\t\t\tif ( type === \"array\" ) {\n\t\t\t\t\t// Inspect recursively\n\t\t\t\t\tadd( elem );\n\t\t\t\t} else if ( type === \"function\" ) {\n\t\t\t\t\t// Add if not in unique mode and callback is not in\n\t\t\t\t\tif ( !flags.unique || !self.has( elem ) ) {\n\t\t\t\t\t\tlist.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// Fire callbacks\n\t\tfire = function( context, args ) {\n\t\t\targs = args || [];\n\t\t\tmemory = !flags.memory || [ context, args ];\n\t\t\tfired = true;\n\t\t\tfiring = true;\n\t\t\tfiringIndex = firingStart || 0;\n\t\t\tfiringStart = 0;\n\t\t\tfiringLength = list.length;\n\t\t\tfor ( ; list && firingIndex < firingLength; firingIndex++ ) {\n\t\t\t\tif ( list[ firingIndex ].apply( context, args ) === false && flags.stopOnFalse ) {\n\t\t\t\t\tmemory = true; // Mark as halted\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfiring = false;\n\t\t\tif ( list ) {\n\t\t\t\tif ( !flags.once ) {\n\t\t\t\t\tif ( stack && stack.length ) {\n\t\t\t\t\t\tmemory = stack.shift();\n\t\t\t\t\t\tself.fireWith( memory[ 0 ], memory[ 1 ] );\n\t\t\t\t\t}\n\t\t\t\t} else if ( memory === true ) {\n\t\t\t\t\tself.disable();\n\t\t\t\t} else {\n\t\t\t\t\tlist = [];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// Actual Callbacks object\n\t\tself = {\n\t\t\t// Add a callback or a collection of callbacks to the list\n\t\t\tadd: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tvar length = list.length;\n\t\t\t\t\tadd( arguments );\n\t\t\t\t\t// Do we need to add the callbacks to the\n\t\t\t\t\t// current firing batch?\n\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\tfiringLength = list.length;\n\t\t\t\t\t// With memory, if we're not firing then\n\t\t\t\t\t// we should call right away, unless previous\n\t\t\t\t\t// firing was halted (stopOnFalse)\n\t\t\t\t\t} else if ( memory && memory !== true ) {\n\t\t\t\t\t\tfiringStart = length;\n\t\t\t\t\t\tfire( memory[ 0 ], memory[ 1 ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Remove a callback from the list\n\t\t\tremove: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tvar args = arguments,\n\t\t\t\t\t\targIndex = 0,\n\t\t\t\t\t\targLength = args.length;\n\t\t\t\t\tfor ( ; argIndex < argLength ; argIndex++ ) {\n\t\t\t\t\t\tfor ( var i = 0; i < list.length; i++ ) {\n\t\t\t\t\t\t\tif ( args[ argIndex ] === list[ i ] ) {\n\t\t\t\t\t\t\t\t// Handle firingIndex and firingLength\n\t\t\t\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\t\t\t\tif ( i <= firingLength ) {\n\t\t\t\t\t\t\t\t\t\tfiringLength--;\n\t\t\t\t\t\t\t\t\t\tif ( i <= firingIndex ) {\n\t\t\t\t\t\t\t\t\t\t\tfiringIndex--;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Remove the element\n\t\t\t\t\t\t\t\tlist.splice( i--, 1 );\n\t\t\t\t\t\t\t\t// If we have some unicity property then\n\t\t\t\t\t\t\t\t// we only need to do this once\n\t\t\t\t\t\t\t\tif ( flags.unique ) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Control if a given callback is in the list\n\t\t\thas: function( fn ) {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tvar i = 0,\n\t\t\t\t\t\tlength = list.length;\n\t\t\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\t\t\tif ( fn === list[ i ] ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\t// Remove all callbacks from the list\n\t\t\tempty: function() {\n\t\t\t\tlist = [];\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Have the list do nothing anymore\n\t\t\tdisable: function() {\n\t\t\t\tlist = stack = memory = undefined;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Is it disabled?\n\t\t\tdisabled: function() {\n\t\t\t\treturn !list;\n\t\t\t},\n\t\t\t// Lock the list in its current state\n\t\t\tlock: function() {\n\t\t\t\tstack = undefined;\n\t\t\t\tif ( !memory || memory === true ) {\n\t\t\t\t\tself.disable();\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Is it locked?\n\t\t\tlocked: function() {\n\t\t\t\treturn !stack;\n\t\t\t},\n\t\t\t// Call all callbacks with the given context and arguments\n\t\t\tfireWith: function( context, args ) {\n\t\t\t\tif ( stack ) {\n\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\tif ( !flags.once ) {\n\t\t\t\t\t\t\tstack.push( [ context, args ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( !( flags.once && memory ) ) {\n\t\t\t\t\t\tfire( context, args );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Call all the callbacks with the given arguments\n\t\t\tfire: function() {\n\t\t\t\tself.fireWith( this, arguments );\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// To know if the callbacks have already been called at least once\n\t\t\tfired: function() {\n\t\t\t\treturn !!fired;\n\t\t\t}\n\t\t};\n\n\treturn self;\n};\n\n\n\n\nvar // Static reference to slice\n\tsliceDeferred = [].slice;\n\njQuery.extend({\n\n\tDeferred: function( func ) {\n\t\tvar doneList = jQuery.Callbacks( \"once memory\" ),\n\t\t\tfailList = jQuery.Callbacks( \"once memory\" ),\n\t\t\tprogressList = jQuery.Callbacks( \"memory\" ),\n\t\t\tstate = \"pending\",\n\t\t\tlists = {\n\t\t\t\tresolve: doneList,\n\t\t\t\treject: failList,\n\t\t\t\tnotify: progressList\n\t\t\t},\n\t\t\tpromise = {\n\t\t\t\tdone: doneList.add,\n\t\t\t\tfail: failList.add,\n\t\t\t\tprogress: progressList.add,\n\n\t\t\t\tstate: function() {\n\t\t\t\t\treturn state;\n\t\t\t\t},\n\n\t\t\t\t// Deprecated\n\t\t\t\tisResolved: doneList.fired,\n\t\t\t\tisRejected: failList.fired,\n\n\t\t\t\tthen: function( doneCallbacks, failCallbacks, progressCallbacks ) {\n\t\t\t\t\tdeferred.done( doneCallbacks ).fail( failCallbacks ).progress( progressCallbacks );\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\talways: function() {\n\t\t\t\t\tdeferred.done.apply( deferred, arguments ).fail.apply( deferred, arguments );\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\tpipe: function( fnDone, fnFail, fnProgress ) {\n\t\t\t\t\treturn jQuery.Deferred(function( newDefer ) {\n\t\t\t\t\t\tjQuery.each( {\n\t\t\t\t\t\t\tdone: [ fnDone, \"resolve\" ],\n\t\t\t\t\t\t\tfail: [ fnFail, \"reject\" ],\n\t\t\t\t\t\t\tprogress: [ fnProgress, \"notify\" ]\n\t\t\t\t\t\t}, function( handler, data ) {\n\t\t\t\t\t\t\tvar fn = data[ 0 ],\n\t\t\t\t\t\t\t\taction = data[ 1 ],\n\t\t\t\t\t\t\t\treturned;\n\t\t\t\t\t\t\tif ( jQuery.isFunction( fn ) ) {\n\t\t\t\t\t\t\t\tdeferred[ handler ](function() {\n\t\t\t\t\t\t\t\t\treturned = fn.apply( this, arguments );\n\t\t\t\t\t\t\t\t\tif ( returned && jQuery.isFunction( returned.promise ) ) {\n\t\t\t\t\t\t\t\t\t\treturned.promise().then( newDefer.resolve, newDefer.reject, newDefer.notify );\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tnewDefer[ action + \"With\" ]( this === deferred ? newDefer : this, [ returned ] );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdeferred[ handler ]( newDefer[ action ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}).promise();\n\t\t\t\t},\n\t\t\t\t// Get a promise for this deferred\n\t\t\t\t// If obj is provided, the promise aspect is added to the object\n\t\t\t\tpromise: function( obj ) {\n\t\t\t\t\tif ( obj == null ) {\n\t\t\t\t\t\tobj = promise;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor ( var key in promise ) {\n\t\t\t\t\t\t\tobj[ key ] = promise[ key ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeferred = promise.promise({}),\n\t\t\tkey;\n\n\t\tfor ( key in lists ) {\n\t\t\tdeferred[ key ] = lists[ key ].fire;\n\t\t\tdeferred[ key + \"With\" ] = lists[ key ].fireWith;\n\t\t}\n\n\t\t// Handle state\n\t\tdeferred.done( function() {\n\t\t\tstate = \"resolved\";\n\t\t}, failList.disable, progressList.lock ).fail( function() {\n\t\t\tstate = \"rejected\";\n\t\t}, doneList.disable, progressList.lock );\n\n\t\t// Call given func if any\n\t\tif ( func ) {\n\t\t\tfunc.call( deferred, deferred );\n\t\t}\n\n\t\t// All done!\n\t\treturn deferred;\n\t},\n\n\t// Deferred helper\n\twhen: function( firstParam ) {\n\t\tvar args = sliceDeferred.call( arguments, 0 ),\n\t\t\ti = 0,\n\t\t\tlength = args.length,\n\t\t\tpValues = new Array( length ),\n\t\t\tcount = length,\n\t\t\tpCount = length,\n\t\t\tdeferred = length <= 1 && firstParam && jQuery.isFunction( firstParam.promise ) ?\n\t\t\t\tfirstParam :\n\t\t\t\tjQuery.Deferred(),\n\t\t\tpromise = deferred.promise();\n\t\tfunction resolveFunc( i ) {\n\t\t\treturn function( value ) {\n\t\t\t\targs[ i ] = arguments.length > 1 ? sliceDeferred.call( arguments, 0 ) : value;\n\t\t\t\tif ( !( --count ) ) {\n\t\t\t\t\tdeferred.resolveWith( deferred, args );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tfunction progressFunc( i ) {\n\t\t\treturn function( value ) {\n\t\t\t\tpValues[ i ] = arguments.length > 1 ? sliceDeferred.call( arguments, 0 ) : value;\n\t\t\t\tdeferred.notifyWith( promise, pValues );\n\t\t\t};\n\t\t}\n\t\tif ( length > 1 ) {\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tif ( args[ i ] && args[ i ].promise && jQuery.isFunction( args[ i ].promise ) ) {\n\t\t\t\t\targs[ i ].promise().then( resolveFunc(i), deferred.reject, progressFunc(i) );\n\t\t\t\t} else {\n\t\t\t\t\t--count;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( !count ) {\n\t\t\t\tdeferred.resolveWith( deferred, args );\n\t\t\t}\n\t\t} else if ( deferred !== firstParam ) {\n\t\t\tdeferred.resolveWith( deferred, length ? [ firstParam ] : [] );\n\t\t}\n\t\treturn promise;\n\t}\n});\n\n\n\n\njQuery.support = (function() {\n\n\tvar support,\n\t\tall,\n\t\ta,\n\t\tselect,\n\t\topt,\n\t\tinput,\n\t\tfragment,\n\t\ttds,\n\t\tevents,\n\t\teventName,\n\t\ti,\n\t\tisSupported,\n\t\tdiv = document.createElement( \"div\" ),\n\t\tdocumentElement = document.documentElement;\n\n\t// Preliminary tests\n\tdiv.setAttribute(\"className\", \"t\");\n\tdiv.innerHTML = \"   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>\";\n\n\tall = div.getElementsByTagName( \"*\" );\n\ta = div.getElementsByTagName( \"a\" )[ 0 ];\n\n\t// Can't get basic test support\n\tif ( !all || !all.length || !a ) {\n\t\treturn {};\n\t}\n\n\t// First batch of supports tests\n\tselect = document.createElement( \"select\" );\n\topt = select.appendChild( document.createElement(\"option\") );\n\tinput = div.getElementsByTagName( \"input\" )[ 0 ];\n\n\tsupport = {\n\t\t// IE strips leading whitespace when .innerHTML is used\n\t\tleadingWhitespace: ( div.firstChild.nodeType === 3 ),\n\n\t\t// Make sure that tbody elements aren't automatically inserted\n\t\t// IE will insert them into empty tables\n\t\ttbody: !div.getElementsByTagName(\"tbody\").length,\n\n\t\t// Make sure that link elements get serialized correctly by innerHTML\n\t\t// This requires a wrapper element in IE\n\t\thtmlSerialize: !!div.getElementsByTagName(\"link\").length,\n\n\t\t// Get the style information from getAttribute\n\t\t// (IE uses .cssText instead)\n\t\tstyle: /top/.test( a.getAttribute(\"style\") ),\n\n\t\t// Make sure that URLs aren't manipulated\n\t\t// (IE normalizes it by default)\n\t\threfNormalized: ( a.getAttribute(\"href\") === \"/a\" ),\n\n\t\t// Make sure that element opacity exists\n\t\t// (IE uses filter instead)\n\t\t// Use a regex to work around a WebKit issue. See #5145\n\t\topacity: /^0.55/.test( a.style.opacity ),\n\n\t\t// Verify style float existence\n\t\t// (IE uses styleFloat instead of cssFloat)\n\t\tcssFloat: !!a.style.cssFloat,\n\n\t\t// Make sure that if no value is specified for a checkbox\n\t\t// that it defaults to \"on\".\n\t\t// (WebKit defaults to \"\" instead)\n\t\tcheckOn: ( input.value === \"on\" ),\n\n\t\t// Make sure that a selected-by-default option has a working selected property.\n\t\t// (WebKit defaults to false instead of true, IE too, if it's in an optgroup)\n\t\toptSelected: opt.selected,\n\n\t\t// Test setAttribute on camelCase class. If it works, we need attrFixes when doing get/setAttribute (ie6/7)\n\t\tgetSetAttribute: div.className !== \"t\",\n\n\t\t// Tests for enctype support on a form(#6743)\n\t\tenctype: !!document.createElement(\"form\").enctype,\n\n\t\t// Makes sure cloning an html5 element does not cause problems\n\t\t// Where outerHTML is undefined, this still works\n\t\thtml5Clone: document.createElement(\"nav\").cloneNode( true ).outerHTML !== \"<:nav></:nav>\",\n\n\t\t// Will be defined later\n\t\tsubmitBubbles: true,\n\t\tchangeBubbles: true,\n\t\tfocusinBubbles: false,\n\t\tdeleteExpando: true,\n\t\tnoCloneEvent: true,\n\t\tinlineBlockNeedsLayout: false,\n\t\tshrinkWrapBlocks: false,\n\t\treliableMarginRight: true,\n\t\tpixelMargin: true\n\t};\n\n\t// jQuery.boxModel DEPRECATED in 1.3, use jQuery.support.boxModel instead\n\tjQuery.boxModel = support.boxModel = (document.compatMode === \"CSS1Compat\");\n\n\t// Make sure checked status is properly cloned\n\tinput.checked = true;\n\tsupport.noCloneChecked = input.cloneNode( true ).checked;\n\n\t// Make sure that the options inside disabled selects aren't marked as disabled\n\t// (WebKit marks them as disabled)\n\tselect.disabled = true;\n\tsupport.optDisabled = !opt.disabled;\n\n\t// Test to see if it's possible to delete an expando from an element\n\t// Fails in Internet Explorer\n\ttry {\n\t\tdelete div.test;\n\t} catch( e ) {\n\t\tsupport.deleteExpando = false;\n\t}\n\n\tif ( !div.addEventListener && div.attachEvent && div.fireEvent ) {\n\t\tdiv.attachEvent( \"onclick\", function() {\n\t\t\t// Cloning a node shouldn't copy over any\n\t\t\t// bound event handlers (IE does this)\n\t\t\tsupport.noCloneEvent = false;\n\t\t});\n\t\tdiv.cloneNode( true ).fireEvent( \"onclick\" );\n\t}\n\n\t// Check if a radio maintains its value\n\t// after being appended to the DOM\n\tinput = document.createElement(\"input\");\n\tinput.value = \"t\";\n\tinput.setAttribute(\"type\", \"radio\");\n\tsupport.radioValue = input.value === \"t\";\n\n\tinput.setAttribute(\"checked\", \"checked\");\n\n\t// #11217 - WebKit loses check when the name is after the checked attribute\n\tinput.setAttribute( \"name\", \"t\" );\n\n\tdiv.appendChild( input );\n\tfragment = document.createDocumentFragment();\n\tfragment.appendChild( div.lastChild );\n\n\t// WebKit doesn't clone checked state correctly in fragments\n\tsupport.checkClone = fragment.cloneNode( true ).cloneNode( true ).lastChild.checked;\n\n\t// Check if a disconnected checkbox will retain its checked\n\t// value of true after appended to the DOM (IE6/7)\n\tsupport.appendChecked = input.checked;\n\n\tfragment.removeChild( input );\n\tfragment.appendChild( div );\n\n\t// Technique from Juriy Zaytsev\n\t// http://perfectionkills.com/detecting-event-support-without-browser-sniffing/\n\t// We only care about the case where non-standard event systems\n\t// are used, namely in IE. Short-circuiting here helps us to\n\t// avoid an eval call (in setAttribute) which can cause CSP\n\t// to go haywire. See: https://developer.mozilla.org/en/Security/CSP\n\tif ( div.attachEvent ) {\n\t\tfor ( i in {\n\t\t\tsubmit: 1,\n\t\t\tchange: 1,\n\t\t\tfocusin: 1\n\t\t}) {\n\t\t\teventName = \"on\" + i;\n\t\t\tisSupported = ( eventName in div );\n\t\t\tif ( !isSupported ) {\n\t\t\t\tdiv.setAttribute( eventName, \"return;\" );\n\t\t\t\tisSupported = ( typeof div[ eventName ] === \"function\" );\n\t\t\t}\n\t\t\tsupport[ i + \"Bubbles\" ] = isSupported;\n\t\t}\n\t}\n\n\tfragment.removeChild( div );\n\n\t// Null elements to avoid leaks in IE\n\tfragment = select = opt = div = input = null;\n\n\t// Run tests that need a body at doc ready\n\tjQuery(function() {\n\t\tvar container, outer, inner, table, td, offsetSupport,\n\t\t\tmarginDiv, conMarginTop, style, html, positionTopLeftWidthHeight,\n\t\t\tpaddingMarginBorderVisibility, paddingMarginBorder,\n\t\t\tbody = document.getElementsByTagName(\"body\")[0];\n\n\t\tif ( !body ) {\n\t\t\t// Return for frameset docs that don't have a body\n\t\t\treturn;\n\t\t}\n\n\t\tconMarginTop = 1;\n\t\tpaddingMarginBorder = \"padding:0;margin:0;border:\";\n\t\tpositionTopLeftWidthHeight = \"position:absolute;top:0;left:0;width:1px;height:1px;\";\n\t\tpaddingMarginBorderVisibility = paddingMarginBorder + \"0;visibility:hidden;\";\n\t\tstyle = \"style='\" + positionTopLeftWidthHeight + paddingMarginBorder + \"5px solid #000;\";\n\t\thtml = \"<div \" + style + \"display:block;'><div style='\" + paddingMarginBorder + \"0;display:block;overflow:hidden;'></div></div>\" +\n\t\t\t\"<table \" + style + \"' cellpadding='0' cellspacing='0'>\" +\n\t\t\t\"<tr><td></td></tr></table>\";\n\n\t\tcontainer = document.createElement(\"div\");\n\t\tcontainer.style.cssText = paddingMarginBorderVisibility + \"width:0;height:0;position:static;top:0;margin-top:\" + conMarginTop + \"px\";\n\t\tbody.insertBefore( container, body.firstChild );\n\n\t\t// Construct the test element\n\t\tdiv = document.createElement(\"div\");\n\t\tcontainer.appendChild( div );\n\n\t\t// Check if table cells still have offsetWidth/Height when they are set\n\t\t// to display:none and there are still other visible table cells in a\n\t\t// table row; if so, offsetWidth/Height are not reliable for use when\n\t\t// determining if an element has been hidden directly using\n\t\t// display:none (it is still safe to use offsets if a parent element is\n\t\t// hidden; don safety goggles and see bug #4512 for more information).\n\t\t// (only IE 8 fails this test)\n\t\tdiv.innerHTML = \"<table><tr><td style='\" + paddingMarginBorder + \"0;display:none'></td><td>t</td></tr></table>\";\n\t\ttds = div.getElementsByTagName( \"td\" );\n\t\tisSupported = ( tds[ 0 ].offsetHeight === 0 );\n\n\t\ttds[ 0 ].style.display = \"\";\n\t\ttds[ 1 ].style.display = \"none\";\n\n\t\t// Check if empty table cells still have offsetWidth/Height\n\t\t// (IE <= 8 fail this test)\n\t\tsupport.reliableHiddenOffsets = isSupported && ( tds[ 0 ].offsetHeight === 0 );\n\n\t\t// Check if div with explicit width and no margin-right incorrectly\n\t\t// gets computed margin-right based on width of container. For more\n\t\t// info see bug #3333\n\t\t// Fails in WebKit before Feb 2011 nightlies\n\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n\t\tif ( window.getComputedStyle ) {\n\t\t\tdiv.innerHTML = \"\";\n\t\t\tmarginDiv = document.createElement( \"div\" );\n\t\t\tmarginDiv.style.width = \"0\";\n\t\t\tmarginDiv.style.marginRight = \"0\";\n\t\t\tdiv.style.width = \"2px\";\n\t\t\tdiv.appendChild( marginDiv );\n\t\t\tsupport.reliableMarginRight =\n\t\t\t\t( parseInt( ( window.getComputedStyle( marginDiv, null ) || { marginRight: 0 } ).marginRight, 10 ) || 0 ) === 0;\n\t\t}\n\n\t\tif ( typeof div.style.zoom !== \"undefined\" ) {\n\t\t\t// Check if natively block-level elements act like inline-block\n\t\t\t// elements when setting their display to 'inline' and giving\n\t\t\t// them layout\n\t\t\t// (IE < 8 does this)\n\t\t\tdiv.innerHTML = \"\";\n\t\t\tdiv.style.width = div.style.padding = \"1px\";\n\t\t\tdiv.style.border = 0;\n\t\t\tdiv.style.overflow = \"hidden\";\n\t\t\tdiv.style.display = \"inline\";\n\t\t\tdiv.style.zoom = 1;\n\t\t\tsupport.inlineBlockNeedsLayout = ( div.offsetWidth === 3 );\n\n\t\t\t// Check if elements with layout shrink-wrap their children\n\t\t\t// (IE 6 does this)\n\t\t\tdiv.style.display = \"block\";\n\t\t\tdiv.style.overflow = \"visible\";\n\t\t\tdiv.innerHTML = \"<div style='width:5px;'></div>\";\n\t\t\tsupport.shrinkWrapBlocks = ( div.offsetWidth !== 3 );\n\t\t}\n\n\t\tdiv.style.cssText = positionTopLeftWidthHeight + paddingMarginBorderVisibility;\n\t\tdiv.innerHTML = html;\n\n\t\touter = div.firstChild;\n\t\tinner = outer.firstChild;\n\t\ttd = outer.nextSibling.firstChild.firstChild;\n\n\t\toffsetSupport = {\n\t\t\tdoesNotAddBorder: ( inner.offsetTop !== 5 ),\n\t\t\tdoesAddBorderForTableAndCells: ( td.offsetTop === 5 )\n\t\t};\n\n\t\tinner.style.position = \"fixed\";\n\t\tinner.style.top = \"20px\";\n\n\t\t// safari subtracts parent border width here which is 5px\n\t\toffsetSupport.fixedPosition = ( inner.offsetTop === 20 || inner.offsetTop === 15 );\n\t\tinner.style.position = inner.style.top = \"\";\n\n\t\touter.style.overflow = \"hidden\";\n\t\touter.style.position = \"relative\";\n\n\t\toffsetSupport.subtractsBorderForOverflowNotVisible = ( inner.offsetTop === -5 );\n\t\toffsetSupport.doesNotIncludeMarginInBodyOffset = ( body.offsetTop !== conMarginTop );\n\n\t\tif ( window.getComputedStyle ) {\n\t\t\tdiv.style.marginTop = \"1%\";\n\t\t\tsupport.pixelMargin = ( window.getComputedStyle( div, null ) || { marginTop: 0 } ).marginTop !== \"1%\";\n\t\t}\n\n\t\tif ( typeof container.style.zoom !== \"undefined\" ) {\n\t\t\tcontainer.style.zoom = 1;\n\t\t}\n\n\t\tbody.removeChild( container );\n\t\tmarginDiv = div = container = null;\n\n\t\tjQuery.extend( support, offsetSupport );\n\t});\n\n\treturn support;\n})();\n\n\n\n\nvar rbrace = /^(?:\\{.*\\}|\\[.*\\])$/,\n\trmultiDash = /([A-Z])/g;\n\njQuery.extend({\n\tcache: {},\n\n\t// Please use with caution\n\tuuid: 0,\n\n\t// Unique for each copy of jQuery on the page\n\t// Non-digits removed to match rinlinejQuery\n\texpando: \"jQuery\" + ( jQuery.fn.jquery + Math.random() ).replace( /\\D/g, \"\" ),\n\n\t// The following elements throw uncatchable exceptions if you\n\t// attempt to add expando properties to them.\n\tnoData: {\n\t\t\"embed\": true,\n\t\t// Ban all objects except for Flash (which handle expandos)\n\t\t\"object\": \"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\",\n\t\t\"applet\": true\n\t},\n\n\thasData: function( elem ) {\n\t\telem = elem.nodeType ? jQuery.cache[ elem[jQuery.expando] ] : elem[ jQuery.expando ];\n\t\treturn !!elem && !isEmptyDataObject( elem );\n\t},\n\n\tdata: function( elem, name, data, pvt /* Internal Use Only */ ) {\n\t\tif ( !jQuery.acceptData( elem ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar privateCache, thisCache, ret,\n\t\t\tinternalKey = jQuery.expando,\n\t\t\tgetByName = typeof name === \"string\",\n\n\t\t\t// We have to handle DOM nodes and JS objects differently because IE6-7\n\t\t\t// can't GC object references properly across the DOM-JS boundary\n\t\t\tisNode = elem.nodeType,\n\n\t\t\t// Only DOM nodes need the global jQuery cache; JS object data is\n\t\t\t// attached directly to the object so GC can occur automatically\n\t\t\tcache = isNode ? jQuery.cache : elem,\n\n\t\t\t// Only defining an ID for JS objects if its cache already exists allows\n\t\t\t// the code to shortcut on the same path as a DOM node with no cache\n\t\t\tid = isNode ? elem[ internalKey ] : elem[ internalKey ] && internalKey,\n\t\t\tisEvents = name === \"events\";\n\n\t\t// Avoid doing any more work than we need to when trying to get data on an\n\t\t// object that has no data at all\n\t\tif ( (!id || !cache[id] || (!isEvents && !pvt && !cache[id].data)) && getByName && data === undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !id ) {\n\t\t\t// Only DOM nodes need a new unique ID for each element since their data\n\t\t\t// ends up in the global cache\n\t\t\tif ( isNode ) {\n\t\t\t\telem[ internalKey ] = id = ++jQuery.uuid;\n\t\t\t} else {\n\t\t\t\tid = internalKey;\n\t\t\t}\n\t\t}\n\n\t\tif ( !cache[ id ] ) {\n\t\t\tcache[ id ] = {};\n\n\t\t\t// Avoids exposing jQuery metadata on plain JS objects when the object\n\t\t\t// is serialized using JSON.stringify\n\t\t\tif ( !isNode ) {\n\t\t\t\tcache[ id ].toJSON = jQuery.noop;\n\t\t\t}\n\t\t}\n\n\t\t// An object can be passed to jQuery.data instead of a key/value pair; this gets\n\t\t// shallow copied over onto the existing cache\n\t\tif ( typeof name === \"object\" || typeof name === \"function\" ) {\n\t\t\tif ( pvt ) {\n\t\t\t\tcache[ id ] = jQuery.extend( cache[ id ], name );\n\t\t\t} else {\n\t\t\t\tcache[ id ].data = jQuery.extend( cache[ id ].data, name );\n\t\t\t}\n\t\t}\n\n\t\tprivateCache = thisCache = cache[ id ];\n\n\t\t// jQuery data() is stored in a separate object inside the object's internal data\n\t\t// cache in order to avoid key collisions between internal data and user-defined\n\t\t// data.\n\t\tif ( !pvt ) {\n\t\t\tif ( !thisCache.data ) {\n\t\t\t\tthisCache.data = {};\n\t\t\t}\n\n\t\t\tthisCache = thisCache.data;\n\t\t}\n\n\t\tif ( data !== undefined ) {\n\t\t\tthisCache[ jQuery.camelCase( name ) ] = data;\n\t\t}\n\n\t\t// Users should not attempt to inspect the internal events object using jQuery.data,\n\t\t// it is undocumented and subject to change. But does anyone listen? No.\n\t\tif ( isEvents && !thisCache[ name ] ) {\n\t\t\treturn privateCache.events;\n\t\t}\n\n\t\t// Check for both converted-to-camel and non-converted data property names\n\t\t// If a data property was specified\n\t\tif ( getByName ) {\n\n\t\t\t// First Try to find as-is property data\n\t\t\tret = thisCache[ name ];\n\n\t\t\t// Test for null|undefined property data\n\t\t\tif ( ret == null ) {\n\n\t\t\t\t// Try to find the camelCased property\n\t\t\t\tret = thisCache[ jQuery.camelCase( name ) ];\n\t\t\t}\n\t\t} else {\n\t\t\tret = thisCache;\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tremoveData: function( elem, name, pvt /* Internal Use Only */ ) {\n\t\tif ( !jQuery.acceptData( elem ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar thisCache, i, l,\n\n\t\t\t// Reference to internal data cache key\n\t\t\tinternalKey = jQuery.expando,\n\n\t\t\tisNode = elem.nodeType,\n\n\t\t\t// See jQuery.data for more information\n\t\t\tcache = isNode ? jQuery.cache : elem,\n\n\t\t\t// See jQuery.data for more information\n\t\t\tid = isNode ? elem[ internalKey ] : internalKey;\n\n\t\t// If there is already no cache entry for this object, there is no\n\t\t// purpose in continuing\n\t\tif ( !cache[ id ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( name ) {\n\n\t\t\tthisCache = pvt ? cache[ id ] : cache[ id ].data;\n\n\t\t\tif ( thisCache ) {\n\n\t\t\t\t// Support array or space separated string names for data keys\n\t\t\t\tif ( !jQuery.isArray( name ) ) {\n\n\t\t\t\t\t// try the string as a key before any manipulation\n\t\t\t\t\tif ( name in thisCache ) {\n\t\t\t\t\t\tname = [ name ];\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// split the camel cased version by spaces unless a key with the spaces exists\n\t\t\t\t\t\tname = jQuery.camelCase( name );\n\t\t\t\t\t\tif ( name in thisCache ) {\n\t\t\t\t\t\t\tname = [ name ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tname = name.split( \" \" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor ( i = 0, l = name.length; i < l; i++ ) {\n\t\t\t\t\tdelete thisCache[ name[i] ];\n\t\t\t\t}\n\n\t\t\t\t// If there is no data left in the cache, we want to continue\n\t\t\t\t// and let the cache object itself get destroyed\n\t\t\t\tif ( !( pvt ? isEmptyDataObject : jQuery.isEmptyObject )( thisCache ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// See jQuery.data for more information\n\t\tif ( !pvt ) {\n\t\t\tdelete cache[ id ].data;\n\n\t\t\t// Don't destroy the parent cache unless the internal data object\n\t\t\t// had been the only thing left in it\n\t\t\tif ( !isEmptyDataObject(cache[ id ]) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Browsers that fail expando deletion also refuse to delete expandos on\n\t\t// the window, but it will allow it on all other JS objects; other browsers\n\t\t// don't care\n\t\t// Ensure that `cache` is not a window object #10080\n\t\tif ( jQuery.support.deleteExpando || !cache.setInterval ) {\n\t\t\tdelete cache[ id ];\n\t\t} else {\n\t\t\tcache[ id ] = null;\n\t\t}\n\n\t\t// We destroyed the cache and need to eliminate the expando on the node to avoid\n\t\t// false lookups in the cache for entries that no longer exist\n\t\tif ( isNode ) {\n\t\t\t// IE does not allow us to delete expando properties from nodes,\n\t\t\t// nor does it have a removeAttribute function on Document nodes;\n\t\t\t// we must handle all of these cases\n\t\t\tif ( jQuery.support.deleteExpando ) {\n\t\t\t\tdelete elem[ internalKey ];\n\t\t\t} else if ( elem.removeAttribute ) {\n\t\t\t\telem.removeAttribute( internalKey );\n\t\t\t} else {\n\t\t\t\telem[ internalKey ] = null;\n\t\t\t}\n\t\t}\n\t},\n\n\t// For internal use only.\n\t_data: function( elem, name, data ) {\n\t\treturn jQuery.data( elem, name, data, true );\n\t},\n\n\t// A method for determining if a DOM node can handle the data expando\n\tacceptData: function( elem ) {\n\t\tif ( elem.nodeName ) {\n\t\t\tvar match = jQuery.noData[ elem.nodeName.toLowerCase() ];\n\n\t\t\tif ( match ) {\n\t\t\t\treturn !(match === true || elem.getAttribute(\"classid\") !== match);\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n});\n\njQuery.fn.extend({\n\tdata: function( key, value ) {\n\t\tvar parts, part, attr, name, l,\n\t\t\telem = this[0],\n\t\t\ti = 0,\n\t\t\tdata = null;\n\n\t\t// Gets all values\n\t\tif ( key === undefined ) {\n\t\t\tif ( this.length ) {\n\t\t\t\tdata = jQuery.data( elem );\n\n\t\t\t\tif ( elem.nodeType === 1 && !jQuery._data( elem, \"parsedAttrs\" ) ) {\n\t\t\t\t\tattr = elem.attributes;\n\t\t\t\t\tfor ( l = attr.length; i < l; i++ ) {\n\t\t\t\t\t\tname = attr[i].name;\n\n\t\t\t\t\t\tif ( name.indexOf( \"data-\" ) === 0 ) {\n\t\t\t\t\t\t\tname = jQuery.camelCase( name.substring(5) );\n\n\t\t\t\t\t\t\tdataAttr( elem, name, data[ name ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tjQuery._data( elem, \"parsedAttrs\", true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t}\n\n\t\t// Sets multiple values\n\t\tif ( typeof key === \"object\" ) {\n\t\t\treturn this.each(function() {\n\t\t\t\tjQuery.data( this, key );\n\t\t\t});\n\t\t}\n\n\t\tparts = key.split( \".\", 2 );\n\t\tparts[1] = parts[1] ? \".\" + parts[1] : \"\";\n\t\tpart = parts[1] + \"!\";\n\n\t\treturn jQuery.access( this, function( value ) {\n\n\t\t\tif ( value === undefined ) {\n\t\t\t\tdata = this.triggerHandler( \"getData\" + part, [ parts[0] ] );\n\n\t\t\t\t// Try to fetch any internally stored data first\n\t\t\t\tif ( data === undefined && elem ) {\n\t\t\t\t\tdata = jQuery.data( elem, key );\n\t\t\t\t\tdata = dataAttr( elem, key, data );\n\t\t\t\t}\n\n\t\t\t\treturn data === undefined && parts[1] ?\n\t\t\t\t\tthis.data( parts[0] ) :\n\t\t\t\t\tdata;\n\t\t\t}\n\n\t\t\tparts[1] = value;\n\t\t\tthis.each(function() {\n\t\t\t\tvar self = jQuery( this );\n\n\t\t\t\tself.triggerHandler( \"setData\" + part, parts );\n\t\t\t\tjQuery.data( this, key, value );\n\t\t\t\tself.triggerHandler( \"changeData\" + part, parts );\n\t\t\t});\n\t\t}, null, value, arguments.length > 1, null, false );\n\t},\n\n\tremoveData: function( key ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.removeData( this, key );\n\t\t});\n\t}\n});\n\nfunction dataAttr( elem, key, data ) {\n\t// If nothing was found internally, try to fetch any\n\t// data from the HTML5 data-* attribute\n\tif ( data === undefined && elem.nodeType === 1 ) {\n\n\t\tvar name = \"data-\" + key.replace( rmultiDash, \"-$1\" ).toLowerCase();\n\n\t\tdata = elem.getAttribute( name );\n\n\t\tif ( typeof data === \"string\" ) {\n\t\t\ttry {\n\t\t\t\tdata = data === \"true\" ? true :\n\t\t\t\tdata === \"false\" ? false :\n\t\t\t\tdata === \"null\" ? null :\n\t\t\t\tjQuery.isNumeric( data ) ? +data :\n\t\t\t\t\trbrace.test( data ) ? jQuery.parseJSON( data ) :\n\t\t\t\t\tdata;\n\t\t\t} catch( e ) {}\n\n\t\t\t// Make sure we set the data so it isn't changed later\n\t\t\tjQuery.data( elem, key, data );\n\n\t\t} else {\n\t\t\tdata = undefined;\n\t\t}\n\t}\n\n\treturn data;\n}\n\n// checks a cache object for emptiness\nfunction isEmptyDataObject( obj ) {\n\tfor ( var name in obj ) {\n\n\t\t// if the public data object is empty, the private is still empty\n\t\tif ( name === \"data\" && jQuery.isEmptyObject( obj[name] ) ) {\n\t\t\tcontinue;\n\t\t}\n\t\tif ( name !== \"toJSON\" ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\n\n\n\nfunction handleQueueMarkDefer( elem, type, src ) {\n\tvar deferDataKey = type + \"defer\",\n\t\tqueueDataKey = type + \"queue\",\n\t\tmarkDataKey = type + \"mark\",\n\t\tdefer = jQuery._data( elem, deferDataKey );\n\tif ( defer &&\n\t\t( src === \"queue\" || !jQuery._data(elem, queueDataKey) ) &&\n\t\t( src === \"mark\" || !jQuery._data(elem, markDataKey) ) ) {\n\t\t// Give room for hard-coded callbacks to fire first\n\t\t// and eventually mark/queue something else on the element\n\t\tsetTimeout( function() {\n\t\t\tif ( !jQuery._data( elem, queueDataKey ) &&\n\t\t\t\t!jQuery._data( elem, markDataKey ) ) {\n\t\t\t\tjQuery.removeData( elem, deferDataKey, true );\n\t\t\t\tdefer.fire();\n\t\t\t}\n\t\t}, 0 );\n\t}\n}\n\njQuery.extend({\n\n\t_mark: function( elem, type ) {\n\t\tif ( elem ) {\n\t\t\ttype = ( type || \"fx\" ) + \"mark\";\n\t\t\tjQuery._data( elem, type, (jQuery._data( elem, type ) || 0) + 1 );\n\t\t}\n\t},\n\n\t_unmark: function( force, elem, type ) {\n\t\tif ( force !== true ) {\n\t\t\ttype = elem;\n\t\t\telem = force;\n\t\t\tforce = false;\n\t\t}\n\t\tif ( elem ) {\n\t\t\ttype = type || \"fx\";\n\t\t\tvar key = type + \"mark\",\n\t\t\t\tcount = force ? 0 : ( (jQuery._data( elem, key ) || 1) - 1 );\n\t\t\tif ( count ) {\n\t\t\t\tjQuery._data( elem, key, count );\n\t\t\t} else {\n\t\t\t\tjQuery.removeData( elem, key, true );\n\t\t\t\thandleQueueMarkDefer( elem, type, \"mark\" );\n\t\t\t}\n\t\t}\n\t},\n\n\tqueue: function( elem, type, data ) {\n\t\tvar q;\n\t\tif ( elem ) {\n\t\t\ttype = ( type || \"fx\" ) + \"queue\";\n\t\t\tq = jQuery._data( elem, type );\n\n\t\t\t// Speed up dequeue by getting out quickly if this is just a lookup\n\t\t\tif ( data ) {\n\t\t\t\tif ( !q || jQuery.isArray(data) ) {\n\t\t\t\t\tq = jQuery._data( elem, type, jQuery.makeArray(data) );\n\t\t\t\t} else {\n\t\t\t\t\tq.push( data );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn q || [];\n\t\t}\n\t},\n\n\tdequeue: function( elem, type ) {\n\t\ttype = type || \"fx\";\n\n\t\tvar queue = jQuery.queue( elem, type ),\n\t\t\tfn = queue.shift(),\n\t\t\thooks = {};\n\n\t\t// If the fx queue is dequeued, always remove the progress sentinel\n\t\tif ( fn === \"inprogress\" ) {\n\t\t\tfn = queue.shift();\n\t\t}\n\n\t\tif ( fn ) {\n\t\t\t// Add a progress sentinel to prevent the fx queue from being\n\t\t\t// automatically dequeued\n\t\t\tif ( type === \"fx\" ) {\n\t\t\t\tqueue.unshift( \"inprogress\" );\n\t\t\t}\n\n\t\t\tjQuery._data( elem, type + \".run\", hooks );\n\t\t\tfn.call( elem, function() {\n\t\t\t\tjQuery.dequeue( elem, type );\n\t\t\t}, hooks );\n\t\t}\n\n\t\tif ( !queue.length ) {\n\t\t\tjQuery.removeData( elem, type + \"queue \" + type + \".run\", true );\n\t\t\thandleQueueMarkDefer( elem, type, \"queue\" );\n\t\t}\n\t}\n});\n\njQuery.fn.extend({\n\tqueue: function( type, data ) {\n\t\tvar setter = 2;\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tdata = type;\n\t\t\ttype = \"fx\";\n\t\t\tsetter--;\n\t\t}\n\n\t\tif ( arguments.length < setter ) {\n\t\t\treturn jQuery.queue( this[0], type );\n\t\t}\n\n\t\treturn data === undefined ?\n\t\t\tthis :\n\t\t\tthis.each(function() {\n\t\t\t\tvar queue = jQuery.queue( this, type, data );\n\n\t\t\t\tif ( type === \"fx\" && queue[0] !== \"inprogress\" ) {\n\t\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t\t}\n\t\t\t});\n\t},\n\tdequeue: function( type ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.dequeue( this, type );\n\t\t});\n\t},\n\t// Based off of the plugin by Clint Helfers, with permission.\n\t// http://blindsignals.com/index.php/2009/07/jquery-delay/\n\tdelay: function( time, type ) {\n\t\ttime = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\n\t\ttype = type || \"fx\";\n\n\t\treturn this.queue( type, function( next, hooks ) {\n\t\t\tvar timeout = setTimeout( next, time );\n\t\t\thooks.stop = function() {\n\t\t\t\tclearTimeout( timeout );\n\t\t\t};\n\t\t});\n\t},\n\tclearQueue: function( type ) {\n\t\treturn this.queue( type || \"fx\", [] );\n\t},\n\t// Get a promise resolved when queues of a certain type\n\t// are emptied (fx is the type by default)\n\tpromise: function( type, object ) {\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tobject = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\ttype = type || \"fx\";\n\t\tvar defer = jQuery.Deferred(),\n\t\t\telements = this,\n\t\t\ti = elements.length,\n\t\t\tcount = 1,\n\t\t\tdeferDataKey = type + \"defer\",\n\t\t\tqueueDataKey = type + \"queue\",\n\t\t\tmarkDataKey = type + \"mark\",\n\t\t\ttmp;\n\t\tfunction resolve() {\n\t\t\tif ( !( --count ) ) {\n\t\t\t\tdefer.resolveWith( elements, [ elements ] );\n\t\t\t}\n\t\t}\n\t\twhile( i-- ) {\n\t\t\tif (( tmp = jQuery.data( elements[ i ], deferDataKey, undefined, true ) ||\n\t\t\t\t\t( jQuery.data( elements[ i ], queueDataKey, undefined, true ) ||\n\t\t\t\t\t\tjQuery.data( elements[ i ], markDataKey, undefined, true ) ) &&\n\t\t\t\t\tjQuery.data( elements[ i ], deferDataKey, jQuery.Callbacks( \"once memory\" ), true ) )) {\n\t\t\t\tcount++;\n\t\t\t\ttmp.add( resolve );\n\t\t\t}\n\t\t}\n\t\tresolve();\n\t\treturn defer.promise( object );\n\t}\n});\n\n\n\n\nvar rclass = /[\\n\\t\\r]/g,\n\trspace = /\\s+/,\n\trreturn = /\\r/g,\n\trtype = /^(?:button|input)$/i,\n\trfocusable = /^(?:button|input|object|select|textarea)$/i,\n\trclickable = /^a(?:rea)?$/i,\n\trboolean = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,\n\tgetSetAttribute = jQuery.support.getSetAttribute,\n\tnodeHook, boolHook, fixSpecified;\n\njQuery.fn.extend({\n\tattr: function( name, value ) {\n\t\treturn jQuery.access( this, jQuery.attr, name, value, arguments.length > 1 );\n\t},\n\n\tremoveAttr: function( name ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.removeAttr( this, name );\n\t\t});\n\t},\n\n\tprop: function( name, value ) {\n\t\treturn jQuery.access( this, jQuery.prop, name, value, arguments.length > 1 );\n\t},\n\n\tremoveProp: function( name ) {\n\t\tname = jQuery.propFix[ name ] || name;\n\t\treturn this.each(function() {\n\t\t\t// try/catch handles cases where IE balks (such as removing a property on window)\n\t\t\ttry {\n\t\t\t\tthis[ name ] = undefined;\n\t\t\t\tdelete this[ name ];\n\t\t\t} catch( e ) {}\n\t\t});\n\t},\n\n\taddClass: function( value ) {\n\t\tvar classNames, i, l, elem,\n\t\t\tsetClass, c, cl;\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each(function( j ) {\n\t\t\t\tjQuery( this ).addClass( value.call(this, j, this.className) );\n\t\t\t});\n\t\t}\n\n\t\tif ( value && typeof value === \"string\" ) {\n\t\t\tclassNames = value.split( rspace );\n\n\t\t\tfor ( i = 0, l = this.length; i < l; i++ ) {\n\t\t\t\telem = this[ i ];\n\n\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\tif ( !elem.className && classNames.length === 1 ) {\n\t\t\t\t\t\telem.className = value;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetClass = \" \" + elem.className + \" \";\n\n\t\t\t\t\t\tfor ( c = 0, cl = classNames.length; c < cl; c++ ) {\n\t\t\t\t\t\t\tif ( !~setClass.indexOf( \" \" + classNames[ c ] + \" \" ) ) {\n\t\t\t\t\t\t\t\tsetClass += classNames[ c ] + \" \";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telem.className = jQuery.trim( setClass );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveClass: function( value ) {\n\t\tvar classNames, i, l, elem, className, c, cl;\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each(function( j ) {\n\t\t\t\tjQuery( this ).removeClass( value.call(this, j, this.className) );\n\t\t\t});\n\t\t}\n\n\t\tif ( (value && typeof value === \"string\") || value === undefined ) {\n\t\t\tclassNames = ( value || \"\" ).split( rspace );\n\n\t\t\tfor ( i = 0, l = this.length; i < l; i++ ) {\n\t\t\t\telem = this[ i ];\n\n\t\t\t\tif ( elem.nodeType === 1 && elem.className ) {\n\t\t\t\t\tif ( value ) {\n\t\t\t\t\t\tclassName = (\" \" + elem.className + \" \").replace( rclass, \" \" );\n\t\t\t\t\t\tfor ( c = 0, cl = classNames.length; c < cl; c++ ) {\n\t\t\t\t\t\t\tclassName = className.replace(\" \" + classNames[ c ] + \" \", \" \");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telem.className = jQuery.trim( className );\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\telem.className = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\ttoggleClass: function( value, stateVal ) {\n\t\tvar type = typeof value,\n\t\t\tisBool = typeof stateVal === \"boolean\";\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each(function( i ) {\n\t\t\t\tjQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );\n\t\t\t});\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tif ( type === \"string\" ) {\n\t\t\t\t// toggle individual class names\n\t\t\t\tvar className,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tself = jQuery( this ),\n\t\t\t\t\tstate = stateVal,\n\t\t\t\t\tclassNames = value.split( rspace );\n\n\t\t\t\twhile ( (className = classNames[ i++ ]) ) {\n\t\t\t\t\t// check each className given, space seperated list\n\t\t\t\t\tstate = isBool ? state : !self.hasClass( className );\n\t\t\t\t\tself[ state ? \"addClass\" : \"removeClass\" ]( className );\n\t\t\t\t}\n\n\t\t\t} else if ( type === \"undefined\" || type === \"boolean\" ) {\n\t\t\t\tif ( this.className ) {\n\t\t\t\t\t// store className if set\n\t\t\t\t\tjQuery._data( this, \"__className__\", this.className );\n\t\t\t\t}\n\n\t\t\t\t// toggle whole className\n\t\t\t\tthis.className = this.className || value === false ? \"\" : jQuery._data( this, \"__className__\" ) || \"\";\n\t\t\t}\n\t\t});\n\t},\n\n\thasClass: function( selector ) {\n\t\tvar className = \" \" + selector + \" \",\n\t\t\ti = 0,\n\t\t\tl = this.length;\n\t\tfor ( ; i < l; i++ ) {\n\t\t\tif ( this[i].nodeType === 1 && (\" \" + this[i].className + \" \").replace(rclass, \" \").indexOf( className ) > -1 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tval: function( value ) {\n\t\tvar hooks, ret, isFunction,\n\t\t\telem = this[0];\n\n\t\tif ( !arguments.length ) {\n\t\t\tif ( elem ) {\n\t\t\t\thooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];\n\n\t\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, \"value\" )) !== undefined ) {\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tret = elem.value;\n\n\t\t\t\treturn typeof ret === \"string\" ?\n\t\t\t\t\t// handle most common string cases\n\t\t\t\t\tret.replace(rreturn, \"\") :\n\t\t\t\t\t// handle cases where value is null/undef or number\n\t\t\t\t\tret == null ? \"\" : ret;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tisFunction = jQuery.isFunction( value );\n\n\t\treturn this.each(function( i ) {\n\t\t\tvar self = jQuery(this), val;\n\n\t\t\tif ( this.nodeType !== 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isFunction ) {\n\t\t\t\tval = value.call( this, i, self.val() );\n\t\t\t} else {\n\t\t\t\tval = value;\n\t\t\t}\n\n\t\t\t// Treat null/undefined as \"\"; convert numbers to string\n\t\t\tif ( val == null ) {\n\t\t\t\tval = \"\";\n\t\t\t} else if ( typeof val === \"number\" ) {\n\t\t\t\tval += \"\";\n\t\t\t} else if ( jQuery.isArray( val ) ) {\n\t\t\t\tval = jQuery.map(val, function ( value ) {\n\t\t\t\t\treturn value == null ? \"\" : value + \"\";\n\t\t\t\t});\n\t\t\t}\n\n\t\t\thooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\n\n\t\t\t// If set returns undefined, fall back to normal setting\n\t\t\tif ( !hooks || !(\"set\" in hooks) || hooks.set( this, val, \"value\" ) === undefined ) {\n\t\t\t\tthis.value = val;\n\t\t\t}\n\t\t});\n\t}\n});\n\njQuery.extend({\n\tvalHooks: {\n\t\toption: {\n\t\t\tget: function( elem ) {\n\t\t\t\t// attributes.value is undefined in Blackberry 4.7 but\n\t\t\t\t// uses .value. See #6932\n\t\t\t\tvar val = elem.attributes.value;\n\t\t\t\treturn !val || val.specified ? elem.value : elem.text;\n\t\t\t}\n\t\t},\n\t\tselect: {\n\t\t\tget: function( elem ) {\n\t\t\t\tvar value, i, max, option,\n\t\t\t\t\tindex = elem.selectedIndex,\n\t\t\t\t\tvalues = [],\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tone = elem.type === \"select-one\";\n\n\t\t\t\t// Nothing was selected\n\t\t\t\tif ( index < 0 ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\t// Loop through all the selected options\n\t\t\t\ti = one ? index : 0;\n\t\t\t\tmax = one ? index + 1 : options.length;\n\t\t\t\tfor ( ; i < max; i++ ) {\n\t\t\t\t\toption = options[ i ];\n\n\t\t\t\t\t// Don't return options that are disabled or in a disabled optgroup\n\t\t\t\t\tif ( option.selected && (jQuery.support.optDisabled ? !option.disabled : option.getAttribute(\"disabled\") === null) &&\n\t\t\t\t\t\t\t(!option.parentNode.disabled || !jQuery.nodeName( option.parentNode, \"optgroup\" )) ) {\n\n\t\t\t\t\t\t// Get the specific value for the option\n\t\t\t\t\t\tvalue = jQuery( option ).val();\n\n\t\t\t\t\t\t// We don't need an array for one selects\n\t\t\t\t\t\tif ( one ) {\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Multi-Selects return an array\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Fixes Bug #2551 -- select.val() broken in IE after form.reset()\n\t\t\t\tif ( one && !values.length && options.length ) {\n\t\t\t\t\treturn jQuery( options[ index ] ).val();\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\t\t\t},\n\n\t\t\tset: function( elem, value ) {\n\t\t\t\tvar values = jQuery.makeArray( value );\n\n\t\t\t\tjQuery(elem).find(\"option\").each(function() {\n\t\t\t\t\tthis.selected = jQuery.inArray( jQuery(this).val(), values ) >= 0;\n\t\t\t\t});\n\n\t\t\t\tif ( !values.length ) {\n\t\t\t\t\telem.selectedIndex = -1;\n\t\t\t\t}\n\t\t\t\treturn values;\n\t\t\t}\n\t\t}\n\t},\n\n\tattrFn: {\n\t\tval: true,\n\t\tcss: true,\n\t\thtml: true,\n\t\ttext: true,\n\t\tdata: true,\n\t\twidth: true,\n\t\theight: true,\n\t\toffset: true\n\t},\n\n\tattr: function( elem, name, value, pass ) {\n\t\tvar ret, hooks, notxml,\n\t\t\tnType = elem.nodeType;\n\n\t\t// don't get/set attributes on text, comment and attribute nodes\n\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( pass && name in jQuery.attrFn ) {\n\t\t\treturn jQuery( elem )[ name ]( value );\n\t\t}\n\n\t\t// Fallback to prop when attributes are not supported\n\t\tif ( typeof elem.getAttribute === \"undefined\" ) {\n\t\t\treturn jQuery.prop( elem, name, value );\n\t\t}\n\n\t\tnotxml = nType !== 1 || !jQuery.isXMLDoc( elem );\n\n\t\t// All attributes are lowercase\n\t\t// Grab necessary hook if one is defined\n\t\tif ( notxml ) {\n\t\t\tname = name.toLowerCase();\n\t\t\thooks = jQuery.attrHooks[ name ] || ( rboolean.test( name ) ? boolHook : nodeHook );\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\n\t\t\tif ( value === null ) {\n\t\t\t\tjQuery.removeAttr( elem, name );\n\t\t\t\treturn;\n\n\t\t\t} else if ( hooks && \"set\" in hooks && notxml && (ret = hooks.set( elem, value, name )) !== undefined ) {\n\t\t\t\treturn ret;\n\n\t\t\t} else {\n\t\t\t\telem.setAttribute( name, \"\" + value );\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t} else if ( hooks && \"get\" in hooks && notxml && (ret = hooks.get( elem, name )) !== null ) {\n\t\t\treturn ret;\n\n\t\t} else {\n\n\t\t\tret = elem.getAttribute( name );\n\n\t\t\t// Non-existent attributes return null, we normalize to undefined\n\t\t\treturn ret === null ?\n\t\t\t\tundefined :\n\t\t\t\tret;\n\t\t}\n\t},\n\n\tremoveAttr: function( elem, value ) {\n\t\tvar propName, attrNames, name, l, isBool,\n\t\t\ti = 0;\n\n\t\tif ( value && elem.nodeType === 1 ) {\n\t\t\tattrNames = value.toLowerCase().split( rspace );\n\t\t\tl = attrNames.length;\n\n\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\tname = attrNames[ i ];\n\n\t\t\t\tif ( name ) {\n\t\t\t\t\tpropName = jQuery.propFix[ name ] || name;\n\t\t\t\t\tisBool = rboolean.test( name );\n\n\t\t\t\t\t// See #9699 for explanation of this approach (setting first, then removal)\n\t\t\t\t\t// Do not do this for boolean attributes (see #10870)\n\t\t\t\t\tif ( !isBool ) {\n\t\t\t\t\t\tjQuery.attr( elem, name, \"\" );\n\t\t\t\t\t}\n\t\t\t\t\telem.removeAttribute( getSetAttribute ? name : propName );\n\n\t\t\t\t\t// Set corresponding property to false for boolean attributes\n\t\t\t\t\tif ( isBool && propName in elem ) {\n\t\t\t\t\t\telem[ propName ] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tattrHooks: {\n\t\ttype: {\n\t\t\tset: function( elem, value ) {\n\t\t\t\t// We can't allow the type property to be changed (since it causes problems in IE)\n\t\t\t\tif ( rtype.test( elem.nodeName ) && elem.parentNode ) {\n\t\t\t\t\tjQuery.error( \"type property can't be changed\" );\n\t\t\t\t} else if ( !jQuery.support.radioValue && value === \"radio\" && jQuery.nodeName(elem, \"input\") ) {\n\t\t\t\t\t// Setting the type on a radio button after the value resets the value in IE6-9\n\t\t\t\t\t// Reset value to it's default in case type is set after value\n\t\t\t\t\t// This is for element creation\n\t\t\t\t\tvar val = elem.value;\n\t\t\t\t\telem.setAttribute( \"type\", value );\n\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\telem.value = val;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// Use the value property for back compat\n\t\t// Use the nodeHook for button elements in IE6/7 (#1954)\n\t\tvalue: {\n\t\t\tget: function( elem, name ) {\n\t\t\t\tif ( nodeHook && jQuery.nodeName( elem, \"button\" ) ) {\n\t\t\t\t\treturn nodeHook.get( elem, name );\n\t\t\t\t}\n\t\t\t\treturn name in elem ?\n\t\t\t\t\telem.value :\n\t\t\t\t\tnull;\n\t\t\t},\n\t\t\tset: function( elem, value, name ) {\n\t\t\t\tif ( nodeHook && jQuery.nodeName( elem, \"button\" ) ) {\n\t\t\t\t\treturn nodeHook.set( elem, value, name );\n\t\t\t\t}\n\t\t\t\t// Does not return so that setAttribute is also used\n\t\t\t\telem.value = value;\n\t\t\t}\n\t\t}\n\t},\n\n\tpropFix: {\n\t\ttabindex: \"tabIndex\",\n\t\treadonly: \"readOnly\",\n\t\t\"for\": \"htmlFor\",\n\t\t\"class\": \"className\",\n\t\tmaxlength: \"maxLength\",\n\t\tcellspacing: \"cellSpacing\",\n\t\tcellpadding: \"cellPadding\",\n\t\trowspan: \"rowSpan\",\n\t\tcolspan: \"colSpan\",\n\t\tusemap: \"useMap\",\n\t\tframeborder: \"frameBorder\",\n\t\tcontenteditable: \"contentEditable\"\n\t},\n\n\tprop: function( elem, name, value ) {\n\t\tvar ret, hooks, notxml,\n\t\t\tnType = elem.nodeType;\n\n\t\t// don't get/set properties on text, comment and attribute nodes\n\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tnotxml = nType !== 1 || !jQuery.isXMLDoc( elem );\n\n\t\tif ( notxml ) {\n\t\t\t// Fix name and attach hooks\n\t\t\tname = jQuery.propFix[ name ] || name;\n\t\t\thooks = jQuery.propHooks[ name ];\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\t\t\tif ( hooks && \"set\" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {\n\t\t\t\treturn ret;\n\n\t\t\t} else {\n\t\t\t\treturn ( elem[ name ] = value );\n\t\t\t}\n\n\t\t} else {\n\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, name )) !== null ) {\n\t\t\t\treturn ret;\n\n\t\t\t} else {\n\t\t\t\treturn elem[ name ];\n\t\t\t}\n\t\t}\n\t},\n\n\tpropHooks: {\n\t\ttabIndex: {\n\t\t\tget: function( elem ) {\n\t\t\t\t// elem.tabIndex doesn't always return the correct value when it hasn't been explicitly set\n\t\t\t\t// http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/\n\t\t\t\tvar attributeNode = elem.getAttributeNode(\"tabindex\");\n\n\t\t\t\treturn attributeNode && attributeNode.specified ?\n\t\t\t\t\tparseInt( attributeNode.value, 10 ) :\n\t\t\t\t\trfocusable.test( elem.nodeName ) || rclickable.test( elem.nodeName ) && elem.href ?\n\t\t\t\t\t\t0 :\n\t\t\t\t\t\tundefined;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// Add the tabIndex propHook to attrHooks for back-compat (different case is intentional)\njQuery.attrHooks.tabindex = jQuery.propHooks.tabIndex;\n\n// Hook for boolean attributes\nboolHook = {\n\tget: function( elem, name ) {\n\t\t// Align boolean attributes with corresponding properties\n\t\t// Fall back to attribute presence where some booleans are not supported\n\t\tvar attrNode,\n\t\t\tproperty = jQuery.prop( elem, name );\n\t\treturn property === true || typeof property !== \"boolean\" && ( attrNode = elem.getAttributeNode(name) ) && attrNode.nodeValue !== false ?\n\t\t\tname.toLowerCase() :\n\t\t\tundefined;\n\t},\n\tset: function( elem, value, name ) {\n\t\tvar propName;\n\t\tif ( value === false ) {\n\t\t\t// Remove boolean attributes when set to false\n\t\t\tjQuery.removeAttr( elem, name );\n\t\t} else {\n\t\t\t// value is true since we know at this point it's type boolean and not false\n\t\t\t// Set boolean attributes to the same name and set the DOM property\n\t\t\tpropName = jQuery.propFix[ name ] || name;\n\t\t\tif ( propName in elem ) {\n\t\t\t\t// Only set the IDL specifically if it already exists on the element\n\t\t\t\telem[ propName ] = true;\n\t\t\t}\n\n\t\t\telem.setAttribute( name, name.toLowerCase() );\n\t\t}\n\t\treturn name;\n\t}\n};\n\n// IE6/7 do not support getting/setting some attributes with get/setAttribute\nif ( !getSetAttribute ) {\n\n\tfixSpecified = {\n\t\tname: true,\n\t\tid: true,\n\t\tcoords: true\n\t};\n\n\t// Use this for any attribute in IE6/7\n\t// This fixes almost every IE6/7 issue\n\tnodeHook = jQuery.valHooks.button = {\n\t\tget: function( elem, name ) {\n\t\t\tvar ret;\n\t\t\tret = elem.getAttributeNode( name );\n\t\t\treturn ret && ( fixSpecified[ name ] ? ret.nodeValue !== \"\" : ret.specified ) ?\n\t\t\t\tret.nodeValue :\n\t\t\t\tundefined;\n\t\t},\n\t\tset: function( elem, value, name ) {\n\t\t\t// Set the existing or create a new attribute node\n\t\t\tvar ret = elem.getAttributeNode( name );\n\t\t\tif ( !ret ) {\n\t\t\t\tret = document.createAttribute( name );\n\t\t\t\telem.setAttributeNode( ret );\n\t\t\t}\n\t\t\treturn ( ret.nodeValue = value + \"\" );\n\t\t}\n\t};\n\n\t// Apply the nodeHook to tabindex\n\tjQuery.attrHooks.tabindex.set = nodeHook.set;\n\n\t// Set width and height to auto instead of 0 on empty string( Bug #8150 )\n\t// This is for removals\n\tjQuery.each([ \"width\", \"height\" ], function( i, name ) {\n\t\tjQuery.attrHooks[ name ] = jQuery.extend( jQuery.attrHooks[ name ], {\n\t\t\tset: function( elem, value ) {\n\t\t\t\tif ( value === \"\" ) {\n\t\t\t\t\telem.setAttribute( name, \"auto\" );\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\t// Set contenteditable to false on removals(#10429)\n\t// Setting to empty string throws an error as an invalid value\n\tjQuery.attrHooks.contenteditable = {\n\t\tget: nodeHook.get,\n\t\tset: function( elem, value, name ) {\n\t\t\tif ( value === \"\" ) {\n\t\t\t\tvalue = \"false\";\n\t\t\t}\n\t\t\tnodeHook.set( elem, value, name );\n\t\t}\n\t};\n}\n\n\n// Some attributes require a special call on IE\nif ( !jQuery.support.hrefNormalized ) {\n\tjQuery.each([ \"href\", \"src\", \"width\", \"height\" ], function( i, name ) {\n\t\tjQuery.attrHooks[ name ] = jQuery.extend( jQuery.attrHooks[ name ], {\n\t\t\tget: function( elem ) {\n\t\t\t\tvar ret = elem.getAttribute( name, 2 );\n\t\t\t\treturn ret === null ? undefined : ret;\n\t\t\t}\n\t\t});\n\t});\n}\n\nif ( !jQuery.support.style ) {\n\tjQuery.attrHooks.style = {\n\t\tget: function( elem ) {\n\t\t\t// Return undefined in the case of empty string\n\t\t\t// Normalize to lowercase since IE uppercases css property names\n\t\t\treturn elem.style.cssText.toLowerCase() || undefined;\n\t\t},\n\t\tset: function( elem, value ) {\n\t\t\treturn ( elem.style.cssText = \"\" + value );\n\t\t}\n\t};\n}\n\n// Safari mis-reports the default selected property of an option\n// Accessing the parent's selectedIndex property fixes it\nif ( !jQuery.support.optSelected ) {\n\tjQuery.propHooks.selected = jQuery.extend( jQuery.propHooks.selected, {\n\t\tget: function( elem ) {\n\t\t\tvar parent = elem.parentNode;\n\n\t\t\tif ( parent ) {\n\t\t\t\tparent.selectedIndex;\n\n\t\t\t\t// Make sure that it also works with optgroups, see #5701\n\t\t\t\tif ( parent.parentNode ) {\n\t\t\t\t\tparent.parentNode.selectedIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t});\n}\n\n// IE6/7 call enctype encoding\nif ( !jQuery.support.enctype ) {\n\tjQuery.propFix.enctype = \"encoding\";\n}\n\n// Radios and checkboxes getter/setter\nif ( !jQuery.support.checkOn ) {\n\tjQuery.each([ \"radio\", \"checkbox\" ], function() {\n\t\tjQuery.valHooks[ this ] = {\n\t\t\tget: function( elem ) {\n\t\t\t\t// Handle the case where in Webkit \"\" is returned instead of \"on\" if a value isn't specified\n\t\t\t\treturn elem.getAttribute(\"value\") === null ? \"on\" : elem.value;\n\t\t\t}\n\t\t};\n\t});\n}\njQuery.each([ \"radio\", \"checkbox\" ], function() {\n\tjQuery.valHooks[ this ] = jQuery.extend( jQuery.valHooks[ this ], {\n\t\tset: function( elem, value ) {\n\t\t\tif ( jQuery.isArray( value ) ) {\n\t\t\t\treturn ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );\n\t\t\t}\n\t\t}\n\t});\n});\n\n\n\n\nvar rformElems = /^(?:textarea|input|select)$/i,\n\trtypenamespace = /^([^\\.]*)?(?:\\.(.+))?$/,\n\trhoverHack = /(?:^|\\s)hover(\\.\\S+)?\\b/,\n\trkeyEvent = /^key/,\n\trmouseEvent = /^(?:mouse|contextmenu)|click/,\n\trfocusMorph = /^(?:focusinfocus|focusoutblur)$/,\n\trquickIs = /^(\\w*)(?:#([\\w\\-]+))?(?:\\.([\\w\\-]+))?$/,\n\tquickParse = function( selector ) {\n\t\tvar quick = rquickIs.exec( selector );\n\t\tif ( quick ) {\n\t\t\t//   0  1    2   3\n\t\t\t// [ _, tag, id, class ]\n\t\t\tquick[1] = ( quick[1] || \"\" ).toLowerCase();\n\t\t\tquick[3] = quick[3] && new RegExp( \"(?:^|\\\\s)\" + quick[3] + \"(?:\\\\s|$)\" );\n\t\t}\n\t\treturn quick;\n\t},\n\tquickIs = function( elem, m ) {\n\t\tvar attrs = elem.attributes || {};\n\t\treturn (\n\t\t\t(!m[1] || elem.nodeName.toLowerCase() === m[1]) &&\n\t\t\t(!m[2] || (attrs.id || {}).value === m[2]) &&\n\t\t\t(!m[3] || m[3].test( (attrs[ \"class\" ] || {}).value ))\n\t\t);\n\t},\n\thoverHack = function( events ) {\n\t\treturn jQuery.event.special.hover ? events : events.replace( rhoverHack, \"mouseenter$1 mouseleave$1\" );\n\t};\n\n/*\n * Helper functions for managing events -- not part of the public interface.\n * Props to Dean Edwards' addEvent library for many of the ideas.\n */\njQuery.event = {\n\n\tadd: function( elem, types, handler, data, selector ) {\n\n\t\tvar elemData, eventHandle, events,\n\t\t\tt, tns, type, namespaces, handleObj,\n\t\t\thandleObjIn, quick, handlers, special;\n\n\t\t// Don't attach events to noData or text/comment nodes (allow plain objects tho)\n\t\tif ( elem.nodeType === 3 || elem.nodeType === 8 || !types || !handler || !(elemData = jQuery._data( elem )) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Caller can pass in an object of custom data in lieu of the handler\n\t\tif ( handler.handler ) {\n\t\t\thandleObjIn = handler;\n\t\t\thandler = handleObjIn.handler;\n\t\t\tselector = handleObjIn.selector;\n\t\t}\n\n\t\t// Make sure that the handler has a unique ID, used to find/remove it later\n\t\tif ( !handler.guid ) {\n\t\t\thandler.guid = jQuery.guid++;\n\t\t}\n\n\t\t// Init the element's event structure and main handler, if this is the first\n\t\tevents = elemData.events;\n\t\tif ( !events ) {\n\t\t\telemData.events = events = {};\n\t\t}\n\t\teventHandle = elemData.handle;\n\t\tif ( !eventHandle ) {\n\t\t\telemData.handle = eventHandle = function( e ) {\n\t\t\t\t// Discard the second event of a jQuery.event.trigger() and\n\t\t\t\t// when an event is called after a page has unloaded\n\t\t\t\treturn typeof jQuery !== \"undefined\" && (!e || jQuery.event.triggered !== e.type) ?\n\t\t\t\t\tjQuery.event.dispatch.apply( eventHandle.elem, arguments ) :\n\t\t\t\t\tundefined;\n\t\t\t};\n\t\t\t// Add elem as a property of the handle fn to prevent a memory leak with IE non-native events\n\t\t\teventHandle.elem = elem;\n\t\t}\n\n\t\t// Handle multiple events separated by a space\n\t\t// jQuery(...).bind(\"mouseover mouseout\", fn);\n\t\ttypes = jQuery.trim( hoverHack(types) ).split( \" \" );\n\t\tfor ( t = 0; t < types.length; t++ ) {\n\n\t\t\ttns = rtypenamespace.exec( types[t] ) || [];\n\t\t\ttype = tns[1];\n\t\t\tnamespaces = ( tns[2] || \"\" ).split( \".\" ).sort();\n\n\t\t\t// If event changes its type, use the special event handlers for the changed type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// If selector defined, determine special event api type, otherwise given type\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\n\t\t\t// Update special based on newly reset type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// handleObj is passed to all event handlers\n\t\t\thandleObj = jQuery.extend({\n\t\t\t\ttype: type,\n\t\t\t\torigType: tns[1],\n\t\t\t\tdata: data,\n\t\t\t\thandler: handler,\n\t\t\t\tguid: handler.guid,\n\t\t\t\tselector: selector,\n\t\t\t\tquick: selector && quickParse( selector ),\n\t\t\t\tnamespace: namespaces.join(\".\")\n\t\t\t}, handleObjIn );\n\n\t\t\t// Init the event handler queue if we're the first\n\t\t\thandlers = events[ type ];\n\t\t\tif ( !handlers ) {\n\t\t\t\thandlers = events[ type ] = [];\n\t\t\t\thandlers.delegateCount = 0;\n\n\t\t\t\t// Only use addEventListener/attachEvent if the special events handler returns false\n\t\t\t\tif ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {\n\t\t\t\t\t// Bind the global event handler to the element\n\t\t\t\t\tif ( elem.addEventListener ) {\n\t\t\t\t\t\telem.addEventListener( type, eventHandle, false );\n\n\t\t\t\t\t} else if ( elem.attachEvent ) {\n\t\t\t\t\t\telem.attachEvent( \"on\" + type, eventHandle );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( special.add ) {\n\t\t\t\tspecial.add.call( elem, handleObj );\n\n\t\t\t\tif ( !handleObj.handler.guid ) {\n\t\t\t\t\thandleObj.handler.guid = handler.guid;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add to the element's handler list, delegates in front\n\t\t\tif ( selector ) {\n\t\t\t\thandlers.splice( handlers.delegateCount++, 0, handleObj );\n\t\t\t} else {\n\t\t\t\thandlers.push( handleObj );\n\t\t\t}\n\n\t\t\t// Keep track of which events have ever been used, for event optimization\n\t\t\tjQuery.event.global[ type ] = true;\n\t\t}\n\n\t\t// Nullify elem to prevent memory leaks in IE\n\t\telem = null;\n\t},\n\n\tglobal: {},\n\n\t// Detach an event or set of events from an element\n\tremove: function( elem, types, handler, selector, mappedTypes ) {\n\n\t\tvar elemData = jQuery.hasData( elem ) && jQuery._data( elem ),\n\t\t\tt, tns, type, origType, namespaces, origCount,\n\t\t\tj, events, special, handle, eventType, handleObj;\n\n\t\tif ( !elemData || !(events = elemData.events) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Once for each type.namespace in types; type may be omitted\n\t\ttypes = jQuery.trim( hoverHack( types || \"\" ) ).split(\" \");\n\t\tfor ( t = 0; t < types.length; t++ ) {\n\t\t\ttns = rtypenamespace.exec( types[t] ) || [];\n\t\t\ttype = origType = tns[1];\n\t\t\tnamespaces = tns[2];\n\n\t\t\t// Unbind all events (on this namespace, if provided) for the element\n\t\t\tif ( !type ) {\n\t\t\t\tfor ( type in events ) {\n\t\t\t\t\tjQuery.event.remove( elem, type + types[ t ], handler, selector, true );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\t\t\ttype = ( selector? special.delegateType : special.bindType ) || type;\n\t\t\teventType = events[ type ] || [];\n\t\t\torigCount = eventType.length;\n\t\t\tnamespaces = namespaces ? new RegExp(\"(^|\\\\.)\" + namespaces.split(\".\").sort().join(\"\\\\.(?:.*\\\\.)?\") + \"(\\\\.|$)\") : null;\n\n\t\t\t// Remove matching events\n\t\t\tfor ( j = 0; j < eventType.length; j++ ) {\n\t\t\t\thandleObj = eventType[ j ];\n\n\t\t\t\tif ( ( mappedTypes || origType === handleObj.origType ) &&\n\t\t\t\t\t ( !handler || handler.guid === handleObj.guid ) &&\n\t\t\t\t\t ( !namespaces || namespaces.test( handleObj.namespace ) ) &&\n\t\t\t\t\t ( !selector || selector === handleObj.selector || selector === \"**\" && handleObj.selector ) ) {\n\t\t\t\t\teventType.splice( j--, 1 );\n\n\t\t\t\t\tif ( handleObj.selector ) {\n\t\t\t\t\t\teventType.delegateCount--;\n\t\t\t\t\t}\n\t\t\t\t\tif ( special.remove ) {\n\t\t\t\t\t\tspecial.remove.call( elem, handleObj );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove generic event handler if we removed something and no more handlers exist\n\t\t\t// (avoids potential for endless recursion during removal of special event handlers)\n\t\t\tif ( eventType.length === 0 && origCount !== eventType.length ) {\n\t\t\t\tif ( !special.teardown || special.teardown.call( elem, namespaces ) === false ) {\n\t\t\t\t\tjQuery.removeEvent( elem, type, elemData.handle );\n\t\t\t\t}\n\n\t\t\t\tdelete events[ type ];\n\t\t\t}\n\t\t}\n\n\t\t// Remove the expando if it's no longer used\n\t\tif ( jQuery.isEmptyObject( events ) ) {\n\t\t\thandle = elemData.handle;\n\t\t\tif ( handle ) {\n\t\t\t\thandle.elem = null;\n\t\t\t}\n\n\t\t\t// removeData also checks for emptiness and clears the expando if empty\n\t\t\t// so use it instead of delete\n\t\t\tjQuery.removeData( elem, [ \"events\", \"handle\" ], true );\n\t\t}\n\t},\n\n\t// Events that are safe to short-circuit if no handlers are attached.\n\t// Native DOM events should not be added, they may have inline handlers.\n\tcustomEvent: {\n\t\t\"getData\": true,\n\t\t\"setData\": true,\n\t\t\"changeData\": true\n\t},\n\n\ttrigger: function( event, data, elem, onlyHandlers ) {\n\t\t// Don't do events on text and comment nodes\n\t\tif ( elem && (elem.nodeType === 3 || elem.nodeType === 8) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Event object or event type\n\t\tvar type = event.type || event,\n\t\t\tnamespaces = [],\n\t\t\tcache, exclusive, i, cur, old, ontype, special, handle, eventPath, bubbleType;\n\n\t\t// focus/blur morphs to focusin/out; ensure we're not firing them right now\n\t\tif ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( type.indexOf( \"!\" ) >= 0 ) {\n\t\t\t// Exclusive events trigger only for the exact event (no namespaces)\n\t\t\ttype = type.slice(0, -1);\n\t\t\texclusive = true;\n\t\t}\n\n\t\tif ( type.indexOf( \".\" ) >= 0 ) {\n\t\t\t// Namespaced trigger; create a regexp to match event type in handle()\n\t\t\tnamespaces = type.split(\".\");\n\t\t\ttype = namespaces.shift();\n\t\t\tnamespaces.sort();\n\t\t}\n\n\t\tif ( (!elem || jQuery.event.customEvent[ type ]) && !jQuery.event.global[ type ] ) {\n\t\t\t// No jQuery handlers for this event type, and it can't have inline handlers\n\t\t\treturn;\n\t\t}\n\n\t\t// Caller can pass in an Event, Object, or just an event type string\n\t\tevent = typeof event === \"object\" ?\n\t\t\t// jQuery.Event object\n\t\t\tevent[ jQuery.expando ] ? event :\n\t\t\t// Object literal\n\t\t\tnew jQuery.Event( type, event ) :\n\t\t\t// Just the event type (string)\n\t\t\tnew jQuery.Event( type );\n\n\t\tevent.type = type;\n\t\tevent.isTrigger = true;\n\t\tevent.exclusive = exclusive;\n\t\tevent.namespace = namespaces.join( \".\" );\n\t\tevent.namespace_re = event.namespace? new RegExp(\"(^|\\\\.)\" + namespaces.join(\"\\\\.(?:.*\\\\.)?\") + \"(\\\\.|$)\") : null;\n\t\tontype = type.indexOf( \":\" ) < 0 ? \"on\" + type : \"\";\n\n\t\t// Handle a global trigger\n\t\tif ( !elem ) {\n\n\t\t\t// TODO: Stop taunting the data cache; remove global events and always attach to document\n\t\t\tcache = jQuery.cache;\n\t\t\tfor ( i in cache ) {\n\t\t\t\tif ( cache[ i ].events && cache[ i ].events[ type ] ) {\n\t\t\t\t\tjQuery.event.trigger( event, data, cache[ i ].handle.elem, true );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Clean up the event in case it is being reused\n\t\tevent.result = undefined;\n\t\tif ( !event.target ) {\n\t\t\tevent.target = elem;\n\t\t}\n\n\t\t// Clone any incoming data and prepend the event, creating the handler arg list\n\t\tdata = data != null ? jQuery.makeArray( data ) : [];\n\t\tdata.unshift( event );\n\n\t\t// Allow special events to draw outside the lines\n\t\tspecial = jQuery.event.special[ type ] || {};\n\t\tif ( special.trigger && special.trigger.apply( elem, data ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine event propagation path in advance, per W3C events spec (#9951)\n\t\t// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\n\t\teventPath = [[ elem, special.bindType || type ]];\n\t\tif ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {\n\n\t\t\tbubbleType = special.delegateType || type;\n\t\t\tcur = rfocusMorph.test( bubbleType + type ) ? elem : elem.parentNode;\n\t\t\told = null;\n\t\t\tfor ( ; cur; cur = cur.parentNode ) {\n\t\t\t\teventPath.push([ cur, bubbleType ]);\n\t\t\t\told = cur;\n\t\t\t}\n\n\t\t\t// Only add window if we got to document (e.g., not plain obj or detached DOM)\n\t\t\tif ( old && old === elem.ownerDocument ) {\n\t\t\t\teventPath.push([ old.defaultView || old.parentWindow || window, bubbleType ]);\n\t\t\t}\n\t\t}\n\n\t\t// Fire handlers on the event path\n\t\tfor ( i = 0; i < eventPath.length && !event.isPropagationStopped(); i++ ) {\n\n\t\t\tcur = eventPath[i][0];\n\t\t\tevent.type = eventPath[i][1];\n\n\t\t\thandle = ( jQuery._data( cur, \"events\" ) || {} )[ event.type ] && jQuery._data( cur, \"handle\" );\n\t\t\tif ( handle ) {\n\t\t\t\thandle.apply( cur, data );\n\t\t\t}\n\t\t\t// Note that this is a bare JS function and not a jQuery handler\n\t\t\thandle = ontype && cur[ ontype ];\n\t\t\tif ( handle && jQuery.acceptData( cur ) && handle.apply( cur, data ) === false ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\t\tevent.type = type;\n\n\t\t// If nobody prevented the default action, do it now\n\t\tif ( !onlyHandlers && !event.isDefaultPrevented() ) {\n\n\t\t\tif ( (!special._default || special._default.apply( elem.ownerDocument, data ) === false) &&\n\t\t\t\t!(type === \"click\" && jQuery.nodeName( elem, \"a\" )) && jQuery.acceptData( elem ) ) {\n\n\t\t\t\t// Call a native DOM method on the target with the same name name as the event.\n\t\t\t\t// Can't use an .isFunction() check here because IE6/7 fails that test.\n\t\t\t\t// Don't do default actions on window, that's where global variables be (#6170)\n\t\t\t\t// IE<9 dies on focus/blur to hidden element (#1486)\n\t\t\t\tif ( ontype && elem[ type ] && ((type !== \"focus\" && type !== \"blur\") || event.target.offsetWidth !== 0) && !jQuery.isWindow( elem ) ) {\n\n\t\t\t\t\t// Don't re-trigger an onFOO event when we call its FOO() method\n\t\t\t\t\told = elem[ ontype ];\n\n\t\t\t\t\tif ( old ) {\n\t\t\t\t\t\telem[ ontype ] = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Prevent re-triggering of the same event, since we already bubbled it above\n\t\t\t\t\tjQuery.event.triggered = type;\n\t\t\t\t\telem[ type ]();\n\t\t\t\t\tjQuery.event.triggered = undefined;\n\n\t\t\t\t\tif ( old ) {\n\t\t\t\t\t\telem[ ontype ] = old;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\tdispatch: function( event ) {\n\n\t\t// Make a writable jQuery.Event from the native event object\n\t\tevent = jQuery.event.fix( event || window.event );\n\n\t\tvar handlers = ( (jQuery._data( this, \"events\" ) || {} )[ event.type ] || []),\n\t\t\tdelegateCount = handlers.delegateCount,\n\t\t\targs = [].slice.call( arguments, 0 ),\n\t\t\trun_all = !event.exclusive && !event.namespace,\n\t\t\tspecial = jQuery.event.special[ event.type ] || {},\n\t\t\thandlerQueue = [],\n\t\t\ti, j, cur, jqcur, ret, selMatch, matched, matches, handleObj, sel, related;\n\n\t\t// Use the fix-ed jQuery.Event rather than the (read-only) native event\n\t\targs[0] = event;\n\t\tevent.delegateTarget = this;\n\n\t\t// Call the preDispatch hook for the mapped type, and let it bail if desired\n\t\tif ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine handlers that should run if there are delegated events\n\t\t// Avoid non-left-click bubbling in Firefox (#3861)\n\t\tif ( delegateCount && !(event.button && event.type === \"click\") ) {\n\n\t\t\t// Pregenerate a single jQuery object for reuse with .is()\n\t\t\tjqcur = jQuery(this);\n\t\t\tjqcur.context = this.ownerDocument || this;\n\n\t\t\tfor ( cur = event.target; cur != this; cur = cur.parentNode || this ) {\n\n\t\t\t\t// Don't process events on disabled elements (#6911, #8165)\n\t\t\t\tif ( cur.disabled !== true ) {\n\t\t\t\t\tselMatch = {};\n\t\t\t\t\tmatches = [];\n\t\t\t\t\tjqcur[0] = cur;\n\t\t\t\t\tfor ( i = 0; i < delegateCount; i++ ) {\n\t\t\t\t\t\thandleObj = handlers[ i ];\n\t\t\t\t\t\tsel = handleObj.selector;\n\n\t\t\t\t\t\tif ( selMatch[ sel ] === undefined ) {\n\t\t\t\t\t\t\tselMatch[ sel ] = (\n\t\t\t\t\t\t\t\thandleObj.quick ? quickIs( cur, handleObj.quick ) : jqcur.is( sel )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( selMatch[ sel ] ) {\n\t\t\t\t\t\t\tmatches.push( handleObj );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( matches.length ) {\n\t\t\t\t\t\thandlerQueue.push({ elem: cur, matches: matches });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add the remaining (directly-bound) handlers\n\t\tif ( handlers.length > delegateCount ) {\n\t\t\thandlerQueue.push({ elem: this, matches: handlers.slice( delegateCount ) });\n\t\t}\n\n\t\t// Run delegates first; they may want to stop propagation beneath us\n\t\tfor ( i = 0; i < handlerQueue.length && !event.isPropagationStopped(); i++ ) {\n\t\t\tmatched = handlerQueue[ i ];\n\t\t\tevent.currentTarget = matched.elem;\n\n\t\t\tfor ( j = 0; j < matched.matches.length && !event.isImmediatePropagationStopped(); j++ ) {\n\t\t\t\thandleObj = matched.matches[ j ];\n\n\t\t\t\t// Triggered event must either 1) be non-exclusive and have no namespace, or\n\t\t\t\t// 2) have namespace(s) a subset or equal to those in the bound event (both can have no namespace).\n\t\t\t\tif ( run_all || (!event.namespace && !handleObj.namespace) || event.namespace_re && event.namespace_re.test( handleObj.namespace ) ) {\n\n\t\t\t\t\tevent.data = handleObj.data;\n\t\t\t\t\tevent.handleObj = handleObj;\n\n\t\t\t\t\tret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )\n\t\t\t\t\t\t\t.apply( matched.elem, args );\n\n\t\t\t\t\tif ( ret !== undefined ) {\n\t\t\t\t\t\tevent.result = ret;\n\t\t\t\t\t\tif ( ret === false ) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Call the postDispatch hook for the mapped type\n\t\tif ( special.postDispatch ) {\n\t\t\tspecial.postDispatch.call( this, event );\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\t// Includes some event props shared by KeyEvent and MouseEvent\n\t// *** attrChange attrName relatedNode srcElement  are not normalized, non-W3C, deprecated, will be removed in 1.8 ***\n\tprops: \"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),\n\n\tfixHooks: {},\n\n\tkeyHooks: {\n\t\tprops: \"char charCode key keyCode\".split(\" \"),\n\t\tfilter: function( event, original ) {\n\n\t\t\t// Add which for key events\n\t\t\tif ( event.which == null ) {\n\t\t\t\tevent.which = original.charCode != null ? original.charCode : original.keyCode;\n\t\t\t}\n\n\t\t\treturn event;\n\t\t}\n\t},\n\n\tmouseHooks: {\n\t\tprops: \"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),\n\t\tfilter: function( event, original ) {\n\t\t\tvar eventDoc, doc, body,\n\t\t\t\tbutton = original.button,\n\t\t\t\tfromElement = original.fromElement;\n\n\t\t\t// Calculate pageX/Y if missing and clientX/Y available\n\t\t\tif ( event.pageX == null && original.clientX != null ) {\n\t\t\t\teventDoc = event.target.ownerDocument || document;\n\t\t\t\tdoc = eventDoc.documentElement;\n\t\t\t\tbody = eventDoc.body;\n\n\t\t\t\tevent.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );\n\t\t\t\tevent.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );\n\t\t\t}\n\n\t\t\t// Add relatedTarget, if necessary\n\t\t\tif ( !event.relatedTarget && fromElement ) {\n\t\t\t\tevent.relatedTarget = fromElement === event.target ? original.toElement : fromElement;\n\t\t\t}\n\n\t\t\t// Add which for click: 1 === left; 2 === middle; 3 === right\n\t\t\t// Note: button is not normalized, so don't use it\n\t\t\tif ( !event.which && button !== undefined ) {\n\t\t\t\tevent.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );\n\t\t\t}\n\n\t\t\treturn event;\n\t\t}\n\t},\n\n\tfix: function( event ) {\n\t\tif ( event[ jQuery.expando ] ) {\n\t\t\treturn event;\n\t\t}\n\n\t\t// Create a writable copy of the event object and normalize some properties\n\t\tvar i, prop,\n\t\t\toriginalEvent = event,\n\t\t\tfixHook = jQuery.event.fixHooks[ event.type ] || {},\n\t\t\tcopy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;\n\n\t\tevent = jQuery.Event( originalEvent );\n\n\t\tfor ( i = copy.length; i; ) {\n\t\t\tprop = copy[ --i ];\n\t\t\tevent[ prop ] = originalEvent[ prop ];\n\t\t}\n\n\t\t// Fix target property, if necessary (#1925, IE 6/7/8 & Safari2)\n\t\tif ( !event.target ) {\n\t\t\tevent.target = originalEvent.srcElement || document;\n\t\t}\n\n\t\t// Target should not be a text node (#504, Safari)\n\t\tif ( event.target.nodeType === 3 ) {\n\t\t\tevent.target = event.target.parentNode;\n\t\t}\n\n\t\t// For mouse/key events; add metaKey if it's not there (#3368, IE6/7/8)\n\t\tif ( event.metaKey === undefined ) {\n\t\t\tevent.metaKey = event.ctrlKey;\n\t\t}\n\n\t\treturn fixHook.filter? fixHook.filter( event, originalEvent ) : event;\n\t},\n\n\tspecial: {\n\t\tready: {\n\t\t\t// Make sure the ready event is setup\n\t\t\tsetup: jQuery.bindReady\n\t\t},\n\n\t\tload: {\n\t\t\t// Prevent triggered image.load events from bubbling to window.load\n\t\t\tnoBubble: true\n\t\t},\n\n\t\tfocus: {\n\t\t\tdelegateType: \"focusin\"\n\t\t},\n\t\tblur: {\n\t\t\tdelegateType: \"focusout\"\n\t\t},\n\n\t\tbeforeunload: {\n\t\t\tsetup: function( data, namespaces, eventHandle ) {\n\t\t\t\t// We only want to do this special case on windows\n\t\t\t\tif ( jQuery.isWindow( this ) ) {\n\t\t\t\t\tthis.onbeforeunload = eventHandle;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tteardown: function( namespaces, eventHandle ) {\n\t\t\t\tif ( this.onbeforeunload === eventHandle ) {\n\t\t\t\t\tthis.onbeforeunload = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tsimulate: function( type, elem, event, bubble ) {\n\t\t// Piggyback on a donor event to simulate a different one.\n\t\t// Fake originalEvent to avoid donor's stopPropagation, but if the\n\t\t// simulated event prevents default then we do the same on the donor.\n\t\tvar e = jQuery.extend(\n\t\t\tnew jQuery.Event(),\n\t\t\tevent,\n\t\t\t{ type: type,\n\t\t\t\tisSimulated: true,\n\t\t\t\toriginalEvent: {}\n\t\t\t}\n\t\t);\n\t\tif ( bubble ) {\n\t\t\tjQuery.event.trigger( e, null, elem );\n\t\t} else {\n\t\t\tjQuery.event.dispatch.call( elem, e );\n\t\t}\n\t\tif ( e.isDefaultPrevented() ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n};\n\n// Some plugins are using, but it's undocumented/deprecated and will be removed.\n// The 1.7 special event interface should provide all the hooks needed now.\njQuery.event.handle = jQuery.event.dispatch;\n\njQuery.removeEvent = document.removeEventListener ?\n\tfunction( elem, type, handle ) {\n\t\tif ( elem.removeEventListener ) {\n\t\t\telem.removeEventListener( type, handle, false );\n\t\t}\n\t} :\n\tfunction( elem, type, handle ) {\n\t\tif ( elem.detachEvent ) {\n\t\t\telem.detachEvent( \"on\" + type, handle );\n\t\t}\n\t};\n\njQuery.Event = function( src, props ) {\n\t// Allow instantiation without the 'new' keyword\n\tif ( !(this instanceof jQuery.Event) ) {\n\t\treturn new jQuery.Event( src, props );\n\t}\n\n\t// Event object\n\tif ( src && src.type ) {\n\t\tthis.originalEvent = src;\n\t\tthis.type = src.type;\n\n\t\t// Events bubbling up the document may have been marked as prevented\n\t\t// by a handler lower down the tree; reflect the correct value.\n\t\tthis.isDefaultPrevented = ( src.defaultPrevented || src.returnValue === false ||\n\t\t\tsrc.getPreventDefault && src.getPreventDefault() ) ? returnTrue : returnFalse;\n\n\t// Event type\n\t} else {\n\t\tthis.type = src;\n\t}\n\n\t// Put explicitly provided properties onto the event object\n\tif ( props ) {\n\t\tjQuery.extend( this, props );\n\t}\n\n\t// Create a timestamp if incoming event doesn't have one\n\tthis.timeStamp = src && src.timeStamp || jQuery.now();\n\n\t// Mark it as fixed\n\tthis[ jQuery.expando ] = true;\n};\n\nfunction returnFalse() {\n\treturn false;\n}\nfunction returnTrue() {\n\treturn true;\n}\n\n// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\n// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\njQuery.Event.prototype = {\n\tpreventDefault: function() {\n\t\tthis.isDefaultPrevented = returnTrue;\n\n\t\tvar e = this.originalEvent;\n\t\tif ( !e ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// if preventDefault exists run it on the original event\n\t\tif ( e.preventDefault ) {\n\t\t\te.preventDefault();\n\n\t\t// otherwise set the returnValue property of the original event to false (IE)\n\t\t} else {\n\t\t\te.returnValue = false;\n\t\t}\n\t},\n\tstopPropagation: function() {\n\t\tthis.isPropagationStopped = returnTrue;\n\n\t\tvar e = this.originalEvent;\n\t\tif ( !e ) {\n\t\t\treturn;\n\t\t}\n\t\t// if stopPropagation exists run it on the original event\n\t\tif ( e.stopPropagation ) {\n\t\t\te.stopPropagation();\n\t\t}\n\t\t// otherwise set the cancelBubble property of the original event to true (IE)\n\t\te.cancelBubble = true;\n\t},\n\tstopImmediatePropagation: function() {\n\t\tthis.isImmediatePropagationStopped = returnTrue;\n\t\tthis.stopPropagation();\n\t},\n\tisDefaultPrevented: returnFalse,\n\tisPropagationStopped: returnFalse,\n\tisImmediatePropagationStopped: returnFalse\n};\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\njQuery.each({\n\tmouseenter: \"mouseover\",\n\tmouseleave: \"mouseout\"\n}, function( orig, fix ) {\n\tjQuery.event.special[ orig ] = {\n\t\tdelegateType: fix,\n\t\tbindType: fix,\n\n\t\thandle: function( event ) {\n\t\t\tvar target = this,\n\t\t\t\trelated = event.relatedTarget,\n\t\t\t\thandleObj = event.handleObj,\n\t\t\t\tselector = handleObj.selector,\n\t\t\t\tret;\n\n\t\t\t// For mousenter/leave call the handler if related is outside the target.\n\t\t\t// NB: No relatedTarget if the mouse left/entered the browser window\n\t\t\tif ( !related || (related !== target && !jQuery.contains( target, related )) ) {\n\t\t\t\tevent.type = handleObj.origType;\n\t\t\t\tret = handleObj.handler.apply( this, arguments );\n\t\t\t\tevent.type = fix;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t};\n});\n\n// IE submit delegation\nif ( !jQuery.support.submitBubbles ) {\n\n\tjQuery.event.special.submit = {\n\t\tsetup: function() {\n\t\t\t// Only need this for delegated form submit events\n\t\t\tif ( jQuery.nodeName( this, \"form\" ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Lazy-add a submit handler when a descendant form may potentially be submitted\n\t\t\tjQuery.event.add( this, \"click._submit keypress._submit\", function( e ) {\n\t\t\t\t// Node name check avoids a VML-related crash in IE (#9807)\n\t\t\t\tvar elem = e.target,\n\t\t\t\t\tform = jQuery.nodeName( elem, \"input\" ) || jQuery.nodeName( elem, \"button\" ) ? elem.form : undefined;\n\t\t\t\tif ( form && !form._submit_attached ) {\n\t\t\t\t\tjQuery.event.add( form, \"submit._submit\", function( event ) {\n\t\t\t\t\t\tevent._submit_bubble = true;\n\t\t\t\t\t});\n\t\t\t\t\tform._submit_attached = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t// return undefined since we don't need an event listener\n\t\t},\n\t\t\n\t\tpostDispatch: function( event ) {\n\t\t\t// If form was submitted by the user, bubble the event up the tree\n\t\t\tif ( event._submit_bubble ) {\n\t\t\t\tdelete event._submit_bubble;\n\t\t\t\tif ( this.parentNode && !event.isTrigger ) {\n\t\t\t\t\tjQuery.event.simulate( \"submit\", this.parentNode, event, true );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tteardown: function() {\n\t\t\t// Only need this for delegated form submit events\n\t\t\tif ( jQuery.nodeName( this, \"form\" ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Remove delegated handlers; cleanData eventually reaps submit handlers attached above\n\t\t\tjQuery.event.remove( this, \"._submit\" );\n\t\t}\n\t};\n}\n\n// IE change delegation and checkbox/radio fix\nif ( !jQuery.support.changeBubbles ) {\n\n\tjQuery.event.special.change = {\n\n\t\tsetup: function() {\n\n\t\t\tif ( rformElems.test( this.nodeName ) ) {\n\t\t\t\t// IE doesn't fire change on a check/radio until blur; trigger it on click\n\t\t\t\t// after a propertychange. Eat the blur-change in special.change.handle.\n\t\t\t\t// This still fires onchange a second time for check/radio after blur.\n\t\t\t\tif ( this.type === \"checkbox\" || this.type === \"radio\" ) {\n\t\t\t\t\tjQuery.event.add( this, \"propertychange._change\", function( event ) {\n\t\t\t\t\t\tif ( event.originalEvent.propertyName === \"checked\" ) {\n\t\t\t\t\t\t\tthis._just_changed = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tjQuery.event.add( this, \"click._change\", function( event ) {\n\t\t\t\t\t\tif ( this._just_changed && !event.isTrigger ) {\n\t\t\t\t\t\t\tthis._just_changed = false;\n\t\t\t\t\t\t\tjQuery.event.simulate( \"change\", this, event, true );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Delegated event; lazy-add a change handler on descendant inputs\n\t\t\tjQuery.event.add( this, \"beforeactivate._change\", function( e ) {\n\t\t\t\tvar elem = e.target;\n\n\t\t\t\tif ( rformElems.test( elem.nodeName ) && !elem._change_attached ) {\n\t\t\t\t\tjQuery.event.add( elem, \"change._change\", function( event ) {\n\t\t\t\t\t\tif ( this.parentNode && !event.isSimulated && !event.isTrigger ) {\n\t\t\t\t\t\t\tjQuery.event.simulate( \"change\", this.parentNode, event, true );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\telem._change_attached = true;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thandle: function( event ) {\n\t\t\tvar elem = event.target;\n\n\t\t\t// Swallow native change events from checkbox/radio, we already triggered them above\n\t\t\tif ( this !== elem || event.isSimulated || event.isTrigger || (elem.type !== \"radio\" && elem.type !== \"checkbox\") ) {\n\t\t\t\treturn event.handleObj.handler.apply( this, arguments );\n\t\t\t}\n\t\t},\n\n\t\tteardown: function() {\n\t\t\tjQuery.event.remove( this, \"._change\" );\n\n\t\t\treturn rformElems.test( this.nodeName );\n\t\t}\n\t};\n}\n\n// Create \"bubbling\" focus and blur events\nif ( !jQuery.support.focusinBubbles ) {\n\tjQuery.each({ focus: \"focusin\", blur: \"focusout\" }, function( orig, fix ) {\n\n\t\t// Attach a single capturing handler while someone wants focusin/focusout\n\t\tvar attaches = 0,\n\t\t\thandler = function( event ) {\n\t\t\t\tjQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );\n\t\t\t};\n\n\t\tjQuery.event.special[ fix ] = {\n\t\t\tsetup: function() {\n\t\t\t\tif ( attaches++ === 0 ) {\n\t\t\t\t\tdocument.addEventListener( orig, handler, true );\n\t\t\t\t}\n\t\t\t},\n\t\t\tteardown: function() {\n\t\t\t\tif ( --attaches === 0 ) {\n\t\t\t\t\tdocument.removeEventListener( orig, handler, true );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n}\n\njQuery.fn.extend({\n\n\ton: function( types, selector, data, fn, /*INTERNAL*/ one ) {\n\t\tvar origFn, type;\n\n\t\t// Types can be a map of types/handlers\n\t\tif ( typeof types === \"object\" ) {\n\t\t\t// ( types-Object, selector, data )\n\t\t\tif ( typeof selector !== \"string\" ) { // && selector != null\n\t\t\t\t// ( types-Object, data )\n\t\t\t\tdata = data || selector;\n\t\t\t\tselector = undefined;\n\t\t\t}\n\t\t\tfor ( type in types ) {\n\t\t\t\tthis.on( type, selector, data, types[ type ], one );\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tif ( data == null && fn == null ) {\n\t\t\t// ( types, fn )\n\t\t\tfn = selector;\n\t\t\tdata = selector = undefined;\n\t\t} else if ( fn == null ) {\n\t\t\tif ( typeof selector === \"string\" ) {\n\t\t\t\t// ( types, selector, fn )\n\t\t\t\tfn = data;\n\t\t\t\tdata = undefined;\n\t\t\t} else {\n\t\t\t\t// ( types, data, fn )\n\t\t\t\tfn = data;\n\t\t\t\tdata = selector;\n\t\t\t\tselector = undefined;\n\t\t\t}\n\t\t}\n\t\tif ( fn === false ) {\n\t\t\tfn = returnFalse;\n\t\t} else if ( !fn ) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif ( one === 1 ) {\n\t\t\torigFn = fn;\n\t\t\tfn = function( event ) {\n\t\t\t\t// Can use an empty set, since event contains the info\n\t\t\t\tjQuery().off( event );\n\t\t\t\treturn origFn.apply( this, arguments );\n\t\t\t};\n\t\t\t// Use same guid so caller can remove using origFn\n\t\t\tfn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\n\t\t}\n\t\treturn this.each( function() {\n\t\t\tjQuery.event.add( this, types, fn, data, selector );\n\t\t});\n\t},\n\tone: function( types, selector, data, fn ) {\n\t\treturn this.on( types, selector, data, fn, 1 );\n\t},\n\toff: function( types, selector, fn ) {\n\t\tif ( types && types.preventDefault && types.handleObj ) {\n\t\t\t// ( event )  dispatched jQuery.Event\n\t\t\tvar handleObj = types.handleObj;\n\t\t\tjQuery( types.delegateTarget ).off(\n\t\t\t\thandleObj.namespace ? handleObj.origType + \".\" + handleObj.namespace : handleObj.origType,\n\t\t\t\thandleObj.selector,\n\t\t\t\thandleObj.handler\n\t\t\t);\n\t\t\treturn this;\n\t\t}\n\t\tif ( typeof types === \"object\" ) {\n\t\t\t// ( types-object [, selector] )\n\t\t\tfor ( var type in types ) {\n\t\t\t\tthis.off( type, selector, types[ type ] );\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t\tif ( selector === false || typeof selector === \"function\" ) {\n\t\t\t// ( types [, fn] )\n\t\t\tfn = selector;\n\t\t\tselector = undefined;\n\t\t}\n\t\tif ( fn === false ) {\n\t\t\tfn = returnFalse;\n\t\t}\n\t\treturn this.each(function() {\n\t\t\tjQuery.event.remove( this, types, fn, selector );\n\t\t});\n\t},\n\n\tbind: function( types, data, fn ) {\n\t\treturn this.on( types, null, data, fn );\n\t},\n\tunbind: function( types, fn ) {\n\t\treturn this.off( types, null, fn );\n\t},\n\n\tlive: function( types, data, fn ) {\n\t\tjQuery( this.context ).on( types, this.selector, data, fn );\n\t\treturn this;\n\t},\n\tdie: function( types, fn ) {\n\t\tjQuery( this.context ).off( types, this.selector || \"**\", fn );\n\t\treturn this;\n\t},\n\n\tdelegate: function( selector, types, data, fn ) {\n\t\treturn this.on( types, selector, data, fn );\n\t},\n\tundelegate: function( selector, types, fn ) {\n\t\t// ( namespace ) or ( selector, types [, fn] )\n\t\treturn arguments.length == 1? this.off( selector, \"**\" ) : this.off( types, selector, fn );\n\t},\n\n\ttrigger: function( type, data ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.event.trigger( type, data, this );\n\t\t});\n\t},\n\ttriggerHandler: function( type, data ) {\n\t\tif ( this[0] ) {\n\t\t\treturn jQuery.event.trigger( type, data, this[0], true );\n\t\t}\n\t},\n\n\ttoggle: function( fn ) {\n\t\t// Save reference to arguments for access in closure\n\t\tvar args = arguments,\n\t\t\tguid = fn.guid || jQuery.guid++,\n\t\t\ti = 0,\n\t\t\ttoggler = function( event ) {\n\t\t\t\t// Figure out which function to execute\n\t\t\t\tvar lastToggle = ( jQuery._data( this, \"lastToggle\" + fn.guid ) || 0 ) % i;\n\t\t\t\tjQuery._data( this, \"lastToggle\" + fn.guid, lastToggle + 1 );\n\n\t\t\t\t// Make sure that clicks stop\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\t// and execute the function\n\t\t\t\treturn args[ lastToggle ].apply( this, arguments ) || false;\n\t\t\t};\n\n\t\t// link all the functions, so any of them can unbind this click handler\n\t\ttoggler.guid = guid;\n\t\twhile ( i < args.length ) {\n\t\t\targs[ i++ ].guid = guid;\n\t\t}\n\n\t\treturn this.click( toggler );\n\t},\n\n\thover: function( fnOver, fnOut ) {\n\t\treturn this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\n\t}\n});\n\njQuery.each( (\"blur focus focusin focusout load resize scroll unload click dblclick \" +\n\t\"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave \" +\n\t\"change select submit keydown keypress keyup error contextmenu\").split(\" \"), function( i, name ) {\n\n\t// Handle event binding\n\tjQuery.fn[ name ] = function( data, fn ) {\n\t\tif ( fn == null ) {\n\t\t\tfn = data;\n\t\t\tdata = null;\n\t\t}\n\n\t\treturn arguments.length > 0 ?\n\t\t\tthis.on( name, null, data, fn ) :\n\t\t\tthis.trigger( name );\n\t};\n\n\tif ( jQuery.attrFn ) {\n\t\tjQuery.attrFn[ name ] = true;\n\t}\n\n\tif ( rkeyEvent.test( name ) ) {\n\t\tjQuery.event.fixHooks[ name ] = jQuery.event.keyHooks;\n\t}\n\n\tif ( rmouseEvent.test( name ) ) {\n\t\tjQuery.event.fixHooks[ name ] = jQuery.event.mouseHooks;\n\t}\n});\n\n\n\n/*!\n * Sizzle CSS Selector Engine\n *  Copyright 2011, The Dojo Foundation\n *  Released under the MIT, BSD, and GPL Licenses.\n *  More information: http://sizzlejs.com/\n */\n(function(){\n\nvar chunker = /((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^\\[\\]]*\\]|['\"][^'\"]*['\"]|[^\\[\\]'\"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?((?:.|\\r|\\n)*)/g,\n\texpando = \"sizcache\" + (Math.random() + '').replace('.', ''),\n\tdone = 0,\n\ttoString = Object.prototype.toString,\n\thasDuplicate = false,\n\tbaseHasDuplicate = true,\n\trBackslash = /\\\\/g,\n\trReturn = /\\r\\n/g,\n\trNonWord = /\\W/;\n\n// Here we check if the JavaScript engine is using some sort of\n// optimization where it does not always call our comparision\n// function. If that is the case, discard the hasDuplicate value.\n//   Thus far that includes Google Chrome.\n[0, 0].sort(function() {\n\tbaseHasDuplicate = false;\n\treturn 0;\n});\n\nvar Sizzle = function( selector, context, results, seed ) {\n\tresults = results || [];\n\tcontext = context || document;\n\n\tvar origContext = context;\n\n\tif ( context.nodeType !== 1 && context.nodeType !== 9 ) {\n\t\treturn [];\n\t}\n\n\tif ( !selector || typeof selector !== \"string\" ) {\n\t\treturn results;\n\t}\n\n\tvar m, set, checkSet, extra, ret, cur, pop, i,\n\t\tprune = true,\n\t\tcontextXML = Sizzle.isXML( context ),\n\t\tparts = [],\n\t\tsoFar = selector;\n\n\t// Reset the position of the chunker regexp (start from head)\n\tdo {\n\t\tchunker.exec( \"\" );\n\t\tm = chunker.exec( soFar );\n\n\t\tif ( m ) {\n\t\t\tsoFar = m[3];\n\n\t\t\tparts.push( m[1] );\n\n\t\t\tif ( m[2] ) {\n\t\t\t\textra = m[3];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t} while ( m );\n\n\tif ( parts.length > 1 && origPOS.exec( selector ) ) {\n\n\t\tif ( parts.length === 2 && Expr.relative[ parts[0] ] ) {\n\t\t\tset = posProcess( parts[0] + parts[1], context, seed );\n\n\t\t} else {\n\t\t\tset = Expr.relative[ parts[0] ] ?\n\t\t\t\t[ context ] :\n\t\t\t\tSizzle( parts.shift(), context );\n\n\t\t\twhile ( parts.length ) {\n\t\t\t\tselector = parts.shift();\n\n\t\t\t\tif ( Expr.relative[ selector ] ) {\n\t\t\t\t\tselector += parts.shift();\n\t\t\t\t}\n\n\t\t\t\tset = posProcess( selector, set, seed );\n\t\t\t}\n\t\t}\n\n\t} else {\n\t\t// Take a shortcut and set the context if the root selector is an ID\n\t\t// (but not if it'll be faster if the inner selector is an ID)\n\t\tif ( !seed && parts.length > 1 && context.nodeType === 9 && !contextXML &&\n\t\t\t\tExpr.match.ID.test(parts[0]) && !Expr.match.ID.test(parts[parts.length - 1]) ) {\n\n\t\t\tret = Sizzle.find( parts.shift(), context, contextXML );\n\t\t\tcontext = ret.expr ?\n\t\t\t\tSizzle.filter( ret.expr, ret.set )[0] :\n\t\t\t\tret.set[0];\n\t\t}\n\n\t\tif ( context ) {\n\t\t\tret = seed ?\n\t\t\t\t{ expr: parts.pop(), set: makeArray(seed) } :\n\t\t\t\tSizzle.find( parts.pop(), parts.length === 1 && (parts[0] === \"~\" || parts[0] === \"+\") && context.parentNode ? context.parentNode : context, contextXML );\n\n\t\t\tset = ret.expr ?\n\t\t\t\tSizzle.filter( ret.expr, ret.set ) :\n\t\t\t\tret.set;\n\n\t\t\tif ( parts.length > 0 ) {\n\t\t\t\tcheckSet = makeArray( set );\n\n\t\t\t} else {\n\t\t\t\tprune = false;\n\t\t\t}\n\n\t\t\twhile ( parts.length ) {\n\t\t\t\tcur = parts.pop();\n\t\t\t\tpop = cur;\n\n\t\t\t\tif ( !Expr.relative[ cur ] ) {\n\t\t\t\t\tcur = \"\";\n\t\t\t\t} else {\n\t\t\t\t\tpop = parts.pop();\n\t\t\t\t}\n\n\t\t\t\tif ( pop == null ) {\n\t\t\t\t\tpop = context;\n\t\t\t\t}\n\n\t\t\t\tExpr.relative[ cur ]( checkSet, pop, contextXML );\n\t\t\t}\n\n\t\t} else {\n\t\t\tcheckSet = parts = [];\n\t\t}\n\t}\n\n\tif ( !checkSet ) {\n\t\tcheckSet = set;\n\t}\n\n\tif ( !checkSet ) {\n\t\tSizzle.error( cur || selector );\n\t}\n\n\tif ( toString.call(checkSet) === \"[object Array]\" ) {\n\t\tif ( !prune ) {\n\t\t\tresults.push.apply( results, checkSet );\n\n\t\t} else if ( context && context.nodeType === 1 ) {\n\t\t\tfor ( i = 0; checkSet[i] != null; i++ ) {\n\t\t\t\tif ( checkSet[i] && (checkSet[i] === true || checkSet[i].nodeType === 1 && Sizzle.contains(context, checkSet[i])) ) {\n\t\t\t\t\tresults.push( set[i] );\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\tfor ( i = 0; checkSet[i] != null; i++ ) {\n\t\t\t\tif ( checkSet[i] && checkSet[i].nodeType === 1 ) {\n\t\t\t\t\tresults.push( set[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t} else {\n\t\tmakeArray( checkSet, results );\n\t}\n\n\tif ( extra ) {\n\t\tSizzle( extra, origContext, results, seed );\n\t\tSizzle.uniqueSort( results );\n\t}\n\n\treturn results;\n};\n\nSizzle.uniqueSort = function( results ) {\n\tif ( sortOrder ) {\n\t\thasDuplicate = baseHasDuplicate;\n\t\tresults.sort( sortOrder );\n\n\t\tif ( hasDuplicate ) {\n\t\t\tfor ( var i = 1; i < results.length; i++ ) {\n\t\t\t\tif ( results[i] === results[ i - 1 ] ) {\n\t\t\t\t\tresults.splice( i--, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn results;\n};\n\nSizzle.matches = function( expr, set ) {\n\treturn Sizzle( expr, null, null, set );\n};\n\nSizzle.matchesSelector = function( node, expr ) {\n\treturn Sizzle( expr, null, null, [node] ).length > 0;\n};\n\nSizzle.find = function( expr, context, isXML ) {\n\tvar set, i, len, match, type, left;\n\n\tif ( !expr ) {\n\t\treturn [];\n\t}\n\n\tfor ( i = 0, len = Expr.order.length; i < len; i++ ) {\n\t\ttype = Expr.order[i];\n\n\t\tif ( (match = Expr.leftMatch[ type ].exec( expr )) ) {\n\t\t\tleft = match[1];\n\t\t\tmatch.splice( 1, 1 );\n\n\t\t\tif ( left.substr( left.length - 1 ) !== \"\\\\\" ) {\n\t\t\t\tmatch[1] = (match[1] || \"\").replace( rBackslash, \"\" );\n\t\t\t\tset = Expr.find[ type ]( match, context, isXML );\n\n\t\t\t\tif ( set != null ) {\n\t\t\t\t\texpr = expr.replace( Expr.match[ type ], \"\" );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( !set ) {\n\t\tset = typeof context.getElementsByTagName !== \"undefined\" ?\n\t\t\tcontext.getElementsByTagName( \"*\" ) :\n\t\t\t[];\n\t}\n\n\treturn { set: set, expr: expr };\n};\n\nSizzle.filter = function( expr, set, inplace, not ) {\n\tvar match, anyFound,\n\t\ttype, found, item, filter, left,\n\t\ti, pass,\n\t\told = expr,\n\t\tresult = [],\n\t\tcurLoop = set,\n\t\tisXMLFilter = set && set[0] && Sizzle.isXML( set[0] );\n\n\twhile ( expr && set.length ) {\n\t\tfor ( type in Expr.filter ) {\n\t\t\tif ( (match = Expr.leftMatch[ type ].exec( expr )) != null && match[2] ) {\n\t\t\t\tfilter = Expr.filter[ type ];\n\t\t\t\tleft = match[1];\n\n\t\t\t\tanyFound = false;\n\n\t\t\t\tmatch.splice(1,1);\n\n\t\t\t\tif ( left.substr( left.length - 1 ) === \"\\\\\" ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( curLoop === result ) {\n\t\t\t\t\tresult = [];\n\t\t\t\t}\n\n\t\t\t\tif ( Expr.preFilter[ type ] ) {\n\t\t\t\t\tmatch = Expr.preFilter[ type ]( match, curLoop, inplace, result, not, isXMLFilter );\n\n\t\t\t\t\tif ( !match ) {\n\t\t\t\t\t\tanyFound = found = true;\n\n\t\t\t\t\t} else if ( match === true ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( match ) {\n\t\t\t\t\tfor ( i = 0; (item = curLoop[i]) != null; i++ ) {\n\t\t\t\t\t\tif ( item ) {\n\t\t\t\t\t\t\tfound = filter( item, match, i, curLoop );\n\t\t\t\t\t\t\tpass = not ^ found;\n\n\t\t\t\t\t\t\tif ( inplace && found != null ) {\n\t\t\t\t\t\t\t\tif ( pass ) {\n\t\t\t\t\t\t\t\t\tanyFound = true;\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcurLoop[i] = false;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else if ( pass ) {\n\t\t\t\t\t\t\t\tresult.push( item );\n\t\t\t\t\t\t\t\tanyFound = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( found !== undefined ) {\n\t\t\t\t\tif ( !inplace ) {\n\t\t\t\t\t\tcurLoop = result;\n\t\t\t\t\t}\n\n\t\t\t\t\texpr = expr.replace( Expr.match[ type ], \"\" );\n\n\t\t\t\t\tif ( !anyFound ) {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Improper expression\n\t\tif ( expr === old ) {\n\t\t\tif ( anyFound == null ) {\n\t\t\t\tSizzle.error( expr );\n\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\told = expr;\n\t}\n\n\treturn curLoop;\n};\n\nSizzle.error = function( msg ) {\n\tthrow new Error( \"Syntax error, unrecognized expression: \" + msg );\n};\n\n/**\n * Utility function for retreiving the text value of an array of DOM nodes\n * @param {Array|Element} elem\n */\nvar getText = Sizzle.getText = function( elem ) {\n    var i, node,\n\t\tnodeType = elem.nodeType,\n\t\tret = \"\";\n\n\tif ( nodeType ) {\n\t\tif ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t\t// Use textContent || innerText for elements\n\t\t\tif ( typeof elem.textContent === 'string' ) {\n\t\t\t\treturn elem.textContent;\n\t\t\t} else if ( typeof elem.innerText === 'string' ) {\n\t\t\t\t// Replace IE's carriage returns\n\t\t\t\treturn elem.innerText.replace( rReturn, '' );\n\t\t\t} else {\n\t\t\t\t// Traverse it's children\n\t\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling) {\n\t\t\t\t\tret += getText( elem );\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\t\treturn elem.nodeValue;\n\t\t}\n\t} else {\n\n\t\t// If no nodeType, this is expected to be an array\n\t\tfor ( i = 0; (node = elem[i]); i++ ) {\n\t\t\t// Do not traverse comment nodes\n\t\t\tif ( node.nodeType !== 8 ) {\n\t\t\t\tret += getText( node );\n\t\t\t}\n\t\t}\n\t}\n\treturn ret;\n};\n\nvar Expr = Sizzle.selectors = {\n\torder: [ \"ID\", \"NAME\", \"TAG\" ],\n\n\tmatch: {\n\t\tID: /#((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/,\n\t\tCLASS: /\\.((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/,\n\t\tNAME: /\\[name=['\"]*((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)['\"]*\\]/,\n\t\tATTR: /\\[\\s*((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)\\s*(?:(\\S?=)\\s*(?:(['\"])(.*?)\\3|(#?(?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)*)|)|)\\s*\\]/,\n\t\tTAG: /^((?:[\\w\\u00c0-\\uFFFF\\*\\-]|\\\\.)+)/,\n\t\tCHILD: /:(only|nth|last|first)-child(?:\\(\\s*(even|odd|(?:[+\\-]?\\d+|(?:[+\\-]?\\d*)?n\\s*(?:[+\\-]\\s*\\d+)?))\\s*\\))?/,\n\t\tPOS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^\\-]|$)/,\n\t\tPSEUDO: /:((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)(?:\\((['\"]?)((?:\\([^\\)]+\\)|[^\\(\\)]*)+)\\2\\))?/\n\t},\n\n\tleftMatch: {},\n\n\tattrMap: {\n\t\t\"class\": \"className\",\n\t\t\"for\": \"htmlFor\"\n\t},\n\n\tattrHandle: {\n\t\thref: function( elem ) {\n\t\t\treturn elem.getAttribute( \"href\" );\n\t\t},\n\t\ttype: function( elem ) {\n\t\t\treturn elem.getAttribute( \"type\" );\n\t\t}\n\t},\n\n\trelative: {\n\t\t\"+\": function(checkSet, part){\n\t\t\tvar isPartStr = typeof part === \"string\",\n\t\t\t\tisTag = isPartStr && !rNonWord.test( part ),\n\t\t\t\tisPartStrNotTag = isPartStr && !isTag;\n\n\t\t\tif ( isTag ) {\n\t\t\t\tpart = part.toLowerCase();\n\t\t\t}\n\n\t\t\tfor ( var i = 0, l = checkSet.length, elem; i < l; i++ ) {\n\t\t\t\tif ( (elem = checkSet[i]) ) {\n\t\t\t\t\twhile ( (elem = elem.previousSibling) && elem.nodeType !== 1 ) {}\n\n\t\t\t\t\tcheckSet[i] = isPartStrNotTag || elem && elem.nodeName.toLowerCase() === part ?\n\t\t\t\t\t\telem || false :\n\t\t\t\t\t\telem === part;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( isPartStrNotTag ) {\n\t\t\t\tSizzle.filter( part, checkSet, true );\n\t\t\t}\n\t\t},\n\n\t\t\">\": function( checkSet, part ) {\n\t\t\tvar elem,\n\t\t\t\tisPartStr = typeof part === \"string\",\n\t\t\t\ti = 0,\n\t\t\t\tl = checkSet.length;\n\n\t\t\tif ( isPartStr && !rNonWord.test( part ) ) {\n\t\t\t\tpart = part.toLowerCase();\n\n\t\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\t\telem = checkSet[i];\n\n\t\t\t\t\tif ( elem ) {\n\t\t\t\t\t\tvar parent = elem.parentNode;\n\t\t\t\t\t\tcheckSet[i] = parent.nodeName.toLowerCase() === part ? parent : false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\t\telem = checkSet[i];\n\n\t\t\t\t\tif ( elem ) {\n\t\t\t\t\t\tcheckSet[i] = isPartStr ?\n\t\t\t\t\t\t\telem.parentNode :\n\t\t\t\t\t\t\telem.parentNode === part;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( isPartStr ) {\n\t\t\t\t\tSizzle.filter( part, checkSet, true );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t\"\": function(checkSet, part, isXML){\n\t\t\tvar nodeCheck,\n\t\t\t\tdoneName = done++,\n\t\t\t\tcheckFn = dirCheck;\n\n\t\t\tif ( typeof part === \"string\" && !rNonWord.test( part ) ) {\n\t\t\t\tpart = part.toLowerCase();\n\t\t\t\tnodeCheck = part;\n\t\t\t\tcheckFn = dirNodeCheck;\n\t\t\t}\n\n\t\t\tcheckFn( \"parentNode\", part, doneName, checkSet, nodeCheck, isXML );\n\t\t},\n\n\t\t\"~\": function( checkSet, part, isXML ) {\n\t\t\tvar nodeCheck,\n\t\t\t\tdoneName = done++,\n\t\t\t\tcheckFn = dirCheck;\n\n\t\t\tif ( typeof part === \"string\" && !rNonWord.test( part ) ) {\n\t\t\t\tpart = part.toLowerCase();\n\t\t\t\tnodeCheck = part;\n\t\t\t\tcheckFn = dirNodeCheck;\n\t\t\t}\n\n\t\t\tcheckFn( \"previousSibling\", part, doneName, checkSet, nodeCheck, isXML );\n\t\t}\n\t},\n\n\tfind: {\n\t\tID: function( match, context, isXML ) {\n\t\t\tif ( typeof context.getElementById !== \"undefined\" && !isXML ) {\n\t\t\t\tvar m = context.getElementById(match[1]);\n\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\treturn m && m.parentNode ? [m] : [];\n\t\t\t}\n\t\t},\n\n\t\tNAME: function( match, context ) {\n\t\t\tif ( typeof context.getElementsByName !== \"undefined\" ) {\n\t\t\t\tvar ret = [],\n\t\t\t\t\tresults = context.getElementsByName( match[1] );\n\n\t\t\t\tfor ( var i = 0, l = results.length; i < l; i++ ) {\n\t\t\t\t\tif ( results[i].getAttribute(\"name\") === match[1] ) {\n\t\t\t\t\t\tret.push( results[i] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn ret.length === 0 ? null : ret;\n\t\t\t}\n\t\t},\n\n\t\tTAG: function( match, context ) {\n\t\t\tif ( typeof context.getElementsByTagName !== \"undefined\" ) {\n\t\t\t\treturn context.getElementsByTagName( match[1] );\n\t\t\t}\n\t\t}\n\t},\n\tpreFilter: {\n\t\tCLASS: function( match, curLoop, inplace, result, not, isXML ) {\n\t\t\tmatch = \" \" + match[1].replace( rBackslash, \"\" ) + \" \";\n\n\t\t\tif ( isXML ) {\n\t\t\t\treturn match;\n\t\t\t}\n\n\t\t\tfor ( var i = 0, elem; (elem = curLoop[i]) != null; i++ ) {\n\t\t\t\tif ( elem ) {\n\t\t\t\t\tif ( not ^ (elem.className && (\" \" + elem.className + \" \").replace(/[\\t\\n\\r]/g, \" \").indexOf(match) >= 0) ) {\n\t\t\t\t\t\tif ( !inplace ) {\n\t\t\t\t\t\t\tresult.push( elem );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( inplace ) {\n\t\t\t\t\t\tcurLoop[i] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\tID: function( match ) {\n\t\t\treturn match[1].replace( rBackslash, \"\" );\n\t\t},\n\n\t\tTAG: function( match, curLoop ) {\n\t\t\treturn match[1].replace( rBackslash, \"\" ).toLowerCase();\n\t\t},\n\n\t\tCHILD: function( match ) {\n\t\t\tif ( match[1] === \"nth\" ) {\n\t\t\t\tif ( !match[2] ) {\n\t\t\t\t\tSizzle.error( match[0] );\n\t\t\t\t}\n\n\t\t\t\tmatch[2] = match[2].replace(/^\\+|\\s*/g, '');\n\n\t\t\t\t// parse equations like 'even', 'odd', '5', '2n', '3n+2', '4n-1', '-n+6'\n\t\t\t\tvar test = /(-?)(\\d*)(?:n([+\\-]?\\d*))?/.exec(\n\t\t\t\t\tmatch[2] === \"even\" && \"2n\" || match[2] === \"odd\" && \"2n+1\" ||\n\t\t\t\t\t!/\\D/.test( match[2] ) && \"0n+\" + match[2] || match[2]);\n\n\t\t\t\t// calculate the numbers (first)n+(last) including if they are negative\n\t\t\t\tmatch[2] = (test[1] + (test[2] || 1)) - 0;\n\t\t\t\tmatch[3] = test[3] - 0;\n\t\t\t}\n\t\t\telse if ( match[2] ) {\n\t\t\t\tSizzle.error( match[0] );\n\t\t\t}\n\n\t\t\t// TODO: Move to normal caching system\n\t\t\tmatch[0] = done++;\n\n\t\t\treturn match;\n\t\t},\n\n\t\tATTR: function( match, curLoop, inplace, result, not, isXML ) {\n\t\t\tvar name = match[1] = match[1].replace( rBackslash, \"\" );\n\n\t\t\tif ( !isXML && Expr.attrMap[name] ) {\n\t\t\t\tmatch[1] = Expr.attrMap[name];\n\t\t\t}\n\n\t\t\t// Handle if an un-quoted value was used\n\t\t\tmatch[4] = ( match[4] || match[5] || \"\" ).replace( rBackslash, \"\" );\n\n\t\t\tif ( match[2] === \"~=\" ) {\n\t\t\t\tmatch[4] = \" \" + match[4] + \" \";\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\tPSEUDO: function( match, curLoop, inplace, result, not ) {\n\t\t\tif ( match[1] === \"not\" ) {\n\t\t\t\t// If we're dealing with a complex expression, or a simple one\n\t\t\t\tif ( ( chunker.exec(match[3]) || \"\" ).length > 1 || /^\\w/.test(match[3]) ) {\n\t\t\t\t\tmatch[3] = Sizzle(match[3], null, null, curLoop);\n\n\t\t\t\t} else {\n\t\t\t\t\tvar ret = Sizzle.filter(match[3], curLoop, inplace, true ^ not);\n\n\t\t\t\t\tif ( !inplace ) {\n\t\t\t\t\t\tresult.push.apply( result, ret );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t} else if ( Expr.match.POS.test( match[0] ) || Expr.match.CHILD.test( match[0] ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\tPOS: function( match ) {\n\t\t\tmatch.unshift( true );\n\n\t\t\treturn match;\n\t\t}\n\t},\n\n\tfilters: {\n\t\tenabled: function( elem ) {\n\t\t\treturn elem.disabled === false && elem.type !== \"hidden\";\n\t\t},\n\n\t\tdisabled: function( elem ) {\n\t\t\treturn elem.disabled === true;\n\t\t},\n\n\t\tchecked: function( elem ) {\n\t\t\treturn elem.checked === true;\n\t\t},\n\n\t\tselected: function( elem ) {\n\t\t\t// Accessing this property makes selected-by-default\n\t\t\t// options in Safari work properly\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\telem.parentNode.selectedIndex;\n\t\t\t}\n\n\t\t\treturn elem.selected === true;\n\t\t},\n\n\t\tparent: function( elem ) {\n\t\t\treturn !!elem.firstChild;\n\t\t},\n\n\t\tempty: function( elem ) {\n\t\t\treturn !elem.firstChild;\n\t\t},\n\n\t\thas: function( elem, i, match ) {\n\t\t\treturn !!Sizzle( match[3], elem ).length;\n\t\t},\n\n\t\theader: function( elem ) {\n\t\t\treturn (/h\\d/i).test( elem.nodeName );\n\t\t},\n\n\t\ttext: function( elem ) {\n\t\t\tvar attr = elem.getAttribute( \"type\" ), type = elem.type;\n\t\t\t// IE6 and 7 will map elem.type to 'text' for new HTML5 types (search, etc)\n\t\t\t// use getAttribute instead to test this case\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" && \"text\" === type && ( attr === type || attr === null );\n\t\t},\n\n\t\tradio: function( elem ) {\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" && \"radio\" === elem.type;\n\t\t},\n\n\t\tcheckbox: function( elem ) {\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" && \"checkbox\" === elem.type;\n\t\t},\n\n\t\tfile: function( elem ) {\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" && \"file\" === elem.type;\n\t\t},\n\n\t\tpassword: function( elem ) {\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" && \"password\" === elem.type;\n\t\t},\n\n\t\tsubmit: function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn (name === \"input\" || name === \"button\") && \"submit\" === elem.type;\n\t\t},\n\n\t\timage: function( elem ) {\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" && \"image\" === elem.type;\n\t\t},\n\n\t\treset: function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn (name === \"input\" || name === \"button\") && \"reset\" === elem.type;\n\t\t},\n\n\t\tbutton: function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn name === \"input\" && \"button\" === elem.type || name === \"button\";\n\t\t},\n\n\t\tinput: function( elem ) {\n\t\t\treturn (/input|select|textarea|button/i).test( elem.nodeName );\n\t\t},\n\n\t\tfocus: function( elem ) {\n\t\t\treturn elem === elem.ownerDocument.activeElement;\n\t\t}\n\t},\n\tsetFilters: {\n\t\tfirst: function( elem, i ) {\n\t\t\treturn i === 0;\n\t\t},\n\n\t\tlast: function( elem, i, match, array ) {\n\t\t\treturn i === array.length - 1;\n\t\t},\n\n\t\teven: function( elem, i ) {\n\t\t\treturn i % 2 === 0;\n\t\t},\n\n\t\todd: function( elem, i ) {\n\t\t\treturn i % 2 === 1;\n\t\t},\n\n\t\tlt: function( elem, i, match ) {\n\t\t\treturn i < match[3] - 0;\n\t\t},\n\n\t\tgt: function( elem, i, match ) {\n\t\t\treturn i > match[3] - 0;\n\t\t},\n\n\t\tnth: function( elem, i, match ) {\n\t\t\treturn match[3] - 0 === i;\n\t\t},\n\n\t\teq: function( elem, i, match ) {\n\t\t\treturn match[3] - 0 === i;\n\t\t}\n\t},\n\tfilter: {\n\t\tPSEUDO: function( elem, match, i, array ) {\n\t\t\tvar name = match[1],\n\t\t\t\tfilter = Expr.filters[ name ];\n\n\t\t\tif ( filter ) {\n\t\t\t\treturn filter( elem, i, match, array );\n\n\t\t\t} else if ( name === \"contains\" ) {\n\t\t\t\treturn (elem.textContent || elem.innerText || getText([ elem ]) || \"\").indexOf(match[3]) >= 0;\n\n\t\t\t} else if ( name === \"not\" ) {\n\t\t\t\tvar not = match[3];\n\n\t\t\t\tfor ( var j = 0, l = not.length; j < l; j++ ) {\n\t\t\t\t\tif ( not[j] === elem ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\n\t\t\t} else {\n\t\t\t\tSizzle.error( name );\n\t\t\t}\n\t\t},\n\n\t\tCHILD: function( elem, match ) {\n\t\t\tvar first, last,\n\t\t\t\tdoneName, parent, cache,\n\t\t\t\tcount, diff,\n\t\t\t\ttype = match[1],\n\t\t\t\tnode = elem;\n\n\t\t\tswitch ( type ) {\n\t\t\t\tcase \"only\":\n\t\t\t\tcase \"first\":\n\t\t\t\t\twhile ( (node = node.previousSibling) ) {\n\t\t\t\t\t\tif ( node.nodeType === 1 ) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( type === \"first\" ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tnode = elem;\n\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase \"last\":\n\t\t\t\t\twhile ( (node = node.nextSibling) ) {\n\t\t\t\t\t\tif ( node.nodeType === 1 ) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\n\t\t\t\tcase \"nth\":\n\t\t\t\t\tfirst = match[2];\n\t\t\t\t\tlast = match[3];\n\n\t\t\t\t\tif ( first === 1 && last === 0 ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tdoneName = match[0];\n\t\t\t\t\tparent = elem.parentNode;\n\n\t\t\t\t\tif ( parent && (parent[ expando ] !== doneName || !elem.nodeIndex) ) {\n\t\t\t\t\t\tcount = 0;\n\n\t\t\t\t\t\tfor ( node = parent.firstChild; node; node = node.nextSibling ) {\n\t\t\t\t\t\t\tif ( node.nodeType === 1 ) {\n\t\t\t\t\t\t\t\tnode.nodeIndex = ++count;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparent[ expando ] = doneName;\n\t\t\t\t\t}\n\n\t\t\t\t\tdiff = elem.nodeIndex - last;\n\n\t\t\t\t\tif ( first === 0 ) {\n\t\t\t\t\t\treturn diff === 0;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn ( diff % first === 0 && diff / first >= 0 );\n\t\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tID: function( elem, match ) {\n\t\t\treturn elem.nodeType === 1 && elem.getAttribute(\"id\") === match;\n\t\t},\n\n\t\tTAG: function( elem, match ) {\n\t\t\treturn (match === \"*\" && elem.nodeType === 1) || !!elem.nodeName && elem.nodeName.toLowerCase() === match;\n\t\t},\n\n\t\tCLASS: function( elem, match ) {\n\t\t\treturn (\" \" + (elem.className || elem.getAttribute(\"class\")) + \" \")\n\t\t\t\t.indexOf( match ) > -1;\n\t\t},\n\n\t\tATTR: function( elem, match ) {\n\t\t\tvar name = match[1],\n\t\t\t\tresult = Sizzle.attr ?\n\t\t\t\t\tSizzle.attr( elem, name ) :\n\t\t\t\t\tExpr.attrHandle[ name ] ?\n\t\t\t\t\tExpr.attrHandle[ name ]( elem ) :\n\t\t\t\t\telem[ name ] != null ?\n\t\t\t\t\t\telem[ name ] :\n\t\t\t\t\t\telem.getAttribute( name ),\n\t\t\t\tvalue = result + \"\",\n\t\t\t\ttype = match[2],\n\t\t\t\tcheck = match[4];\n\n\t\t\treturn result == null ?\n\t\t\t\ttype === \"!=\" :\n\t\t\t\t!type && Sizzle.attr ?\n\t\t\t\tresult != null :\n\t\t\t\ttype === \"=\" ?\n\t\t\t\tvalue === check :\n\t\t\t\ttype === \"*=\" ?\n\t\t\t\tvalue.indexOf(check) >= 0 :\n\t\t\t\ttype === \"~=\" ?\n\t\t\t\t(\" \" + value + \" \").indexOf(check) >= 0 :\n\t\t\t\t!check ?\n\t\t\t\tvalue && result !== false :\n\t\t\t\ttype === \"!=\" ?\n\t\t\t\tvalue !== check :\n\t\t\t\ttype === \"^=\" ?\n\t\t\t\tvalue.indexOf(check) === 0 :\n\t\t\t\ttype === \"$=\" ?\n\t\t\t\tvalue.substr(value.length - check.length) === check :\n\t\t\t\ttype === \"|=\" ?\n\t\t\t\tvalue === check || value.substr(0, check.length + 1) === check + \"-\" :\n\t\t\t\tfalse;\n\t\t},\n\n\t\tPOS: function( elem, match, i, array ) {\n\t\t\tvar name = match[2],\n\t\t\t\tfilter = Expr.setFilters[ name ];\n\n\t\t\tif ( filter ) {\n\t\t\t\treturn filter( elem, i, match, array );\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar origPOS = Expr.match.POS,\n\tfescape = function(all, num){\n\t\treturn \"\\\\\" + (num - 0 + 1);\n\t};\n\nfor ( var type in Expr.match ) {\n\tExpr.match[ type ] = new RegExp( Expr.match[ type ].source + (/(?![^\\[]*\\])(?![^\\(]*\\))/.source) );\n\tExpr.leftMatch[ type ] = new RegExp( /(^(?:.|\\r|\\n)*?)/.source + Expr.match[ type ].source.replace(/\\\\(\\d+)/g, fescape) );\n}\n// Expose origPOS\n// \"global\" as in regardless of relation to brackets/parens\nExpr.match.globalPOS = origPOS;\n\nvar makeArray = function( array, results ) {\n\tarray = Array.prototype.slice.call( array, 0 );\n\n\tif ( results ) {\n\t\tresults.push.apply( results, array );\n\t\treturn results;\n\t}\n\n\treturn array;\n};\n\n// Perform a simple check to determine if the browser is capable of\n// converting a NodeList to an array using builtin methods.\n// Also verifies that the returned array holds DOM nodes\n// (which is not the case in the Blackberry browser)\ntry {\n\tArray.prototype.slice.call( document.documentElement.childNodes, 0 )[0].nodeType;\n\n// Provide a fallback method if it does not work\n} catch( e ) {\n\tmakeArray = function( array, results ) {\n\t\tvar i = 0,\n\t\t\tret = results || [];\n\n\t\tif ( toString.call(array) === \"[object Array]\" ) {\n\t\t\tArray.prototype.push.apply( ret, array );\n\n\t\t} else {\n\t\t\tif ( typeof array.length === \"number\" ) {\n\t\t\t\tfor ( var l = array.length; i < l; i++ ) {\n\t\t\t\t\tret.push( array[i] );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tfor ( ; array[i]; i++ ) {\n\t\t\t\t\tret.push( array[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t};\n}\n\nvar sortOrder, siblingCheck;\n\nif ( document.documentElement.compareDocumentPosition ) {\n\tsortOrder = function( a, b ) {\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\tif ( !a.compareDocumentPosition || !b.compareDocumentPosition ) {\n\t\t\treturn a.compareDocumentPosition ? -1 : 1;\n\t\t}\n\n\t\treturn a.compareDocumentPosition(b) & 4 ? -1 : 1;\n\t};\n\n} else {\n\tsortOrder = function( a, b ) {\n\t\t// The nodes are identical, we can exit early\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\n\t\t// Fallback to using sourceIndex (in IE) if it's available on both nodes\n\t\t} else if ( a.sourceIndex && b.sourceIndex ) {\n\t\t\treturn a.sourceIndex - b.sourceIndex;\n\t\t}\n\n\t\tvar al, bl,\n\t\t\tap = [],\n\t\t\tbp = [],\n\t\t\taup = a.parentNode,\n\t\t\tbup = b.parentNode,\n\t\t\tcur = aup;\n\n\t\t// If the nodes are siblings (or identical) we can do a quick check\n\t\tif ( aup === bup ) {\n\t\t\treturn siblingCheck( a, b );\n\n\t\t// If no parents were found then the nodes are disconnected\n\t\t} else if ( !aup ) {\n\t\t\treturn -1;\n\n\t\t} else if ( !bup ) {\n\t\t\treturn 1;\n\t\t}\n\n\t\t// Otherwise they're somewhere else in the tree so we need\n\t\t// to build up a full list of the parentNodes for comparison\n\t\twhile ( cur ) {\n\t\t\tap.unshift( cur );\n\t\t\tcur = cur.parentNode;\n\t\t}\n\n\t\tcur = bup;\n\n\t\twhile ( cur ) {\n\t\t\tbp.unshift( cur );\n\t\t\tcur = cur.parentNode;\n\t\t}\n\n\t\tal = ap.length;\n\t\tbl = bp.length;\n\n\t\t// Start walking down the tree looking for a discrepancy\n\t\tfor ( var i = 0; i < al && i < bl; i++ ) {\n\t\t\tif ( ap[i] !== bp[i] ) {\n\t\t\t\treturn siblingCheck( ap[i], bp[i] );\n\t\t\t}\n\t\t}\n\n\t\t// We ended someplace up the tree so do a sibling check\n\t\treturn i === al ?\n\t\t\tsiblingCheck( a, bp[i], -1 ) :\n\t\t\tsiblingCheck( ap[i], b, 1 );\n\t};\n\n\tsiblingCheck = function( a, b, ret ) {\n\t\tif ( a === b ) {\n\t\t\treturn ret;\n\t\t}\n\n\t\tvar cur = a.nextSibling;\n\n\t\twhile ( cur ) {\n\t\t\tif ( cur === b ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tcur = cur.nextSibling;\n\t\t}\n\n\t\treturn 1;\n\t};\n}\n\n// Check to see if the browser returns elements by name when\n// querying by getElementById (and provide a workaround)\n(function(){\n\t// We're going to inject a fake input element with a specified name\n\tvar form = document.createElement(\"div\"),\n\t\tid = \"script\" + (new Date()).getTime(),\n\t\troot = document.documentElement;\n\n\tform.innerHTML = \"<a name='\" + id + \"'/>\";\n\n\t// Inject it into the root element, check its status, and remove it quickly\n\troot.insertBefore( form, root.firstChild );\n\n\t// The workaround has to do additional checks after a getElementById\n\t// Which slows things down for other browsers (hence the branching)\n\tif ( document.getElementById( id ) ) {\n\t\tExpr.find.ID = function( match, context, isXML ) {\n\t\t\tif ( typeof context.getElementById !== \"undefined\" && !isXML ) {\n\t\t\t\tvar m = context.getElementById(match[1]);\n\n\t\t\t\treturn m ?\n\t\t\t\t\tm.id === match[1] || typeof m.getAttributeNode !== \"undefined\" && m.getAttributeNode(\"id\").nodeValue === match[1] ?\n\t\t\t\t\t\t[m] :\n\t\t\t\t\t\tundefined :\n\t\t\t\t\t[];\n\t\t\t}\n\t\t};\n\n\t\tExpr.filter.ID = function( elem, match ) {\n\t\t\tvar node = typeof elem.getAttributeNode !== \"undefined\" && elem.getAttributeNode(\"id\");\n\n\t\t\treturn elem.nodeType === 1 && node && node.nodeValue === match;\n\t\t};\n\t}\n\n\troot.removeChild( form );\n\n\t// release memory in IE\n\troot = form = null;\n})();\n\n(function(){\n\t// Check to see if the browser returns only elements\n\t// when doing getElementsByTagName(\"*\")\n\n\t// Create a fake element\n\tvar div = document.createElement(\"div\");\n\tdiv.appendChild( document.createComment(\"\") );\n\n\t// Make sure no comments are found\n\tif ( div.getElementsByTagName(\"*\").length > 0 ) {\n\t\tExpr.find.TAG = function( match, context ) {\n\t\t\tvar results = context.getElementsByTagName( match[1] );\n\n\t\t\t// Filter out possible comments\n\t\t\tif ( match[1] === \"*\" ) {\n\t\t\t\tvar tmp = [];\n\n\t\t\t\tfor ( var i = 0; results[i]; i++ ) {\n\t\t\t\t\tif ( results[i].nodeType === 1 ) {\n\t\t\t\t\t\ttmp.push( results[i] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresults = tmp;\n\t\t\t}\n\n\t\t\treturn results;\n\t\t};\n\t}\n\n\t// Check to see if an attribute returns normalized href attributes\n\tdiv.innerHTML = \"<a href='#'></a>\";\n\n\tif ( div.firstChild && typeof div.firstChild.getAttribute !== \"undefined\" &&\n\t\t\tdiv.firstChild.getAttribute(\"href\") !== \"#\" ) {\n\n\t\tExpr.attrHandle.href = function( elem ) {\n\t\t\treturn elem.getAttribute( \"href\", 2 );\n\t\t};\n\t}\n\n\t// release memory in IE\n\tdiv = null;\n})();\n\nif ( document.querySelectorAll ) {\n\t(function(){\n\t\tvar oldSizzle = Sizzle,\n\t\t\tdiv = document.createElement(\"div\"),\n\t\t\tid = \"__sizzle__\";\n\n\t\tdiv.innerHTML = \"<p class='TEST'></p>\";\n\n\t\t// Safari can't handle uppercase or unicode characters when\n\t\t// in quirks mode.\n\t\tif ( div.querySelectorAll && div.querySelectorAll(\".TEST\").length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tSizzle = function( query, context, extra, seed ) {\n\t\t\tcontext = context || document;\n\n\t\t\t// Only use querySelectorAll on non-XML documents\n\t\t\t// (ID selectors don't work in non-HTML documents)\n\t\t\tif ( !seed && !Sizzle.isXML(context) ) {\n\t\t\t\t// See if we find a selector to speed up\n\t\t\t\tvar match = /^(\\w+$)|^\\.([\\w\\-]+$)|^#([\\w\\-]+$)/.exec( query );\n\n\t\t\t\tif ( match && (context.nodeType === 1 || context.nodeType === 9) ) {\n\t\t\t\t\t// Speed-up: Sizzle(\"TAG\")\n\t\t\t\t\tif ( match[1] ) {\n\t\t\t\t\t\treturn makeArray( context.getElementsByTagName( query ), extra );\n\n\t\t\t\t\t// Speed-up: Sizzle(\".CLASS\")\n\t\t\t\t\t} else if ( match[2] && Expr.find.CLASS && context.getElementsByClassName ) {\n\t\t\t\t\t\treturn makeArray( context.getElementsByClassName( match[2] ), extra );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( context.nodeType === 9 ) {\n\t\t\t\t\t// Speed-up: Sizzle(\"body\")\n\t\t\t\t\t// The body element only exists once, optimize finding it\n\t\t\t\t\tif ( query === \"body\" && context.body ) {\n\t\t\t\t\t\treturn makeArray( [ context.body ], extra );\n\n\t\t\t\t\t// Speed-up: Sizzle(\"#ID\")\n\t\t\t\t\t} else if ( match && match[3] ) {\n\t\t\t\t\t\tvar elem = context.getElementById( match[3] );\n\n\t\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\t\t\tif ( elem && elem.parentNode ) {\n\t\t\t\t\t\t\t// Handle the case where IE and Opera return items\n\t\t\t\t\t\t\t// by name instead of ID\n\t\t\t\t\t\t\tif ( elem.id === match[3] ) {\n\t\t\t\t\t\t\t\treturn makeArray( [ elem ], extra );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn makeArray( [], extra );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn makeArray( context.querySelectorAll(query), extra );\n\t\t\t\t\t} catch(qsaError) {}\n\n\t\t\t\t// qSA works strangely on Element-rooted queries\n\t\t\t\t// We can work around this by specifying an extra ID on the root\n\t\t\t\t// and working up from there (Thanks to Andrew Dupont for the technique)\n\t\t\t\t// IE 8 doesn't work on object elements\n\t\t\t\t} else if ( context.nodeType === 1 && context.nodeName.toLowerCase() !== \"object\" ) {\n\t\t\t\t\tvar oldContext = context,\n\t\t\t\t\t\told = context.getAttribute( \"id\" ),\n\t\t\t\t\t\tnid = old || id,\n\t\t\t\t\t\thasParent = context.parentNode,\n\t\t\t\t\t\trelativeHierarchySelector = /^\\s*[+~]/.test( query );\n\n\t\t\t\t\tif ( !old ) {\n\t\t\t\t\t\tcontext.setAttribute( \"id\", nid );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnid = nid.replace( /'/g, \"\\\\$&\" );\n\t\t\t\t\t}\n\t\t\t\t\tif ( relativeHierarchySelector && hasParent ) {\n\t\t\t\t\t\tcontext = context.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif ( !relativeHierarchySelector || hasParent ) {\n\t\t\t\t\t\t\treturn makeArray( context.querySelectorAll( \"[id='\" + nid + \"'] \" + query ), extra );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} catch(pseudoError) {\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tif ( !old ) {\n\t\t\t\t\t\t\toldContext.removeAttribute( \"id\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn oldSizzle(query, context, extra, seed);\n\t\t};\n\n\t\tfor ( var prop in oldSizzle ) {\n\t\t\tSizzle[ prop ] = oldSizzle[ prop ];\n\t\t}\n\n\t\t// release memory in IE\n\t\tdiv = null;\n\t})();\n}\n\n(function(){\n\tvar html = document.documentElement,\n\t\tmatches = html.matchesSelector || html.mozMatchesSelector || html.webkitMatchesSelector || html.msMatchesSelector;\n\n\tif ( matches ) {\n\t\t// Check to see if it's possible to do matchesSelector\n\t\t// on a disconnected node (IE 9 fails this)\n\t\tvar disconnectedMatch = !matches.call( document.createElement( \"div\" ), \"div\" ),\n\t\t\tpseudoWorks = false;\n\n\t\ttry {\n\t\t\t// This should fail with an exception\n\t\t\t// Gecko does not error, returns false instead\n\t\t\tmatches.call( document.documentElement, \"[test!='']:sizzle\" );\n\n\t\t} catch( pseudoError ) {\n\t\t\tpseudoWorks = true;\n\t\t}\n\n\t\tSizzle.matchesSelector = function( node, expr ) {\n\t\t\t// Make sure that attribute selectors are quoted\n\t\t\texpr = expr.replace(/\\=\\s*([^'\"\\]]*)\\s*\\]/g, \"='$1']\");\n\n\t\t\tif ( !Sizzle.isXML( node ) ) {\n\t\t\t\ttry {\n\t\t\t\t\tif ( pseudoWorks || !Expr.match.PSEUDO.test( expr ) && !/!=/.test( expr ) ) {\n\t\t\t\t\t\tvar ret = matches.call( node, expr );\n\n\t\t\t\t\t\t// IE 9's matchesSelector returns false on disconnected nodes\n\t\t\t\t\t\tif ( ret || !disconnectedMatch ||\n\t\t\t\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n\t\t\t\t\t\t\t\t// fragment in IE 9, so check for that\n\t\t\t\t\t\t\t\tnode.document && node.document.nodeType !== 11 ) {\n\t\t\t\t\t\t\treturn ret;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\n\t\t\treturn Sizzle(expr, null, null, [node]).length > 0;\n\t\t};\n\t}\n})();\n\n(function(){\n\tvar div = document.createElement(\"div\");\n\n\tdiv.innerHTML = \"<div class='test e'></div><div class='test'></div>\";\n\n\t// Opera can't find a second classname (in 9.6)\n\t// Also, make sure that getElementsByClassName actually exists\n\tif ( !div.getElementsByClassName || div.getElementsByClassName(\"e\").length === 0 ) {\n\t\treturn;\n\t}\n\n\t// Safari caches class attributes, doesn't catch changes (in 3.2)\n\tdiv.lastChild.className = \"e\";\n\n\tif ( div.getElementsByClassName(\"e\").length === 1 ) {\n\t\treturn;\n\t}\n\n\tExpr.order.splice(1, 0, \"CLASS\");\n\tExpr.find.CLASS = function( match, context, isXML ) {\n\t\tif ( typeof context.getElementsByClassName !== \"undefined\" && !isXML ) {\n\t\t\treturn context.getElementsByClassName(match[1]);\n\t\t}\n\t};\n\n\t// release memory in IE\n\tdiv = null;\n})();\n\nfunction dirNodeCheck( dir, cur, doneName, checkSet, nodeCheck, isXML ) {\n\tfor ( var i = 0, l = checkSet.length; i < l; i++ ) {\n\t\tvar elem = checkSet[i];\n\n\t\tif ( elem ) {\n\t\t\tvar match = false;\n\n\t\t\telem = elem[dir];\n\n\t\t\twhile ( elem ) {\n\t\t\t\tif ( elem[ expando ] === doneName ) {\n\t\t\t\t\tmatch = checkSet[elem.sizset];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif ( elem.nodeType === 1 && !isXML ){\n\t\t\t\t\telem[ expando ] = doneName;\n\t\t\t\t\telem.sizset = i;\n\t\t\t\t}\n\n\t\t\t\tif ( elem.nodeName.toLowerCase() === cur ) {\n\t\t\t\t\tmatch = elem;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\telem = elem[dir];\n\t\t\t}\n\n\t\t\tcheckSet[i] = match;\n\t\t}\n\t}\n}\n\nfunction dirCheck( dir, cur, doneName, checkSet, nodeCheck, isXML ) {\n\tfor ( var i = 0, l = checkSet.length; i < l; i++ ) {\n\t\tvar elem = checkSet[i];\n\n\t\tif ( elem ) {\n\t\t\tvar match = false;\n\n\t\t\telem = elem[dir];\n\n\t\t\twhile ( elem ) {\n\t\t\t\tif ( elem[ expando ] === doneName ) {\n\t\t\t\t\tmatch = checkSet[elem.sizset];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\tif ( !isXML ) {\n\t\t\t\t\t\telem[ expando ] = doneName;\n\t\t\t\t\t\telem.sizset = i;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( typeof cur !== \"string\" ) {\n\t\t\t\t\t\tif ( elem === cur ) {\n\t\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( Sizzle.filter( cur, [elem] ).length > 0 ) {\n\t\t\t\t\t\tmatch = elem;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\telem = elem[dir];\n\t\t\t}\n\n\t\t\tcheckSet[i] = match;\n\t\t}\n\t}\n}\n\nif ( document.documentElement.contains ) {\n\tSizzle.contains = function( a, b ) {\n\t\treturn a !== b && (a.contains ? a.contains(b) : true);\n\t};\n\n} else if ( document.documentElement.compareDocumentPosition ) {\n\tSizzle.contains = function( a, b ) {\n\t\treturn !!(a.compareDocumentPosition(b) & 16);\n\t};\n\n} else {\n\tSizzle.contains = function() {\n\t\treturn false;\n\t};\n}\n\nSizzle.isXML = function( elem ) {\n\t// documentElement is verified for cases where it doesn't yet exist\n\t// (such as loading iframes in IE - #4833)\n\tvar documentElement = (elem ? elem.ownerDocument || elem : 0).documentElement;\n\n\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n};\n\nvar posProcess = function( selector, context, seed ) {\n\tvar match,\n\t\ttmpSet = [],\n\t\tlater = \"\",\n\t\troot = context.nodeType ? [context] : context;\n\n\t// Position selectors must be done after the filter\n\t// And so must :not(positional) so we move all PSEUDOs to the end\n\twhile ( (match = Expr.match.PSEUDO.exec( selector )) ) {\n\t\tlater += match[0];\n\t\tselector = selector.replace( Expr.match.PSEUDO, \"\" );\n\t}\n\n\tselector = Expr.relative[selector] ? selector + \"*\" : selector;\n\n\tfor ( var i = 0, l = root.length; i < l; i++ ) {\n\t\tSizzle( selector, root[i], tmpSet, seed );\n\t}\n\n\treturn Sizzle.filter( later, tmpSet );\n};\n\n// EXPOSE\n// Override sizzle attribute retrieval\nSizzle.attr = jQuery.attr;\nSizzle.selectors.attrMap = {};\njQuery.find = Sizzle;\njQuery.expr = Sizzle.selectors;\njQuery.expr[\":\"] = jQuery.expr.filters;\njQuery.unique = Sizzle.uniqueSort;\njQuery.text = Sizzle.getText;\njQuery.isXMLDoc = Sizzle.isXML;\njQuery.contains = Sizzle.contains;\n\n\n})();\n\n\nvar runtil = /Until$/,\n\trparentsprev = /^(?:parents|prevUntil|prevAll)/,\n\t// Note: This RegExp should be improved, or likely pulled from Sizzle\n\trmultiselector = /,/,\n\tisSimple = /^.[^:#\\[\\.,]*$/,\n\tslice = Array.prototype.slice,\n\tPOS = jQuery.expr.match.globalPOS,\n\t// methods guaranteed to produce a unique set when starting from a unique set\n\tguaranteedUnique = {\n\t\tchildren: true,\n\t\tcontents: true,\n\t\tnext: true,\n\t\tprev: true\n\t};\n\njQuery.fn.extend({\n\tfind: function( selector ) {\n\t\tvar self = this,\n\t\t\ti, l;\n\n\t\tif ( typeof selector !== \"string\" ) {\n\t\t\treturn jQuery( selector ).filter(function() {\n\t\t\t\tfor ( i = 0, l = self.length; i < l; i++ ) {\n\t\t\t\t\tif ( jQuery.contains( self[ i ], this ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar ret = this.pushStack( \"\", \"find\", selector ),\n\t\t\tlength, n, r;\n\n\t\tfor ( i = 0, l = this.length; i < l; i++ ) {\n\t\t\tlength = ret.length;\n\t\t\tjQuery.find( selector, this[i], ret );\n\n\t\t\tif ( i > 0 ) {\n\t\t\t\t// Make sure that the results are unique\n\t\t\t\tfor ( n = length; n < ret.length; n++ ) {\n\t\t\t\t\tfor ( r = 0; r < length; r++ ) {\n\t\t\t\t\t\tif ( ret[r] === ret[n] ) {\n\t\t\t\t\t\t\tret.splice(n--, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\thas: function( target ) {\n\t\tvar targets = jQuery( target );\n\t\treturn this.filter(function() {\n\t\t\tfor ( var i = 0, l = targets.length; i < l; i++ ) {\n\t\t\t\tif ( jQuery.contains( this, targets[i] ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\tnot: function( selector ) {\n\t\treturn this.pushStack( winnow(this, selector, false), \"not\", selector);\n\t},\n\n\tfilter: function( selector ) {\n\t\treturn this.pushStack( winnow(this, selector, true), \"filter\", selector );\n\t},\n\n\tis: function( selector ) {\n\t\treturn !!selector && (\n\t\t\ttypeof selector === \"string\" ?\n\t\t\t\t// If this is a positional selector, check membership in the returned set\n\t\t\t\t// so $(\"p:first\").is(\"p:last\") won't return true for a doc with two \"p\".\n\t\t\t\tPOS.test( selector ) ?\n\t\t\t\t\tjQuery( selector, this.context ).index( this[0] ) >= 0 :\n\t\t\t\t\tjQuery.filter( selector, this ).length > 0 :\n\t\t\t\tthis.filter( selector ).length > 0 );\n\t},\n\n\tclosest: function( selectors, context ) {\n\t\tvar ret = [], i, l, cur = this[0];\n\n\t\t// Array (deprecated as of jQuery 1.7)\n\t\tif ( jQuery.isArray( selectors ) ) {\n\t\t\tvar level = 1;\n\n\t\t\twhile ( cur && cur.ownerDocument && cur !== context ) {\n\t\t\t\tfor ( i = 0; i < selectors.length; i++ ) {\n\n\t\t\t\t\tif ( jQuery( cur ).is( selectors[ i ] ) ) {\n\t\t\t\t\t\tret.push({ selector: selectors[ i ], elem: cur, level: level });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcur = cur.parentNode;\n\t\t\t\tlevel++;\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}\n\n\t\t// String\n\t\tvar pos = POS.test( selectors ) || typeof selectors !== \"string\" ?\n\t\t\t\tjQuery( selectors, context || this.context ) :\n\t\t\t\t0;\n\n\t\tfor ( i = 0, l = this.length; i < l; i++ ) {\n\t\t\tcur = this[i];\n\n\t\t\twhile ( cur ) {\n\t\t\t\tif ( pos ? pos.index(cur) > -1 : jQuery.find.matchesSelector(cur, selectors) ) {\n\t\t\t\t\tret.push( cur );\n\t\t\t\t\tbreak;\n\n\t\t\t\t} else {\n\t\t\t\t\tcur = cur.parentNode;\n\t\t\t\t\tif ( !cur || !cur.ownerDocument || cur === context || cur.nodeType === 11 ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tret = ret.length > 1 ? jQuery.unique( ret ) : ret;\n\n\t\treturn this.pushStack( ret, \"closest\", selectors );\n\t},\n\n\t// Determine the position of an element within\n\t// the matched set of elements\n\tindex: function( elem ) {\n\n\t\t// No argument, return index in parent\n\t\tif ( !elem ) {\n\t\t\treturn ( this[0] && this[0].parentNode ) ? this.prevAll().length : -1;\n\t\t}\n\n\t\t// index in selector\n\t\tif ( typeof elem === \"string\" ) {\n\t\t\treturn jQuery.inArray( this[0], jQuery( elem ) );\n\t\t}\n\n\t\t// Locate the position of the desired element\n\t\treturn jQuery.inArray(\n\t\t\t// If it receives a jQuery object, the first element is used\n\t\t\telem.jquery ? elem[0] : elem, this );\n\t},\n\n\tadd: function( selector, context ) {\n\t\tvar set = typeof selector === \"string\" ?\n\t\t\t\tjQuery( selector, context ) :\n\t\t\t\tjQuery.makeArray( selector && selector.nodeType ? [ selector ] : selector ),\n\t\t\tall = jQuery.merge( this.get(), set );\n\n\t\treturn this.pushStack( isDisconnected( set[0] ) || isDisconnected( all[0] ) ?\n\t\t\tall :\n\t\t\tjQuery.unique( all ) );\n\t},\n\n\tandSelf: function() {\n\t\treturn this.add( this.prevObject );\n\t}\n});\n\n// A painfully simple check to see if an element is disconnected\n// from a document (should be improved, where feasible).\nfunction isDisconnected( node ) {\n\treturn !node || !node.parentNode || node.parentNode.nodeType === 11;\n}\n\njQuery.each({\n\tparent: function( elem ) {\n\t\tvar parent = elem.parentNode;\n\t\treturn parent && parent.nodeType !== 11 ? parent : null;\n\t},\n\tparents: function( elem ) {\n\t\treturn jQuery.dir( elem, \"parentNode\" );\n\t},\n\tparentsUntil: function( elem, i, until ) {\n\t\treturn jQuery.dir( elem, \"parentNode\", until );\n\t},\n\tnext: function( elem ) {\n\t\treturn jQuery.nth( elem, 2, \"nextSibling\" );\n\t},\n\tprev: function( elem ) {\n\t\treturn jQuery.nth( elem, 2, \"previousSibling\" );\n\t},\n\tnextAll: function( elem ) {\n\t\treturn jQuery.dir( elem, \"nextSibling\" );\n\t},\n\tprevAll: function( elem ) {\n\t\treturn jQuery.dir( elem, \"previousSibling\" );\n\t},\n\tnextUntil: function( elem, i, until ) {\n\t\treturn jQuery.dir( elem, \"nextSibling\", until );\n\t},\n\tprevUntil: function( elem, i, until ) {\n\t\treturn jQuery.dir( elem, \"previousSibling\", until );\n\t},\n\tsiblings: function( elem ) {\n\t\treturn jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );\n\t},\n\tchildren: function( elem ) {\n\t\treturn jQuery.sibling( elem.firstChild );\n\t},\n\tcontents: function( elem ) {\n\t\treturn jQuery.nodeName( elem, \"iframe\" ) ?\n\t\t\telem.contentDocument || elem.contentWindow.document :\n\t\t\tjQuery.makeArray( elem.childNodes );\n\t}\n}, function( name, fn ) {\n\tjQuery.fn[ name ] = function( until, selector ) {\n\t\tvar ret = jQuery.map( this, fn, until );\n\n\t\tif ( !runtil.test( name ) ) {\n\t\t\tselector = until;\n\t\t}\n\n\t\tif ( selector && typeof selector === \"string\" ) {\n\t\t\tret = jQuery.filter( selector, ret );\n\t\t}\n\n\t\tret = this.length > 1 && !guaranteedUnique[ name ] ? jQuery.unique( ret ) : ret;\n\n\t\tif ( (this.length > 1 || rmultiselector.test( selector )) && rparentsprev.test( name ) ) {\n\t\t\tret = ret.reverse();\n\t\t}\n\n\t\treturn this.pushStack( ret, name, slice.call( arguments ).join(\",\") );\n\t};\n});\n\njQuery.extend({\n\tfilter: function( expr, elems, not ) {\n\t\tif ( not ) {\n\t\t\texpr = \":not(\" + expr + \")\";\n\t\t}\n\n\t\treturn elems.length === 1 ?\n\t\t\tjQuery.find.matchesSelector(elems[0], expr) ? [ elems[0] ] : [] :\n\t\t\tjQuery.find.matches(expr, elems);\n\t},\n\n\tdir: function( elem, dir, until ) {\n\t\tvar matched = [],\n\t\t\tcur = elem[ dir ];\n\n\t\twhile ( cur && cur.nodeType !== 9 && (until === undefined || cur.nodeType !== 1 || !jQuery( cur ).is( until )) ) {\n\t\t\tif ( cur.nodeType === 1 ) {\n\t\t\t\tmatched.push( cur );\n\t\t\t}\n\t\t\tcur = cur[dir];\n\t\t}\n\t\treturn matched;\n\t},\n\n\tnth: function( cur, result, dir, elem ) {\n\t\tresult = result || 1;\n\t\tvar num = 0;\n\n\t\tfor ( ; cur; cur = cur[dir] ) {\n\t\t\tif ( cur.nodeType === 1 && ++num === result ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn cur;\n\t},\n\n\tsibling: function( n, elem ) {\n\t\tvar r = [];\n\n\t\tfor ( ; n; n = n.nextSibling ) {\n\t\t\tif ( n.nodeType === 1 && n !== elem ) {\n\t\t\t\tr.push( n );\n\t\t\t}\n\t\t}\n\n\t\treturn r;\n\t}\n});\n\n// Implement the identical functionality for filter and not\nfunction winnow( elements, qualifier, keep ) {\n\n\t// Can't pass null or undefined to indexOf in Firefox 4\n\t// Set to 0 to skip string check\n\tqualifier = qualifier || 0;\n\n\tif ( jQuery.isFunction( qualifier ) ) {\n\t\treturn jQuery.grep(elements, function( elem, i ) {\n\t\t\tvar retVal = !!qualifier.call( elem, i, elem );\n\t\t\treturn retVal === keep;\n\t\t});\n\n\t} else if ( qualifier.nodeType ) {\n\t\treturn jQuery.grep(elements, function( elem, i ) {\n\t\t\treturn ( elem === qualifier ) === keep;\n\t\t});\n\n\t} else if ( typeof qualifier === \"string\" ) {\n\t\tvar filtered = jQuery.grep(elements, function( elem ) {\n\t\t\treturn elem.nodeType === 1;\n\t\t});\n\n\t\tif ( isSimple.test( qualifier ) ) {\n\t\t\treturn jQuery.filter(qualifier, filtered, !keep);\n\t\t} else {\n\t\t\tqualifier = jQuery.filter( qualifier, filtered );\n\t\t}\n\t}\n\n\treturn jQuery.grep(elements, function( elem, i ) {\n\t\treturn ( jQuery.inArray( elem, qualifier ) >= 0 ) === keep;\n\t});\n}\n\n\n\n\nfunction createSafeFragment( document ) {\n\tvar list = nodeNames.split( \"|\" ),\n\tsafeFrag = document.createDocumentFragment();\n\n\tif ( safeFrag.createElement ) {\n\t\twhile ( list.length ) {\n\t\t\tsafeFrag.createElement(\n\t\t\t\tlist.pop()\n\t\t\t);\n\t\t}\n\t}\n\treturn safeFrag;\n}\n\nvar nodeNames = \"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|\" +\n\t\t\"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",\n\trinlinejQuery = / jQuery\\d+=\"(?:\\d+|null)\"/g,\n\trleadingWhitespace = /^\\s+/,\n\trxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/ig,\n\trtagName = /<([\\w:]+)/,\n\trtbody = /<tbody/i,\n\trhtml = /<|&#?\\w+;/,\n\trnoInnerhtml = /<(?:script|style)/i,\n\trnocache = /<(?:script|object|embed|option|style)/i,\n\trnoshimcache = new RegExp(\"<(?:\" + nodeNames + \")[\\\\s/>]\", \"i\"),\n\t// checked=\"checked\" or checked\n\trchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\n\trscriptType = /\\/(java|ecma)script/i,\n\trcleanScript = /^\\s*<!(?:\\[CDATA\\[|\\-\\-)/,\n\twrapMap = {\n\t\toption: [ 1, \"<select multiple='multiple'>\", \"</select>\" ],\n\t\tlegend: [ 1, \"<fieldset>\", \"</fieldset>\" ],\n\t\tthead: [ 1, \"<table>\", \"</table>\" ],\n\t\ttr: [ 2, \"<table><tbody>\", \"</tbody></table>\" ],\n\t\ttd: [ 3, \"<table><tbody><tr>\", \"</tr></tbody></table>\" ],\n\t\tcol: [ 2, \"<table><tbody></tbody><colgroup>\", \"</colgroup></table>\" ],\n\t\tarea: [ 1, \"<map>\", \"</map>\" ],\n\t\t_default: [ 0, \"\", \"\" ]\n\t},\n\tsafeFragment = createSafeFragment( document );\n\nwrapMap.optgroup = wrapMap.option;\nwrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\nwrapMap.th = wrapMap.td;\n\n// IE can't serialize <link> and <script> tags normally\nif ( !jQuery.support.htmlSerialize ) {\n\twrapMap._default = [ 1, \"div<div>\", \"</div>\" ];\n}\n\njQuery.fn.extend({\n\ttext: function( value ) {\n\t\treturn jQuery.access( this, function( value ) {\n\t\t\treturn value === undefined ?\n\t\t\t\tjQuery.text( this ) :\n\t\t\t\tthis.empty().append( ( this[0] && this[0].ownerDocument || document ).createTextNode( value ) );\n\t\t}, null, value, arguments.length );\n\t},\n\n\twrapAll: function( html ) {\n\t\tif ( jQuery.isFunction( html ) ) {\n\t\t\treturn this.each(function(i) {\n\t\t\t\tjQuery(this).wrapAll( html.call(this, i) );\n\t\t\t});\n\t\t}\n\n\t\tif ( this[0] ) {\n\t\t\t// The elements to wrap the target around\n\t\t\tvar wrap = jQuery( html, this[0].ownerDocument ).eq(0).clone(true);\n\n\t\t\tif ( this[0].parentNode ) {\n\t\t\t\twrap.insertBefore( this[0] );\n\t\t\t}\n\n\t\t\twrap.map(function() {\n\t\t\t\tvar elem = this;\n\n\t\t\t\twhile ( elem.firstChild && elem.firstChild.nodeType === 1 ) {\n\t\t\t\t\telem = elem.firstChild;\n\t\t\t\t}\n\n\t\t\t\treturn elem;\n\t\t\t}).append( this );\n\t\t}\n\n\t\treturn this;\n\t},\n\n\twrapInner: function( html ) {\n\t\tif ( jQuery.isFunction( html ) ) {\n\t\t\treturn this.each(function(i) {\n\t\t\t\tjQuery(this).wrapInner( html.call(this, i) );\n\t\t\t});\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tvar self = jQuery( this ),\n\t\t\t\tcontents = self.contents();\n\n\t\t\tif ( contents.length ) {\n\t\t\t\tcontents.wrapAll( html );\n\n\t\t\t} else {\n\t\t\t\tself.append( html );\n\t\t\t}\n\t\t});\n\t},\n\n\twrap: function( html ) {\n\t\tvar isFunction = jQuery.isFunction( html );\n\n\t\treturn this.each(function(i) {\n\t\t\tjQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );\n\t\t});\n\t},\n\n\tunwrap: function() {\n\t\treturn this.parent().each(function() {\n\t\t\tif ( !jQuery.nodeName( this, \"body\" ) ) {\n\t\t\t\tjQuery( this ).replaceWith( this.childNodes );\n\t\t\t}\n\t\t}).end();\n\t},\n\n\tappend: function() {\n\t\treturn this.domManip(arguments, true, function( elem ) {\n\t\t\tif ( this.nodeType === 1 ) {\n\t\t\t\tthis.appendChild( elem );\n\t\t\t}\n\t\t});\n\t},\n\n\tprepend: function() {\n\t\treturn this.domManip(arguments, true, function( elem ) {\n\t\t\tif ( this.nodeType === 1 ) {\n\t\t\t\tthis.insertBefore( elem, this.firstChild );\n\t\t\t}\n\t\t});\n\t},\n\n\tbefore: function() {\n\t\tif ( this[0] && this[0].parentNode ) {\n\t\t\treturn this.domManip(arguments, false, function( elem ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this );\n\t\t\t});\n\t\t} else if ( arguments.length ) {\n\t\t\tvar set = jQuery.clean( arguments );\n\t\t\tset.push.apply( set, this.toArray() );\n\t\t\treturn this.pushStack( set, \"before\", arguments );\n\t\t}\n\t},\n\n\tafter: function() {\n\t\tif ( this[0] && this[0].parentNode ) {\n\t\t\treturn this.domManip(arguments, false, function( elem ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this.nextSibling );\n\t\t\t});\n\t\t} else if ( arguments.length ) {\n\t\t\tvar set = this.pushStack( this, \"after\", arguments );\n\t\t\tset.push.apply( set, jQuery.clean(arguments) );\n\t\t\treturn set;\n\t\t}\n\t},\n\n\t// keepData is for internal use only--do not document\n\tremove: function( selector, keepData ) {\n\t\tfor ( var i = 0, elem; (elem = this[i]) != null; i++ ) {\n\t\t\tif ( !selector || jQuery.filter( selector, [ elem ] ).length ) {\n\t\t\t\tif ( !keepData && elem.nodeType === 1 ) {\n\t\t\t\t\tjQuery.cleanData( elem.getElementsByTagName(\"*\") );\n\t\t\t\t\tjQuery.cleanData( [ elem ] );\n\t\t\t\t}\n\n\t\t\t\tif ( elem.parentNode ) {\n\t\t\t\t\telem.parentNode.removeChild( elem );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tempty: function() {\n\t\tfor ( var i = 0, elem; (elem = this[i]) != null; i++ ) {\n\t\t\t// Remove element nodes and prevent memory leaks\n\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\tjQuery.cleanData( elem.getElementsByTagName(\"*\") );\n\t\t\t}\n\n\t\t\t// Remove any remaining nodes\n\t\t\twhile ( elem.firstChild ) {\n\t\t\t\telem.removeChild( elem.firstChild );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclone: function( dataAndEvents, deepDataAndEvents ) {\n\t\tdataAndEvents = dataAndEvents == null ? false : dataAndEvents;\n\t\tdeepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\n\n\t\treturn this.map( function () {\n\t\t\treturn jQuery.clone( this, dataAndEvents, deepDataAndEvents );\n\t\t});\n\t},\n\n\thtml: function( value ) {\n\t\treturn jQuery.access( this, function( value ) {\n\t\t\tvar elem = this[0] || {},\n\t\t\t\ti = 0,\n\t\t\t\tl = this.length;\n\n\t\t\tif ( value === undefined ) {\n\t\t\t\treturn elem.nodeType === 1 ?\n\t\t\t\t\telem.innerHTML.replace( rinlinejQuery, \"\" ) :\n\t\t\t\t\tnull;\n\t\t\t}\n\n\n\t\t\tif ( typeof value === \"string\" && !rnoInnerhtml.test( value ) &&\n\t\t\t\t( jQuery.support.leadingWhitespace || !rleadingWhitespace.test( value ) ) &&\n\t\t\t\t!wrapMap[ ( rtagName.exec( value ) || [\"\", \"\"] )[1].toLowerCase() ] ) {\n\n\t\t\t\tvalue = value.replace( rxhtmlTag, \"<$1></$2>\" );\n\n\t\t\t\ttry {\n\t\t\t\t\tfor (; i < l; i++ ) {\n\t\t\t\t\t\t// Remove element nodes and prevent memory leaks\n\t\t\t\t\t\telem = this[i] || {};\n\t\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\t\tjQuery.cleanData( elem.getElementsByTagName( \"*\" ) );\n\t\t\t\t\t\t\telem.innerHTML = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\telem = 0;\n\n\t\t\t\t// If using innerHTML throws an exception, use the fallback method\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\n\t\t\tif ( elem ) {\n\t\t\t\tthis.empty().append( value );\n\t\t\t}\n\t\t}, null, value, arguments.length );\n\t},\n\n\treplaceWith: function( value ) {\n\t\tif ( this[0] && this[0].parentNode ) {\n\t\t\t// Make sure that the elements are removed from the DOM before they are inserted\n\t\t\t// this can help fix replacing a parent with child elements\n\t\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\t\treturn this.each(function(i) {\n\t\t\t\t\tvar self = jQuery(this), old = self.html();\n\t\t\t\t\tself.replaceWith( value.call( this, i, old ) );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif ( typeof value !== \"string\" ) {\n\t\t\t\tvalue = jQuery( value ).detach();\n\t\t\t}\n\n\t\t\treturn this.each(function() {\n\t\t\t\tvar next = this.nextSibling,\n\t\t\t\t\tparent = this.parentNode;\n\n\t\t\t\tjQuery( this ).remove();\n\n\t\t\t\tif ( next ) {\n\t\t\t\t\tjQuery(next).before( value );\n\t\t\t\t} else {\n\t\t\t\t\tjQuery(parent).append( value );\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn this.length ?\n\t\t\t\tthis.pushStack( jQuery(jQuery.isFunction(value) ? value() : value), \"replaceWith\", value ) :\n\t\t\t\tthis;\n\t\t}\n\t},\n\n\tdetach: function( selector ) {\n\t\treturn this.remove( selector, true );\n\t},\n\n\tdomManip: function( args, table, callback ) {\n\t\tvar results, first, fragment, parent,\n\t\t\tvalue = args[0],\n\t\t\tscripts = [];\n\n\t\t// We can't cloneNode fragments that contain checked, in WebKit\n\t\tif ( !jQuery.support.checkClone && arguments.length === 3 && typeof value === \"string\" && rchecked.test( value ) ) {\n\t\t\treturn this.each(function() {\n\t\t\t\tjQuery(this).domManip( args, table, callback, true );\n\t\t\t});\n\t\t}\n\n\t\tif ( jQuery.isFunction(value) ) {\n\t\t\treturn this.each(function(i) {\n\t\t\t\tvar self = jQuery(this);\n\t\t\t\targs[0] = value.call(this, i, table ? self.html() : undefined);\n\t\t\t\tself.domManip( args, table, callback );\n\t\t\t});\n\t\t}\n\n\t\tif ( this[0] ) {\n\t\t\tparent = value && value.parentNode;\n\n\t\t\t// If we're in a fragment, just use that instead of building a new one\n\t\t\tif ( jQuery.support.parentNode && parent && parent.nodeType === 11 && parent.childNodes.length === this.length ) {\n\t\t\t\tresults = { fragment: parent };\n\n\t\t\t} else {\n\t\t\t\tresults = jQuery.buildFragment( args, this, scripts );\n\t\t\t}\n\n\t\t\tfragment = results.fragment;\n\n\t\t\tif ( fragment.childNodes.length === 1 ) {\n\t\t\t\tfirst = fragment = fragment.firstChild;\n\t\t\t} else {\n\t\t\t\tfirst = fragment.firstChild;\n\t\t\t}\n\n\t\t\tif ( first ) {\n\t\t\t\ttable = table && jQuery.nodeName( first, \"tr\" );\n\n\t\t\t\tfor ( var i = 0, l = this.length, lastIndex = l - 1; i < l; i++ ) {\n\t\t\t\t\tcallback.call(\n\t\t\t\t\t\ttable ?\n\t\t\t\t\t\t\troot(this[i], first) :\n\t\t\t\t\t\t\tthis[i],\n\t\t\t\t\t\t// Make sure that we do not leak memory by inadvertently discarding\n\t\t\t\t\t\t// the original fragment (which might have attached data) instead of\n\t\t\t\t\t\t// using it; in addition, use the original fragment object for the last\n\t\t\t\t\t\t// item instead of first because it can end up being emptied incorrectly\n\t\t\t\t\t\t// in certain situations (Bug #8070).\n\t\t\t\t\t\t// Fragments from the fragment cache must always be cloned and never used\n\t\t\t\t\t\t// in place.\n\t\t\t\t\t\tresults.cacheable || ( l > 1 && i < lastIndex ) ?\n\t\t\t\t\t\t\tjQuery.clone( fragment, true, true ) :\n\t\t\t\t\t\t\tfragment\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( scripts.length ) {\n\t\t\t\tjQuery.each( scripts, function( i, elem ) {\n\t\t\t\t\tif ( elem.src ) {\n\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\ttype: \"GET\",\n\t\t\t\t\t\t\tglobal: false,\n\t\t\t\t\t\t\turl: elem.src,\n\t\t\t\t\t\t\tasync: false,\n\t\t\t\t\t\t\tdataType: \"script\"\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tjQuery.globalEval( ( elem.text || elem.textContent || elem.innerHTML || \"\" ).replace( rcleanScript, \"/*$0*/\" ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( elem.parentNode ) {\n\t\t\t\t\t\telem.parentNode.removeChild( elem );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\nfunction root( elem, cur ) {\n\treturn jQuery.nodeName(elem, \"table\") ?\n\t\t(elem.getElementsByTagName(\"tbody\")[0] ||\n\t\telem.appendChild(elem.ownerDocument.createElement(\"tbody\"))) :\n\t\telem;\n}\n\nfunction cloneCopyEvent( src, dest ) {\n\n\tif ( dest.nodeType !== 1 || !jQuery.hasData( src ) ) {\n\t\treturn;\n\t}\n\n\tvar type, i, l,\n\t\toldData = jQuery._data( src ),\n\t\tcurData = jQuery._data( dest, oldData ),\n\t\tevents = oldData.events;\n\n\tif ( events ) {\n\t\tdelete curData.handle;\n\t\tcurData.events = {};\n\n\t\tfor ( type in events ) {\n\t\t\tfor ( i = 0, l = events[ type ].length; i < l; i++ ) {\n\t\t\t\tjQuery.event.add( dest, type, events[ type ][ i ] );\n\t\t\t}\n\t\t}\n\t}\n\n\t// make the cloned public data object a copy from the original\n\tif ( curData.data ) {\n\t\tcurData.data = jQuery.extend( {}, curData.data );\n\t}\n}\n\nfunction cloneFixAttributes( src, dest ) {\n\tvar nodeName;\n\n\t// We do not need to do anything for non-Elements\n\tif ( dest.nodeType !== 1 ) {\n\t\treturn;\n\t}\n\n\t// clearAttributes removes the attributes, which we don't want,\n\t// but also removes the attachEvent events, which we *do* want\n\tif ( dest.clearAttributes ) {\n\t\tdest.clearAttributes();\n\t}\n\n\t// mergeAttributes, in contrast, only merges back on the\n\t// original attributes, not the events\n\tif ( dest.mergeAttributes ) {\n\t\tdest.mergeAttributes( src );\n\t}\n\n\tnodeName = dest.nodeName.toLowerCase();\n\n\t// IE6-8 fail to clone children inside object elements that use\n\t// the proprietary classid attribute value (rather than the type\n\t// attribute) to identify the type of content to display\n\tif ( nodeName === \"object\" ) {\n\t\tdest.outerHTML = src.outerHTML;\n\n\t} else if ( nodeName === \"input\" && (src.type === \"checkbox\" || src.type === \"radio\") ) {\n\t\t// IE6-8 fails to persist the checked state of a cloned checkbox\n\t\t// or radio button. Worse, IE6-7 fail to give the cloned element\n\t\t// a checked appearance if the defaultChecked value isn't also set\n\t\tif ( src.checked ) {\n\t\t\tdest.defaultChecked = dest.checked = src.checked;\n\t\t}\n\n\t\t// IE6-7 get confused and end up setting the value of a cloned\n\t\t// checkbox/radio button to an empty string instead of \"on\"\n\t\tif ( dest.value !== src.value ) {\n\t\t\tdest.value = src.value;\n\t\t}\n\n\t// IE6-8 fails to return the selected option to the default selected\n\t// state when cloning options\n\t} else if ( nodeName === \"option\" ) {\n\t\tdest.selected = src.defaultSelected;\n\n\t// IE6-8 fails to set the defaultValue to the correct value when\n\t// cloning other types of input fields\n\t} else if ( nodeName === \"input\" || nodeName === \"textarea\" ) {\n\t\tdest.defaultValue = src.defaultValue;\n\n\t// IE blanks contents when cloning scripts\n\t} else if ( nodeName === \"script\" && dest.text !== src.text ) {\n\t\tdest.text = src.text;\n\t}\n\n\t// Event data gets referenced instead of copied if the expando\n\t// gets copied too\n\tdest.removeAttribute( jQuery.expando );\n\n\t// Clear flags for bubbling special change/submit events, they must\n\t// be reattached when the newly cloned events are first activated\n\tdest.removeAttribute( \"_submit_attached\" );\n\tdest.removeAttribute( \"_change_attached\" );\n}\n\njQuery.buildFragment = function( args, nodes, scripts ) {\n\tvar fragment, cacheable, cacheresults, doc,\n\tfirst = args[ 0 ];\n\n\t// nodes may contain either an explicit document object,\n\t// a jQuery collection or context object.\n\t// If nodes[0] contains a valid object to assign to doc\n\tif ( nodes && nodes[0] ) {\n\t\tdoc = nodes[0].ownerDocument || nodes[0];\n\t}\n\n\t// Ensure that an attr object doesn't incorrectly stand in as a document object\n\t// Chrome and Firefox seem to allow this to occur and will throw exception\n\t// Fixes #8950\n\tif ( !doc.createDocumentFragment ) {\n\t\tdoc = document;\n\t}\n\n\t// Only cache \"small\" (1/2 KB) HTML strings that are associated with the main document\n\t// Cloning options loses the selected state, so don't cache them\n\t// IE 6 doesn't like it when you put <object> or <embed> elements in a fragment\n\t// Also, WebKit does not clone 'checked' attributes on cloneNode, so don't cache\n\t// Lastly, IE6,7,8 will not correctly reuse cached fragments that were created from unknown elems #10501\n\tif ( args.length === 1 && typeof first === \"string\" && first.length < 512 && doc === document &&\n\t\tfirst.charAt(0) === \"<\" && !rnocache.test( first ) &&\n\t\t(jQuery.support.checkClone || !rchecked.test( first )) &&\n\t\t(jQuery.support.html5Clone || !rnoshimcache.test( first )) ) {\n\n\t\tcacheable = true;\n\n\t\tcacheresults = jQuery.fragments[ first ];\n\t\tif ( cacheresults && cacheresults !== 1 ) {\n\t\t\tfragment = cacheresults;\n\t\t}\n\t}\n\n\tif ( !fragment ) {\n\t\tfragment = doc.createDocumentFragment();\n\t\tjQuery.clean( args, doc, fragment, scripts );\n\t}\n\n\tif ( cacheable ) {\n\t\tjQuery.fragments[ first ] = cacheresults ? fragment : 1;\n\t}\n\n\treturn { fragment: fragment, cacheable: cacheable };\n};\n\njQuery.fragments = {};\n\njQuery.each({\n\tappendTo: \"append\",\n\tprependTo: \"prepend\",\n\tinsertBefore: \"before\",\n\tinsertAfter: \"after\",\n\treplaceAll: \"replaceWith\"\n}, function( name, original ) {\n\tjQuery.fn[ name ] = function( selector ) {\n\t\tvar ret = [],\n\t\t\tinsert = jQuery( selector ),\n\t\t\tparent = this.length === 1 && this[0].parentNode;\n\n\t\tif ( parent && parent.nodeType === 11 && parent.childNodes.length === 1 && insert.length === 1 ) {\n\t\t\tinsert[ original ]( this[0] );\n\t\t\treturn this;\n\n\t\t} else {\n\t\t\tfor ( var i = 0, l = insert.length; i < l; i++ ) {\n\t\t\t\tvar elems = ( i > 0 ? this.clone(true) : this ).get();\n\t\t\t\tjQuery( insert[i] )[ original ]( elems );\n\t\t\t\tret = ret.concat( elems );\n\t\t\t}\n\n\t\t\treturn this.pushStack( ret, name, insert.selector );\n\t\t}\n\t};\n});\n\nfunction getAll( elem ) {\n\tif ( typeof elem.getElementsByTagName !== \"undefined\" ) {\n\t\treturn elem.getElementsByTagName( \"*\" );\n\n\t} else if ( typeof elem.querySelectorAll !== \"undefined\" ) {\n\t\treturn elem.querySelectorAll( \"*\" );\n\n\t} else {\n\t\treturn [];\n\t}\n}\n\n// Used in clean, fixes the defaultChecked property\nfunction fixDefaultChecked( elem ) {\n\tif ( elem.type === \"checkbox\" || elem.type === \"radio\" ) {\n\t\telem.defaultChecked = elem.checked;\n\t}\n}\n// Finds all inputs and passes them to fixDefaultChecked\nfunction findInputs( elem ) {\n\tvar nodeName = ( elem.nodeName || \"\" ).toLowerCase();\n\tif ( nodeName === \"input\" ) {\n\t\tfixDefaultChecked( elem );\n\t// Skip scripts, get other children\n\t} else if ( nodeName !== \"script\" && typeof elem.getElementsByTagName !== \"undefined\" ) {\n\t\tjQuery.grep( elem.getElementsByTagName(\"input\"), fixDefaultChecked );\n\t}\n}\n\n// Derived From: http://www.iecss.com/shimprove/javascript/shimprove.1-0-1.js\nfunction shimCloneNode( elem ) {\n\tvar div = document.createElement( \"div\" );\n\tsafeFragment.appendChild( div );\n\n\tdiv.innerHTML = elem.outerHTML;\n\treturn div.firstChild;\n}\n\njQuery.extend({\n\tclone: function( elem, dataAndEvents, deepDataAndEvents ) {\n\t\tvar srcElements,\n\t\t\tdestElements,\n\t\t\ti,\n\t\t\t// IE<=8 does not properly clone detached, unknown element nodes\n\t\t\tclone = jQuery.support.html5Clone || jQuery.isXMLDoc(elem) || !rnoshimcache.test( \"<\" + elem.nodeName + \">\" ) ?\n\t\t\t\telem.cloneNode( true ) :\n\t\t\t\tshimCloneNode( elem );\n\n\t\tif ( (!jQuery.support.noCloneEvent || !jQuery.support.noCloneChecked) &&\n\t\t\t\t(elem.nodeType === 1 || elem.nodeType === 11) && !jQuery.isXMLDoc(elem) ) {\n\t\t\t// IE copies events bound via attachEvent when using cloneNode.\n\t\t\t// Calling detachEvent on the clone will also remove the events\n\t\t\t// from the original. In order to get around this, we use some\n\t\t\t// proprietary methods to clear the events. Thanks to MooTools\n\t\t\t// guys for this hotness.\n\n\t\t\tcloneFixAttributes( elem, clone );\n\n\t\t\t// Using Sizzle here is crazy slow, so we use getElementsByTagName instead\n\t\t\tsrcElements = getAll( elem );\n\t\t\tdestElements = getAll( clone );\n\n\t\t\t// Weird iteration because IE will replace the length property\n\t\t\t// with an element if you are cloning the body and one of the\n\t\t\t// elements on the page has a name or id of \"length\"\n\t\t\tfor ( i = 0; srcElements[i]; ++i ) {\n\t\t\t\t// Ensure that the destination node is not null; Fixes #9587\n\t\t\t\tif ( destElements[i] ) {\n\t\t\t\t\tcloneFixAttributes( srcElements[i], destElements[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Copy the events from the original to the clone\n\t\tif ( dataAndEvents ) {\n\t\t\tcloneCopyEvent( elem, clone );\n\n\t\t\tif ( deepDataAndEvents ) {\n\t\t\t\tsrcElements = getAll( elem );\n\t\t\t\tdestElements = getAll( clone );\n\n\t\t\t\tfor ( i = 0; srcElements[i]; ++i ) {\n\t\t\t\t\tcloneCopyEvent( srcElements[i], destElements[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsrcElements = destElements = null;\n\n\t\t// Return the cloned set\n\t\treturn clone;\n\t},\n\n\tclean: function( elems, context, fragment, scripts ) {\n\t\tvar checkScriptType, script, j,\n\t\t\t\tret = [];\n\n\t\tcontext = context || document;\n\n\t\t// !context.createElement fails in IE with an error but returns typeof 'object'\n\t\tif ( typeof context.createElement === \"undefined\" ) {\n\t\t\tcontext = context.ownerDocument || context[0] && context[0].ownerDocument || document;\n\t\t}\n\n\t\tfor ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {\n\t\t\tif ( typeof elem === \"number\" ) {\n\t\t\t\telem += \"\";\n\t\t\t}\n\n\t\t\tif ( !elem ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Convert html string into DOM nodes\n\t\t\tif ( typeof elem === \"string\" ) {\n\t\t\t\tif ( !rhtml.test( elem ) ) {\n\t\t\t\t\telem = context.createTextNode( elem );\n\t\t\t\t} else {\n\t\t\t\t\t// Fix \"XHTML\"-style tags in all browsers\n\t\t\t\t\telem = elem.replace(rxhtmlTag, \"<$1></$2>\");\n\n\t\t\t\t\t// Trim whitespace, otherwise indexOf won't work as expected\n\t\t\t\t\tvar tag = ( rtagName.exec( elem ) || [\"\", \"\"] )[1].toLowerCase(),\n\t\t\t\t\t\twrap = wrapMap[ tag ] || wrapMap._default,\n\t\t\t\t\t\tdepth = wrap[0],\n\t\t\t\t\t\tdiv = context.createElement(\"div\"),\n\t\t\t\t\t\tsafeChildNodes = safeFragment.childNodes,\n\t\t\t\t\t\tremove;\n\n\t\t\t\t\t// Append wrapper element to unknown element safe doc fragment\n\t\t\t\t\tif ( context === document ) {\n\t\t\t\t\t\t// Use the fragment we've already created for this document\n\t\t\t\t\t\tsafeFragment.appendChild( div );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Use a fragment created with the owner document\n\t\t\t\t\t\tcreateSafeFragment( context ).appendChild( div );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Go to html and back, then peel off extra wrappers\n\t\t\t\t\tdiv.innerHTML = wrap[1] + elem + wrap[2];\n\n\t\t\t\t\t// Move to the right depth\n\t\t\t\t\twhile ( depth-- ) {\n\t\t\t\t\t\tdiv = div.lastChild;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove IE's autoinserted <tbody> from table fragments\n\t\t\t\t\tif ( !jQuery.support.tbody ) {\n\n\t\t\t\t\t\t// String was a <table>, *may* have spurious <tbody>\n\t\t\t\t\t\tvar hasBody = rtbody.test(elem),\n\t\t\t\t\t\t\ttbody = tag === \"table\" && !hasBody ?\n\t\t\t\t\t\t\t\tdiv.firstChild && div.firstChild.childNodes :\n\n\t\t\t\t\t\t\t\t// String was a bare <thead> or <tfoot>\n\t\t\t\t\t\t\t\twrap[1] === \"<table>\" && !hasBody ?\n\t\t\t\t\t\t\t\t\tdiv.childNodes :\n\t\t\t\t\t\t\t\t\t[];\n\n\t\t\t\t\t\tfor ( j = tbody.length - 1; j >= 0 ; --j ) {\n\t\t\t\t\t\t\tif ( jQuery.nodeName( tbody[ j ], \"tbody\" ) && !tbody[ j ].childNodes.length ) {\n\t\t\t\t\t\t\t\ttbody[ j ].parentNode.removeChild( tbody[ j ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// IE completely kills leading whitespace when innerHTML is used\n\t\t\t\t\tif ( !jQuery.support.leadingWhitespace && rleadingWhitespace.test( elem ) ) {\n\t\t\t\t\t\tdiv.insertBefore( context.createTextNode( rleadingWhitespace.exec(elem)[0] ), div.firstChild );\n\t\t\t\t\t}\n\n\t\t\t\t\telem = div.childNodes;\n\n\t\t\t\t\t// Clear elements from DocumentFragment (safeFragment or otherwise)\n\t\t\t\t\t// to avoid hoarding elements. Fixes #11356\n\t\t\t\t\tif ( div ) {\n\t\t\t\t\t\tdiv.parentNode.removeChild( div );\n\n\t\t\t\t\t\t// Guard against -1 index exceptions in FF3.6\n\t\t\t\t\t\tif ( safeChildNodes.length > 0 ) {\n\t\t\t\t\t\t\tremove = safeChildNodes[ safeChildNodes.length - 1 ];\n\n\t\t\t\t\t\t\tif ( remove && remove.parentNode ) {\n\t\t\t\t\t\t\t\tremove.parentNode.removeChild( remove );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Resets defaultChecked for any radios and checkboxes\n\t\t\t// about to be appended to the DOM in IE 6/7 (#8060)\n\t\t\tvar len;\n\t\t\tif ( !jQuery.support.appendChecked ) {\n\t\t\t\tif ( elem[0] && typeof (len = elem.length) === \"number\" ) {\n\t\t\t\t\tfor ( j = 0; j < len; j++ ) {\n\t\t\t\t\t\tfindInputs( elem[j] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfindInputs( elem );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( elem.nodeType ) {\n\t\t\t\tret.push( elem );\n\t\t\t} else {\n\t\t\t\tret = jQuery.merge( ret, elem );\n\t\t\t}\n\t\t}\n\n\t\tif ( fragment ) {\n\t\t\tcheckScriptType = function( elem ) {\n\t\t\t\treturn !elem.type || rscriptType.test( elem.type );\n\t\t\t};\n\t\t\tfor ( i = 0; ret[i]; i++ ) {\n\t\t\t\tscript = ret[i];\n\t\t\t\tif ( scripts && jQuery.nodeName( script, \"script\" ) && (!script.type || rscriptType.test( script.type )) ) {\n\t\t\t\t\tscripts.push( script.parentNode ? script.parentNode.removeChild( script ) : script );\n\n\t\t\t\t} else {\n\t\t\t\t\tif ( script.nodeType === 1 ) {\n\t\t\t\t\t\tvar jsTags = jQuery.grep( script.getElementsByTagName( \"script\" ), checkScriptType );\n\n\t\t\t\t\t\tret.splice.apply( ret, [i + 1, 0].concat( jsTags ) );\n\t\t\t\t\t}\n\t\t\t\t\tfragment.appendChild( script );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tcleanData: function( elems ) {\n\t\tvar data, id,\n\t\t\tcache = jQuery.cache,\n\t\t\tspecial = jQuery.event.special,\n\t\t\tdeleteExpando = jQuery.support.deleteExpando;\n\n\t\tfor ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {\n\t\t\tif ( elem.nodeName && jQuery.noData[elem.nodeName.toLowerCase()] ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tid = elem[ jQuery.expando ];\n\n\t\t\tif ( id ) {\n\t\t\t\tdata = cache[ id ];\n\n\t\t\t\tif ( data && data.events ) {\n\t\t\t\t\tfor ( var type in data.events ) {\n\t\t\t\t\t\tif ( special[ type ] ) {\n\t\t\t\t\t\t\tjQuery.event.remove( elem, type );\n\n\t\t\t\t\t\t// This is a shortcut to avoid jQuery.event.remove's overhead\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tjQuery.removeEvent( elem, type, data.handle );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Null the DOM reference to avoid IE6/7/8 leak (#7054)\n\t\t\t\t\tif ( data.handle ) {\n\t\t\t\t\t\tdata.handle.elem = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( deleteExpando ) {\n\t\t\t\t\tdelete elem[ jQuery.expando ];\n\n\t\t\t\t} else if ( elem.removeAttribute ) {\n\t\t\t\t\telem.removeAttribute( jQuery.expando );\n\t\t\t\t}\n\n\t\t\t\tdelete cache[ id ];\n\t\t\t}\n\t\t}\n\t}\n});\n\n\n\n\nvar ralpha = /alpha\\([^)]*\\)/i,\n\tropacity = /opacity=([^)]*)/,\n\t// fixed for IE9, see #8346\n\trupper = /([A-Z]|^ms)/g,\n\trnum = /^[\\-+]?(?:\\d*\\.)?\\d+$/i,\n\trnumnonpx = /^-?(?:\\d*\\.)?\\d+(?!px)[^\\d\\s]+$/i,\n\trrelNum = /^([\\-+])=([\\-+.\\de]+)/,\n\trmargin = /^margin/,\n\n\tcssShow = { position: \"absolute\", visibility: \"hidden\", display: \"block\" },\n\n\t// order is important!\n\tcssExpand = [ \"Top\", \"Right\", \"Bottom\", \"Left\" ],\n\n\tcurCSS,\n\n\tgetComputedStyle,\n\tcurrentStyle;\n\njQuery.fn.css = function( name, value ) {\n\treturn jQuery.access( this, function( elem, name, value ) {\n\t\treturn value !== undefined ?\n\t\t\tjQuery.style( elem, name, value ) :\n\t\t\tjQuery.css( elem, name );\n\t}, name, value, arguments.length > 1 );\n};\n\njQuery.extend({\n\t// Add in style property hooks for overriding the default\n\t// behavior of getting and setting a style property\n\tcssHooks: {\n\t\topacity: {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\tif ( computed ) {\n\t\t\t\t\t// We should always get a number back from opacity\n\t\t\t\t\tvar ret = curCSS( elem, \"opacity\" );\n\t\t\t\t\treturn ret === \"\" ? \"1\" : ret;\n\n\t\t\t\t} else {\n\t\t\t\t\treturn elem.style.opacity;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t// Exclude the following css properties to add px\n\tcssNumber: {\n\t\t\"fillOpacity\": true,\n\t\t\"fontWeight\": true,\n\t\t\"lineHeight\": true,\n\t\t\"opacity\": true,\n\t\t\"orphans\": true,\n\t\t\"widows\": true,\n\t\t\"zIndex\": true,\n\t\t\"zoom\": true\n\t},\n\n\t// Add in properties whose names you wish to fix before\n\t// setting or getting the value\n\tcssProps: {\n\t\t// normalize float css property\n\t\t\"float\": jQuery.support.cssFloat ? \"cssFloat\" : \"styleFloat\"\n\t},\n\n\t// Get and set the style property on a DOM Node\n\tstyle: function( elem, name, value, extra ) {\n\t\t// Don't set styles on text and comment nodes\n\t\tif ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure that we're working with the right name\n\t\tvar ret, type, origName = jQuery.camelCase( name ),\n\t\t\tstyle = elem.style, hooks = jQuery.cssHooks[ origName ];\n\n\t\tname = jQuery.cssProps[ origName ] || origName;\n\n\t\t// Check if we're setting a value\n\t\tif ( value !== undefined ) {\n\t\t\ttype = typeof value;\n\n\t\t\t// convert relative number strings (+= or -=) to relative numbers. #7345\n\t\t\tif ( type === \"string\" && (ret = rrelNum.exec( value )) ) {\n\t\t\t\tvalue = ( +( ret[1] + 1) * +ret[2] ) + parseFloat( jQuery.css( elem, name ) );\n\t\t\t\t// Fixes bug #9237\n\t\t\t\ttype = \"number\";\n\t\t\t}\n\n\t\t\t// Make sure that NaN and null values aren't set. See: #7116\n\t\t\tif ( value == null || type === \"number\" && isNaN( value ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If a number was passed in, add 'px' to the (except for certain CSS properties)\n\t\t\tif ( type === \"number\" && !jQuery.cssNumber[ origName ] ) {\n\t\t\t\tvalue += \"px\";\n\t\t\t}\n\n\t\t\t// If a hook was provided, use that value, otherwise just set the specified value\n\t\t\tif ( !hooks || !(\"set\" in hooks) || (value = hooks.set( elem, value )) !== undefined ) {\n\t\t\t\t// Wrapped to prevent IE from throwing errors when 'invalid' values are provided\n\t\t\t\t// Fixes bug #5509\n\t\t\t\ttry {\n\t\t\t\t\tstyle[ name ] = value;\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\n\t\t} else {\n\t\t\t// If a hook was provided get the non-computed value from there\n\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\t// Otherwise just get the value from the style object\n\t\t\treturn style[ name ];\n\t\t}\n\t},\n\n\tcss: function( elem, name, extra ) {\n\t\tvar ret, hooks;\n\n\t\t// Make sure that we're working with the right name\n\t\tname = jQuery.camelCase( name );\n\t\thooks = jQuery.cssHooks[ name ];\n\t\tname = jQuery.cssProps[ name ] || name;\n\n\t\t// cssFloat needs a special treatment\n\t\tif ( name === \"cssFloat\" ) {\n\t\t\tname = \"float\";\n\t\t}\n\n\t\t// If a hook was provided get the computed value from there\n\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, true, extra )) !== undefined ) {\n\t\t\treturn ret;\n\n\t\t// Otherwise, if a way to get the computed value exists, use that\n\t\t} else if ( curCSS ) {\n\t\t\treturn curCSS( elem, name );\n\t\t}\n\t},\n\n\t// A method for quickly swapping in/out CSS properties to get correct calculations\n\tswap: function( elem, options, callback ) {\n\t\tvar old = {},\n\t\t\tret, name;\n\n\t\t// Remember the old values, and insert the new ones\n\t\tfor ( name in options ) {\n\t\t\told[ name ] = elem.style[ name ];\n\t\t\telem.style[ name ] = options[ name ];\n\t\t}\n\n\t\tret = callback.call( elem );\n\n\t\t// Revert the old values\n\t\tfor ( name in options ) {\n\t\t\telem.style[ name ] = old[ name ];\n\t\t}\n\n\t\treturn ret;\n\t}\n});\n\n// DEPRECATED in 1.3, Use jQuery.css() instead\njQuery.curCSS = jQuery.css;\n\nif ( document.defaultView && document.defaultView.getComputedStyle ) {\n\tgetComputedStyle = function( elem, name ) {\n\t\tvar ret, defaultView, computedStyle, width,\n\t\t\tstyle = elem.style;\n\n\t\tname = name.replace( rupper, \"-$1\" ).toLowerCase();\n\n\t\tif ( (defaultView = elem.ownerDocument.defaultView) &&\n\t\t\t\t(computedStyle = defaultView.getComputedStyle( elem, null )) ) {\n\n\t\t\tret = computedStyle.getPropertyValue( name );\n\t\t\tif ( ret === \"\" && !jQuery.contains( elem.ownerDocument.documentElement, elem ) ) {\n\t\t\t\tret = jQuery.style( elem, name );\n\t\t\t}\n\t\t}\n\n\t\t// A tribute to the \"awesome hack by Dean Edwards\"\n\t\t// WebKit uses \"computed value (percentage if specified)\" instead of \"used value\" for margins\n\t\t// which is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values\n\t\tif ( !jQuery.support.pixelMargin && computedStyle && rmargin.test( name ) && rnumnonpx.test( ret ) ) {\n\t\t\twidth = style.width;\n\t\t\tstyle.width = ret;\n\t\t\tret = computedStyle.width;\n\t\t\tstyle.width = width;\n\t\t}\n\n\t\treturn ret;\n\t};\n}\n\nif ( document.documentElement.currentStyle ) {\n\tcurrentStyle = function( elem, name ) {\n\t\tvar left, rsLeft, uncomputed,\n\t\t\tret = elem.currentStyle && elem.currentStyle[ name ],\n\t\t\tstyle = elem.style;\n\n\t\t// Avoid setting ret to empty string here\n\t\t// so we don't default to auto\n\t\tif ( ret == null && style && (uncomputed = style[ name ]) ) {\n\t\t\tret = uncomputed;\n\t\t}\n\n\t\t// From the awesome hack by Dean Edwards\n\t\t// http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291\n\n\t\t// If we're not dealing with a regular pixel number\n\t\t// but a number that has a weird ending, we need to convert it to pixels\n\t\tif ( rnumnonpx.test( ret ) ) {\n\n\t\t\t// Remember the original values\n\t\t\tleft = style.left;\n\t\t\trsLeft = elem.runtimeStyle && elem.runtimeStyle.left;\n\n\t\t\t// Put in the new values to get a computed value out\n\t\t\tif ( rsLeft ) {\n\t\t\t\telem.runtimeStyle.left = elem.currentStyle.left;\n\t\t\t}\n\t\t\tstyle.left = name === \"fontSize\" ? \"1em\" : ret;\n\t\t\tret = style.pixelLeft + \"px\";\n\n\t\t\t// Revert the changed values\n\t\t\tstyle.left = left;\n\t\t\tif ( rsLeft ) {\n\t\t\t\telem.runtimeStyle.left = rsLeft;\n\t\t\t}\n\t\t}\n\n\t\treturn ret === \"\" ? \"auto\" : ret;\n\t};\n}\n\ncurCSS = getComputedStyle || currentStyle;\n\nfunction getWidthOrHeight( elem, name, extra ) {\n\n\t// Start with offset property\n\tvar val = name === \"width\" ? elem.offsetWidth : elem.offsetHeight,\n\t\ti = name === \"width\" ? 1 : 0,\n\t\tlen = 4;\n\n\tif ( val > 0 ) {\n\t\tif ( extra !== \"border\" ) {\n\t\t\tfor ( ; i < len; i += 2 ) {\n\t\t\t\tif ( !extra ) {\n\t\t\t\t\tval -= parseFloat( jQuery.css( elem, \"padding\" + cssExpand[ i ] ) ) || 0;\n\t\t\t\t}\n\t\t\t\tif ( extra === \"margin\" ) {\n\t\t\t\t\tval += parseFloat( jQuery.css( elem, extra + cssExpand[ i ] ) ) || 0;\n\t\t\t\t} else {\n\t\t\t\t\tval -= parseFloat( jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\" ) ) || 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn val + \"px\";\n\t}\n\n\t// Fall back to computed then uncomputed css if necessary\n\tval = curCSS( elem, name );\n\tif ( val < 0 || val == null ) {\n\t\tval = elem.style[ name ];\n\t}\n\n\t// Computed unit is not pixels. Stop here and return.\n\tif ( rnumnonpx.test(val) ) {\n\t\treturn val;\n\t}\n\n\t// Normalize \"\", auto, and prepare for extra\n\tval = parseFloat( val ) || 0;\n\n\t// Add padding, border, margin\n\tif ( extra ) {\n\t\tfor ( ; i < len; i += 2 ) {\n\t\t\tval += parseFloat( jQuery.css( elem, \"padding\" + cssExpand[ i ] ) ) || 0;\n\t\t\tif ( extra !== \"padding\" ) {\n\t\t\t\tval += parseFloat( jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\" ) ) || 0;\n\t\t\t}\n\t\t\tif ( extra === \"margin\" ) {\n\t\t\t\tval += parseFloat( jQuery.css( elem, extra + cssExpand[ i ]) ) || 0;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn val + \"px\";\n}\n\njQuery.each([ \"height\", \"width\" ], function( i, name ) {\n\tjQuery.cssHooks[ name ] = {\n\t\tget: function( elem, computed, extra ) {\n\t\t\tif ( computed ) {\n\t\t\t\tif ( elem.offsetWidth !== 0 ) {\n\t\t\t\t\treturn getWidthOrHeight( elem, name, extra );\n\t\t\t\t} else {\n\t\t\t\t\treturn jQuery.swap( elem, cssShow, function() {\n\t\t\t\t\t\treturn getWidthOrHeight( elem, name, extra );\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tset: function( elem, value ) {\n\t\t\treturn rnum.test( value ) ?\n\t\t\t\tvalue + \"px\" :\n\t\t\t\tvalue;\n\t\t}\n\t};\n});\n\nif ( !jQuery.support.opacity ) {\n\tjQuery.cssHooks.opacity = {\n\t\tget: function( elem, computed ) {\n\t\t\t// IE uses filters for opacity\n\t\t\treturn ropacity.test( (computed && elem.currentStyle ? elem.currentStyle.filter : elem.style.filter) || \"\" ) ?\n\t\t\t\t( parseFloat( RegExp.$1 ) / 100 ) + \"\" :\n\t\t\t\tcomputed ? \"1\" : \"\";\n\t\t},\n\n\t\tset: function( elem, value ) {\n\t\t\tvar style = elem.style,\n\t\t\t\tcurrentStyle = elem.currentStyle,\n\t\t\t\topacity = jQuery.isNumeric( value ) ? \"alpha(opacity=\" + value * 100 + \")\" : \"\",\n\t\t\t\tfilter = currentStyle && currentStyle.filter || style.filter || \"\";\n\n\t\t\t// IE has trouble with opacity if it does not have layout\n\t\t\t// Force it by setting the zoom level\n\t\t\tstyle.zoom = 1;\n\n\t\t\t// if setting opacity to 1, and no other filters exist - attempt to remove filter attribute #6652\n\t\t\tif ( value >= 1 && jQuery.trim( filter.replace( ralpha, \"\" ) ) === \"\" ) {\n\n\t\t\t\t// Setting style.filter to null, \"\" & \" \" still leave \"filter:\" in the cssText\n\t\t\t\t// if \"filter:\" is present at all, clearType is disabled, we want to avoid this\n\t\t\t\t// style.removeAttribute is IE Only, but so apparently is this code path...\n\t\t\t\tstyle.removeAttribute( \"filter\" );\n\n\t\t\t\t// if there there is no filter style applied in a css rule, we are done\n\t\t\t\tif ( currentStyle && !currentStyle.filter ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// otherwise, set new filter values\n\t\t\tstyle.filter = ralpha.test( filter ) ?\n\t\t\t\tfilter.replace( ralpha, opacity ) :\n\t\t\t\tfilter + \" \" + opacity;\n\t\t}\n\t};\n}\n\njQuery(function() {\n\t// This hook cannot be added until DOM ready because the support test\n\t// for it is not run until after DOM ready\n\tif ( !jQuery.support.reliableMarginRight ) {\n\t\tjQuery.cssHooks.marginRight = {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n\t\t\t\t// Work around by temporarily setting element display to inline-block\n\t\t\t\treturn jQuery.swap( elem, { \"display\": \"inline-block\" }, function() {\n\t\t\t\t\tif ( computed ) {\n\t\t\t\t\t\treturn curCSS( elem, \"margin-right\" );\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn elem.style.marginRight;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n});\n\nif ( jQuery.expr && jQuery.expr.filters ) {\n\tjQuery.expr.filters.hidden = function( elem ) {\n\t\tvar width = elem.offsetWidth,\n\t\t\theight = elem.offsetHeight;\n\n\t\treturn ( width === 0 && height === 0 ) || (!jQuery.support.reliableHiddenOffsets && ((elem.style && elem.style.display) || jQuery.css( elem, \"display\" )) === \"none\");\n\t};\n\n\tjQuery.expr.filters.visible = function( elem ) {\n\t\treturn !jQuery.expr.filters.hidden( elem );\n\t};\n}\n\n// These hooks are used by animate to expand properties\njQuery.each({\n\tmargin: \"\",\n\tpadding: \"\",\n\tborder: \"Width\"\n}, function( prefix, suffix ) {\n\n\tjQuery.cssHooks[ prefix + suffix ] = {\n\t\texpand: function( value ) {\n\t\t\tvar i,\n\n\t\t\t\t// assumes a single number if not a string\n\t\t\t\tparts = typeof value === \"string\" ? value.split(\" \") : [ value ],\n\t\t\t\texpanded = {};\n\n\t\t\tfor ( i = 0; i < 4; i++ ) {\n\t\t\t\texpanded[ prefix + cssExpand[ i ] + suffix ] =\n\t\t\t\t\tparts[ i ] || parts[ i - 2 ] || parts[ 0 ];\n\t\t\t}\n\n\t\t\treturn expanded;\n\t\t}\n\t};\n});\n\n\n\n\nvar r20 = /%20/g,\n\trbracket = /\\[\\]$/,\n\trCRLF = /\\r?\\n/g,\n\trhash = /#.*$/,\n\trheaders = /^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/mg, // IE leaves an \\r character at EOL\n\trinput = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,\n\t// #7653, #8125, #8152: local protocol detection\n\trlocalProtocol = /^(?:about|app|app\\-storage|.+\\-extension|file|res|widget):$/,\n\trnoContent = /^(?:GET|HEAD)$/,\n\trprotocol = /^\\/\\//,\n\trquery = /\\?/,\n\trscript = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,\n\trselectTextarea = /^(?:select|textarea)/i,\n\trspacesAjax = /\\s+/,\n\trts = /([?&])_=[^&]*/,\n\trurl = /^([\\w\\+\\.\\-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+))?)?/,\n\n\t// Keep a copy of the old load method\n\t_load = jQuery.fn.load,\n\n\t/* Prefilters\n\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\n\t * 2) These are called:\n\t *    - BEFORE asking for a transport\n\t *    - AFTER param serialization (s.data is a string if s.processData is true)\n\t * 3) key is the dataType\n\t * 4) the catchall symbol \"*\" can be used\n\t * 5) execution will start with transport dataType and THEN continue down to \"*\" if needed\n\t */\n\tprefilters = {},\n\n\t/* Transports bindings\n\t * 1) key is the dataType\n\t * 2) the catchall symbol \"*\" can be used\n\t * 3) selection will start with transport dataType and THEN go to \"*\" if needed\n\t */\n\ttransports = {},\n\n\t// Document location\n\tajaxLocation,\n\n\t// Document location segments\n\tajaxLocParts,\n\n\t// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\n\tallTypes = [\"*/\"] + [\"*\"];\n\n// #8138, IE may throw an exception when accessing\n// a field from window.location if document.domain has been set\ntry {\n\tajaxLocation = location.href;\n} catch( e ) {\n\t// Use the href attribute of an A element\n\t// since IE will modify it given document.location\n\tajaxLocation = document.createElement( \"a\" );\n\tajaxLocation.href = \"\";\n\tajaxLocation = ajaxLocation.href;\n}\n\n// Segment location into parts\najaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];\n\n// Base \"constructor\" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\nfunction addToPrefiltersOrTransports( structure ) {\n\n\t// dataTypeExpression is optional and defaults to \"*\"\n\treturn function( dataTypeExpression, func ) {\n\n\t\tif ( typeof dataTypeExpression !== \"string\" ) {\n\t\t\tfunc = dataTypeExpression;\n\t\t\tdataTypeExpression = \"*\";\n\t\t}\n\n\t\tif ( jQuery.isFunction( func ) ) {\n\t\t\tvar dataTypes = dataTypeExpression.toLowerCase().split( rspacesAjax ),\n\t\t\t\ti = 0,\n\t\t\t\tlength = dataTypes.length,\n\t\t\t\tdataType,\n\t\t\t\tlist,\n\t\t\t\tplaceBefore;\n\n\t\t\t// For each dataType in the dataTypeExpression\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tdataType = dataTypes[ i ];\n\t\t\t\t// We control if we're asked to add before\n\t\t\t\t// any existing element\n\t\t\t\tplaceBefore = /^\\+/.test( dataType );\n\t\t\t\tif ( placeBefore ) {\n\t\t\t\t\tdataType = dataType.substr( 1 ) || \"*\";\n\t\t\t\t}\n\t\t\t\tlist = structure[ dataType ] = structure[ dataType ] || [];\n\t\t\t\t// then we add to the structure accordingly\n\t\t\t\tlist[ placeBefore ? \"unshift\" : \"push\" ]( func );\n\t\t\t}\n\t\t}\n\t};\n}\n\n// Base inspection function for prefilters and transports\nfunction inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR,\n\t\tdataType /* internal */, inspected /* internal */ ) {\n\n\tdataType = dataType || options.dataTypes[ 0 ];\n\tinspected = inspected || {};\n\n\tinspected[ dataType ] = true;\n\n\tvar list = structure[ dataType ],\n\t\ti = 0,\n\t\tlength = list ? list.length : 0,\n\t\texecuteOnly = ( structure === prefilters ),\n\t\tselection;\n\n\tfor ( ; i < length && ( executeOnly || !selection ); i++ ) {\n\t\tselection = list[ i ]( options, originalOptions, jqXHR );\n\t\t// If we got redirected to another dataType\n\t\t// we try there if executing only and not done already\n\t\tif ( typeof selection === \"string\" ) {\n\t\t\tif ( !executeOnly || inspected[ selection ] ) {\n\t\t\t\tselection = undefined;\n\t\t\t} else {\n\t\t\t\toptions.dataTypes.unshift( selection );\n\t\t\t\tselection = inspectPrefiltersOrTransports(\n\t\t\t\t\t\tstructure, options, originalOptions, jqXHR, selection, inspected );\n\t\t\t}\n\t\t}\n\t}\n\t// If we're only executing or nothing was selected\n\t// we try the catchall dataType if not done already\n\tif ( ( executeOnly || !selection ) && !inspected[ \"*\" ] ) {\n\t\tselection = inspectPrefiltersOrTransports(\n\t\t\t\tstructure, options, originalOptions, jqXHR, \"*\", inspected );\n\t}\n\t// unnecessary when only executing (prefilters)\n\t// but it'll be ignored by the caller in that case\n\treturn selection;\n}\n\n// A special extend for ajax options\n// that takes \"flat\" options (not to be deep extended)\n// Fixes #9887\nfunction ajaxExtend( target, src ) {\n\tvar key, deep,\n\t\tflatOptions = jQuery.ajaxSettings.flatOptions || {};\n\tfor ( key in src ) {\n\t\tif ( src[ key ] !== undefined ) {\n\t\t\t( flatOptions[ key ] ? target : ( deep || ( deep = {} ) ) )[ key ] = src[ key ];\n\t\t}\n\t}\n\tif ( deep ) {\n\t\tjQuery.extend( true, target, deep );\n\t}\n}\n\njQuery.fn.extend({\n\tload: function( url, params, callback ) {\n\t\tif ( typeof url !== \"string\" && _load ) {\n\t\t\treturn _load.apply( this, arguments );\n\n\t\t// Don't do a request if no elements are being requested\n\t\t} else if ( !this.length ) {\n\t\t\treturn this;\n\t\t}\n\n\t\tvar off = url.indexOf( \" \" );\n\t\tif ( off >= 0 ) {\n\t\t\tvar selector = url.slice( off, url.length );\n\t\t\turl = url.slice( 0, off );\n\t\t}\n\n\t\t// Default to a GET request\n\t\tvar type = \"GET\";\n\n\t\t// If the second parameter was provided\n\t\tif ( params ) {\n\t\t\t// If it's a function\n\t\t\tif ( jQuery.isFunction( params ) ) {\n\t\t\t\t// We assume that it's the callback\n\t\t\t\tcallback = params;\n\t\t\t\tparams = undefined;\n\n\t\t\t// Otherwise, build a param string\n\t\t\t} else if ( typeof params === \"object\" ) {\n\t\t\t\tparams = jQuery.param( params, jQuery.ajaxSettings.traditional );\n\t\t\t\ttype = \"POST\";\n\t\t\t}\n\t\t}\n\n\t\tvar self = this;\n\n\t\t// Request the remote document\n\t\tjQuery.ajax({\n\t\t\turl: url,\n\t\t\ttype: type,\n\t\t\tdataType: \"html\",\n\t\t\tdata: params,\n\t\t\t// Complete callback (responseText is used internally)\n\t\t\tcomplete: function( jqXHR, status, responseText ) {\n\t\t\t\t// Store the response as specified by the jqXHR object\n\t\t\t\tresponseText = jqXHR.responseText;\n\t\t\t\t// If successful, inject the HTML into all the matched elements\n\t\t\t\tif ( jqXHR.isResolved() ) {\n\t\t\t\t\t// #4825: Get the actual response in case\n\t\t\t\t\t// a dataFilter is present in ajaxSettings\n\t\t\t\t\tjqXHR.done(function( r ) {\n\t\t\t\t\t\tresponseText = r;\n\t\t\t\t\t});\n\t\t\t\t\t// See if a selector was specified\n\t\t\t\t\tself.html( selector ?\n\t\t\t\t\t\t// Create a dummy div to hold the results\n\t\t\t\t\t\tjQuery(\"<div>\")\n\t\t\t\t\t\t\t// inject the contents of the document in, removing the scripts\n\t\t\t\t\t\t\t// to avoid any 'Permission Denied' errors in IE\n\t\t\t\t\t\t\t.append(responseText.replace(rscript, \"\"))\n\n\t\t\t\t\t\t\t// Locate the specified elements\n\t\t\t\t\t\t\t.find(selector) :\n\n\t\t\t\t\t\t// If not, just inject the full result\n\t\t\t\t\t\tresponseText );\n\t\t\t\t}\n\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tself.each( callback, [ responseText, status, jqXHR ] );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this;\n\t},\n\n\tserialize: function() {\n\t\treturn jQuery.param( this.serializeArray() );\n\t},\n\n\tserializeArray: function() {\n\t\treturn this.map(function(){\n\t\t\treturn this.elements ? jQuery.makeArray( this.elements ) : this;\n\t\t})\n\t\t.filter(function(){\n\t\t\treturn this.name && !this.disabled &&\n\t\t\t\t( this.checked || rselectTextarea.test( this.nodeName ) ||\n\t\t\t\t\trinput.test( this.type ) );\n\t\t})\n\t\t.map(function( i, elem ){\n\t\t\tvar val = jQuery( this ).val();\n\n\t\t\treturn val == null ?\n\t\t\t\tnull :\n\t\t\t\tjQuery.isArray( val ) ?\n\t\t\t\t\tjQuery.map( val, function( val, i ){\n\t\t\t\t\t\treturn { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n\t\t\t\t\t}) :\n\t\t\t\t\t{ name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n\t\t}).get();\n\t}\n});\n\n// Attach a bunch of functions for handling common AJAX events\njQuery.each( \"ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend\".split( \" \" ), function( i, o ){\n\tjQuery.fn[ o ] = function( f ){\n\t\treturn this.on( o, f );\n\t};\n});\n\njQuery.each( [ \"get\", \"post\" ], function( i, method ) {\n\tjQuery[ method ] = function( url, data, callback, type ) {\n\t\t// shift arguments if data argument was omitted\n\t\tif ( jQuery.isFunction( data ) ) {\n\t\t\ttype = type || callback;\n\t\t\tcallback = data;\n\t\t\tdata = undefined;\n\t\t}\n\n\t\treturn jQuery.ajax({\n\t\t\ttype: method,\n\t\t\turl: url,\n\t\t\tdata: data,\n\t\t\tsuccess: callback,\n\t\t\tdataType: type\n\t\t});\n\t};\n});\n\njQuery.extend({\n\n\tgetScript: function( url, callback ) {\n\t\treturn jQuery.get( url, undefined, callback, \"script\" );\n\t},\n\n\tgetJSON: function( url, data, callback ) {\n\t\treturn jQuery.get( url, data, callback, \"json\" );\n\t},\n\n\t// Creates a full fledged settings object into target\n\t// with both ajaxSettings and settings fields.\n\t// If target is omitted, writes into ajaxSettings.\n\tajaxSetup: function( target, settings ) {\n\t\tif ( settings ) {\n\t\t\t// Building a settings object\n\t\t\tajaxExtend( target, jQuery.ajaxSettings );\n\t\t} else {\n\t\t\t// Extending ajaxSettings\n\t\t\tsettings = target;\n\t\t\ttarget = jQuery.ajaxSettings;\n\t\t}\n\t\tajaxExtend( target, settings );\n\t\treturn target;\n\t},\n\n\tajaxSettings: {\n\t\turl: ajaxLocation,\n\t\tisLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),\n\t\tglobal: true,\n\t\ttype: \"GET\",\n\t\tcontentType: \"application/x-www-form-urlencoded; charset=UTF-8\",\n\t\tprocessData: true,\n\t\tasync: true,\n\t\t/*\n\t\ttimeout: 0,\n\t\tdata: null,\n\t\tdataType: null,\n\t\tusername: null,\n\t\tpassword: null,\n\t\tcache: null,\n\t\ttraditional: false,\n\t\theaders: {},\n\t\t*/\n\n\t\taccepts: {\n\t\t\txml: \"application/xml, text/xml\",\n\t\t\thtml: \"text/html\",\n\t\t\ttext: \"text/plain\",\n\t\t\tjson: \"application/json, text/javascript\",\n\t\t\t\"*\": allTypes\n\t\t},\n\n\t\tcontents: {\n\t\t\txml: /xml/,\n\t\t\thtml: /html/,\n\t\t\tjson: /json/\n\t\t},\n\n\t\tresponseFields: {\n\t\t\txml: \"responseXML\",\n\t\t\ttext: \"responseText\"\n\t\t},\n\n\t\t// List of data converters\n\t\t// 1) key format is \"source_type destination_type\" (a single space in-between)\n\t\t// 2) the catchall symbol \"*\" can be used for source_type\n\t\tconverters: {\n\n\t\t\t// Convert anything to text\n\t\t\t\"* text\": window.String,\n\n\t\t\t// Text to html (true = no transformation)\n\t\t\t\"text html\": true,\n\n\t\t\t// Evaluate text as a json expression\n\t\t\t\"text json\": jQuery.parseJSON,\n\n\t\t\t// Parse text as xml\n\t\t\t\"text xml\": jQuery.parseXML\n\t\t},\n\n\t\t// For options that shouldn't be deep extended:\n\t\t// you can add your own custom options here if\n\t\t// and when you create one that shouldn't be\n\t\t// deep extended (see ajaxExtend)\n\t\tflatOptions: {\n\t\t\tcontext: true,\n\t\t\turl: true\n\t\t}\n\t},\n\n\tajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\n\tajaxTransport: addToPrefiltersOrTransports( transports ),\n\n\t// Main method\n\tajax: function( url, options ) {\n\n\t\t// If url is an object, simulate pre-1.5 signature\n\t\tif ( typeof url === \"object\" ) {\n\t\t\toptions = url;\n\t\t\turl = undefined;\n\t\t}\n\n\t\t// Force options to be an object\n\t\toptions = options || {};\n\n\t\tvar // Create the final options object\n\t\t\ts = jQuery.ajaxSetup( {}, options ),\n\t\t\t// Callbacks context\n\t\t\tcallbackContext = s.context || s,\n\t\t\t// Context for global events\n\t\t\t// It's the callbackContext if one was provided in the options\n\t\t\t// and if it's a DOM node or a jQuery collection\n\t\t\tglobalEventContext = callbackContext !== s &&\n\t\t\t\t( callbackContext.nodeType || callbackContext instanceof jQuery ) ?\n\t\t\t\t\t\tjQuery( callbackContext ) : jQuery.event,\n\t\t\t// Deferreds\n\t\t\tdeferred = jQuery.Deferred(),\n\t\t\tcompleteDeferred = jQuery.Callbacks( \"once memory\" ),\n\t\t\t// Status-dependent callbacks\n\t\t\tstatusCode = s.statusCode || {},\n\t\t\t// ifModified key\n\t\t\tifModifiedKey,\n\t\t\t// Headers (they are sent all at once)\n\t\t\trequestHeaders = {},\n\t\t\trequestHeadersNames = {},\n\t\t\t// Response headers\n\t\t\tresponseHeadersString,\n\t\t\tresponseHeaders,\n\t\t\t// transport\n\t\t\ttransport,\n\t\t\t// timeout handle\n\t\t\ttimeoutTimer,\n\t\t\t// Cross-domain detection vars\n\t\t\tparts,\n\t\t\t// The jqXHR state\n\t\t\tstate = 0,\n\t\t\t// To know if global events are to be dispatched\n\t\t\tfireGlobals,\n\t\t\t// Loop variable\n\t\t\ti,\n\t\t\t// Fake xhr\n\t\t\tjqXHR = {\n\n\t\t\t\treadyState: 0,\n\n\t\t\t\t// Caches the header\n\t\t\t\tsetRequestHeader: function( name, value ) {\n\t\t\t\t\tif ( !state ) {\n\t\t\t\t\t\tvar lname = name.toLowerCase();\n\t\t\t\t\t\tname = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;\n\t\t\t\t\t\trequestHeaders[ name ] = value;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Raw string\n\t\t\t\tgetAllResponseHeaders: function() {\n\t\t\t\t\treturn state === 2 ? responseHeadersString : null;\n\t\t\t\t},\n\n\t\t\t\t// Builds headers hashtable if needed\n\t\t\t\tgetResponseHeader: function( key ) {\n\t\t\t\t\tvar match;\n\t\t\t\t\tif ( state === 2 ) {\n\t\t\t\t\t\tif ( !responseHeaders ) {\n\t\t\t\t\t\t\tresponseHeaders = {};\n\t\t\t\t\t\t\twhile( ( match = rheaders.exec( responseHeadersString ) ) ) {\n\t\t\t\t\t\t\t\tresponseHeaders[ match[1].toLowerCase() ] = match[ 2 ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmatch = responseHeaders[ key.toLowerCase() ];\n\t\t\t\t\t}\n\t\t\t\t\treturn match === undefined ? null : match;\n\t\t\t\t},\n\n\t\t\t\t// Overrides response content-type header\n\t\t\t\toverrideMimeType: function( type ) {\n\t\t\t\t\tif ( !state ) {\n\t\t\t\t\t\ts.mimeType = type;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Cancel the request\n\t\t\t\tabort: function( statusText ) {\n\t\t\t\t\tstatusText = statusText || \"abort\";\n\t\t\t\t\tif ( transport ) {\n\t\t\t\t\t\ttransport.abort( statusText );\n\t\t\t\t\t}\n\t\t\t\t\tdone( 0, statusText );\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t};\n\n\t\t// Callback for when everything is done\n\t\t// It is defined here because jslint complains if it is declared\n\t\t// at the end of the function (which would be more logical and readable)\n\t\tfunction done( status, nativeStatusText, responses, headers ) {\n\n\t\t\t// Called once\n\t\t\tif ( state === 2 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// State is \"done\" now\n\t\t\tstate = 2;\n\n\t\t\t// Clear timeout if it exists\n\t\t\tif ( timeoutTimer ) {\n\t\t\t\tclearTimeout( timeoutTimer );\n\t\t\t}\n\n\t\t\t// Dereference transport for early garbage collection\n\t\t\t// (no matter how long the jqXHR object will be used)\n\t\t\ttransport = undefined;\n\n\t\t\t// Cache response headers\n\t\t\tresponseHeadersString = headers || \"\";\n\n\t\t\t// Set readyState\n\t\t\tjqXHR.readyState = status > 0 ? 4 : 0;\n\n\t\t\tvar isSuccess,\n\t\t\t\tsuccess,\n\t\t\t\terror,\n\t\t\t\tstatusText = nativeStatusText,\n\t\t\t\tresponse = responses ? ajaxHandleResponses( s, jqXHR, responses ) : undefined,\n\t\t\t\tlastModified,\n\t\t\t\tetag;\n\n\t\t\t// If successful, handle type chaining\n\t\t\tif ( status >= 200 && status < 300 || status === 304 ) {\n\n\t\t\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\t\t\tif ( s.ifModified ) {\n\n\t\t\t\t\tif ( ( lastModified = jqXHR.getResponseHeader( \"Last-Modified\" ) ) ) {\n\t\t\t\t\t\tjQuery.lastModified[ ifModifiedKey ] = lastModified;\n\t\t\t\t\t}\n\t\t\t\t\tif ( ( etag = jqXHR.getResponseHeader( \"Etag\" ) ) ) {\n\t\t\t\t\t\tjQuery.etag[ ifModifiedKey ] = etag;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If not modified\n\t\t\t\tif ( status === 304 ) {\n\n\t\t\t\t\tstatusText = \"notmodified\";\n\t\t\t\t\tisSuccess = true;\n\n\t\t\t\t// If we have data\n\t\t\t\t} else {\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tsuccess = ajaxConvert( s, response );\n\t\t\t\t\t\tstatusText = \"success\";\n\t\t\t\t\t\tisSuccess = true;\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t// We have a parsererror\n\t\t\t\t\t\tstatusText = \"parsererror\";\n\t\t\t\t\t\terror = e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We extract error from statusText\n\t\t\t\t// then normalize statusText and status for non-aborts\n\t\t\t\terror = statusText;\n\t\t\t\tif ( !statusText || status ) {\n\t\t\t\t\tstatusText = \"error\";\n\t\t\t\t\tif ( status < 0 ) {\n\t\t\t\t\t\tstatus = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set data for the fake xhr object\n\t\t\tjqXHR.status = status;\n\t\t\tjqXHR.statusText = \"\" + ( nativeStatusText || statusText );\n\n\t\t\t// Success/Error\n\t\t\tif ( isSuccess ) {\n\t\t\t\tdeferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\n\t\t\t} else {\n\t\t\t\tdeferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\n\t\t\t}\n\n\t\t\t// Status-dependent callbacks\n\t\t\tjqXHR.statusCode( statusCode );\n\t\t\tstatusCode = undefined;\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajax\" + ( isSuccess ? \"Success\" : \"Error\" ),\n\t\t\t\t\t\t[ jqXHR, s, isSuccess ? success : error ] );\n\t\t\t}\n\n\t\t\t// Complete\n\t\t\tcompleteDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajaxComplete\", [ jqXHR, s ] );\n\t\t\t\t// Handle the global AJAX counter\n\t\t\t\tif ( !( --jQuery.active ) ) {\n\t\t\t\t\tjQuery.event.trigger( \"ajaxStop\" );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Attach deferreds\n\t\tdeferred.promise( jqXHR );\n\t\tjqXHR.success = jqXHR.done;\n\t\tjqXHR.error = jqXHR.fail;\n\t\tjqXHR.complete = completeDeferred.add;\n\n\t\t// Status-dependent callbacks\n\t\tjqXHR.statusCode = function( map ) {\n\t\t\tif ( map ) {\n\t\t\t\tvar tmp;\n\t\t\t\tif ( state < 2 ) {\n\t\t\t\t\tfor ( tmp in map ) {\n\t\t\t\t\t\tstatusCode[ tmp ] = [ statusCode[tmp], map[tmp] ];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttmp = map[ jqXHR.status ];\n\t\t\t\t\tjqXHR.then( tmp, tmp );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\n\t\t// Remove hash character (#7531: and string promotion)\n\t\t// Add protocol if not provided (#5866: IE7 issue with protocol-less urls)\n\t\t// We also use the url parameter if available\n\t\ts.url = ( ( url || s.url ) + \"\" ).replace( rhash, \"\" ).replace( rprotocol, ajaxLocParts[ 1 ] + \"//\" );\n\n\t\t// Extract dataTypes list\n\t\ts.dataTypes = jQuery.trim( s.dataType || \"*\" ).toLowerCase().split( rspacesAjax );\n\n\t\t// Determine if a cross-domain request is in order\n\t\tif ( s.crossDomain == null ) {\n\t\t\tparts = rurl.exec( s.url.toLowerCase() );\n\t\t\ts.crossDomain = !!( parts &&\n\t\t\t\t( parts[ 1 ] != ajaxLocParts[ 1 ] || parts[ 2 ] != ajaxLocParts[ 2 ] ||\n\t\t\t\t\t( parts[ 3 ] || ( parts[ 1 ] === \"http:\" ? 80 : 443 ) ) !=\n\t\t\t\t\t\t( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === \"http:\" ? 80 : 443 ) ) )\n\t\t\t);\n\t\t}\n\n\t\t// Convert data if not already a string\n\t\tif ( s.data && s.processData && typeof s.data !== \"string\" ) {\n\t\t\ts.data = jQuery.param( s.data, s.traditional );\n\t\t}\n\n\t\t// Apply prefilters\n\t\tinspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\n\n\t\t// If request was aborted inside a prefilter, stop there\n\t\tif ( state === 2 ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// We can fire global events as of now if asked to\n\t\tfireGlobals = s.global;\n\n\t\t// Uppercase the type\n\t\ts.type = s.type.toUpperCase();\n\n\t\t// Determine if request has content\n\t\ts.hasContent = !rnoContent.test( s.type );\n\n\t\t// Watch for a new set of requests\n\t\tif ( fireGlobals && jQuery.active++ === 0 ) {\n\t\t\tjQuery.event.trigger( \"ajaxStart\" );\n\t\t}\n\n\t\t// More options handling for requests with no content\n\t\tif ( !s.hasContent ) {\n\n\t\t\t// If data is available, append data to url\n\t\t\tif ( s.data ) {\n\t\t\t\ts.url += ( rquery.test( s.url ) ? \"&\" : \"?\" ) + s.data;\n\t\t\t\t// #9682: remove data so that it's not used in an eventual retry\n\t\t\t\tdelete s.data;\n\t\t\t}\n\n\t\t\t// Get ifModifiedKey before adding the anti-cache parameter\n\t\t\tifModifiedKey = s.url;\n\n\t\t\t// Add anti-cache in url if needed\n\t\t\tif ( s.cache === false ) {\n\n\t\t\t\tvar ts = jQuery.now(),\n\t\t\t\t\t// try replacing _= if it is there\n\t\t\t\t\tret = s.url.replace( rts, \"$1_=\" + ts );\n\n\t\t\t\t// if nothing was replaced, add timestamp to the end\n\t\t\t\ts.url = ret + ( ( ret === s.url ) ? ( rquery.test( s.url ) ? \"&\" : \"?\" ) + \"_=\" + ts : \"\" );\n\t\t\t}\n\t\t}\n\n\t\t// Set the correct header, if data is being sent\n\t\tif ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\n\t\t\tjqXHR.setRequestHeader( \"Content-Type\", s.contentType );\n\t\t}\n\n\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\tif ( s.ifModified ) {\n\t\t\tifModifiedKey = ifModifiedKey || s.url;\n\t\t\tif ( jQuery.lastModified[ ifModifiedKey ] ) {\n\t\t\t\tjqXHR.setRequestHeader( \"If-Modified-Since\", jQuery.lastModified[ ifModifiedKey ] );\n\t\t\t}\n\t\t\tif ( jQuery.etag[ ifModifiedKey ] ) {\n\t\t\t\tjqXHR.setRequestHeader( \"If-None-Match\", jQuery.etag[ ifModifiedKey ] );\n\t\t\t}\n\t\t}\n\n\t\t// Set the Accepts header for the server, depending on the dataType\n\t\tjqXHR.setRequestHeader(\n\t\t\t\"Accept\",\n\t\t\ts.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?\n\t\t\t\ts.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== \"*\" ? \", \" + allTypes + \"; q=0.01\" : \"\" ) :\n\t\t\t\ts.accepts[ \"*\" ]\n\t\t);\n\n\t\t// Check for headers option\n\t\tfor ( i in s.headers ) {\n\t\t\tjqXHR.setRequestHeader( i, s.headers[ i ] );\n\t\t}\n\n\t\t// Allow custom headers/mimetypes and early abort\n\t\tif ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {\n\t\t\t\t// Abort if not done already\n\t\t\t\tjqXHR.abort();\n\t\t\t\treturn false;\n\n\t\t}\n\n\t\t// Install callbacks on deferreds\n\t\tfor ( i in { success: 1, error: 1, complete: 1 } ) {\n\t\t\tjqXHR[ i ]( s[ i ] );\n\t\t}\n\n\t\t// Get transport\n\t\ttransport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\n\n\t\t// If no transport, we auto-abort\n\t\tif ( !transport ) {\n\t\t\tdone( -1, \"No Transport\" );\n\t\t} else {\n\t\t\tjqXHR.readyState = 1;\n\t\t\t// Send global event\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajaxSend\", [ jqXHR, s ] );\n\t\t\t}\n\t\t\t// Timeout\n\t\t\tif ( s.async && s.timeout > 0 ) {\n\t\t\t\ttimeoutTimer = setTimeout( function(){\n\t\t\t\t\tjqXHR.abort( \"timeout\" );\n\t\t\t\t}, s.timeout );\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tstate = 1;\n\t\t\t\ttransport.send( requestHeaders, done );\n\t\t\t} catch (e) {\n\t\t\t\t// Propagate exception as error if not done\n\t\t\t\tif ( state < 2 ) {\n\t\t\t\t\tdone( -1, e );\n\t\t\t\t// Simply rethrow otherwise\n\t\t\t\t} else {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn jqXHR;\n\t},\n\n\t// Serialize an array of form elements or a set of\n\t// key/values into a query string\n\tparam: function( a, traditional ) {\n\t\tvar s = [],\n\t\t\tadd = function( key, value ) {\n\t\t\t\t// If value is a function, invoke it and return its value\n\t\t\t\tvalue = jQuery.isFunction( value ) ? value() : value;\n\t\t\t\ts[ s.length ] = encodeURIComponent( key ) + \"=\" + encodeURIComponent( value );\n\t\t\t};\n\n\t\t// Set traditional to true for jQuery <= 1.3.2 behavior.\n\t\tif ( traditional === undefined ) {\n\t\t\ttraditional = jQuery.ajaxSettings.traditional;\n\t\t}\n\n\t\t// If an array was passed in, assume that it is an array of form elements.\n\t\tif ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\n\t\t\t// Serialize the form elements\n\t\t\tjQuery.each( a, function() {\n\t\t\t\tadd( this.name, this.value );\n\t\t\t});\n\n\t\t} else {\n\t\t\t// If traditional, encode the \"old\" way (the way 1.3.2 or older\n\t\t\t// did it), otherwise encode params recursively.\n\t\t\tfor ( var prefix in a ) {\n\t\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\n\t\t\t}\n\t\t}\n\n\t\t// Return the resulting serialization\n\t\treturn s.join( \"&\" ).replace( r20, \"+\" );\n\t}\n});\n\nfunction buildParams( prefix, obj, traditional, add ) {\n\tif ( jQuery.isArray( obj ) ) {\n\t\t// Serialize array item.\n\t\tjQuery.each( obj, function( i, v ) {\n\t\t\tif ( traditional || rbracket.test( prefix ) ) {\n\t\t\t\t// Treat each array item as a scalar.\n\t\t\t\tadd( prefix, v );\n\n\t\t\t} else {\n\t\t\t\t// If array item is non-scalar (array or object), encode its\n\t\t\t\t// numeric index to resolve deserialization ambiguity issues.\n\t\t\t\t// Note that rack (as of 1.0.0) can't currently deserialize\n\t\t\t\t// nested arrays properly, and attempting to do so may cause\n\t\t\t\t// a server error. Possible fixes are to modify rack's\n\t\t\t\t// deserialization algorithm or to provide an option or flag\n\t\t\t\t// to force array serialization to be shallow.\n\t\t\t\tbuildParams( prefix + \"[\" + ( typeof v === \"object\" ? i : \"\" ) + \"]\", v, traditional, add );\n\t\t\t}\n\t\t});\n\n\t} else if ( !traditional && jQuery.type( obj ) === \"object\" ) {\n\t\t// Serialize object item.\n\t\tfor ( var name in obj ) {\n\t\t\tbuildParams( prefix + \"[\" + name + \"]\", obj[ name ], traditional, add );\n\t\t}\n\n\t} else {\n\t\t// Serialize scalar item.\n\t\tadd( prefix, obj );\n\t}\n}\n\n// This is still on the jQuery object... for now\n// Want to move this to jQuery.ajax some day\njQuery.extend({\n\n\t// Counter for holding the number of active queries\n\tactive: 0,\n\n\t// Last-Modified header cache for next request\n\tlastModified: {},\n\tetag: {}\n\n});\n\n/* Handles responses to an ajax request:\n * - sets all responseXXX fields accordingly\n * - finds the right dataType (mediates between content-type and expected dataType)\n * - returns the corresponding response\n */\nfunction ajaxHandleResponses( s, jqXHR, responses ) {\n\n\tvar contents = s.contents,\n\t\tdataTypes = s.dataTypes,\n\t\tresponseFields = s.responseFields,\n\t\tct,\n\t\ttype,\n\t\tfinalDataType,\n\t\tfirstDataType;\n\n\t// Fill responseXXX fields\n\tfor ( type in responseFields ) {\n\t\tif ( type in responses ) {\n\t\t\tjqXHR[ responseFields[type] ] = responses[ type ];\n\t\t}\n\t}\n\n\t// Remove auto dataType and get content-type in the process\n\twhile( dataTypes[ 0 ] === \"*\" ) {\n\t\tdataTypes.shift();\n\t\tif ( ct === undefined ) {\n\t\t\tct = s.mimeType || jqXHR.getResponseHeader( \"content-type\" );\n\t\t}\n\t}\n\n\t// Check if we're dealing with a known content-type\n\tif ( ct ) {\n\t\tfor ( type in contents ) {\n\t\t\tif ( contents[ type ] && contents[ type ].test( ct ) ) {\n\t\t\t\tdataTypes.unshift( type );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check to see if we have a response for the expected dataType\n\tif ( dataTypes[ 0 ] in responses ) {\n\t\tfinalDataType = dataTypes[ 0 ];\n\t} else {\n\t\t// Try convertible dataTypes\n\t\tfor ( type in responses ) {\n\t\t\tif ( !dataTypes[ 0 ] || s.converters[ type + \" \" + dataTypes[0] ] ) {\n\t\t\t\tfinalDataType = type;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( !firstDataType ) {\n\t\t\t\tfirstDataType = type;\n\t\t\t}\n\t\t}\n\t\t// Or just use first one\n\t\tfinalDataType = finalDataType || firstDataType;\n\t}\n\n\t// If we found a dataType\n\t// We add the dataType to the list if needed\n\t// and return the corresponding response\n\tif ( finalDataType ) {\n\t\tif ( finalDataType !== dataTypes[ 0 ] ) {\n\t\t\tdataTypes.unshift( finalDataType );\n\t\t}\n\t\treturn responses[ finalDataType ];\n\t}\n}\n\n// Chain conversions given the request and the original response\nfunction ajaxConvert( s, response ) {\n\n\t// Apply the dataFilter if provided\n\tif ( s.dataFilter ) {\n\t\tresponse = s.dataFilter( response, s.dataType );\n\t}\n\n\tvar dataTypes = s.dataTypes,\n\t\tconverters = {},\n\t\ti,\n\t\tkey,\n\t\tlength = dataTypes.length,\n\t\ttmp,\n\t\t// Current and previous dataTypes\n\t\tcurrent = dataTypes[ 0 ],\n\t\tprev,\n\t\t// Conversion expression\n\t\tconversion,\n\t\t// Conversion function\n\t\tconv,\n\t\t// Conversion functions (transitive conversion)\n\t\tconv1,\n\t\tconv2;\n\n\t// For each dataType in the chain\n\tfor ( i = 1; i < length; i++ ) {\n\n\t\t// Create converters map\n\t\t// with lowercased keys\n\t\tif ( i === 1 ) {\n\t\t\tfor ( key in s.converters ) {\n\t\t\t\tif ( typeof key === \"string\" ) {\n\t\t\t\t\tconverters[ key.toLowerCase() ] = s.converters[ key ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Get the dataTypes\n\t\tprev = current;\n\t\tcurrent = dataTypes[ i ];\n\n\t\t// If current is auto dataType, update it to prev\n\t\tif ( current === \"*\" ) {\n\t\t\tcurrent = prev;\n\t\t// If no auto and dataTypes are actually different\n\t\t} else if ( prev !== \"*\" && prev !== current ) {\n\n\t\t\t// Get the converter\n\t\t\tconversion = prev + \" \" + current;\n\t\t\tconv = converters[ conversion ] || converters[ \"* \" + current ];\n\n\t\t\t// If there is no direct converter, search transitively\n\t\t\tif ( !conv ) {\n\t\t\t\tconv2 = undefined;\n\t\t\t\tfor ( conv1 in converters ) {\n\t\t\t\t\ttmp = conv1.split( \" \" );\n\t\t\t\t\tif ( tmp[ 0 ] === prev || tmp[ 0 ] === \"*\" ) {\n\t\t\t\t\t\tconv2 = converters[ tmp[1] + \" \" + current ];\n\t\t\t\t\t\tif ( conv2 ) {\n\t\t\t\t\t\t\tconv1 = converters[ conv1 ];\n\t\t\t\t\t\t\tif ( conv1 === true ) {\n\t\t\t\t\t\t\t\tconv = conv2;\n\t\t\t\t\t\t\t} else if ( conv2 === true ) {\n\t\t\t\t\t\t\t\tconv = conv1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we found no converter, dispatch an error\n\t\t\tif ( !( conv || conv2 ) ) {\n\t\t\t\tjQuery.error( \"No conversion from \" + conversion.replace(\" \",\" to \") );\n\t\t\t}\n\t\t\t// If found converter is not an equivalence\n\t\t\tif ( conv !== true ) {\n\t\t\t\t// Convert with 1 or 2 converters accordingly\n\t\t\t\tresponse = conv ? conv( response ) : conv2( conv1(response) );\n\t\t\t}\n\t\t}\n\t}\n\treturn response;\n}\n\n\n\n\nvar jsc = jQuery.now(),\n\tjsre = /(\\=)\\?(&|$)|\\?\\?/i;\n\n// Default jsonp settings\njQuery.ajaxSetup({\n\tjsonp: \"callback\",\n\tjsonpCallback: function() {\n\t\treturn jQuery.expando + \"_\" + ( jsc++ );\n\t}\n});\n\n// Detect, normalize options and install callbacks for jsonp requests\njQuery.ajaxPrefilter( \"json jsonp\", function( s, originalSettings, jqXHR ) {\n\n\tvar inspectData = ( typeof s.data === \"string\" ) && /^application\\/x\\-www\\-form\\-urlencoded/.test( s.contentType );\n\n\tif ( s.dataTypes[ 0 ] === \"jsonp\" ||\n\t\ts.jsonp !== false && ( jsre.test( s.url ) ||\n\t\t\t\tinspectData && jsre.test( s.data ) ) ) {\n\n\t\tvar responseContainer,\n\t\t\tjsonpCallback = s.jsonpCallback =\n\t\t\t\tjQuery.isFunction( s.jsonpCallback ) ? s.jsonpCallback() : s.jsonpCallback,\n\t\t\tprevious = window[ jsonpCallback ],\n\t\t\turl = s.url,\n\t\t\tdata = s.data,\n\t\t\treplace = \"$1\" + jsonpCallback + \"$2\";\n\n\t\tif ( s.jsonp !== false ) {\n\t\t\turl = url.replace( jsre, replace );\n\t\t\tif ( s.url === url ) {\n\t\t\t\tif ( inspectData ) {\n\t\t\t\t\tdata = data.replace( jsre, replace );\n\t\t\t\t}\n\t\t\t\tif ( s.data === data ) {\n\t\t\t\t\t// Add callback manually\n\t\t\t\t\turl += (/\\?/.test( url ) ? \"&\" : \"?\") + s.jsonp + \"=\" + jsonpCallback;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ts.url = url;\n\t\ts.data = data;\n\n\t\t// Install callback\n\t\twindow[ jsonpCallback ] = function( response ) {\n\t\t\tresponseContainer = [ response ];\n\t\t};\n\n\t\t// Clean-up function\n\t\tjqXHR.always(function() {\n\t\t\t// Set callback back to previous value\n\t\t\twindow[ jsonpCallback ] = previous;\n\t\t\t// Call if it was a function and we have a response\n\t\t\tif ( responseContainer && jQuery.isFunction( previous ) ) {\n\t\t\t\twindow[ jsonpCallback ]( responseContainer[ 0 ] );\n\t\t\t}\n\t\t});\n\n\t\t// Use data converter to retrieve json after script execution\n\t\ts.converters[\"script json\"] = function() {\n\t\t\tif ( !responseContainer ) {\n\t\t\t\tjQuery.error( jsonpCallback + \" was not called\" );\n\t\t\t}\n\t\t\treturn responseContainer[ 0 ];\n\t\t};\n\n\t\t// force json dataType\n\t\ts.dataTypes[ 0 ] = \"json\";\n\n\t\t// Delegate to script\n\t\treturn \"script\";\n\t}\n});\n\n\n\n\n// Install script dataType\njQuery.ajaxSetup({\n\taccepts: {\n\t\tscript: \"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"\n\t},\n\tcontents: {\n\t\tscript: /javascript|ecmascript/\n\t},\n\tconverters: {\n\t\t\"text script\": function( text ) {\n\t\t\tjQuery.globalEval( text );\n\t\t\treturn text;\n\t\t}\n\t}\n});\n\n// Handle cache's special case and global\njQuery.ajaxPrefilter( \"script\", function( s ) {\n\tif ( s.cache === undefined ) {\n\t\ts.cache = false;\n\t}\n\tif ( s.crossDomain ) {\n\t\ts.type = \"GET\";\n\t\ts.global = false;\n\t}\n});\n\n// Bind script tag hack transport\njQuery.ajaxTransport( \"script\", function(s) {\n\n\t// This transport only deals with cross domain requests\n\tif ( s.crossDomain ) {\n\n\t\tvar script,\n\t\t\thead = document.head || document.getElementsByTagName( \"head\" )[0] || document.documentElement;\n\n\t\treturn {\n\n\t\t\tsend: function( _, callback ) {\n\n\t\t\t\tscript = document.createElement( \"script\" );\n\n\t\t\t\tscript.async = \"async\";\n\n\t\t\t\tif ( s.scriptCharset ) {\n\t\t\t\t\tscript.charset = s.scriptCharset;\n\t\t\t\t}\n\n\t\t\t\tscript.src = s.url;\n\n\t\t\t\t// Attach handlers for all browsers\n\t\t\t\tscript.onload = script.onreadystatechange = function( _, isAbort ) {\n\n\t\t\t\t\tif ( isAbort || !script.readyState || /loaded|complete/.test( script.readyState ) ) {\n\n\t\t\t\t\t\t// Handle memory leak in IE\n\t\t\t\t\t\tscript.onload = script.onreadystatechange = null;\n\n\t\t\t\t\t\t// Remove the script\n\t\t\t\t\t\tif ( head && script.parentNode ) {\n\t\t\t\t\t\t\thead.removeChild( script );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Dereference the script\n\t\t\t\t\t\tscript = undefined;\n\n\t\t\t\t\t\t// Callback if not abort\n\t\t\t\t\t\tif ( !isAbort ) {\n\t\t\t\t\t\t\tcallback( 200, \"success\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t// Use insertBefore instead of appendChild  to circumvent an IE6 bug.\n\t\t\t\t// This arises when a base node is used (#2709 and #4378).\n\t\t\t\thead.insertBefore( script, head.firstChild );\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tif ( script ) {\n\t\t\t\t\tscript.onload( 0, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n});\n\n\n\n\nvar // #5280: Internet Explorer will keep connections alive if we don't abort on unload\n\txhrOnUnloadAbort = window.ActiveXObject ? function() {\n\t\t// Abort all pending requests\n\t\tfor ( var key in xhrCallbacks ) {\n\t\t\txhrCallbacks[ key ]( 0, 1 );\n\t\t}\n\t} : false,\n\txhrId = 0,\n\txhrCallbacks;\n\n// Functions to create xhrs\nfunction createStandardXHR() {\n\ttry {\n\t\treturn new window.XMLHttpRequest();\n\t} catch( e ) {}\n}\n\nfunction createActiveXHR() {\n\ttry {\n\t\treturn new window.ActiveXObject( \"Microsoft.XMLHTTP\" );\n\t} catch( e ) {}\n}\n\n// Create the request object\n// (This is still attached to ajaxSettings for backward compatibility)\njQuery.ajaxSettings.xhr = window.ActiveXObject ?\n\t/* Microsoft failed to properly\n\t * implement the XMLHttpRequest in IE7 (can't request local files),\n\t * so we use the ActiveXObject when it is available\n\t * Additionally XMLHttpRequest can be disabled in IE7/IE8 so\n\t * we need a fallback.\n\t */\n\tfunction() {\n\t\treturn !this.isLocal && createStandardXHR() || createActiveXHR();\n\t} :\n\t// For all other browsers, use the standard XMLHttpRequest object\n\tcreateStandardXHR;\n\n// Determine support properties\n(function( xhr ) {\n\tjQuery.extend( jQuery.support, {\n\t\tajax: !!xhr,\n\t\tcors: !!xhr && ( \"withCredentials\" in xhr )\n\t});\n})( jQuery.ajaxSettings.xhr() );\n\n// Create transport if the browser can provide an xhr\nif ( jQuery.support.ajax ) {\n\n\tjQuery.ajaxTransport(function( s ) {\n\t\t// Cross domain only allowed if supported through XMLHttpRequest\n\t\tif ( !s.crossDomain || jQuery.support.cors ) {\n\n\t\t\tvar callback;\n\n\t\t\treturn {\n\t\t\t\tsend: function( headers, complete ) {\n\n\t\t\t\t\t// Get a new xhr\n\t\t\t\t\tvar xhr = s.xhr(),\n\t\t\t\t\t\thandle,\n\t\t\t\t\t\ti;\n\n\t\t\t\t\t// Open the socket\n\t\t\t\t\t// Passing null username, generates a login popup on Opera (#2865)\n\t\t\t\t\tif ( s.username ) {\n\t\t\t\t\t\txhr.open( s.type, s.url, s.async, s.username, s.password );\n\t\t\t\t\t} else {\n\t\t\t\t\t\txhr.open( s.type, s.url, s.async );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Apply custom fields if provided\n\t\t\t\t\tif ( s.xhrFields ) {\n\t\t\t\t\t\tfor ( i in s.xhrFields ) {\n\t\t\t\t\t\t\txhr[ i ] = s.xhrFields[ i ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Override mime type if needed\n\t\t\t\t\tif ( s.mimeType && xhr.overrideMimeType ) {\n\t\t\t\t\t\txhr.overrideMimeType( s.mimeType );\n\t\t\t\t\t}\n\n\t\t\t\t\t// X-Requested-With header\n\t\t\t\t\t// For cross-domain requests, seeing as conditions for a preflight are\n\t\t\t\t\t// akin to a jigsaw puzzle, we simply never set it to be sure.\n\t\t\t\t\t// (it can always be set on a per-request basis or even using ajaxSetup)\n\t\t\t\t\t// For same-domain requests, won't change header if already provided.\n\t\t\t\t\tif ( !s.crossDomain && !headers[\"X-Requested-With\"] ) {\n\t\t\t\t\t\theaders[ \"X-Requested-With\" ] = \"XMLHttpRequest\";\n\t\t\t\t\t}\n\n\t\t\t\t\t// Need an extra try/catch for cross domain requests in Firefox 3\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfor ( i in headers ) {\n\t\t\t\t\t\t\txhr.setRequestHeader( i, headers[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch( _ ) {}\n\n\t\t\t\t\t// Do send the request\n\t\t\t\t\t// This may raise an exception which is actually\n\t\t\t\t\t// handled in jQuery.ajax (so no try/catch here)\n\t\t\t\t\txhr.send( ( s.hasContent && s.data ) || null );\n\n\t\t\t\t\t// Listener\n\t\t\t\t\tcallback = function( _, isAbort ) {\n\n\t\t\t\t\t\tvar status,\n\t\t\t\t\t\t\tstatusText,\n\t\t\t\t\t\t\tresponseHeaders,\n\t\t\t\t\t\t\tresponses,\n\t\t\t\t\t\t\txml;\n\n\t\t\t\t\t\t// Firefox throws exceptions when accessing properties\n\t\t\t\t\t\t// of an xhr when a network error occured\n\t\t\t\t\t\t// http://helpful.knobs-dials.com/index.php/Component_returned_failure_code:_0x80040111_(NS_ERROR_NOT_AVAILABLE)\n\t\t\t\t\t\ttry {\n\n\t\t\t\t\t\t\t// Was never called and is aborted or complete\n\t\t\t\t\t\t\tif ( callback && ( isAbort || xhr.readyState === 4 ) ) {\n\n\t\t\t\t\t\t\t\t// Only called once\n\t\t\t\t\t\t\t\tcallback = undefined;\n\n\t\t\t\t\t\t\t\t// Do not keep as active anymore\n\t\t\t\t\t\t\t\tif ( handle ) {\n\t\t\t\t\t\t\t\t\txhr.onreadystatechange = jQuery.noop;\n\t\t\t\t\t\t\t\t\tif ( xhrOnUnloadAbort ) {\n\t\t\t\t\t\t\t\t\t\tdelete xhrCallbacks[ handle ];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// If it's an abort\n\t\t\t\t\t\t\t\tif ( isAbort ) {\n\t\t\t\t\t\t\t\t\t// Abort it manually if needed\n\t\t\t\t\t\t\t\t\tif ( xhr.readyState !== 4 ) {\n\t\t\t\t\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tstatus = xhr.status;\n\t\t\t\t\t\t\t\t\tresponseHeaders = xhr.getAllResponseHeaders();\n\t\t\t\t\t\t\t\t\tresponses = {};\n\t\t\t\t\t\t\t\t\txml = xhr.responseXML;\n\n\t\t\t\t\t\t\t\t\t// Construct response list\n\t\t\t\t\t\t\t\t\tif ( xml && xml.documentElement /* #4958 */ ) {\n\t\t\t\t\t\t\t\t\t\tresponses.xml = xml;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// When requesting binary data, IE6-9 will throw an exception\n\t\t\t\t\t\t\t\t\t// on any attempt to access responseText (#11426)\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tresponses.text = xhr.responseText;\n\t\t\t\t\t\t\t\t\t} catch( _ ) {\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Firefox throws an exception when accessing\n\t\t\t\t\t\t\t\t\t// statusText for faulty cross-domain requests\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tstatusText = xhr.statusText;\n\t\t\t\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t\t\t\t// We normalize with Webkit giving an empty statusText\n\t\t\t\t\t\t\t\t\t\tstatusText = \"\";\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Filter status for non standard behaviors\n\n\t\t\t\t\t\t\t\t\t// If the request is local and we have data: assume a success\n\t\t\t\t\t\t\t\t\t// (success with no data won't get notified, that's the best we\n\t\t\t\t\t\t\t\t\t// can do given current implementations)\n\t\t\t\t\t\t\t\t\tif ( !status && s.isLocal && !s.crossDomain ) {\n\t\t\t\t\t\t\t\t\t\tstatus = responses.text ? 200 : 404;\n\t\t\t\t\t\t\t\t\t// IE - #1450: sometimes returns 1223 when it should be 204\n\t\t\t\t\t\t\t\t\t} else if ( status === 1223 ) {\n\t\t\t\t\t\t\t\t\t\tstatus = 204;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch( firefoxAccessException ) {\n\t\t\t\t\t\t\tif ( !isAbort ) {\n\t\t\t\t\t\t\t\tcomplete( -1, firefoxAccessException );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Call complete if needed\n\t\t\t\t\t\tif ( responses ) {\n\t\t\t\t\t\t\tcomplete( status, statusText, responses, responseHeaders );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// if we're in sync mode or it's in cache\n\t\t\t\t\t// and has been retrieved directly (IE6 & IE7)\n\t\t\t\t\t// we need to manually fire the callback\n\t\t\t\t\tif ( !s.async || xhr.readyState === 4 ) {\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t} else {\n\t\t\t\t\t\thandle = ++xhrId;\n\t\t\t\t\t\tif ( xhrOnUnloadAbort ) {\n\t\t\t\t\t\t\t// Create the active xhrs callbacks list if needed\n\t\t\t\t\t\t\t// and attach the unload handler\n\t\t\t\t\t\t\tif ( !xhrCallbacks ) {\n\t\t\t\t\t\t\t\txhrCallbacks = {};\n\t\t\t\t\t\t\t\tjQuery( window ).unload( xhrOnUnloadAbort );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Add to list of active xhrs callbacks\n\t\t\t\t\t\t\txhrCallbacks[ handle ] = callback;\n\t\t\t\t\t\t}\n\t\t\t\t\t\txhr.onreadystatechange = callback;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tabort: function() {\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\tcallback(0,1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t});\n}\n\n\n\n\nvar elemdisplay = {},\n\tiframe, iframeDoc,\n\trfxtypes = /^(?:toggle|show|hide)$/,\n\trfxnum = /^([+\\-]=)?([\\d+.\\-]+)([a-z%]*)$/i,\n\ttimerId,\n\tfxAttrs = [\n\t\t// height animations\n\t\t[ \"height\", \"marginTop\", \"marginBottom\", \"paddingTop\", \"paddingBottom\" ],\n\t\t// width animations\n\t\t[ \"width\", \"marginLeft\", \"marginRight\", \"paddingLeft\", \"paddingRight\" ],\n\t\t// opacity animations\n\t\t[ \"opacity\" ]\n\t],\n\tfxNow;\n\njQuery.fn.extend({\n\tshow: function( speed, easing, callback ) {\n\t\tvar elem, display;\n\n\t\tif ( speed || speed === 0 ) {\n\t\t\treturn this.animate( genFx(\"show\", 3), speed, easing, callback );\n\n\t\t} else {\n\t\t\tfor ( var i = 0, j = this.length; i < j; i++ ) {\n\t\t\t\telem = this[ i ];\n\n\t\t\t\tif ( elem.style ) {\n\t\t\t\t\tdisplay = elem.style.display;\n\n\t\t\t\t\t// Reset the inline display of this element to learn if it is\n\t\t\t\t\t// being hidden by cascaded rules or not\n\t\t\t\t\tif ( !jQuery._data(elem, \"olddisplay\") && display === \"none\" ) {\n\t\t\t\t\t\tdisplay = elem.style.display = \"\";\n\t\t\t\t\t}\n\n\t\t\t\t\t// Set elements which have been overridden with display: none\n\t\t\t\t\t// in a stylesheet to whatever the default browser style is\n\t\t\t\t\t// for such an element\n\t\t\t\t\tif ( (display === \"\" && jQuery.css(elem, \"display\") === \"none\") ||\n\t\t\t\t\t\t!jQuery.contains( elem.ownerDocument.documentElement, elem ) ) {\n\t\t\t\t\t\tjQuery._data( elem, \"olddisplay\", defaultDisplay(elem.nodeName) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set the display of most of the elements in a second loop\n\t\t\t// to avoid the constant reflow\n\t\t\tfor ( i = 0; i < j; i++ ) {\n\t\t\t\telem = this[ i ];\n\n\t\t\t\tif ( elem.style ) {\n\t\t\t\t\tdisplay = elem.style.display;\n\n\t\t\t\t\tif ( display === \"\" || display === \"none\" ) {\n\t\t\t\t\t\telem.style.display = jQuery._data( elem, \"olddisplay\" ) || \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\t},\n\n\thide: function( speed, easing, callback ) {\n\t\tif ( speed || speed === 0 ) {\n\t\t\treturn this.animate( genFx(\"hide\", 3), speed, easing, callback);\n\n\t\t} else {\n\t\t\tvar elem, display,\n\t\t\t\ti = 0,\n\t\t\t\tj = this.length;\n\n\t\t\tfor ( ; i < j; i++ ) {\n\t\t\t\telem = this[i];\n\t\t\t\tif ( elem.style ) {\n\t\t\t\t\tdisplay = jQuery.css( elem, \"display\" );\n\n\t\t\t\t\tif ( display !== \"none\" && !jQuery._data( elem, \"olddisplay\" ) ) {\n\t\t\t\t\t\tjQuery._data( elem, \"olddisplay\", display );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set the display of the elements in a second loop\n\t\t\t// to avoid the constant reflow\n\t\t\tfor ( i = 0; i < j; i++ ) {\n\t\t\t\tif ( this[i].style ) {\n\t\t\t\t\tthis[i].style.display = \"none\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\t},\n\n\t// Save the old toggle function\n\t_toggle: jQuery.fn.toggle,\n\n\ttoggle: function( fn, fn2, callback ) {\n\t\tvar bool = typeof fn === \"boolean\";\n\n\t\tif ( jQuery.isFunction(fn) && jQuery.isFunction(fn2) ) {\n\t\t\tthis._toggle.apply( this, arguments );\n\n\t\t} else if ( fn == null || bool ) {\n\t\t\tthis.each(function() {\n\t\t\t\tvar state = bool ? fn : jQuery(this).is(\":hidden\");\n\t\t\t\tjQuery(this)[ state ? \"show\" : \"hide\" ]();\n\t\t\t});\n\n\t\t} else {\n\t\t\tthis.animate(genFx(\"toggle\", 3), fn, fn2, callback);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tfadeTo: function( speed, to, easing, callback ) {\n\t\treturn this.filter(\":hidden\").css(\"opacity\", 0).show().end()\n\t\t\t\t\t.animate({opacity: to}, speed, easing, callback);\n\t},\n\n\tanimate: function( prop, speed, easing, callback ) {\n\t\tvar optall = jQuery.speed( speed, easing, callback );\n\n\t\tif ( jQuery.isEmptyObject( prop ) ) {\n\t\t\treturn this.each( optall.complete, [ false ] );\n\t\t}\n\n\t\t// Do not change referenced properties as per-property easing will be lost\n\t\tprop = jQuery.extend( {}, prop );\n\n\t\tfunction doAnimation() {\n\t\t\t// XXX 'this' does not always have a nodeName when running the\n\t\t\t// test suite\n\n\t\t\tif ( optall.queue === false ) {\n\t\t\t\tjQuery._mark( this );\n\t\t\t}\n\n\t\t\tvar opt = jQuery.extend( {}, optall ),\n\t\t\t\tisElement = this.nodeType === 1,\n\t\t\t\thidden = isElement && jQuery(this).is(\":hidden\"),\n\t\t\t\tname, val, p, e, hooks, replace,\n\t\t\t\tparts, start, end, unit,\n\t\t\t\tmethod;\n\n\t\t\t// will store per property easing and be used to determine when an animation is complete\n\t\t\topt.animatedProperties = {};\n\n\t\t\t// first pass over propertys to expand / normalize\n\t\t\tfor ( p in prop ) {\n\t\t\t\tname = jQuery.camelCase( p );\n\t\t\t\tif ( p !== name ) {\n\t\t\t\t\tprop[ name ] = prop[ p ];\n\t\t\t\t\tdelete prop[ p ];\n\t\t\t\t}\n\n\t\t\t\tif ( ( hooks = jQuery.cssHooks[ name ] ) && \"expand\" in hooks ) {\n\t\t\t\t\treplace = hooks.expand( prop[ name ] );\n\t\t\t\t\tdelete prop[ name ];\n\n\t\t\t\t\t// not quite $.extend, this wont overwrite keys already present.\n\t\t\t\t\t// also - reusing 'p' from above because we have the correct \"name\"\n\t\t\t\t\tfor ( p in replace ) {\n\t\t\t\t\t\tif ( ! ( p in prop ) ) {\n\t\t\t\t\t\t\tprop[ p ] = replace[ p ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor ( name in prop ) {\n\t\t\t\tval = prop[ name ];\n\t\t\t\t// easing resolution: per property > opt.specialEasing > opt.easing > 'swing' (default)\n\t\t\t\tif ( jQuery.isArray( val ) ) {\n\t\t\t\t\topt.animatedProperties[ name ] = val[ 1 ];\n\t\t\t\t\tval = prop[ name ] = val[ 0 ];\n\t\t\t\t} else {\n\t\t\t\t\topt.animatedProperties[ name ] = opt.specialEasing && opt.specialEasing[ name ] || opt.easing || 'swing';\n\t\t\t\t}\n\n\t\t\t\tif ( val === \"hide\" && hidden || val === \"show\" && !hidden ) {\n\t\t\t\t\treturn opt.complete.call( this );\n\t\t\t\t}\n\n\t\t\t\tif ( isElement && ( name === \"height\" || name === \"width\" ) ) {\n\t\t\t\t\t// Make sure that nothing sneaks out\n\t\t\t\t\t// Record all 3 overflow attributes because IE does not\n\t\t\t\t\t// change the overflow attribute when overflowX and\n\t\t\t\t\t// overflowY are set to the same value\n\t\t\t\t\topt.overflow = [ this.style.overflow, this.style.overflowX, this.style.overflowY ];\n\n\t\t\t\t\t// Set display property to inline-block for height/width\n\t\t\t\t\t// animations on inline elements that are having width/height animated\n\t\t\t\t\tif ( jQuery.css( this, \"display\" ) === \"inline\" &&\n\t\t\t\t\t\t\tjQuery.css( this, \"float\" ) === \"none\" ) {\n\n\t\t\t\t\t\t// inline-level elements accept inline-block;\n\t\t\t\t\t\t// block-level elements need to be inline with layout\n\t\t\t\t\t\tif ( !jQuery.support.inlineBlockNeedsLayout || defaultDisplay( this.nodeName ) === \"inline\" ) {\n\t\t\t\t\t\t\tthis.style.display = \"inline-block\";\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.style.zoom = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( opt.overflow != null ) {\n\t\t\t\tthis.style.overflow = \"hidden\";\n\t\t\t}\n\n\t\t\tfor ( p in prop ) {\n\t\t\t\te = new jQuery.fx( this, opt, p );\n\t\t\t\tval = prop[ p ];\n\n\t\t\t\tif ( rfxtypes.test( val ) ) {\n\n\t\t\t\t\t// Tracks whether to show or hide based on private\n\t\t\t\t\t// data attached to the element\n\t\t\t\t\tmethod = jQuery._data( this, \"toggle\" + p ) || ( val === \"toggle\" ? hidden ? \"show\" : \"hide\" : 0 );\n\t\t\t\t\tif ( method ) {\n\t\t\t\t\t\tjQuery._data( this, \"toggle\" + p, method === \"show\" ? \"hide\" : \"show\" );\n\t\t\t\t\t\te[ method ]();\n\t\t\t\t\t} else {\n\t\t\t\t\t\te[ val ]();\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tparts = rfxnum.exec( val );\n\t\t\t\t\tstart = e.cur();\n\n\t\t\t\t\tif ( parts ) {\n\t\t\t\t\t\tend = parseFloat( parts[2] );\n\t\t\t\t\t\tunit = parts[3] || ( jQuery.cssNumber[ p ] ? \"\" : \"px\" );\n\n\t\t\t\t\t\t// We need to compute starting value\n\t\t\t\t\t\tif ( unit !== \"px\" ) {\n\t\t\t\t\t\t\tjQuery.style( this, p, (end || 1) + unit);\n\t\t\t\t\t\t\tstart = ( (end || 1) / e.cur() ) * start;\n\t\t\t\t\t\t\tjQuery.style( this, p, start + unit);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If a +=/-= token was provided, we're doing a relative animation\n\t\t\t\t\t\tif ( parts[1] ) {\n\t\t\t\t\t\t\tend = ( (parts[ 1 ] === \"-=\" ? -1 : 1) * end ) + start;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\te.custom( start, end, unit );\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.custom( start, val, \"\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// For JS strict compliance\n\t\t\treturn true;\n\t\t}\n\n\t\treturn optall.queue === false ?\n\t\t\tthis.each( doAnimation ) :\n\t\t\tthis.queue( optall.queue, doAnimation );\n\t},\n\n\tstop: function( type, clearQueue, gotoEnd ) {\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tgotoEnd = clearQueue;\n\t\t\tclearQueue = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\tif ( clearQueue && type !== false ) {\n\t\t\tthis.queue( type || \"fx\", [] );\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tvar index,\n\t\t\t\thadTimers = false,\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tdata = jQuery._data( this );\n\n\t\t\t// clear marker counters if we know they won't be\n\t\t\tif ( !gotoEnd ) {\n\t\t\t\tjQuery._unmark( true, this );\n\t\t\t}\n\n\t\t\tfunction stopQueue( elem, data, index ) {\n\t\t\t\tvar hooks = data[ index ];\n\t\t\t\tjQuery.removeData( elem, index, true );\n\t\t\t\thooks.stop( gotoEnd );\n\t\t\t}\n\n\t\t\tif ( type == null ) {\n\t\t\t\tfor ( index in data ) {\n\t\t\t\t\tif ( data[ index ] && data[ index ].stop && index.indexOf(\".run\") === index.length - 4 ) {\n\t\t\t\t\t\tstopQueue( this, data, index );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if ( data[ index = type + \".run\" ] && data[ index ].stop ){\n\t\t\t\tstopQueue( this, data, index );\n\t\t\t}\n\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {\n\t\t\t\t\tif ( gotoEnd ) {\n\n\t\t\t\t\t\t// force the next step to be the last\n\t\t\t\t\t\ttimers[ index ]( true );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimers[ index ].saveState();\n\t\t\t\t\t}\n\t\t\t\t\thadTimers = true;\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// start the next in the queue if the last step wasn't forced\n\t\t\t// timers currently will call their complete callbacks, which will dequeue\n\t\t\t// but only if they were gotoEnd\n\t\t\tif ( !( gotoEnd && hadTimers ) ) {\n\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t}\n\t\t});\n\t}\n\n});\n\n// Animations created synchronously will run synchronously\nfunction createFxNow() {\n\tsetTimeout( clearFxNow, 0 );\n\treturn ( fxNow = jQuery.now() );\n}\n\nfunction clearFxNow() {\n\tfxNow = undefined;\n}\n\n// Generate parameters to create a standard animation\nfunction genFx( type, num ) {\n\tvar obj = {};\n\n\tjQuery.each( fxAttrs.concat.apply([], fxAttrs.slice( 0, num )), function() {\n\t\tobj[ this ] = type;\n\t});\n\n\treturn obj;\n}\n\n// Generate shortcuts for custom animations\njQuery.each({\n\tslideDown: genFx( \"show\", 1 ),\n\tslideUp: genFx( \"hide\", 1 ),\n\tslideToggle: genFx( \"toggle\", 1 ),\n\tfadeIn: { opacity: \"show\" },\n\tfadeOut: { opacity: \"hide\" },\n\tfadeToggle: { opacity: \"toggle\" }\n}, function( name, props ) {\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn this.animate( props, speed, easing, callback );\n\t};\n});\n\njQuery.extend({\n\tspeed: function( speed, easing, fn ) {\n\t\tvar opt = speed && typeof speed === \"object\" ? jQuery.extend( {}, speed ) : {\n\t\t\tcomplete: fn || !fn && easing ||\n\t\t\t\tjQuery.isFunction( speed ) && speed,\n\t\t\tduration: speed,\n\t\t\teasing: fn && easing || easing && !jQuery.isFunction( easing ) && easing\n\t\t};\n\n\t\topt.duration = jQuery.fx.off ? 0 : typeof opt.duration === \"number\" ? opt.duration :\n\t\t\topt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;\n\n\t\t// normalize opt.queue - true/undefined/null -> \"fx\"\n\t\tif ( opt.queue == null || opt.queue === true ) {\n\t\t\topt.queue = \"fx\";\n\t\t}\n\n\t\t// Queueing\n\t\topt.old = opt.complete;\n\n\t\topt.complete = function( noUnmark ) {\n\t\t\tif ( jQuery.isFunction( opt.old ) ) {\n\t\t\t\topt.old.call( this );\n\t\t\t}\n\n\t\t\tif ( opt.queue ) {\n\t\t\t\tjQuery.dequeue( this, opt.queue );\n\t\t\t} else if ( noUnmark !== false ) {\n\t\t\t\tjQuery._unmark( this );\n\t\t\t}\n\t\t};\n\n\t\treturn opt;\n\t},\n\n\teasing: {\n\t\tlinear: function( p ) {\n\t\t\treturn p;\n\t\t},\n\t\tswing: function( p ) {\n\t\t\treturn ( -Math.cos( p*Math.PI ) / 2 ) + 0.5;\n\t\t}\n\t},\n\n\ttimers: [],\n\n\tfx: function( elem, options, prop ) {\n\t\tthis.options = options;\n\t\tthis.elem = elem;\n\t\tthis.prop = prop;\n\n\t\toptions.orig = options.orig || {};\n\t}\n\n});\n\njQuery.fx.prototype = {\n\t// Simple function for setting a style value\n\tupdate: function() {\n\t\tif ( this.options.step ) {\n\t\t\tthis.options.step.call( this.elem, this.now, this );\n\t\t}\n\n\t\t( jQuery.fx.step[ this.prop ] || jQuery.fx.step._default )( this );\n\t},\n\n\t// Get the current size\n\tcur: function() {\n\t\tif ( this.elem[ this.prop ] != null && (!this.elem.style || this.elem.style[ this.prop ] == null) ) {\n\t\t\treturn this.elem[ this.prop ];\n\t\t}\n\n\t\tvar parsed,\n\t\t\tr = jQuery.css( this.elem, this.prop );\n\t\t// Empty strings, null, undefined and \"auto\" are converted to 0,\n\t\t// complex values such as \"rotate(1rad)\" are returned as is,\n\t\t// simple values such as \"10px\" are parsed to Float.\n\t\treturn isNaN( parsed = parseFloat( r ) ) ? !r || r === \"auto\" ? 0 : r : parsed;\n\t},\n\n\t// Start an animation from one number to another\n\tcustom: function( from, to, unit ) {\n\t\tvar self = this,\n\t\t\tfx = jQuery.fx;\n\n\t\tthis.startTime = fxNow || createFxNow();\n\t\tthis.end = to;\n\t\tthis.now = this.start = from;\n\t\tthis.pos = this.state = 0;\n\t\tthis.unit = unit || this.unit || ( jQuery.cssNumber[ this.prop ] ? \"\" : \"px\" );\n\n\t\tfunction t( gotoEnd ) {\n\t\t\treturn self.step( gotoEnd );\n\t\t}\n\n\t\tt.queue = this.options.queue;\n\t\tt.elem = this.elem;\n\t\tt.saveState = function() {\n\t\t\tif ( jQuery._data( self.elem, \"fxshow\" + self.prop ) === undefined ) {\n\t\t\t\tif ( self.options.hide ) {\n\t\t\t\t\tjQuery._data( self.elem, \"fxshow\" + self.prop, self.start );\n\t\t\t\t} else if ( self.options.show ) {\n\t\t\t\t\tjQuery._data( self.elem, \"fxshow\" + self.prop, self.end );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif ( t() && jQuery.timers.push(t) && !timerId ) {\n\t\t\ttimerId = setInterval( fx.tick, fx.interval );\n\t\t}\n\t},\n\n\t// Simple 'show' function\n\tshow: function() {\n\t\tvar dataShow = jQuery._data( this.elem, \"fxshow\" + this.prop );\n\n\t\t// Remember where we started, so that we can go back to it later\n\t\tthis.options.orig[ this.prop ] = dataShow || jQuery.style( this.elem, this.prop );\n\t\tthis.options.show = true;\n\n\t\t// Begin the animation\n\t\t// Make sure that we start at a small width/height to avoid any flash of content\n\t\tif ( dataShow !== undefined ) {\n\t\t\t// This show is picking up where a previous hide or show left off\n\t\t\tthis.custom( this.cur(), dataShow );\n\t\t} else {\n\t\t\tthis.custom( this.prop === \"width\" || this.prop === \"height\" ? 1 : 0, this.cur() );\n\t\t}\n\n\t\t// Start by showing the element\n\t\tjQuery( this.elem ).show();\n\t},\n\n\t// Simple 'hide' function\n\thide: function() {\n\t\t// Remember where we started, so that we can go back to it later\n\t\tthis.options.orig[ this.prop ] = jQuery._data( this.elem, \"fxshow\" + this.prop ) || jQuery.style( this.elem, this.prop );\n\t\tthis.options.hide = true;\n\n\t\t// Begin the animation\n\t\tthis.custom( this.cur(), 0 );\n\t},\n\n\t// Each step of an animation\n\tstep: function( gotoEnd ) {\n\t\tvar p, n, complete,\n\t\t\tt = fxNow || createFxNow(),\n\t\t\tdone = true,\n\t\t\telem = this.elem,\n\t\t\toptions = this.options;\n\n\t\tif ( gotoEnd || t >= options.duration + this.startTime ) {\n\t\t\tthis.now = this.end;\n\t\t\tthis.pos = this.state = 1;\n\t\t\tthis.update();\n\n\t\t\toptions.animatedProperties[ this.prop ] = true;\n\n\t\t\tfor ( p in options.animatedProperties ) {\n\t\t\t\tif ( options.animatedProperties[ p ] !== true ) {\n\t\t\t\t\tdone = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( done ) {\n\t\t\t\t// Reset the overflow\n\t\t\t\tif ( options.overflow != null && !jQuery.support.shrinkWrapBlocks ) {\n\n\t\t\t\t\tjQuery.each( [ \"\", \"X\", \"Y\" ], function( index, value ) {\n\t\t\t\t\t\telem.style[ \"overflow\" + value ] = options.overflow[ index ];\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Hide the element if the \"hide\" operation was done\n\t\t\t\tif ( options.hide ) {\n\t\t\t\t\tjQuery( elem ).hide();\n\t\t\t\t}\n\n\t\t\t\t// Reset the properties, if the item has been hidden or shown\n\t\t\t\tif ( options.hide || options.show ) {\n\t\t\t\t\tfor ( p in options.animatedProperties ) {\n\t\t\t\t\t\tjQuery.style( elem, p, options.orig[ p ] );\n\t\t\t\t\t\tjQuery.removeData( elem, \"fxshow\" + p, true );\n\t\t\t\t\t\t// Toggle data is no longer needed\n\t\t\t\t\t\tjQuery.removeData( elem, \"toggle\" + p, true );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Execute the complete function\n\t\t\t\t// in the event that the complete function throws an exception\n\t\t\t\t// we must ensure it won't be called twice. #5684\n\n\t\t\t\tcomplete = options.complete;\n\t\t\t\tif ( complete ) {\n\n\t\t\t\t\toptions.complete = false;\n\t\t\t\t\tcomplete.call( elem );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t} else {\n\t\t\t// classical easing cannot be used with an Infinity duration\n\t\t\tif ( options.duration == Infinity ) {\n\t\t\t\tthis.now = t;\n\t\t\t} else {\n\t\t\t\tn = t - this.startTime;\n\t\t\t\tthis.state = n / options.duration;\n\n\t\t\t\t// Perform the easing function, defaults to swing\n\t\t\t\tthis.pos = jQuery.easing[ options.animatedProperties[this.prop] ]( this.state, n, 0, 1, options.duration );\n\t\t\t\tthis.now = this.start + ( (this.end - this.start) * this.pos );\n\t\t\t}\n\t\t\t// Perform the next step of the animation\n\t\t\tthis.update();\n\t\t}\n\n\t\treturn true;\n\t}\n};\n\njQuery.extend( jQuery.fx, {\n\ttick: function() {\n\t\tvar timer,\n\t\t\ttimers = jQuery.timers,\n\t\t\ti = 0;\n\n\t\tfor ( ; i < timers.length; i++ ) {\n\t\t\ttimer = timers[ i ];\n\t\t\t// Checks the timer has not already been removed\n\t\t\tif ( !timer() && timers[ i ] === timer ) {\n\t\t\t\ttimers.splice( i--, 1 );\n\t\t\t}\n\t\t}\n\n\t\tif ( !timers.length ) {\n\t\t\tjQuery.fx.stop();\n\t\t}\n\t},\n\n\tinterval: 13,\n\n\tstop: function() {\n\t\tclearInterval( timerId );\n\t\ttimerId = null;\n\t},\n\n\tspeeds: {\n\t\tslow: 600,\n\t\tfast: 200,\n\t\t// Default speed\n\t\t_default: 400\n\t},\n\n\tstep: {\n\t\topacity: function( fx ) {\n\t\t\tjQuery.style( fx.elem, \"opacity\", fx.now );\n\t\t},\n\n\t\t_default: function( fx ) {\n\t\t\tif ( fx.elem.style && fx.elem.style[ fx.prop ] != null ) {\n\t\t\t\tfx.elem.style[ fx.prop ] = fx.now + fx.unit;\n\t\t\t} else {\n\t\t\t\tfx.elem[ fx.prop ] = fx.now;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// Ensure props that can't be negative don't go there on undershoot easing\njQuery.each( fxAttrs.concat.apply( [], fxAttrs ), function( i, prop ) {\n\t// exclude marginTop, marginLeft, marginBottom and marginRight from this list\n\tif ( prop.indexOf( \"margin\" ) ) {\n\t\tjQuery.fx.step[ prop ] = function( fx ) {\n\t\t\tjQuery.style( fx.elem, prop, Math.max(0, fx.now) + fx.unit );\n\t\t};\n\t}\n});\n\nif ( jQuery.expr && jQuery.expr.filters ) {\n\tjQuery.expr.filters.animated = function( elem ) {\n\t\treturn jQuery.grep(jQuery.timers, function( fn ) {\n\t\t\treturn elem === fn.elem;\n\t\t}).length;\n\t};\n}\n\n// Try to restore the default display value of an element\nfunction defaultDisplay( nodeName ) {\n\n\tif ( !elemdisplay[ nodeName ] ) {\n\n\t\tvar body = document.body,\n\t\t\telem = jQuery( \"<\" + nodeName + \">\" ).appendTo( body ),\n\t\t\tdisplay = elem.css( \"display\" );\n\t\telem.remove();\n\n\t\t// If the simple way fails,\n\t\t// get element's real default display by attaching it to a temp iframe\n\t\tif ( display === \"none\" || display === \"\" ) {\n\t\t\t// No iframe to use yet, so create it\n\t\t\tif ( !iframe ) {\n\t\t\t\tiframe = document.createElement( \"iframe\" );\n\t\t\t\tiframe.frameBorder = iframe.width = iframe.height = 0;\n\t\t\t}\n\n\t\t\tbody.appendChild( iframe );\n\n\t\t\t// Create a cacheable copy of the iframe document on first call.\n\t\t\t// IE and Opera will allow us to reuse the iframeDoc without re-writing the fake HTML\n\t\t\t// document to it; WebKit & Firefox won't allow reusing the iframe document.\n\t\t\tif ( !iframeDoc || !iframe.createElement ) {\n\t\t\t\tiframeDoc = ( iframe.contentWindow || iframe.contentDocument ).document;\n\t\t\t\tiframeDoc.write( ( jQuery.support.boxModel ? \"<!doctype html>\" : \"\" ) + \"<html><body>\" );\n\t\t\t\tiframeDoc.close();\n\t\t\t}\n\n\t\t\telem = iframeDoc.createElement( nodeName );\n\n\t\t\tiframeDoc.body.appendChild( elem );\n\n\t\t\tdisplay = jQuery.css( elem, \"display\" );\n\t\t\tbody.removeChild( iframe );\n\t\t}\n\n\t\t// Store the correct default display\n\t\telemdisplay[ nodeName ] = display;\n\t}\n\n\treturn elemdisplay[ nodeName ];\n}\n\n\n\n\nvar getOffset,\n\trtable = /^t(?:able|d|h)$/i,\n\trroot = /^(?:body|html)$/i;\n\nif ( \"getBoundingClientRect\" in document.documentElement ) {\n\tgetOffset = function( elem, doc, docElem, box ) {\n\t\ttry {\n\t\t\tbox = elem.getBoundingClientRect();\n\t\t} catch(e) {}\n\n\t\t// Make sure we're not dealing with a disconnected DOM node\n\t\tif ( !box || !jQuery.contains( docElem, elem ) ) {\n\t\t\treturn box ? { top: box.top, left: box.left } : { top: 0, left: 0 };\n\t\t}\n\n\t\tvar body = doc.body,\n\t\t\twin = getWindow( doc ),\n\t\t\tclientTop  = docElem.clientTop  || body.clientTop  || 0,\n\t\t\tclientLeft = docElem.clientLeft || body.clientLeft || 0,\n\t\t\tscrollTop  = win.pageYOffset || jQuery.support.boxModel && docElem.scrollTop  || body.scrollTop,\n\t\t\tscrollLeft = win.pageXOffset || jQuery.support.boxModel && docElem.scrollLeft || body.scrollLeft,\n\t\t\ttop  = box.top  + scrollTop  - clientTop,\n\t\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\treturn { top: top, left: left };\n\t};\n\n} else {\n\tgetOffset = function( elem, doc, docElem ) {\n\t\tvar computedStyle,\n\t\t\toffsetParent = elem.offsetParent,\n\t\t\tprevOffsetParent = elem,\n\t\t\tbody = doc.body,\n\t\t\tdefaultView = doc.defaultView,\n\t\t\tprevComputedStyle = defaultView ? defaultView.getComputedStyle( elem, null ) : elem.currentStyle,\n\t\t\ttop = elem.offsetTop,\n\t\t\tleft = elem.offsetLeft;\n\n\t\twhile ( (elem = elem.parentNode) && elem !== body && elem !== docElem ) {\n\t\t\tif ( jQuery.support.fixedPosition && prevComputedStyle.position === \"fixed\" ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcomputedStyle = defaultView ? defaultView.getComputedStyle(elem, null) : elem.currentStyle;\n\t\t\ttop  -= elem.scrollTop;\n\t\t\tleft -= elem.scrollLeft;\n\n\t\t\tif ( elem === offsetParent ) {\n\t\t\t\ttop  += elem.offsetTop;\n\t\t\t\tleft += elem.offsetLeft;\n\n\t\t\t\tif ( jQuery.support.doesNotAddBorder && !(jQuery.support.doesAddBorderForTableAndCells && rtable.test(elem.nodeName)) ) {\n\t\t\t\t\ttop  += parseFloat( computedStyle.borderTopWidth  ) || 0;\n\t\t\t\t\tleft += parseFloat( computedStyle.borderLeftWidth ) || 0;\n\t\t\t\t}\n\n\t\t\t\tprevOffsetParent = offsetParent;\n\t\t\t\toffsetParent = elem.offsetParent;\n\t\t\t}\n\n\t\t\tif ( jQuery.support.subtractsBorderForOverflowNotVisible && computedStyle.overflow !== \"visible\" ) {\n\t\t\t\ttop  += parseFloat( computedStyle.borderTopWidth  ) || 0;\n\t\t\t\tleft += parseFloat( computedStyle.borderLeftWidth ) || 0;\n\t\t\t}\n\n\t\t\tprevComputedStyle = computedStyle;\n\t\t}\n\n\t\tif ( prevComputedStyle.position === \"relative\" || prevComputedStyle.position === \"static\" ) {\n\t\t\ttop  += body.offsetTop;\n\t\t\tleft += body.offsetLeft;\n\t\t}\n\n\t\tif ( jQuery.support.fixedPosition && prevComputedStyle.position === \"fixed\" ) {\n\t\t\ttop  += Math.max( docElem.scrollTop, body.scrollTop );\n\t\t\tleft += Math.max( docElem.scrollLeft, body.scrollLeft );\n\t\t}\n\n\t\treturn { top: top, left: left };\n\t};\n}\n\njQuery.fn.offset = function( options ) {\n\tif ( arguments.length ) {\n\t\treturn options === undefined ?\n\t\t\tthis :\n\t\t\tthis.each(function( i ) {\n\t\t\t\tjQuery.offset.setOffset( this, options, i );\n\t\t\t});\n\t}\n\n\tvar elem = this[0],\n\t\tdoc = elem && elem.ownerDocument;\n\n\tif ( !doc ) {\n\t\treturn null;\n\t}\n\n\tif ( elem === doc.body ) {\n\t\treturn jQuery.offset.bodyOffset( elem );\n\t}\n\n\treturn getOffset( elem, doc, doc.documentElement );\n};\n\njQuery.offset = {\n\n\tbodyOffset: function( body ) {\n\t\tvar top = body.offsetTop,\n\t\t\tleft = body.offsetLeft;\n\n\t\tif ( jQuery.support.doesNotIncludeMarginInBodyOffset ) {\n\t\t\ttop  += parseFloat( jQuery.css(body, \"marginTop\") ) || 0;\n\t\t\tleft += parseFloat( jQuery.css(body, \"marginLeft\") ) || 0;\n\t\t}\n\n\t\treturn { top: top, left: left };\n\t},\n\n\tsetOffset: function( elem, options, i ) {\n\t\tvar position = jQuery.css( elem, \"position\" );\n\n\t\t// set position first, in-case top/left are set even on static elem\n\t\tif ( position === \"static\" ) {\n\t\t\telem.style.position = \"relative\";\n\t\t}\n\n\t\tvar curElem = jQuery( elem ),\n\t\t\tcurOffset = curElem.offset(),\n\t\t\tcurCSSTop = jQuery.css( elem, \"top\" ),\n\t\t\tcurCSSLeft = jQuery.css( elem, \"left\" ),\n\t\t\tcalculatePosition = ( position === \"absolute\" || position === \"fixed\" ) && jQuery.inArray(\"auto\", [curCSSTop, curCSSLeft]) > -1,\n\t\t\tprops = {}, curPosition = {}, curTop, curLeft;\n\n\t\t// need to be able to calculate position if either top or left is auto and position is either absolute or fixed\n\t\tif ( calculatePosition ) {\n\t\t\tcurPosition = curElem.position();\n\t\t\tcurTop = curPosition.top;\n\t\t\tcurLeft = curPosition.left;\n\t\t} else {\n\t\t\tcurTop = parseFloat( curCSSTop ) || 0;\n\t\t\tcurLeft = parseFloat( curCSSLeft ) || 0;\n\t\t}\n\n\t\tif ( jQuery.isFunction( options ) ) {\n\t\t\toptions = options.call( elem, i, curOffset );\n\t\t}\n\n\t\tif ( options.top != null ) {\n\t\t\tprops.top = ( options.top - curOffset.top ) + curTop;\n\t\t}\n\t\tif ( options.left != null ) {\n\t\t\tprops.left = ( options.left - curOffset.left ) + curLeft;\n\t\t}\n\n\t\tif ( \"using\" in options ) {\n\t\t\toptions.using.call( elem, props );\n\t\t} else {\n\t\t\tcurElem.css( props );\n\t\t}\n\t}\n};\n\n\njQuery.fn.extend({\n\n\tposition: function() {\n\t\tif ( !this[0] ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar elem = this[0],\n\n\t\t// Get *real* offsetParent\n\t\toffsetParent = this.offsetParent(),\n\n\t\t// Get correct offsets\n\t\toffset       = this.offset(),\n\t\tparentOffset = rroot.test(offsetParent[0].nodeName) ? { top: 0, left: 0 } : offsetParent.offset();\n\n\t\t// Subtract element margins\n\t\t// note: when an element has margin: auto the offsetLeft and marginLeft\n\t\t// are the same in Safari causing offset.left to incorrectly be 0\n\t\toffset.top  -= parseFloat( jQuery.css(elem, \"marginTop\") ) || 0;\n\t\toffset.left -= parseFloat( jQuery.css(elem, \"marginLeft\") ) || 0;\n\n\t\t// Add offsetParent borders\n\t\tparentOffset.top  += parseFloat( jQuery.css(offsetParent[0], \"borderTopWidth\") ) || 0;\n\t\tparentOffset.left += parseFloat( jQuery.css(offsetParent[0], \"borderLeftWidth\") ) || 0;\n\n\t\t// Subtract the two offsets\n\t\treturn {\n\t\t\ttop:  offset.top  - parentOffset.top,\n\t\t\tleft: offset.left - parentOffset.left\n\t\t};\n\t},\n\n\toffsetParent: function() {\n\t\treturn this.map(function() {\n\t\t\tvar offsetParent = this.offsetParent || document.body;\n\t\t\twhile ( offsetParent && (!rroot.test(offsetParent.nodeName) && jQuery.css(offsetParent, \"position\") === \"static\") ) {\n\t\t\t\toffsetParent = offsetParent.offsetParent;\n\t\t\t}\n\t\t\treturn offsetParent;\n\t\t});\n\t}\n});\n\n\n// Create scrollLeft and scrollTop methods\njQuery.each( {scrollLeft: \"pageXOffset\", scrollTop: \"pageYOffset\"}, function( method, prop ) {\n\tvar top = /Y/.test( prop );\n\n\tjQuery.fn[ method ] = function( val ) {\n\t\treturn jQuery.access( this, function( elem, method, val ) {\n\t\t\tvar win = getWindow( elem );\n\n\t\t\tif ( val === undefined ) {\n\t\t\t\treturn win ? (prop in win) ? win[ prop ] :\n\t\t\t\t\tjQuery.support.boxModel && win.document.documentElement[ method ] ||\n\t\t\t\t\t\twin.document.body[ method ] :\n\t\t\t\t\telem[ method ];\n\t\t\t}\n\n\t\t\tif ( win ) {\n\t\t\t\twin.scrollTo(\n\t\t\t\t\t!top ? val : jQuery( win ).scrollLeft(),\n\t\t\t\t\t top ? val : jQuery( win ).scrollTop()\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\telem[ method ] = val;\n\t\t\t}\n\t\t}, method, val, arguments.length, null );\n\t};\n});\n\nfunction getWindow( elem ) {\n\treturn jQuery.isWindow( elem ) ?\n\t\telem :\n\t\telem.nodeType === 9 ?\n\t\t\telem.defaultView || elem.parentWindow :\n\t\t\tfalse;\n}\n\n\n\n\n// Create width, height, innerHeight, innerWidth, outerHeight and outerWidth methods\njQuery.each( { Height: \"height\", Width: \"width\" }, function( name, type ) {\n\tvar clientProp = \"client\" + name,\n\t\tscrollProp = \"scroll\" + name,\n\t\toffsetProp = \"offset\" + name;\n\n\t// innerHeight and innerWidth\n\tjQuery.fn[ \"inner\" + name ] = function() {\n\t\tvar elem = this[0];\n\t\treturn elem ?\n\t\t\telem.style ?\n\t\t\tparseFloat( jQuery.css( elem, type, \"padding\" ) ) :\n\t\t\tthis[ type ]() :\n\t\t\tnull;\n\t};\n\n\t// outerHeight and outerWidth\n\tjQuery.fn[ \"outer\" + name ] = function( margin ) {\n\t\tvar elem = this[0];\n\t\treturn elem ?\n\t\t\telem.style ?\n\t\t\tparseFloat( jQuery.css( elem, type, margin ? \"margin\" : \"border\" ) ) :\n\t\t\tthis[ type ]() :\n\t\t\tnull;\n\t};\n\n\tjQuery.fn[ type ] = function( value ) {\n\t\treturn jQuery.access( this, function( elem, type, value ) {\n\t\t\tvar doc, docElemProp, orig, ret;\n\n\t\t\tif ( jQuery.isWindow( elem ) ) {\n\t\t\t\t// 3rd condition allows Nokia support, as it supports the docElem prop but not CSS1Compat\n\t\t\t\tdoc = elem.document;\n\t\t\t\tdocElemProp = doc.documentElement[ clientProp ];\n\t\t\t\treturn jQuery.support.boxModel && docElemProp ||\n\t\t\t\t\tdoc.body && doc.body[ clientProp ] || docElemProp;\n\t\t\t}\n\n\t\t\t// Get document width or height\n\t\t\tif ( elem.nodeType === 9 ) {\n\t\t\t\t// Either scroll[Width/Height] or offset[Width/Height], whichever is greater\n\t\t\t\tdoc = elem.documentElement;\n\n\t\t\t\t// when a window > document, IE6 reports a offset[Width/Height] > client[Width/Height]\n\t\t\t\t// so we can't use max, as it'll choose the incorrect offset[Width/Height]\n\t\t\t\t// instead we use the correct client[Width/Height]\n\t\t\t\t// support:IE6\n\t\t\t\tif ( doc[ clientProp ] >= doc[ scrollProp ] ) {\n\t\t\t\t\treturn doc[ clientProp ];\n\t\t\t\t}\n\n\t\t\t\treturn Math.max(\n\t\t\t\t\telem.body[ scrollProp ], doc[ scrollProp ],\n\t\t\t\t\telem.body[ offsetProp ], doc[ offsetProp ]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Get width or height on the element\n\t\t\tif ( value === undefined ) {\n\t\t\t\torig = jQuery.css( elem, type );\n\t\t\t\tret = parseFloat( orig );\n\t\t\t\treturn jQuery.isNumeric( ret ) ? ret : orig;\n\t\t\t}\n\n\t\t\t// Set the width or height on the element\n\t\t\tjQuery( elem ).css( type, value );\n\t\t}, type, value, arguments.length, null );\n\t};\n});\n\n\n\n\n// Expose jQuery to the global object\nwindow.jQuery = window.$ = jQuery;\n\n// Expose jQuery as an AMD module, but only for AMD loaders that\n// understand the issues with loading multiple versions of jQuery\n// in a page that all might call define(). The loader will indicate\n// they have special allowances for multiple jQuery versions by\n// specifying define.amd.jQuery = true. Register as a named module,\n// since jQuery can be concatenated with other files that may use define,\n// but not use a proper concatenation script that understands anonymous\n// AMD modules. A named AMD is safest and most robust way to register.\n// Lowercase jquery is used because AMD module names are derived from\n// file names, and jQuery is normally delivered in a lowercase file name.\n// Do this after creating the global so that if an AMD module wants to call\n// noConflict to hide this version of jQuery, it will work.\nif ( typeof define === \"function\" && define.amd && define.amd.jQuery ) {\n\tdefine( \"jquery\", [], function () { return jQuery; } );\n}\n\n\n\n})( window );\n"]}]}